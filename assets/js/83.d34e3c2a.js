(window.webpackJsonp=window.webpackJsonp||[]).push([[83],{441:function(s,a,n){"use strict";n.r(a);var e=n(4),t=Object(e.a)({},(function(){var s=this,a=s._self._c;return a("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[a("h1",{attrs:{id:"若依管理系统ruoyi-vue-二-权限系统设计详解-一枝梅的技术收录"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#若依管理系统ruoyi-vue-二-权限系统设计详解-一枝梅的技术收录"}},[s._v("#")]),s._v(" 若依管理系统RuoYi-Vue（二）：权限系统设计详解 - 一枝梅的技术收录")]),s._v(" "),a("p",[a("a",{attrs:{href:"https://blog.kdyzm.cn/post/45",target:"_blank",rel:"noopener noreferrer"}},[s._v("https://blog.kdyzm.cn/post/45"),a("OutboundLink")],1)]),s._v(" "),a("p",[s._v("本篇文章试图讲解若依Vue系统中的权限设计原理以及实战，为什么是“试图”？因为这也是摸索着理解的，不一定准")]),s._v(" "),a("p",[s._v("若依Vue系统中的权限管理部分的功能都集中在了系统管理菜单模块中，如下图所示。其中权限部分主要涉及到了用户管理、角色管理、菜单管理、部门管理这四个部分。")]),s._v(" "),a("p",[a("img",{staticClass:"lazy",attrs:{alt:"%E8%8B%A5%E4%BE%9D%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9FRuoYi-Vue%EF%BC%88%E4%BA%8C%EF%BC%89%EF%BC%9A%E6%9D%83%E9%99%90%E7%B3%BB%E7%BB%9F%E8%AE%BE%E8%AE%A1%E8%AF%A6%E8%A7%A3%20-%20%E4%B8%80%E6%9E%9D%E6%A2%85%E7%9A%84%E6%8A%80%E6%9C%AF%E6%94%B6%E5%BD%95%2075091a4d849d41c9ba464571517093f4/2TS3KJER31SHCAKHD1ISTRSMR7.png","data-src":"%E8%8B%A5%E4%BE%9D%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9FRuoYi-Vue%EF%BC%88%E4%BA%8C%EF%BC%89%EF%BC%9A%E6%9D%83%E9%99%90%E7%B3%BB%E7%BB%9F%E8%AE%BE%E8%AE%A1%E8%AF%A6%E8%A7%A3%20-%20%E4%B8%80%E6%9E%9D%E6%A2%85%E7%9A%84%E6%8A%80%E6%9C%AF%E6%94%B6%E5%BD%95%2075091a4d849d41c9ba464571517093f4/2TS3KJER31SHCAKHD1ISTRSMR7.png",loading:"lazy"}})]),s._v(" "),a("h2",{attrs:{id:"一、若依vue系统中的权限分类"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#一、若依vue系统中的权限分类"}},[s._v("#")]),s._v(" 一、若依Vue系统中的权限分类")]),s._v(" "),a("p",[s._v("根据观察，若依Vue系统中的权限分为以下几类")]),s._v(" "),a("ul",[a("li",[s._v("菜单权限：用户登录系统之后能看到哪些菜单")]),s._v(" "),a("li",[s._v("按钮权限：用户在一个页面上能看到哪些按钮，比如新增、删除等按钮")]),s._v(" "),a("li",[s._v("接口权限：用户带着认证信息请求后端接口，是否有权限访问，该接口和前端页面上的按钮一一对应")]),s._v(" "),a("li",[s._v("数据权限：用户有权限访问后端某个接口，但是不同的用户相同的接口相同的入参，根据权限大小不同，返回的结果应当不一样——权限大的能够看到的数据更多。")])]),s._v(" "),a("h3",{attrs:{id:"_1-菜单权限"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_1-菜单权限"}},[s._v("#")]),s._v(" 1.菜单权限")]),s._v(" "),a("p",[s._v("这个比较好理解，拥有不同权限的用户登录系统之后看到的菜单是不一样的，从新建菜单到给一个用户分配菜单权限，上一篇文章已经讲过，不赘述。")]),s._v(" "),a("p",[s._v("用户登录之后会请求后端的"),a("code",[s._v("com.ruoyi.web.controller.system.SysLoginController#getRouters")]),s._v("接口获取登录用户的菜单数据：")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("select distinct m.menu_id, m.parent_id, m.menu_name, m.path, m.component, m.visible, m.status, ifnull(m.perms,'') as perms, m.is_frame, m.is_cache, m.menu_type, m.icon, m.order_num, m.create_time\n\t\tfrom sys_menu m\n\t\t\t left join sys_role_menu rm on m.menu_id = rm.menu_id\n\t\t\t left join sys_user_role ur on rm.role_id = ur.role_id\n\t\t\t left join sys_role ro on ur.role_id = ro.role_id\n\t\t\t left join sys_user u on ur.user_id = u.user_id\n\t\twhere u.user_id = #{userId} and m.menu_type in ('M', 'C') and m.status = 0  AND ro.status = 0\n\t\torder by m.parent_id, m.order_num\n\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br")])]),a("p",[s._v("菜单类型（M目录 C菜单 F按钮）；菜单状态（0显示 1隐藏）")]),s._v(" "),a("p",[s._v("这是典型的用户-角色-菜单模型。")]),s._v(" "),a("p",[s._v("前端会根据该接口返回的数据渲染出不同的菜单。")]),s._v(" "),a("h3",{attrs:{id:"_2-按钮权限"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_2-按钮权限"}},[s._v("#")]),s._v(" 2.按钮权限")]),s._v(" "),a("p",[s._v("新增按钮权限和新增菜单差不多，下图是我在新闻列表页面上新增了一个按钮叫做"),a("code",[s._v("新闻新增")]),s._v("，该按钮的权限分配和菜单的权限分配方法是一样的。")]),s._v(" "),a("p",[a("img",{staticClass:"lazy",attrs:{alt:"%E8%8B%A5%E4%BE%9D%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9FRuoYi-Vue%EF%BC%88%E4%BA%8C%EF%BC%89%EF%BC%9A%E6%9D%83%E9%99%90%E7%B3%BB%E7%BB%9F%E8%AE%BE%E8%AE%A1%E8%AF%A6%E8%A7%A3%20-%20%E4%B8%80%E6%9E%9D%E6%A2%85%E7%9A%84%E6%8A%80%E6%9C%AF%E6%94%B6%E5%BD%95%2075091a4d849d41c9ba464571517093f4/1GM0K7AFSIPAPK4829O06HUUD9.png","data-src":"%E8%8B%A5%E4%BE%9D%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9FRuoYi-Vue%EF%BC%88%E4%BA%8C%EF%BC%89%EF%BC%9A%E6%9D%83%E9%99%90%E7%B3%BB%E7%BB%9F%E8%AE%BE%E8%AE%A1%E8%AF%A6%E8%A7%A3%20-%20%E4%B8%80%E6%9E%9D%E6%A2%85%E7%9A%84%E6%8A%80%E6%9C%AF%E6%94%B6%E5%BD%95%2075091a4d849d41c9ba464571517093f4/1GM0K7AFSIPAPK4829O06HUUD9.png",loading:"lazy"}})]),s._v(" "),a("p",[a("img",{staticClass:"lazy",attrs:{alt:"%E8%8B%A5%E4%BE%9D%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9FRuoYi-Vue%EF%BC%88%E4%BA%8C%EF%BC%89%EF%BC%9A%E6%9D%83%E9%99%90%E7%B3%BB%E7%BB%9F%E8%AE%BE%E8%AE%A1%E8%AF%A6%E8%A7%A3%20-%20%E4%B8%80%E6%9E%9D%E6%A2%85%E7%9A%84%E6%8A%80%E6%9C%AF%E6%94%B6%E5%BD%95%2075091a4d849d41c9ba464571517093f4/3TPQMOUVRNBSNH41R9CCOG4OV4.png","data-src":"%E8%8B%A5%E4%BE%9D%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9FRuoYi-Vue%EF%BC%88%E4%BA%8C%EF%BC%89%EF%BC%9A%E6%9D%83%E9%99%90%E7%B3%BB%E7%BB%9F%E8%AE%BE%E8%AE%A1%E8%AF%A6%E8%A7%A3%20-%20%E4%B8%80%E6%9E%9D%E6%A2%85%E7%9A%84%E6%8A%80%E6%9C%AF%E6%94%B6%E5%BD%95%2075091a4d849d41c9ba464571517093f4/3TPQMOUVRNBSNH41R9CCOG4OV4.png",loading:"lazy"}})]),s._v(" "),a("h3",{attrs:{id:"_3-接口权限"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_3-接口权限"}},[s._v("#")]),s._v(" 3.接口权限")]),s._v(" "),a("p",[s._v("每一个按钮基本上都会对应着一个后端的接口，前端会根据权限标志显示或者隐藏按钮，但是如果用户不点击按钮，直接通过http请求工具请求后端咋办？所以接口权限也是要有的，该权限和按钮上权限完全一致。")]),s._v(" "),a("p",[s._v("若依系统使用了SpringSecurity框架，接口权限都是基于注解"),a("code",[s._v("@PreAuthorize")]),s._v("实现的，比如，用户管理页面中的修改用户按钮对应的后端接口长这个样子")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v('    @PreAuthorize("@ss.hasPermi(\'system:user:edit\')")\n    @Log(title = "用户管理", businessType = BusinessType.UPDATE)\n    @PutMapping\n    public AjaxResult edit(@Validated @RequestBody SysUser user)\n    {\n        ...\n    }\n\n')])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br")])]),a("p",[s._v("和其对应的前端按钮权限标志一样")]),s._v(" "),a("p",[a("img",{staticClass:"lazy",attrs:{alt:"%E8%8B%A5%E4%BE%9D%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9FRuoYi-Vue%EF%BC%88%E4%BA%8C%EF%BC%89%EF%BC%9A%E6%9D%83%E9%99%90%E7%B3%BB%E7%BB%9F%E8%AE%BE%E8%AE%A1%E8%AF%A6%E8%A7%A3%20-%20%E4%B8%80%E6%9E%9D%E6%A2%85%E7%9A%84%E6%8A%80%E6%9C%AF%E6%94%B6%E5%BD%95%2075091a4d849d41c9ba464571517093f4/2U23041DQ5KH3PPN6E46M5IB6T.png","data-src":"%E8%8B%A5%E4%BE%9D%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9FRuoYi-Vue%EF%BC%88%E4%BA%8C%EF%BC%89%EF%BC%9A%E6%9D%83%E9%99%90%E7%B3%BB%E7%BB%9F%E8%AE%BE%E8%AE%A1%E8%AF%A6%E8%A7%A3%20-%20%E4%B8%80%E6%9E%9D%E6%A2%85%E7%9A%84%E6%8A%80%E6%9C%AF%E6%94%B6%E5%BD%95%2075091a4d849d41c9ba464571517093f4/2U23041DQ5KH3PPN6E46M5IB6T.png",loading:"lazy"}})]),s._v(" "),a("p",[s._v("如果没有权限访问接口，则会返回类似如下信息：")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v('{\n"msg": "请求访问：/system/user/list，认证失败，无法访问系统资源",\n"code": 401\n}\n\n')])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br")])]),a("h3",{attrs:{id:"_4-数据权限"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_4-数据权限"}},[s._v("#")]),s._v(" 4.数据权限")]),s._v(" "),a("p",[s._v("用户有权限访问后端某个接口，但是不同的用户相同的接口相同的入参，根据权限大小不同，返回的结果应当不一样——权限大的能够看到的数据更多。")]),s._v(" "),a("p",[s._v("体现在若依Vue系统中，举个例子，现在若以系统中有两个用户，一个是超级管理员admin，一个是普通用户kdyzm")]),s._v(" "),a("p",[a("img",{staticClass:"lazy",attrs:{alt:"%E8%8B%A5%E4%BE%9D%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9FRuoYi-Vue%EF%BC%88%E4%BA%8C%EF%BC%89%EF%BC%9A%E6%9D%83%E9%99%90%E7%B3%BB%E7%BB%9F%E8%AE%BE%E8%AE%A1%E8%AF%A6%E8%A7%A3%20-%20%E4%B8%80%E6%9E%9D%E6%A2%85%E7%9A%84%E6%8A%80%E6%9C%AF%E6%94%B6%E5%BD%95%2075091a4d849d41c9ba464571517093f4/S9PUKL20QCR9GCNN3KCIUHDRA.png","data-src":"%E8%8B%A5%E4%BE%9D%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9FRuoYi-Vue%EF%BC%88%E4%BA%8C%EF%BC%89%EF%BC%9A%E6%9D%83%E9%99%90%E7%B3%BB%E7%BB%9F%E8%AE%BE%E8%AE%A1%E8%AF%A6%E8%A7%A3%20-%20%E4%B8%80%E6%9E%9D%E6%A2%85%E7%9A%84%E6%8A%80%E6%9C%AF%E6%94%B6%E5%BD%95%2075091a4d849d41c9ba464571517093f4/S9PUKL20QCR9GCNN3KCIUHDRA.png",loading:"lazy"}})]),s._v(" "),a("p",[s._v("它们两者均有用户管理、菜单管理、角色管理权限，所以它们能够看到相应的菜单并作出相应的操作，比如删除、新增、修改等。这里有个问题，kdyzm应当只能看到一部分数据，而超级管理员应当能够看到所有数据，在若依系统中，是通过对角色"),a("code",[s._v("数据权限")]),s._v("修改进行控制的。")]),s._v(" "),a("p",[a("img",{staticClass:"lazy",attrs:{alt:"%E8%8B%A5%E4%BE%9D%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9FRuoYi-Vue%EF%BC%88%E4%BA%8C%EF%BC%89%EF%BC%9A%E6%9D%83%E9%99%90%E7%B3%BB%E7%BB%9F%E8%AE%BE%E8%AE%A1%E8%AF%A6%E8%A7%A3%20-%20%E4%B8%80%E6%9E%9D%E6%A2%85%E7%9A%84%E6%8A%80%E6%9C%AF%E6%94%B6%E5%BD%95%2075091a4d849d41c9ba464571517093f4/2BONF6U5H5SNSRK84COBTDGPTQ.png","data-src":"%E8%8B%A5%E4%BE%9D%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9FRuoYi-Vue%EF%BC%88%E4%BA%8C%EF%BC%89%EF%BC%9A%E6%9D%83%E9%99%90%E7%B3%BB%E7%BB%9F%E8%AE%BE%E8%AE%A1%E8%AF%A6%E8%A7%A3%20-%20%E4%B8%80%E6%9E%9D%E6%A2%85%E7%9A%84%E6%8A%80%E6%9C%AF%E6%94%B6%E5%BD%95%2075091a4d849d41c9ba464571517093f4/2BONF6U5H5SNSRK84COBTDGPTQ.png",loading:"lazy"}})]),s._v(" "),a("p",[a("img",{staticClass:"lazy",attrs:{alt:"%E8%8B%A5%E4%BE%9D%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9FRuoYi-Vue%EF%BC%88%E4%BA%8C%EF%BC%89%EF%BC%9A%E6%9D%83%E9%99%90%E7%B3%BB%E7%BB%9F%E8%AE%BE%E8%AE%A1%E8%AF%A6%E8%A7%A3%20-%20%E4%B8%80%E6%9E%9D%E6%A2%85%E7%9A%84%E6%8A%80%E6%9C%AF%E6%94%B6%E5%BD%95%2075091a4d849d41c9ba464571517093f4/GU3KSDV82C3GHL4EPCEV2I8OH.png","data-src":"%E8%8B%A5%E4%BE%9D%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9FRuoYi-Vue%EF%BC%88%E4%BA%8C%EF%BC%89%EF%BC%9A%E6%9D%83%E9%99%90%E7%B3%BB%E7%BB%9F%E8%AE%BE%E8%AE%A1%E8%AF%A6%E8%A7%A3%20-%20%E4%B8%80%E6%9E%9D%E6%A2%85%E7%9A%84%E6%8A%80%E6%9C%AF%E6%94%B6%E5%BD%95%2075091a4d849d41c9ba464571517093f4/GU3KSDV82C3GHL4EPCEV2I8OH.png",loading:"lazy"}})]),s._v(" "),a("p",[s._v("所以，相同的权限，超级管理员能够看到的用户数量和普通用户kdyzm能够看到的用户数量是不一样的。")]),s._v(" "),a("p",[s._v("超级管理员看到的用户管理页面：")]),s._v(" "),a("p",[a("img",{staticClass:"lazy",attrs:{alt:"%E8%8B%A5%E4%BE%9D%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9FRuoYi-Vue%EF%BC%88%E4%BA%8C%EF%BC%89%EF%BC%9A%E6%9D%83%E9%99%90%E7%B3%BB%E7%BB%9F%E8%AE%BE%E8%AE%A1%E8%AF%A6%E8%A7%A3%20-%20%E4%B8%80%E6%9E%9D%E6%A2%85%E7%9A%84%E6%8A%80%E6%9C%AF%E6%94%B6%E5%BD%95%2075091a4d849d41c9ba464571517093f4/2Q0H8GS42KUUEUUH9B8DJQ4U69.png","data-src":"%E8%8B%A5%E4%BE%9D%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9FRuoYi-Vue%EF%BC%88%E4%BA%8C%EF%BC%89%EF%BC%9A%E6%9D%83%E9%99%90%E7%B3%BB%E7%BB%9F%E8%AE%BE%E8%AE%A1%E8%AF%A6%E8%A7%A3%20-%20%E4%B8%80%E6%9E%9D%E6%A2%85%E7%9A%84%E6%8A%80%E6%9C%AF%E6%94%B6%E5%BD%95%2075091a4d849d41c9ba464571517093f4/2Q0H8GS42KUUEUUH9B8DJQ4U69.png",loading:"lazy"}})]),s._v(" "),a("p",[s._v("普通用户kdyzm看到的用户管理页面：")]),s._v(" "),a("p",[a("img",{staticClass:"lazy",attrs:{alt:"%E8%8B%A5%E4%BE%9D%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9FRuoYi-Vue%EF%BC%88%E4%BA%8C%EF%BC%89%EF%BC%9A%E6%9D%83%E9%99%90%E7%B3%BB%E7%BB%9F%E8%AE%BE%E8%AE%A1%E8%AF%A6%E8%A7%A3%20-%20%E4%B8%80%E6%9E%9D%E6%A2%85%E7%9A%84%E6%8A%80%E6%9C%AF%E6%94%B6%E5%BD%95%2075091a4d849d41c9ba464571517093f4/3GI2FKPE84LDGREP4PN2IGNER4.png","data-src":"%E8%8B%A5%E4%BE%9D%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9FRuoYi-Vue%EF%BC%88%E4%BA%8C%EF%BC%89%EF%BC%9A%E6%9D%83%E9%99%90%E7%B3%BB%E7%BB%9F%E8%AE%BE%E8%AE%A1%E8%AF%A6%E8%A7%A3%20-%20%E4%B8%80%E6%9E%9D%E6%A2%85%E7%9A%84%E6%8A%80%E6%9C%AF%E6%94%B6%E5%BD%95%2075091a4d849d41c9ba464571517093f4/3GI2FKPE84LDGREP4PN2IGNER4.png",loading:"lazy"}})]),s._v(" "),a("h2",{attrs:{id:"二、各种类型权限实现原理"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#二、各种类型权限实现原理"}},[s._v("#")]),s._v(" 二、各种类型权限实现原理")]),s._v(" "),a("h3",{attrs:{id:"_1-菜单权限-2"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_1-菜单权限-2"}},[s._v("#")]),s._v(" 1.菜单权限")]),s._v(" "),a("p",[s._v("菜单权限很简单，实际上就是简单的用户-角色-菜单模型，那么菜单是什么时候加载的呢？"),a("code",[s._v("ruoyi-ui\\src\\permission.js")]),s._v("，加载的逻辑在这个文件中。")]),s._v(" "),a("p",[a("code",[s._v("permission.js")]),s._v("文件中设置了"),a("a",{attrs:{href:"https://router.vuejs.org/zh/guide/advanced/navigation-guards.html",target:"_blank",rel:"noopener noreferrer"}},[s._v("导航守卫"),a("OutboundLink")],1),s._v("，每次路由发生变化的时候就会触发router.beforeEach的回调函数。")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("router.beforeEach((to, from, next) => {\n  NProgress.start()\n  if (getToken()) {\n    /* has token*/\n    if (to.path === '/login') {\n      next({ path: '/' })\n      NProgress.done()\n    } else {\n      if (store.getters.roles.length === 0) {\n        // 判断当前用户是否已拉取完user_info信息\n        store.dispatch('GetInfo').then(res => {\n          // 拉取user_info\n          const roles = res.roles\n          store.dispatch('GenerateRoutes', { roles }).then(accessRoutes => {\n            // 根据roles权限生成可访问的路由表\n            router.addRoutes(accessRoutes) // 动态添加可访问路由表\n            next({ ...to, replace: true }) // hack方法 确保addRoutes已完成\n          })\n        }).catch(err => {\n            store.dispatch('LogOut').then(() => {\n              Message.error(err)\n              next({ path: '/' })\n            })\n          })\n      } else {\n        next()\n      }\n    }\n  } else {\n    // 没有token\n    if (whiteList.indexOf(to.path) !== -1) {\n      // 在免登录白名单，直接进入\n      next()\n    } else {\n      next(`/login?redirect=${to.fullPath}`) // 否则全部重定向到登录页\n      NProgress.done()\n    }\n  }\n})\n\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br"),a("span",{staticClass:"line-number"},[s._v("16")]),a("br"),a("span",{staticClass:"line-number"},[s._v("17")]),a("br"),a("span",{staticClass:"line-number"},[s._v("18")]),a("br"),a("span",{staticClass:"line-number"},[s._v("19")]),a("br"),a("span",{staticClass:"line-number"},[s._v("20")]),a("br"),a("span",{staticClass:"line-number"},[s._v("21")]),a("br"),a("span",{staticClass:"line-number"},[s._v("22")]),a("br"),a("span",{staticClass:"line-number"},[s._v("23")]),a("br"),a("span",{staticClass:"line-number"},[s._v("24")]),a("br"),a("span",{staticClass:"line-number"},[s._v("25")]),a("br"),a("span",{staticClass:"line-number"},[s._v("26")]),a("br"),a("span",{staticClass:"line-number"},[s._v("27")]),a("br"),a("span",{staticClass:"line-number"},[s._v("28")]),a("br"),a("span",{staticClass:"line-number"},[s._v("29")]),a("br"),a("span",{staticClass:"line-number"},[s._v("30")]),a("br"),a("span",{staticClass:"line-number"},[s._v("31")]),a("br"),a("span",{staticClass:"line-number"},[s._v("32")]),a("br"),a("span",{staticClass:"line-number"},[s._v("33")]),a("br"),a("span",{staticClass:"line-number"},[s._v("34")]),a("br"),a("span",{staticClass:"line-number"},[s._v("35")]),a("br"),a("span",{staticClass:"line-number"},[s._v("36")]),a("br"),a("span",{staticClass:"line-number"},[s._v("37")]),a("br"),a("span",{staticClass:"line-number"},[s._v("38")]),a("br"),a("span",{staticClass:"line-number"},[s._v("39")]),a("br"),a("span",{staticClass:"line-number"},[s._v("40")]),a("br")])]),a("p",[s._v("注意"),a("code",[s._v("if (store.getters.roles.length === 0) {")]),s._v("这段逻辑，可以看出，如果不刷新当前页面，就算给用户添加了新的菜单权限，用户也看不到新的菜单。")]),s._v(" "),a("h3",{attrs:{id:"_2-按钮权限-2"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_2-按钮权限-2"}},[s._v("#")]),s._v(" 2.按钮权限")]),s._v(" "),a("p",[s._v("按钮权限设置上和菜单权限基本上是一样的，是附着于页面中的细粒度权限。按钮权限体现在如果用户没有相应的权限，则看不到相关的按钮。这个是咋实现的呢？")]),s._v(" "),a("p",[s._v("先看下系统管理下的菜单管理中的修改、新增和删除按钮前端vue代码")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v('<el-table-column label="操作" align="center" class-name="small-padding fixed-width">\n        <template slot-scope="scope">\n          <el-button size="mini"\n            type="text"\n            icon="el-icon-edit"\n            @click="handleUpdate(scope.row)"\n            v-hasPermi="[\'system:menu:edit\']"\n          >修改</el-button>\n          <el-button\n            size="mini"\n            type="text"\n            icon="el-icon-plus"\n            @click="handleAdd(scope.row)"\n            v-hasPermi="[\'system:menu:add\']"\n          >新增</el-button>\n          <el-button\n            size="mini"\n            type="text"\n            icon="el-icon-delete"\n            @click="handleDelete(scope.row)"\n            v-hasPermi="[\'system:menu:remove\']"\n          >删除</el-button>\n        </template>\n      </el-table-column>\n\n')])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br"),a("span",{staticClass:"line-number"},[s._v("16")]),a("br"),a("span",{staticClass:"line-number"},[s._v("17")]),a("br"),a("span",{staticClass:"line-number"},[s._v("18")]),a("br"),a("span",{staticClass:"line-number"},[s._v("19")]),a("br"),a("span",{staticClass:"line-number"},[s._v("20")]),a("br"),a("span",{staticClass:"line-number"},[s._v("21")]),a("br"),a("span",{staticClass:"line-number"},[s._v("22")]),a("br"),a("span",{staticClass:"line-number"},[s._v("23")]),a("br"),a("span",{staticClass:"line-number"},[s._v("24")]),a("br"),a("span",{staticClass:"line-number"},[s._v("25")]),a("br")])]),a("p",[s._v("el-button上有个属性"),a("code",[s._v("v-hasPermi")]),s._v("，这实际上是vue的自定义指令，属性值就是创建按钮的时候定义的那个"),a("code",[s._v("权限标志")]),s._v("。其定义在"),a("code",[s._v("src/directive/permission/index.js")]),s._v("文件")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("import hasRole from './hasRole'\nimport hasPermi from './hasPermi'\n\nconst install = function(Vue) {\n  Vue.directive('hasRole', hasRole)\n  Vue.directive('hasPermi', hasPermi)\n}\n\nif (window.Vue) {\n  window['hasRole'] = hasRole\n  window['hasPermi'] = hasPermi\n  Vue.use(install); // eslint-disable-line\n}\n\nexport default install\n\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br"),a("span",{staticClass:"line-number"},[s._v("16")]),a("br")])]),a("p",[s._v("其具体实现逻辑就在同目录的"),a("code",[s._v("hasPermi.js")]),s._v("文件中")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("import store from '@/store'\n\nexport default {\n  inserted(el, binding, vnode) {\n    const { value } = binding\n    const all_permission = \"*:*:*\";\n    const permissions = store.getters && store.getters.permissions\n\n    if (value && value instanceof Array && value.length > 0) {\n      const permissionFlag = value\n\n      const hasPermissions = permissions.some(permission => {\n        return all_permission === permission || permissionFlag.includes(permission)\n      })\n\n      if (!hasPermissions) {\n        el.parentNode && el.parentNode.removeChild(el)\n      }\n    } else {\n      throw new Error(`请设置操作权限标签值`)\n    }\n  }\n}\n\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br"),a("span",{staticClass:"line-number"},[s._v("16")]),a("br"),a("span",{staticClass:"line-number"},[s._v("17")]),a("br"),a("span",{staticClass:"line-number"},[s._v("18")]),a("br"),a("span",{staticClass:"line-number"},[s._v("19")]),a("br"),a("span",{staticClass:"line-number"},[s._v("20")]),a("br"),a("span",{staticClass:"line-number"},[s._v("21")]),a("br"),a("span",{staticClass:"line-number"},[s._v("22")]),a("br"),a("span",{staticClass:"line-number"},[s._v("23")]),a("br"),a("span",{staticClass:"line-number"},[s._v("24")]),a("br")])]),a("p",[s._v("注意代码        "),a("code",[s._v("el.parentNode && el.parentNode.removeChild(el)")]),s._v("，可以看到，如果没有按钮权限，则会将按钮本身从dom中移除。")]),s._v(" "),a("h3",{attrs:{id:"_3-接口权限-2"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_3-接口权限-2"}},[s._v("#")]),s._v(" 3.接口权限")]),s._v(" "),a("p",[s._v("接口权限和前端的按钮权限一一对应。为的是防止用户绕过按钮直接请求后端接口获取数据。在若依Vue系统中，是使用SpringSecurity的注解"),a("code",[s._v("@PreAuthorize")]),s._v("实现的。")]),s._v(" "),a("p",[s._v("虽然只是一个注解，但是它是SpringSecurity+JWT集成的结晶~这个之后再细谈。")]),s._v(" "),a("h3",{attrs:{id:"_4-数据权限-2"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_4-数据权限-2"}},[s._v("#")]),s._v(" 4.数据权限")]),s._v(" "),a("p",[s._v("数据权限实现的关键在于"),a("code",[s._v("com.ruoyi.framework.aspectj.DataScopeAspect")]),s._v("类。该类是一个切面类，凡是加上"),a("code",[s._v("com.ruoyi.common.annotation.DataScope")]),s._v("注解的方法，在执行的时候都会被它拦截。")]),s._v(" "),a("p",[s._v("该切面定义了五种权限范围")]),s._v(" "),a("table",[a("thead",[a("tr",[a("th",[s._v("name")]),s._v(" "),a("th",[s._v("code")]),s._v(" "),a("th",[s._v("desc")])])]),s._v(" "),a("tbody",[a("tr",[a("td",[s._v("DATA_SCOPE_ALL")]),s._v(" "),a("td",[s._v("1")]),s._v(" "),a("td",[s._v("全部数据权限")])]),s._v(" "),a("tr",[a("td",[s._v("DATA_SCOPE_CUSTOM")]),s._v(" "),a("td",[s._v("2")]),s._v(" "),a("td",[s._v("自定数据权限")])]),s._v(" "),a("tr",[a("td",[s._v("DATA_SCOPE_DEPT")]),s._v(" "),a("td",[s._v("3")]),s._v(" "),a("td",[s._v("部门数据权限")])]),s._v(" "),a("tr",[a("td",[s._v("DATA_SCOPE_DEPT_AND_CHILD")]),s._v(" "),a("td",[s._v("4")]),s._v(" "),a("td",[s._v("部门及以下数据权限")])]),s._v(" "),a("tr",[a("td",[s._v("DATA_SCOPE_SELF")]),s._v(" "),a("td",[s._v("5")]),s._v(" "),a("td",[s._v("仅本人数据权限")])])])]),s._v(" "),a("p",[s._v('该切面的核心逻辑是“拼SQL”，方法执行之前，会给参数的一个params属性添加一个dataScope键值对，key为"dataScope"，值为'),a("code",[s._v('AND (" + sqlString.substring(4) + ")"')]),s._v("样式的一段SQL，这段SQL会根据当前用户所在的部门以及当前用户角色的权限范围发生变化。")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v('StringBuilder sqlString = new StringBuilder();\n        for (SysRole role : user.getRoles())\n        {\n            String dataScope = role.getDataScope();\n            if (DATA_SCOPE_ALL.equals(dataScope))\n            {\n                sqlString = new StringBuilder();\n                break;\n            }\n            else if (DATA_SCOPE_CUSTOM.equals(dataScope))\n            {\n                sqlString.append(StringUtils.format(\n                        " OR {}.dept_id IN ( SELECT dept_id FROM sys_role_dept WHERE role_id = {} ) ", deptAlias,\n                        role.getRoleId()));\n            }\n            else if (DATA_SCOPE_DEPT.equals(dataScope))\n            {\n                sqlString.append(StringUtils.format(" OR {}.dept_id = {} ", deptAlias, user.getDeptId()));\n            }\n            else if (DATA_SCOPE_DEPT_AND_CHILD.equals(dataScope))\n            {\n                sqlString.append(StringUtils.format(\n                        " OR {}.dept_id IN ( SELECT dept_id FROM sys_dept WHERE dept_id = {} or find_in_set( {} , ancestors ) )",\n                        deptAlias, user.getDeptId(), user.getDeptId()));\n            }\n            else if (DATA_SCOPE_SELF.equals(dataScope))\n            {\n                if (StringUtils.isNotBlank(userAlias))\n                {\n                    sqlString.append(StringUtils.format(" OR {}.user_id = {} ", userAlias, user.getUserId()));\n                }\n                else\n                {\n                    // 数据权限为仅本人且没有userAlias别名不查询任何数据\n                    sqlString.append(" OR 1=0 ");\n                }\n            }\n        }\n\n')])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br"),a("span",{staticClass:"line-number"},[s._v("16")]),a("br"),a("span",{staticClass:"line-number"},[s._v("17")]),a("br"),a("span",{staticClass:"line-number"},[s._v("18")]),a("br"),a("span",{staticClass:"line-number"},[s._v("19")]),a("br"),a("span",{staticClass:"line-number"},[s._v("20")]),a("br"),a("span",{staticClass:"line-number"},[s._v("21")]),a("br"),a("span",{staticClass:"line-number"},[s._v("22")]),a("br"),a("span",{staticClass:"line-number"},[s._v("23")]),a("br"),a("span",{staticClass:"line-number"},[s._v("24")]),a("br"),a("span",{staticClass:"line-number"},[s._v("25")]),a("br"),a("span",{staticClass:"line-number"},[s._v("26")]),a("br"),a("span",{staticClass:"line-number"},[s._v("27")]),a("br"),a("span",{staticClass:"line-number"},[s._v("28")]),a("br"),a("span",{staticClass:"line-number"},[s._v("29")]),a("br"),a("span",{staticClass:"line-number"},[s._v("30")]),a("br"),a("span",{staticClass:"line-number"},[s._v("31")]),a("br"),a("span",{staticClass:"line-number"},[s._v("32")]),a("br"),a("span",{staticClass:"line-number"},[s._v("33")]),a("br"),a("span",{staticClass:"line-number"},[s._v("34")]),a("br"),a("span",{staticClass:"line-number"},[s._v("35")]),a("br"),a("span",{staticClass:"line-number"},[s._v("36")]),a("br"),a("span",{staticClass:"line-number"},[s._v("37")]),a("br"),a("span",{staticClass:"line-number"},[s._v("38")]),a("br"),a("span",{staticClass:"line-number"},[s._v("39")]),a("br")])]),a("p",[s._v("简单来说，这段代码的逻辑就是用户所在的部门权限越高，数据权限范围越大，查出来的结果集将会越大。")]),s._v(" "),a("p",[a("img",{staticClass:"lazy",attrs:{alt:"%E8%8B%A5%E4%BE%9D%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9FRuoYi-Vue%EF%BC%88%E4%BA%8C%EF%BC%89%EF%BC%9A%E6%9D%83%E9%99%90%E7%B3%BB%E7%BB%9F%E8%AE%BE%E8%AE%A1%E8%AF%A6%E8%A7%A3%20-%20%E4%B8%80%E6%9E%9D%E6%A2%85%E7%9A%84%E6%8A%80%E6%9C%AF%E6%94%B6%E5%BD%95%2075091a4d849d41c9ba464571517093f4/75ASL6GIH1Q1V941RH2JJU5PR.png","data-src":"%E8%8B%A5%E4%BE%9D%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9FRuoYi-Vue%EF%BC%88%E4%BA%8C%EF%BC%89%EF%BC%9A%E6%9D%83%E9%99%90%E7%B3%BB%E7%BB%9F%E8%AE%BE%E8%AE%A1%E8%AF%A6%E8%A7%A3%20-%20%E4%B8%80%E6%9E%9D%E6%A2%85%E7%9A%84%E6%8A%80%E6%9C%AF%E6%94%B6%E5%BD%95%2075091a4d849d41c9ba464571517093f4/75ASL6GIH1Q1V941RH2JJU5PR.png",loading:"lazy"}})]),s._v(" "),a("p",[s._v("DataScope注解分别加到了部门列表查询、角色列表查询、用户列表查询的接口上，很明显，这几个接口需要根据不同的人查出不同的结果。")]),s._v(" "),a("p",[s._v("以用户列表查询为例，执行sql为")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("    <select id=\"selectUserList\" parameterType=\"SysUser\" resultMap=\"SysUserResult\">\n\t\tselect u.user_id, u.dept_id, u.nick_name, u.user_name, u.email, u.avatar, u.phonenumber, u.password, u.sex, u.status, u.del_flag, u.login_ip, u.login_date, u.create_by, u.create_time, u.remark, d.dept_name, d.leader from sys_user u\n\t\tleft join sys_dept d on u.dept_id = d.dept_id\n\t\twhere u.del_flag = '0'\n\t\t<if test=\"userName != null and userName != ''\">\n\t\t\tAND u.user_name like concat('%', #{userName}, '%')\n\t\t</if>\n\t\t<if test=\"status != null and status != ''\">\n\t\t\tAND u.status = #{status}\n\t\t</if>\n\t\t<if test=\"phonenumber != null and phonenumber != ''\">\n\t\t\tAND u.phonenumber like concat('%', #{phonenumber}, '%')\n\t\t</if>\n\t\t<if test=\"params.beginTime != null and params.beginTime != ''\">\x3c!-- 开始时间检索 --\x3e\n\t\t\tAND date_format(u.create_time,'%y%m%d') &gt;= date_format(#{params.beginTime},'%y%m%d')\n\t\t</if>\n\t\t<if test=\"params.endTime != null and params.endTime != ''\">\x3c!-- 结束时间检索 --\x3e\n\t\t\tAND date_format(u.create_time,'%y%m%d') &lt;= date_format(#{params.endTime},'%y%m%d')\n\t\t</if>\n\t\t<if test=\"deptId != null and deptId != 0\">\n\t\t\tAND (u.dept_id = #{deptId} OR u.dept_id IN ( SELECT t.dept_id FROM sys_dept t WHERE find_in_set(#{deptId}, ancestors) ))\n\t\t</if>\n\t\t\x3c!-- 数据范围过滤 --\x3e\n\t\t${params.dataScope}\n\t</select>\n\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br"),a("span",{staticClass:"line-number"},[s._v("16")]),a("br"),a("span",{staticClass:"line-number"},[s._v("17")]),a("br"),a("span",{staticClass:"line-number"},[s._v("18")]),a("br"),a("span",{staticClass:"line-number"},[s._v("19")]),a("br"),a("span",{staticClass:"line-number"},[s._v("20")]),a("br"),a("span",{staticClass:"line-number"},[s._v("21")]),a("br"),a("span",{staticClass:"line-number"},[s._v("22")]),a("br"),a("span",{staticClass:"line-number"},[s._v("23")]),a("br"),a("span",{staticClass:"line-number"},[s._v("24")]),a("br"),a("span",{staticClass:"line-number"},[s._v("25")]),a("br"),a("span",{staticClass:"line-number"},[s._v("26")]),a("br")])]),a("p",[s._v("其中，有这么一段代码")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("\x3c!-- 数据范围过滤 --\x3e\n${params.dataScope}\n\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br")])]),a("p",[s._v("实际上"),a("code",[s._v("DataScopeAspect")]),s._v("切面就只干了填充params的dataScope属性这么一件事情。")]),s._v(" "),a("h2",{attrs:{id:"三、若依vue系统springsecurity-jwt"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#三、若依vue系统springsecurity-jwt"}},[s._v("#")]),s._v(" 三、若依Vue系统SpringSecurity+JWT")]),s._v(" "),a("p",[s._v("若依Vue系统中从用户登录到后端接口权限校验，都是基于SpringSecurity+JWT实现的，其中，SpringSecurity是核心，jwt只是为了保证token合法性的一种手段（签名防止篡改）。spring security集成的相关代码在"),a("code",[s._v("ruoyi-framework")]),s._v("模块的"),a("code",[s._v("com.ruoyi.framework.security")]),s._v("包以及"),a("code",[s._v("com.ruoyi.framework.config.SecurityConfig")]),s._v("类中。")]),s._v(" "),a("p",[a("code",[s._v("SecurityConfig")]),s._v("是核心配置类，所有的配置均在该类中。")]),s._v(" "),a("h3",{attrs:{id:"_1-用户登录"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_1-用户登录"}},[s._v("#")]),s._v(" 1.用户登录")]),s._v(" "),a("p",[s._v("用户登录的逻辑在方法"),a("code",[s._v("com.ruoyi.web.controller.system.SysLoginController#login")]),s._v("中，一个典型的登录请求体如下所示")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v('{\n\t"username": "admin",\n\t"password": "admin123",\n\t"code": "0",\n\t"uuid": "a9fdbcbcb28748b796b5b77ad71bbb97"\n}\n\n')])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br")])]),a("p",[s._v("username和password分别是用户名和密码，code为验证码，uuid为验证码的唯一标识。登录成功之后会返回前端一个jwt令牌")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v('{\n\t"msg": "操作成功",\n\t"code": 200,\n\t"token": "eyJhbGciOiJIUzUxMiJ9.eyJsb2dpbl91c2VyX2tleSI6IjIzZjRhNjJjLTY5NzMtNDcxZS04ZmU4LWJmYWQ4YzllNWFkMiJ9.9d3iIaNq62CkjTXlxFOQgdDMOAZiu5tAsEn0cEuV23opT6PAqu_CiaN7kQY8_XhlQrHX5RgZ2bH7LpsiKLLcSw"\n}\n\n')])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br")])]),a("p",[s._v("在登录方法中，做了以下几件事情")]),s._v(" "),a("ul",[a("li",[s._v("根据uuid获取redis中的验证码并对请求的验证码做验证")]),s._v(" "),a("li",[s._v("如果验证码没问题，则对用户名和密码进行校验")]),s._v(" "),a("li",[s._v("如果用户名和密码校验成功，则使用token作为key将用户信息保存到redis")]),s._v(" "),a("li",[s._v("使用jwt对token签名并返回前端")])]),s._v(" "),a("p",[s._v("在整个过程中，会抛出一些自定义异常，比如")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("throw new CaptchaExpireException();\nthrow new CaptchaException();\nthrow new UserPasswordNotMatchException();\nthrow new CustomException(e.getMessage());\n\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br")])]),a("p",[s._v("这些异常最终会被全局异常处理器处理掉："),a("code",[s._v("com.ruoyi.framework.web.exception.GlobalExceptionHandler")])]),s._v(" "),a("h3",{attrs:{id:"_2-接口权限校验"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_2-接口权限校验"}},[s._v("#")]),s._v(" 2.接口权限校验")]),s._v(" "),a("p",[s._v("前端请求完成登录接口之后会将token存储到cookie，key为Admin-Token，value是jwt令牌。登录逻辑："),a("code",[s._v("user.actions.Login")]),s._v("。")]),s._v(" "),a("p",[s._v("之后，每次请求后端接口的时候都会带上Authentication Header")]),s._v(" "),a("p",[a("img",{staticClass:"lazy",attrs:{alt:"%E8%8B%A5%E4%BE%9D%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9FRuoYi-Vue%EF%BC%88%E4%BA%8C%EF%BC%89%EF%BC%9A%E6%9D%83%E9%99%90%E7%B3%BB%E7%BB%9F%E8%AE%BE%E8%AE%A1%E8%AF%A6%E8%A7%A3%20-%20%E4%B8%80%E6%9E%9D%E6%A2%85%E7%9A%84%E6%8A%80%E6%9C%AF%E6%94%B6%E5%BD%95%2075091a4d849d41c9ba464571517093f4/9GQINIAHHR6MA6PP2CPMHG3HS.png","data-src":"%E8%8B%A5%E4%BE%9D%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9FRuoYi-Vue%EF%BC%88%E4%BA%8C%EF%BC%89%EF%BC%9A%E6%9D%83%E9%99%90%E7%B3%BB%E7%BB%9F%E8%AE%BE%E8%AE%A1%E8%AF%A6%E8%A7%A3%20-%20%E4%B8%80%E6%9E%9D%E6%A2%85%E7%9A%84%E6%8A%80%E6%9C%AF%E6%94%B6%E5%BD%95%2075091a4d849d41c9ba464571517093f4/9GQINIAHHR6MA6PP2CPMHG3HS.png",loading:"lazy"}})]),s._v(" "),a("p",[s._v("这实际上是通过axios的请求拦截器实现的：详情可见"),a("code",[s._v("src/utils/request.js")]),s._v("文件")]),s._v(" "),a("p",[s._v("带着Authentication Header的请求打到后端的时候会经过过滤器"),a("code",[s._v("com.ruoyi.framework.security.filter.JwtAuthenticationTokenFilter")]),s._v("，该过滤器做了以下几件事情")]),s._v(" "),a("ul",[a("li",[s._v("从请求头中取出jwt令牌，并对其进行jwt验签，验签若是成功，则取出原始token")]),s._v(" "),a("li",[s._v("根据token从redis中取出用户数据")]),s._v(" "),a("li",[s._v("将用户信息封装成"),a("code",[s._v("UsernamePasswordAuthenticationToken")]),s._v("对象，并将该对象填充到Spring Security上下文中")])]),s._v(" "),a("p",[s._v("填充到SpringSecurity上下文才能让Controller接口上的"),a("code",[s._v("@PreAuthorize")]),s._v("注解发挥作用（"),a("strong",[s._v("存疑，这里若依作者并非使用原生的SpringSecurity提供的spel表达式，也没有用authorities，而是使用了PermissionService类")]),s._v("）。")]),s._v(" "),a("p",[s._v("接着，Controller接口正式执行之前会进入"),a("code",[s._v("com.ruoyi.framework.web.service.PermissionService#hasPermi")]),s._v("方法判定权限，这里重新从redis中取出用户数据并进行权限校验，权限校验失败则不再执行接口中逻辑（"),a("strong",[s._v("存疑，这里并没有使用SpringSecurity上下文中的用户数据，那么"),a("code",[s._v("JwtAuthenticationTokenFilter")]),s._v("中的用户信息填充上下文中的代码是干啥用的")]),s._v("）。")]),s._v(" "),a("h2",{attrs:{id:"四、实战"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#四、实战"}},[s._v("#")]),s._v(" 四、实战")]),s._v(" "),a("p",[s._v("上一篇文章讲解了如何创建一个菜单并创建页面，但是是个空页面")]),s._v(" "),a("p",[a("img",{staticClass:"lazy",attrs:{alt:"%E8%8B%A5%E4%BE%9D%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9FRuoYi-Vue%EF%BC%88%E4%BA%8C%EF%BC%89%EF%BC%9A%E6%9D%83%E9%99%90%E7%B3%BB%E7%BB%9F%E8%AE%BE%E8%AE%A1%E8%AF%A6%E8%A7%A3%20-%20%E4%B8%80%E6%9E%9D%E6%A2%85%E7%9A%84%E6%8A%80%E6%9C%AF%E6%94%B6%E5%BD%95%2075091a4d849d41c9ba464571517093f4/14KU25KR1CG5G5FPKMPG38IN7G.png","data-src":"%E8%8B%A5%E4%BE%9D%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9FRuoYi-Vue%EF%BC%88%E4%BA%8C%EF%BC%89%EF%BC%9A%E6%9D%83%E9%99%90%E7%B3%BB%E7%BB%9F%E8%AE%BE%E8%AE%A1%E8%AF%A6%E8%A7%A3%20-%20%E4%B8%80%E6%9E%9D%E6%A2%85%E7%9A%84%E6%8A%80%E6%9C%AF%E6%94%B6%E5%BD%95%2075091a4d849d41c9ba464571517093f4/14KU25KR1CG5G5FPKMPG38IN7G.png",loading:"lazy"}})]),s._v(" "),a("p",[s._v("这篇文章将会讲解如何实现增删查改功能。")]),s._v(" "),a("p",[s._v("一切开始之前，新建表news，建表SQL如下")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("CREATE TABLE `news` (\n  `id` int(11) NOT NULL AUTO_INCREMENT COMMENT '主键',\n  `title` varchar(128) NOT NULL COMMENT '新闻标题',\n  `brief` varchar(256) DEFAULT NULL COMMENT '新闻概述',\n  `content` text COMMENT '新闻正文',\n  `create_time` datetime DEFAULT NULL,\n  `create_by` varchar(64) DEFAULT NULL,\n  `update_time` datetime DEFAULT NULL,\n  `update_by` varchar(64) DEFAULT NULL,\n  `delete_flag` tinyint(1) DEFAULT NULL,\n  PRIMARY KEY (`id`)\n) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4\n\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br")])]),a("h3",{attrs:{id:"_1-前端页面修改"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_1-前端页面修改"}},[s._v("#")]),s._v(" 1.前端页面修改")]),s._v(" "),a("p",[s._v("可以仿照角色管理的页面写，直接将角色管理页面的代码直接拷贝到news文件中，效果如下")]),s._v(" "),a("p",[a("img",{staticClass:"lazy",attrs:{alt:"%E8%8B%A5%E4%BE%9D%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9FRuoYi-Vue%EF%BC%88%E4%BA%8C%EF%BC%89%EF%BC%9A%E6%9D%83%E9%99%90%E7%B3%BB%E7%BB%9F%E8%AE%BE%E8%AE%A1%E8%AF%A6%E8%A7%A3%20-%20%E4%B8%80%E6%9E%9D%E6%A2%85%E7%9A%84%E6%8A%80%E6%9C%AF%E6%94%B6%E5%BD%95%2075091a4d849d41c9ba464571517093f4/1OOISFU5CSQ6OIC9TD7EHG5KC2.png","data-src":"%E8%8B%A5%E4%BE%9D%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9FRuoYi-Vue%EF%BC%88%E4%BA%8C%EF%BC%89%EF%BC%9A%E6%9D%83%E9%99%90%E7%B3%BB%E7%BB%9F%E8%AE%BE%E8%AE%A1%E8%AF%A6%E8%A7%A3%20-%20%E4%B8%80%E6%9E%9D%E6%A2%85%E7%9A%84%E6%8A%80%E6%9C%AF%E6%94%B6%E5%BD%95%2075091a4d849d41c9ba464571517093f4/1OOISFU5CSQ6OIC9TD7EHG5KC2.png",loading:"lazy"}})]),s._v(" "),a("p",[s._v("没错，新闻列表的标题，角色管理的页面。。。")]),s._v(" "),a("p",[a("img",{staticClass:"lazy",attrs:{alt:"%E8%8B%A5%E4%BE%9D%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9FRuoYi-Vue%EF%BC%88%E4%BA%8C%EF%BC%89%EF%BC%9A%E6%9D%83%E9%99%90%E7%B3%BB%E7%BB%9F%E8%AE%BE%E8%AE%A1%E8%AF%A6%E8%A7%A3%20-%20%E4%B8%80%E6%9E%9D%E6%A2%85%E7%9A%84%E6%8A%80%E6%9C%AF%E6%94%B6%E5%BD%95%2075091a4d849d41c9ba464571517093f4/1IFROUJCO5B7OH3763BRCFMJ9D.png","data-src":"%E8%8B%A5%E4%BE%9D%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9FRuoYi-Vue%EF%BC%88%E4%BA%8C%EF%BC%89%EF%BC%9A%E6%9D%83%E9%99%90%E7%B3%BB%E7%BB%9F%E8%AE%BE%E8%AE%A1%E8%AF%A6%E8%A7%A3%20-%20%E4%B8%80%E6%9E%9D%E6%A2%85%E7%9A%84%E6%8A%80%E6%9C%AF%E6%94%B6%E5%BD%95%2075091a4d849d41c9ba464571517093f4/1IFROUJCO5B7OH3763BRCFMJ9D.png",loading:"lazy"}})]),s._v(" "),a("p",[s._v("之后对页面中元素进行修改，使其和上面创建的表结构一致，修改后的页面样子")]),s._v(" "),a("p",[a("img",{staticClass:"lazy",attrs:{alt:"%E8%8B%A5%E4%BE%9D%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9FRuoYi-Vue%EF%BC%88%E4%BA%8C%EF%BC%89%EF%BC%9A%E6%9D%83%E9%99%90%E7%B3%BB%E7%BB%9F%E8%AE%BE%E8%AE%A1%E8%AF%A6%E8%A7%A3%20-%20%E4%B8%80%E6%9E%9D%E6%A2%85%E7%9A%84%E6%8A%80%E6%9C%AF%E6%94%B6%E5%BD%95%2075091a4d849d41c9ba464571517093f4/1G84GPSKCQB5CLHG539JQB1LOV.png","data-src":"%E8%8B%A5%E4%BE%9D%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9FRuoYi-Vue%EF%BC%88%E4%BA%8C%EF%BC%89%EF%BC%9A%E6%9D%83%E9%99%90%E7%B3%BB%E7%BB%9F%E8%AE%BE%E8%AE%A1%E8%AF%A6%E8%A7%A3%20-%20%E4%B8%80%E6%9E%9D%E6%A2%85%E7%9A%84%E6%8A%80%E6%9C%AF%E6%94%B6%E5%BD%95%2075091a4d849d41c9ba464571517093f4/1G84GPSKCQB5CLHG539JQB1LOV.png",loading:"lazy"}})]),s._v(" "),a("p",[s._v("这是预期中的样子，但是内容还是角色管理页面的内容。")]),s._v(" "),a("h3",{attrs:{id:"_2-创建按钮权限"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_2-创建按钮权限"}},[s._v("#")]),s._v(" 2.创建按钮权限")]),s._v(" "),a("p",[s._v("上一步已经完成了页面外观的改造，接下来需要修改页面内容了，首先需要把按钮权限给加上")]),s._v(" "),a("p",[a("img",{staticClass:"lazy",attrs:{alt:"%E8%8B%A5%E4%BE%9D%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9FRuoYi-Vue%EF%BC%88%E4%BA%8C%EF%BC%89%EF%BC%9A%E6%9D%83%E9%99%90%E7%B3%BB%E7%BB%9F%E8%AE%BE%E8%AE%A1%E8%AF%A6%E8%A7%A3%20-%20%E4%B8%80%E6%9E%9D%E6%A2%85%E7%9A%84%E6%8A%80%E6%9C%AF%E6%94%B6%E5%BD%95%2075091a4d849d41c9ba464571517093f4/1BRPQ63J5ET6E3K73EFL3I0DUB.png","data-src":"%E8%8B%A5%E4%BE%9D%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9FRuoYi-Vue%EF%BC%88%E4%BA%8C%EF%BC%89%EF%BC%9A%E6%9D%83%E9%99%90%E7%B3%BB%E7%BB%9F%E8%AE%BE%E8%AE%A1%E8%AF%A6%E8%A7%A3%20-%20%E4%B8%80%E6%9E%9D%E6%A2%85%E7%9A%84%E6%8A%80%E6%9C%AF%E6%94%B6%E5%BD%95%2075091a4d849d41c9ba464571517093f4/1BRPQ63J5ET6E3K73EFL3I0DUB.png",loading:"lazy"}})]),s._v(" "),a("p",[s._v("按照这个样子添加按钮权限，之后把权限标志分配到前端页面中")]),s._v(" "),a("p",[a("img",{staticClass:"lazy",attrs:{alt:"%E8%8B%A5%E4%BE%9D%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9FRuoYi-Vue%EF%BC%88%E4%BA%8C%EF%BC%89%EF%BC%9A%E6%9D%83%E9%99%90%E7%B3%BB%E7%BB%9F%E8%AE%BE%E8%AE%A1%E8%AF%A6%E8%A7%A3%20-%20%E4%B8%80%E6%9E%9D%E6%A2%85%E7%9A%84%E6%8A%80%E6%9C%AF%E6%94%B6%E5%BD%95%2075091a4d849d41c9ba464571517093f4/DUI2M9IHG5LQ3KOKF8MRUMKNC.png","data-src":"%E8%8B%A5%E4%BE%9D%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9FRuoYi-Vue%EF%BC%88%E4%BA%8C%EF%BC%89%EF%BC%9A%E6%9D%83%E9%99%90%E7%B3%BB%E7%BB%9F%E8%AE%BE%E8%AE%A1%E8%AF%A6%E8%A7%A3%20-%20%E4%B8%80%E6%9E%9D%E6%A2%85%E7%9A%84%E6%8A%80%E6%9C%AF%E6%94%B6%E5%BD%95%2075091a4d849d41c9ba464571517093f4/DUI2M9IHG5LQ3KOKF8MRUMKNC.png",loading:"lazy"}})]),s._v(" "),a("h3",{attrs:{id:"_3-使用代码生成代码"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_3-使用代码生成代码"}},[s._v("#")]),s._v(" 3.使用代码生成代码")]),s._v(" "),a("p",[s._v("在系统工具-代码生成页面中生成news表对应的相关实体类、mapper、xml对象等，可以极大的简化开发过程。")]),s._v(" "),a("p",[a("img",{staticClass:"lazy",attrs:{alt:"%E8%8B%A5%E4%BE%9D%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9FRuoYi-Vue%EF%BC%88%E4%BA%8C%EF%BC%89%EF%BC%9A%E6%9D%83%E9%99%90%E7%B3%BB%E7%BB%9F%E8%AE%BE%E8%AE%A1%E8%AF%A6%E8%A7%A3%20-%20%E4%B8%80%E6%9E%9D%E6%A2%85%E7%9A%84%E6%8A%80%E6%9C%AF%E6%94%B6%E5%BD%95%2075091a4d849d41c9ba464571517093f4/3GSOUH1U4GT69DE86SQVG9FKHD.png","data-src":"%E8%8B%A5%E4%BE%9D%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9FRuoYi-Vue%EF%BC%88%E4%BA%8C%EF%BC%89%EF%BC%9A%E6%9D%83%E9%99%90%E7%B3%BB%E7%BB%9F%E8%AE%BE%E8%AE%A1%E8%AF%A6%E8%A7%A3%20-%20%E4%B8%80%E6%9E%9D%E6%A2%85%E7%9A%84%E6%8A%80%E6%9C%AF%E6%94%B6%E5%BD%95%2075091a4d849d41c9ba464571517093f4/3GSOUH1U4GT69DE86SQVG9FKHD.png",loading:"lazy"}})]),s._v(" "),a("h3",{attrs:{id:"_4-准备后端接口"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_4-准备后端接口"}},[s._v("#")]),s._v(" 4.准备后端接口")]),s._v(" "),a("p",[s._v("将上一步代码生成器生成的"),a("code",[s._v("NewsController")]),s._v("拿过来改一改就行，修改后的代码如下所示：")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v('package com.ruoyi.web.controller.business;\n\nimport com.ruoyi.common.annotation.Log;\nimport com.ruoyi.common.core.controller.BaseController;\nimport com.ruoyi.common.core.domain.AjaxResult;\nimport com.ruoyi.common.core.page.TableDataInfo;\nimport com.ruoyi.common.enums.BusinessType;\nimport com.ruoyi.common.utils.SecurityUtils;\nimport com.ruoyi.common.utils.poi.ExcelUtil;\nimport com.ruoyi.system.domain.News;\nimport com.ruoyi.system.mapper.NewsMapper;\nimport org.springframework.beans.factory.annotation.Autowired;\nimport org.springframework.security.access.prepost.PreAuthorize;\nimport org.springframework.validation.annotation.Validated;\nimport org.springframework.web.bind.annotation.*;\n\nimport java.util.Date;\nimport java.util.List;\n\n/**\n * @author kdyzm\n */\n@RestController\n@RequestMapping("/business/news")\npublic class NewsController extends BaseController {\n\n    @Autowired\n    private NewsMapper newsMapper;\n\n    /**\n     * 获取新闻列表\n     */\n    @PreAuthorize("@ss.hasPermi(\'business:news:list\')")\n    @GetMapping("/list")\n    public TableDataInfo list(News post) {\n        startPage();\n        List<News> list = newsMapper.selectNewsList(post);\n        return getDataTable(list);\n    }\n\n    @Log(title = "新闻管理", businessType = BusinessType.EXPORT)\n    @PreAuthorize("@ss.hasPermi(\'business:news:export\')")\n    @GetMapping("/export")\n    public AjaxResult export(News post) {\n        List<News> list = newsMapper.selectNewsList(post);\n        ExcelUtil<News> util = new ExcelUtil<>(News.class);\n        return util.exportExcel(list, "新闻数据");\n    }\n\n    /**\n     * 根据新闻编号获取详细信息\n     */\n    @PreAuthorize("@ss.hasPermi(\'business:news:query\')")\n    @GetMapping(value = "/{postId}")\n    public AjaxResult getInfo(@PathVariable Long postId) {\n        return AjaxResult.success(newsMapper.selectNewsById(postId));\n    }\n\n    /**\n     * 新增新闻\n     */\n    @PreAuthorize("@ss.hasPermi(\'business:news:add\')")\n    @Log(title = "新闻管理", businessType = BusinessType.INSERT)\n    @PostMapping\n    public AjaxResult add(@Validated @RequestBody News post) {\n        post.setCreateBy(SecurityUtils.getUsername());\n        post.setCreateTime(new Date());\n        return toAjax(newsMapper.insertNews(post));\n    }\n\n    /**\n     * 修改新闻\n     */\n    @PreAuthorize("@ss.hasPermi(\'business:news:update\')")\n    @Log(title = "新闻管理", businessType = BusinessType.UPDATE)\n    @PutMapping\n    public AjaxResult edit(@Validated @RequestBody News post) {\n        post.setUpdateBy(SecurityUtils.getUsername());\n        return toAjax(newsMapper.updateNews(post));\n    }\n\n    /**\n     * 删除新闻\n     */\n    @PreAuthorize("@ss.hasPermi(\'business:news:delete\')")\n    @Log(title = "新闻管理", businessType = BusinessType.DELETE)\n    @DeleteMapping("/{postIds}")\n    public AjaxResult remove(@PathVariable Long[] postIds) {\n        return toAjax(newsMapper.deleteNewsByIds(postIds));\n    }\n}\n\n')])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br"),a("span",{staticClass:"line-number"},[s._v("16")]),a("br"),a("span",{staticClass:"line-number"},[s._v("17")]),a("br"),a("span",{staticClass:"line-number"},[s._v("18")]),a("br"),a("span",{staticClass:"line-number"},[s._v("19")]),a("br"),a("span",{staticClass:"line-number"},[s._v("20")]),a("br"),a("span",{staticClass:"line-number"},[s._v("21")]),a("br"),a("span",{staticClass:"line-number"},[s._v("22")]),a("br"),a("span",{staticClass:"line-number"},[s._v("23")]),a("br"),a("span",{staticClass:"line-number"},[s._v("24")]),a("br"),a("span",{staticClass:"line-number"},[s._v("25")]),a("br"),a("span",{staticClass:"line-number"},[s._v("26")]),a("br"),a("span",{staticClass:"line-number"},[s._v("27")]),a("br"),a("span",{staticClass:"line-number"},[s._v("28")]),a("br"),a("span",{staticClass:"line-number"},[s._v("29")]),a("br"),a("span",{staticClass:"line-number"},[s._v("30")]),a("br"),a("span",{staticClass:"line-number"},[s._v("31")]),a("br"),a("span",{staticClass:"line-number"},[s._v("32")]),a("br"),a("span",{staticClass:"line-number"},[s._v("33")]),a("br"),a("span",{staticClass:"line-number"},[s._v("34")]),a("br"),a("span",{staticClass:"line-number"},[s._v("35")]),a("br"),a("span",{staticClass:"line-number"},[s._v("36")]),a("br"),a("span",{staticClass:"line-number"},[s._v("37")]),a("br"),a("span",{staticClass:"line-number"},[s._v("38")]),a("br"),a("span",{staticClass:"line-number"},[s._v("39")]),a("br"),a("span",{staticClass:"line-number"},[s._v("40")]),a("br"),a("span",{staticClass:"line-number"},[s._v("41")]),a("br"),a("span",{staticClass:"line-number"},[s._v("42")]),a("br"),a("span",{staticClass:"line-number"},[s._v("43")]),a("br"),a("span",{staticClass:"line-number"},[s._v("44")]),a("br"),a("span",{staticClass:"line-number"},[s._v("45")]),a("br"),a("span",{staticClass:"line-number"},[s._v("46")]),a("br"),a("span",{staticClass:"line-number"},[s._v("47")]),a("br"),a("span",{staticClass:"line-number"},[s._v("48")]),a("br"),a("span",{staticClass:"line-number"},[s._v("49")]),a("br"),a("span",{staticClass:"line-number"},[s._v("50")]),a("br"),a("span",{staticClass:"line-number"},[s._v("51")]),a("br"),a("span",{staticClass:"line-number"},[s._v("52")]),a("br"),a("span",{staticClass:"line-number"},[s._v("53")]),a("br"),a("span",{staticClass:"line-number"},[s._v("54")]),a("br"),a("span",{staticClass:"line-number"},[s._v("55")]),a("br"),a("span",{staticClass:"line-number"},[s._v("56")]),a("br"),a("span",{staticClass:"line-number"},[s._v("57")]),a("br"),a("span",{staticClass:"line-number"},[s._v("58")]),a("br"),a("span",{staticClass:"line-number"},[s._v("59")]),a("br"),a("span",{staticClass:"line-number"},[s._v("60")]),a("br"),a("span",{staticClass:"line-number"},[s._v("61")]),a("br"),a("span",{staticClass:"line-number"},[s._v("62")]),a("br"),a("span",{staticClass:"line-number"},[s._v("63")]),a("br"),a("span",{staticClass:"line-number"},[s._v("64")]),a("br"),a("span",{staticClass:"line-number"},[s._v("65")]),a("br"),a("span",{staticClass:"line-number"},[s._v("66")]),a("br"),a("span",{staticClass:"line-number"},[s._v("67")]),a("br"),a("span",{staticClass:"line-number"},[s._v("68")]),a("br"),a("span",{staticClass:"line-number"},[s._v("69")]),a("br"),a("span",{staticClass:"line-number"},[s._v("70")]),a("br"),a("span",{staticClass:"line-number"},[s._v("71")]),a("br"),a("span",{staticClass:"line-number"},[s._v("72")]),a("br"),a("span",{staticClass:"line-number"},[s._v("73")]),a("br"),a("span",{staticClass:"line-number"},[s._v("74")]),a("br"),a("span",{staticClass:"line-number"},[s._v("75")]),a("br"),a("span",{staticClass:"line-number"},[s._v("76")]),a("br"),a("span",{staticClass:"line-number"},[s._v("77")]),a("br"),a("span",{staticClass:"line-number"},[s._v("78")]),a("br"),a("span",{staticClass:"line-number"},[s._v("79")]),a("br"),a("span",{staticClass:"line-number"},[s._v("80")]),a("br"),a("span",{staticClass:"line-number"},[s._v("81")]),a("br"),a("span",{staticClass:"line-number"},[s._v("82")]),a("br"),a("span",{staticClass:"line-number"},[s._v("83")]),a("br"),a("span",{staticClass:"line-number"},[s._v("84")]),a("br"),a("span",{staticClass:"line-number"},[s._v("85")]),a("br"),a("span",{staticClass:"line-number"},[s._v("86")]),a("br"),a("span",{staticClass:"line-number"},[s._v("87")]),a("br"),a("span",{staticClass:"line-number"},[s._v("88")]),a("br"),a("span",{staticClass:"line-number"},[s._v("89")]),a("br"),a("span",{staticClass:"line-number"},[s._v("90")]),a("br"),a("span",{staticClass:"line-number"},[s._v("91")]),a("br"),a("span",{staticClass:"line-number"},[s._v("92")]),a("br")])]),a("h3",{attrs:{id:"_5-修改前端页面请求地址"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_5-修改前端页面请求地址"}},[s._v("#")]),s._v(" 5.修改前端页面请求地址")]),s._v(" "),a("p",[s._v("将生成的代码中的news.js文件放到api目录，并修改其中的接口路径与后端接口地址一一对应。")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("import request from '@/utils/request'\n\n// 查询角色列表\nexport function listNews(query) {\n  return request({\n    url: '/business/news/list',\n    method: 'get',\n    params: query\n  })\n}\n\n// 查询角色详细\nexport function getNews(roleId) {\n  return request({\n    url: '/business/news/' + roleId,\n    method: 'get'\n  })\n}\n\n// 新增角色\nexport function addNews(data) {\n  return request({\n    url: '/business/news',\n    method: 'post',\n    data: data\n  })\n}\n\n// 修改角色\nexport function updateNews(data) {\n  return request({\n    url: '/business/news',\n    method: 'put',\n    data: data\n  })\n}\n\n// 删除角色\nexport function delNews(roleId) {\n  return request({\n    url: '/business/news/' + roleId,\n    method: 'delete'\n  })\n}\n\n// 导出角色\nexport function exportNews(query) {\n  return request({\n    url: '/business/news/export',\n    method: 'get',\n    params: query\n  })\n}\n\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br"),a("span",{staticClass:"line-number"},[s._v("16")]),a("br"),a("span",{staticClass:"line-number"},[s._v("17")]),a("br"),a("span",{staticClass:"line-number"},[s._v("18")]),a("br"),a("span",{staticClass:"line-number"},[s._v("19")]),a("br"),a("span",{staticClass:"line-number"},[s._v("20")]),a("br"),a("span",{staticClass:"line-number"},[s._v("21")]),a("br"),a("span",{staticClass:"line-number"},[s._v("22")]),a("br"),a("span",{staticClass:"line-number"},[s._v("23")]),a("br"),a("span",{staticClass:"line-number"},[s._v("24")]),a("br"),a("span",{staticClass:"line-number"},[s._v("25")]),a("br"),a("span",{staticClass:"line-number"},[s._v("26")]),a("br"),a("span",{staticClass:"line-number"},[s._v("27")]),a("br"),a("span",{staticClass:"line-number"},[s._v("28")]),a("br"),a("span",{staticClass:"line-number"},[s._v("29")]),a("br"),a("span",{staticClass:"line-number"},[s._v("30")]),a("br"),a("span",{staticClass:"line-number"},[s._v("31")]),a("br"),a("span",{staticClass:"line-number"},[s._v("32")]),a("br"),a("span",{staticClass:"line-number"},[s._v("33")]),a("br"),a("span",{staticClass:"line-number"},[s._v("34")]),a("br"),a("span",{staticClass:"line-number"},[s._v("35")]),a("br"),a("span",{staticClass:"line-number"},[s._v("36")]),a("br"),a("span",{staticClass:"line-number"},[s._v("37")]),a("br"),a("span",{staticClass:"line-number"},[s._v("38")]),a("br"),a("span",{staticClass:"line-number"},[s._v("39")]),a("br"),a("span",{staticClass:"line-number"},[s._v("40")]),a("br"),a("span",{staticClass:"line-number"},[s._v("41")]),a("br"),a("span",{staticClass:"line-number"},[s._v("42")]),a("br"),a("span",{staticClass:"line-number"},[s._v("43")]),a("br"),a("span",{staticClass:"line-number"},[s._v("44")]),a("br"),a("span",{staticClass:"line-number"},[s._v("45")]),a("br"),a("span",{staticClass:"line-number"},[s._v("46")]),a("br"),a("span",{staticClass:"line-number"},[s._v("47")]),a("br"),a("span",{staticClass:"line-number"},[s._v("48")]),a("br"),a("span",{staticClass:"line-number"},[s._v("49")]),a("br"),a("span",{staticClass:"line-number"},[s._v("50")]),a("br"),a("span",{staticClass:"line-number"},[s._v("51")]),a("br"),a("span",{staticClass:"line-number"},[s._v("52")]),a("br"),a("span",{staticClass:"line-number"},[s._v("53")]),a("br"),a("span",{staticClass:"line-number"},[s._v("54")]),a("br")])]),a("p",[s._v("然后修改页面中的请求地址使用这里的地址。")]),s._v(" "),a("h2",{attrs:{id:"五、测试"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#五、测试"}},[s._v("#")]),s._v(" 五、测试")]),s._v(" "),a("h3",{attrs:{id:"_1-超级管理员测试"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_1-超级管理员测试"}},[s._v("#")]),s._v(" 1.超级管理员测试")]),s._v(" "),a("p",[s._v("超级管理员拥有最大权限，所有权限校验都会跳过对超级管理员的权限校验。这里先使用超级管理员进行测试可以规避权限问题，大体上先看看能否跑的通。")]),s._v(" "),a("p",[s._v("下面是演示超级管理员的CRUD操作。")]),s._v(" "),a("p",[a("img",{staticClass:"lazy",attrs:{alt:"%E8%8B%A5%E4%BE%9D%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9FRuoYi-Vue%EF%BC%88%E4%BA%8C%EF%BC%89%EF%BC%9A%E6%9D%83%E9%99%90%E7%B3%BB%E7%BB%9F%E8%AE%BE%E8%AE%A1%E8%AF%A6%E8%A7%A3%20-%20%E4%B8%80%E6%9E%9D%E6%A2%85%E7%9A%84%E6%8A%80%E6%9C%AF%E6%94%B6%E5%BD%95%2075091a4d849d41c9ba464571517093f4/1V267CBLE8N9N3O7R7TUQIM81K.gif","data-src":"%E8%8B%A5%E4%BE%9D%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9FRuoYi-Vue%EF%BC%88%E4%BA%8C%EF%BC%89%EF%BC%9A%E6%9D%83%E9%99%90%E7%B3%BB%E7%BB%9F%E8%AE%BE%E8%AE%A1%E8%AF%A6%E8%A7%A3%20-%20%E4%B8%80%E6%9E%9D%E6%A2%85%E7%9A%84%E6%8A%80%E6%9C%AF%E6%94%B6%E5%BD%95%2075091a4d849d41c9ba464571517093f4/1V267CBLE8N9N3O7R7TUQIM81K.gif",loading:"lazy"}})]),s._v(" "),a("h3",{attrs:{id:"_2-普通用户测试"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_2-普通用户测试"}},[s._v("#")]),s._v(" 2.普通用户测试")]),s._v(" "),a("p",[s._v("这里用用户kdyzm进行测试，在测试之前，先看下kdyzm的角色")]),s._v(" "),a("p",[a("img",{staticClass:"lazy",attrs:{alt:"%E8%8B%A5%E4%BE%9D%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9FRuoYi-Vue%EF%BC%88%E4%BA%8C%EF%BC%89%EF%BC%9A%E6%9D%83%E9%99%90%E7%B3%BB%E7%BB%9F%E8%AE%BE%E8%AE%A1%E8%AF%A6%E8%A7%A3%20-%20%E4%B8%80%E6%9E%9D%E6%A2%85%E7%9A%84%E6%8A%80%E6%9C%AF%E6%94%B6%E5%BD%95%2075091a4d849d41c9ba464571517093f4/2NDBLLTJGCMND7L984CF2B2TUB.png","data-src":"%E8%8B%A5%E4%BE%9D%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9FRuoYi-Vue%EF%BC%88%E4%BA%8C%EF%BC%89%EF%BC%9A%E6%9D%83%E9%99%90%E7%B3%BB%E7%BB%9F%E8%AE%BE%E8%AE%A1%E8%AF%A6%E8%A7%A3%20-%20%E4%B8%80%E6%9E%9D%E6%A2%85%E7%9A%84%E6%8A%80%E6%9C%AF%E6%94%B6%E5%BD%95%2075091a4d849d41c9ba464571517093f4/2NDBLLTJGCMND7L984CF2B2TUB.png",loading:"lazy"}})]),s._v(" "),a("p",[s._v("可以看到该用户是运营角色，那么修改角色权限，只给查询、修改、新增权限，不给导出和删除权限，如下所示")]),s._v(" "),a("p",[a("img",{staticClass:"lazy",attrs:{alt:"%E8%8B%A5%E4%BE%9D%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9FRuoYi-Vue%EF%BC%88%E4%BA%8C%EF%BC%89%EF%BC%9A%E6%9D%83%E9%99%90%E7%B3%BB%E7%BB%9F%E8%AE%BE%E8%AE%A1%E8%AF%A6%E8%A7%A3%20-%20%E4%B8%80%E6%9E%9D%E6%A2%85%E7%9A%84%E6%8A%80%E6%9C%AF%E6%94%B6%E5%BD%95%2075091a4d849d41c9ba464571517093f4/46M75EQAGTEUGNPLA13AFERMK.png","data-src":"%E8%8B%A5%E4%BE%9D%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9FRuoYi-Vue%EF%BC%88%E4%BA%8C%EF%BC%89%EF%BC%9A%E6%9D%83%E9%99%90%E7%B3%BB%E7%BB%9F%E8%AE%BE%E8%AE%A1%E8%AF%A6%E8%A7%A3%20-%20%E4%B8%80%E6%9E%9D%E6%A2%85%E7%9A%84%E6%8A%80%E6%9C%AF%E6%94%B6%E5%BD%95%2075091a4d849d41c9ba464571517093f4/46M75EQAGTEUGNPLA13AFERMK.png",loading:"lazy"}})]),s._v(" "),a("p",[s._v("这时候切换登录用户为kdyzm，看看新闻列表页面")]),s._v(" "),a("p",[a("img",{staticClass:"lazy",attrs:{alt:"%E8%8B%A5%E4%BE%9D%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9FRuoYi-Vue%EF%BC%88%E4%BA%8C%EF%BC%89%EF%BC%9A%E6%9D%83%E9%99%90%E7%B3%BB%E7%BB%9F%E8%AE%BE%E8%AE%A1%E8%AF%A6%E8%A7%A3%20-%20%E4%B8%80%E6%9E%9D%E6%A2%85%E7%9A%84%E6%8A%80%E6%9C%AF%E6%94%B6%E5%BD%95%2075091a4d849d41c9ba464571517093f4/MLHETKL3UDK0PS3T9I3PFSRFT.png","data-src":"%E8%8B%A5%E4%BE%9D%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9FRuoYi-Vue%EF%BC%88%E4%BA%8C%EF%BC%89%EF%BC%9A%E6%9D%83%E9%99%90%E7%B3%BB%E7%BB%9F%E8%AE%BE%E8%AE%A1%E8%AF%A6%E8%A7%A3%20-%20%E4%B8%80%E6%9E%9D%E6%A2%85%E7%9A%84%E6%8A%80%E6%9C%AF%E6%94%B6%E5%BD%95%2075091a4d849d41c9ba464571517093f4/MLHETKL3UDK0PS3T9I3PFSRFT.png",loading:"lazy"}})]),s._v(" "),a("p",[s._v("可以看到，kdyzm在新闻列表页面中，看不到导出导出按钮和删除按钮，符合预期设想。")]),s._v(" "),a("p",[s._v("好了，若依Vue权限详解部分到此结束了，欢迎关注我的博客 "),a("a",{attrs:{href:"https://blog.kdyzm.cn/",target:"_blank",rel:"noopener noreferrer"}},[s._v("https://blog.kdyzm.cn"),a("OutboundLink")],1)]),s._v(" "),a("p",[s._v("注意：本文归作者所有，未经作者允许，不得转载")]),s._v(" "),a("p",[a("a",{attrs:{href:"https://blog.kdyzm.cn/tag/%E8%8B%A5%E4%BE%9D/",target:"_blank",rel:"noopener noreferrer"}},[s._v("#若依"),a("OutboundLink")],1),s._v(" "),a("a",{attrs:{href:"https://blog.kdyzm.cn/tag/ruoyi/",target:"_blank",rel:"noopener noreferrer"}},[s._v("#ruoyi"),a("OutboundLink")],1)]),s._v(" "),a("p",[s._v("我有话说:")]),s._v(" "),a("p",[s._v("名字：")]),s._v(" "),a("p",[s._v("邮箱：")]),s._v(" "),a("p",[s._v("网址：")]),s._v(" "),a("div",{staticStyle:{display:"block !important"},attrs:{pseudo:"-webkit-input-placeholder",id:"placeholder"}},[s._v("请输入评论内容，不超过1024字")]),a("div"),s._v(" "),a("p",[s._v("验证码：")]),s._v(" "),a("h3",{attrs:{id:"全部评论-3-条"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#全部评论-3-条"}},[s._v("#")]),s._v(" 全部评论: 3 条")]),s._v(" "),a("ul",[a("li",[a("p",[s._v("受教了~ "),a("a",{attrs:{href:"http://",target:"_blank",rel:"noopener noreferrer"}},[s._v("@test"),a("OutboundLink")],1),s._v(": 存疑那里，因为使用jwtfilter，所以没有在config里面配置formlogin,也就无法使用UsernamePasswordAuthenticationFIlter，所以需要通过jwt将authentication塞入到spring security上下文。")]),s._v(" "),a("h3",{attrs:{id:"一枝梅2022-06-15"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#一枝梅2022-06-15"}},[s._v("#")]),s._v(" "),a("a",{attrs:{href:"https://blog.kdyzm.cn/",target:"_blank",rel:"noopener noreferrer"}},[s._v("一枝梅"),a("OutboundLink")],1),s._v("2022-06-15")])])])])}),[],!1,null,null,null);a.default=t.exports}}]);