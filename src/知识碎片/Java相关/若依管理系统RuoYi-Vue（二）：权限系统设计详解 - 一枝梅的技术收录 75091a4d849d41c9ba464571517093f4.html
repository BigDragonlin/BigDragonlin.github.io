<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>若依管理系统RuoYi-Vue（二）：权限系统设计详解 - 一枝梅的技术收录 | lin</title>
    <meta name="generator" content="VuePress 1.9.10">
    <link rel="icon" href="/favicon.ico">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/all.min.css">
    <meta name="description" content="记录进步的点滴">
    <meta property="og:site_name" content="lin">
    <meta property="og:title" content="若依管理系统RuoYi-Vue（二）：权限系统设计详解 - 一枝梅的技术收录">
    <meta property="og:type" content="article">
    <meta property="og:url" content="https://bigdragonlin.github.io/src/%E7%9F%A5%E8%AF%86%E7%A2%8E%E7%89%87/Java%E7%9B%B8%E5%85%B3/%E8%8B%A5%E4%BE%9D%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9FRuoYi-Vue%EF%BC%88%E4%BA%8C%EF%BC%89%EF%BC%9A%E6%9D%83%E9%99%90%E7%B3%BB%E7%BB%9F%E8%AE%BE%E8%AE%A1%E8%AF%A6%E8%A7%A3%20-%20%E4%B8%80%E6%9E%9D%E6%A2%85%E7%9A%84%E6%8A%80%E6%9C%AF%E6%94%B6%E5%BD%95%2075091a4d849d41c9ba464571517093f4.html">
    <meta name="twitter:title" content="若依管理系统RuoYi-Vue（二）：权限系统设计详解 - 一枝梅的技术收录">
    <meta name="twitter:url" content="https://bigdragonlin.github.io/src/%E7%9F%A5%E8%AF%86%E7%A2%8E%E7%89%87/Java%E7%9B%B8%E5%85%B3/%E8%8B%A5%E4%BE%9D%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9FRuoYi-Vue%EF%BC%88%E4%BA%8C%EF%BC%89%EF%BC%9A%E6%9D%83%E9%99%90%E7%B3%BB%E7%BB%9F%E8%AE%BE%E8%AE%A1%E8%AF%A6%E8%A7%A3%20-%20%E4%B8%80%E6%9E%9D%E6%A2%85%E7%9A%84%E6%8A%80%E6%9C%AF%E6%94%B6%E5%BD%95%2075091a4d849d41c9ba464571517093f4.html">
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:label1" content="Written by">
    <meta name="twitter:label2" content="Filed under">
    <meta name="twitter:data2" content="程序员, 编程, 计算机">
    <meta property="article:tag" content="程序员">
    <meta name="keywords" content="编程学习路线, 编程知识百科, Java, 编程导航, 前端, 开发, 编程分享, 项目, IT, 求职, 面经">
    
    <link rel="preload" href="/assets/css/0.styles.b0591cca.css" as="style"><link rel="preload" href="/assets/js/app.594b08d3.js" as="script"><link rel="preload" href="/assets/js/1.0dbf451f.js" as="script"><link rel="preload" href="/assets/js/116.303522e2.js" as="script"><link rel="prefetch" href="/assets/js/10.9fef656e.js"><link rel="prefetch" href="/assets/js/100.525b17be.js"><link rel="prefetch" href="/assets/js/101.560386e9.js"><link rel="prefetch" href="/assets/js/102.2e0df717.js"><link rel="prefetch" href="/assets/js/103.8bfd9c2e.js"><link rel="prefetch" href="/assets/js/104.2393786d.js"><link rel="prefetch" href="/assets/js/105.f79fadb6.js"><link rel="prefetch" href="/assets/js/106.4cafadd8.js"><link rel="prefetch" href="/assets/js/107.977314ac.js"><link rel="prefetch" href="/assets/js/108.4425c9dc.js"><link rel="prefetch" href="/assets/js/109.b5e7a340.js"><link rel="prefetch" href="/assets/js/11.683739b7.js"><link rel="prefetch" href="/assets/js/110.2ceb0d0a.js"><link rel="prefetch" href="/assets/js/111.a8a6a249.js"><link rel="prefetch" href="/assets/js/112.58a9bdc0.js"><link rel="prefetch" href="/assets/js/113.31b005db.js"><link rel="prefetch" href="/assets/js/114.7fbcc1e6.js"><link rel="prefetch" href="/assets/js/115.9e36cfa7.js"><link rel="prefetch" href="/assets/js/117.a63df5c5.js"><link rel="prefetch" href="/assets/js/118.590bc26e.js"><link rel="prefetch" href="/assets/js/119.3be96c90.js"><link rel="prefetch" href="/assets/js/12.2cf4830a.js"><link rel="prefetch" href="/assets/js/120.0ea9bf5e.js"><link rel="prefetch" href="/assets/js/121.ea6f7cd0.js"><link rel="prefetch" href="/assets/js/122.fa8ab557.js"><link rel="prefetch" href="/assets/js/123.c8821875.js"><link rel="prefetch" href="/assets/js/124.b18f1e9f.js"><link rel="prefetch" href="/assets/js/125.7e860b9c.js"><link rel="prefetch" href="/assets/js/126.b424683a.js"><link rel="prefetch" href="/assets/js/127.3b9fb511.js"><link rel="prefetch" href="/assets/js/128.ddcbf8d6.js"><link rel="prefetch" href="/assets/js/129.e9692f6a.js"><link rel="prefetch" href="/assets/js/13.1b182ba9.js"><link rel="prefetch" href="/assets/js/130.1bf1a2ef.js"><link rel="prefetch" href="/assets/js/131.ce704a36.js"><link rel="prefetch" href="/assets/js/132.8283006a.js"><link rel="prefetch" href="/assets/js/133.1c434a64.js"><link rel="prefetch" href="/assets/js/134.6a7c502b.js"><link rel="prefetch" href="/assets/js/135.36e96a79.js"><link rel="prefetch" href="/assets/js/136.6786da14.js"><link rel="prefetch" href="/assets/js/137.52c00c67.js"><link rel="prefetch" href="/assets/js/138.6938b926.js"><link rel="prefetch" href="/assets/js/139.a3637987.js"><link rel="prefetch" href="/assets/js/14.0d4ef0a2.js"><link rel="prefetch" href="/assets/js/140.4d7278fb.js"><link rel="prefetch" href="/assets/js/141.24c3fb07.js"><link rel="prefetch" href="/assets/js/142.51c920b4.js"><link rel="prefetch" href="/assets/js/143.9477385e.js"><link rel="prefetch" href="/assets/js/144.6ce44da3.js"><link rel="prefetch" href="/assets/js/145.16598dc0.js"><link rel="prefetch" href="/assets/js/146.ddd99b24.js"><link rel="prefetch" href="/assets/js/147.0d7b920c.js"><link rel="prefetch" href="/assets/js/148.aa355be2.js"><link rel="prefetch" href="/assets/js/149.0310e9dc.js"><link rel="prefetch" href="/assets/js/15.d6e0463b.js"><link rel="prefetch" href="/assets/js/150.025fa435.js"><link rel="prefetch" href="/assets/js/151.e4e0c006.js"><link rel="prefetch" href="/assets/js/152.f22e2d03.js"><link rel="prefetch" href="/assets/js/153.3a5ddc18.js"><link rel="prefetch" href="/assets/js/154.eab11cd6.js"><link rel="prefetch" href="/assets/js/155.0c5cf23f.js"><link rel="prefetch" href="/assets/js/156.94995d4d.js"><link rel="prefetch" href="/assets/js/157.01fd429c.js"><link rel="prefetch" href="/assets/js/158.f2a7b03b.js"><link rel="prefetch" href="/assets/js/159.2a678752.js"><link rel="prefetch" href="/assets/js/16.b10b867d.js"><link rel="prefetch" href="/assets/js/160.9a87b2d4.js"><link rel="prefetch" href="/assets/js/161.a1c01a1c.js"><link rel="prefetch" href="/assets/js/162.b309d5eb.js"><link rel="prefetch" href="/assets/js/163.a65f20cb.js"><link rel="prefetch" href="/assets/js/164.95d05154.js"><link rel="prefetch" href="/assets/js/165.5cf122af.js"><link rel="prefetch" href="/assets/js/166.9c6363a6.js"><link rel="prefetch" href="/assets/js/167.5cb6922a.js"><link rel="prefetch" href="/assets/js/168.7e4a8d58.js"><link rel="prefetch" href="/assets/js/169.2749163c.js"><link rel="prefetch" href="/assets/js/17.58cd8f53.js"><link rel="prefetch" href="/assets/js/170.14c350b2.js"><link rel="prefetch" href="/assets/js/171.4bc50f8e.js"><link rel="prefetch" href="/assets/js/172.6718e67c.js"><link rel="prefetch" href="/assets/js/173.dd659939.js"><link rel="prefetch" href="/assets/js/174.98b51446.js"><link rel="prefetch" href="/assets/js/175.d1cc6ac3.js"><link rel="prefetch" href="/assets/js/176.605618d7.js"><link rel="prefetch" href="/assets/js/177.f41afed3.js"><link rel="prefetch" href="/assets/js/178.3e531004.js"><link rel="prefetch" href="/assets/js/179.c34e4549.js"><link rel="prefetch" href="/assets/js/18.0773a3c5.js"><link rel="prefetch" href="/assets/js/180.dcc346d9.js"><link rel="prefetch" href="/assets/js/181.9b3ac2cc.js"><link rel="prefetch" href="/assets/js/182.41850209.js"><link rel="prefetch" href="/assets/js/183.bc9c1f61.js"><link rel="prefetch" href="/assets/js/184.451f388f.js"><link rel="prefetch" href="/assets/js/185.7510e863.js"><link rel="prefetch" href="/assets/js/186.29dd59d0.js"><link rel="prefetch" href="/assets/js/187.65f556e8.js"><link rel="prefetch" href="/assets/js/188.accf6d03.js"><link rel="prefetch" href="/assets/js/189.30515232.js"><link rel="prefetch" href="/assets/js/19.9b138b67.js"><link rel="prefetch" href="/assets/js/190.15d08ade.js"><link rel="prefetch" href="/assets/js/191.c1a42435.js"><link rel="prefetch" href="/assets/js/192.846af3d8.js"><link rel="prefetch" href="/assets/js/193.aa03b0f9.js"><link rel="prefetch" href="/assets/js/194.e98d87ba.js"><link rel="prefetch" href="/assets/js/195.74bf697c.js"><link rel="prefetch" href="/assets/js/196.2581f0e9.js"><link rel="prefetch" href="/assets/js/197.c21bd50a.js"><link rel="prefetch" href="/assets/js/2.90688c22.js"><link rel="prefetch" href="/assets/js/20.80320303.js"><link rel="prefetch" href="/assets/js/21.0e60e06e.js"><link rel="prefetch" href="/assets/js/22.8e85d903.js"><link rel="prefetch" href="/assets/js/23.53a60c49.js"><link rel="prefetch" href="/assets/js/24.0bf3b153.js"><link rel="prefetch" href="/assets/js/25.346029a3.js"><link rel="prefetch" href="/assets/js/26.d93d8326.js"><link rel="prefetch" href="/assets/js/27.1af59ff5.js"><link rel="prefetch" href="/assets/js/28.4dcd80fc.js"><link rel="prefetch" href="/assets/js/29.6807ccd4.js"><link rel="prefetch" href="/assets/js/3.cb4602cc.js"><link rel="prefetch" href="/assets/js/30.4b97d8de.js"><link rel="prefetch" href="/assets/js/31.56f99fbd.js"><link rel="prefetch" href="/assets/js/32.803b8814.js"><link rel="prefetch" href="/assets/js/33.ed99686c.js"><link rel="prefetch" href="/assets/js/34.58387757.js"><link rel="prefetch" href="/assets/js/35.96403a8e.js"><link rel="prefetch" href="/assets/js/36.1f24a1fe.js"><link rel="prefetch" href="/assets/js/37.7074470e.js"><link rel="prefetch" href="/assets/js/38.272465ab.js"><link rel="prefetch" href="/assets/js/39.1d55b379.js"><link rel="prefetch" href="/assets/js/4.78354d3c.js"><link rel="prefetch" href="/assets/js/40.6799ef0c.js"><link rel="prefetch" href="/assets/js/41.a17e5884.js"><link rel="prefetch" href="/assets/js/42.56d0e256.js"><link rel="prefetch" href="/assets/js/43.ba341557.js"><link rel="prefetch" href="/assets/js/44.e996e1a1.js"><link rel="prefetch" href="/assets/js/45.831b5a32.js"><link rel="prefetch" href="/assets/js/46.f5c91c94.js"><link rel="prefetch" href="/assets/js/47.a9e71bdc.js"><link rel="prefetch" href="/assets/js/48.a6c2ccb2.js"><link rel="prefetch" href="/assets/js/49.cf75e86c.js"><link rel="prefetch" href="/assets/js/5.188c7b33.js"><link rel="prefetch" href="/assets/js/50.05ac2200.js"><link rel="prefetch" href="/assets/js/51.36b8a786.js"><link rel="prefetch" href="/assets/js/52.2e0c11e6.js"><link rel="prefetch" href="/assets/js/53.5712d97f.js"><link rel="prefetch" href="/assets/js/54.21eabb0c.js"><link rel="prefetch" href="/assets/js/55.5a0c591a.js"><link rel="prefetch" href="/assets/js/56.8cfc2eb8.js"><link rel="prefetch" href="/assets/js/57.14d120d3.js"><link rel="prefetch" href="/assets/js/58.066a92c4.js"><link rel="prefetch" href="/assets/js/59.fe8fc17d.js"><link rel="prefetch" href="/assets/js/6.101e097c.js"><link rel="prefetch" href="/assets/js/60.0423408f.js"><link rel="prefetch" href="/assets/js/61.cad6d9e6.js"><link rel="prefetch" href="/assets/js/62.7c8846b3.js"><link rel="prefetch" href="/assets/js/63.fa28685a.js"><link rel="prefetch" href="/assets/js/64.1e90a96b.js"><link rel="prefetch" href="/assets/js/65.26bb82be.js"><link rel="prefetch" href="/assets/js/66.f83b85a9.js"><link rel="prefetch" href="/assets/js/67.39d29b92.js"><link rel="prefetch" href="/assets/js/68.94c37c31.js"><link rel="prefetch" href="/assets/js/69.5c9d3af1.js"><link rel="prefetch" href="/assets/js/7.bb657764.js"><link rel="prefetch" href="/assets/js/70.16aaa661.js"><link rel="prefetch" href="/assets/js/71.3487b52f.js"><link rel="prefetch" href="/assets/js/72.f6305994.js"><link rel="prefetch" href="/assets/js/73.0bd3fed1.js"><link rel="prefetch" href="/assets/js/74.eaea9141.js"><link rel="prefetch" href="/assets/js/75.e006189d.js"><link rel="prefetch" href="/assets/js/76.2ebea1e6.js"><link rel="prefetch" href="/assets/js/77.23f40aa3.js"><link rel="prefetch" href="/assets/js/78.fc4f596e.js"><link rel="prefetch" href="/assets/js/79.6f020fc3.js"><link rel="prefetch" href="/assets/js/80.df73a9f7.js"><link rel="prefetch" href="/assets/js/81.c6d78e39.js"><link rel="prefetch" href="/assets/js/82.78fe38ca.js"><link rel="prefetch" href="/assets/js/83.597e7365.js"><link rel="prefetch" href="/assets/js/84.a1656199.js"><link rel="prefetch" href="/assets/js/85.e52d11f5.js"><link rel="prefetch" href="/assets/js/86.bef0c2dc.js"><link rel="prefetch" href="/assets/js/87.948fd05f.js"><link rel="prefetch" href="/assets/js/88.5915a1d8.js"><link rel="prefetch" href="/assets/js/89.dceee4d9.js"><link rel="prefetch" href="/assets/js/90.396be273.js"><link rel="prefetch" href="/assets/js/91.4f17483e.js"><link rel="prefetch" href="/assets/js/92.26a445ca.js"><link rel="prefetch" href="/assets/js/93.98aecdc4.js"><link rel="prefetch" href="/assets/js/94.63d4c743.js"><link rel="prefetch" href="/assets/js/95.8379772b.js"><link rel="prefetch" href="/assets/js/96.866b061a.js"><link rel="prefetch" href="/assets/js/97.6439b9d7.js"><link rel="prefetch" href="/assets/js/98.c5c0003e.js"><link rel="prefetch" href="/assets/js/99.3449fc15.js"><link rel="prefetch" href="/assets/js/vendors~docsearch.9fd01095.js">
    <link rel="stylesheet" href="/assets/css/0.styles.b0591cca.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container no-sidebar"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><img src="/logo.png" alt="lin" class="logo"> <span class="site-name can-hide">lin</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/知识碎片/" class="nav-link"><!---->
  知识碎片
</a></div><div class="nav-item"><a href="/读书笔记/" class="nav-link"><!---->
  读书笔记
</a></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/知识碎片/" class="nav-link"><!---->
  知识碎片
</a></div><div class="nav-item"><a href="/读书笔记/" class="nav-link"><!---->
  读书笔记
</a></div> <!----></nav>  <!----> </aside> <main class="page"> <div class="content"><div style="width:100%"><div class="theme-default-content custom-content content__default"><h1 id="若依管理系统ruoyi-vue-二-权限系统设计详解-一枝梅的技术收录"><a href="#若依管理系统ruoyi-vue-二-权限系统设计详解-一枝梅的技术收录" class="header-anchor">#</a> 若依管理系统RuoYi-Vue（二）：权限系统设计详解 - 一枝梅的技术收录</h1> <p><a href="https://blog.kdyzm.cn/post/45" target="_blank" rel="noopener noreferrer">https://blog.kdyzm.cn/post/45<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <p>本篇文章试图讲解若依Vue系统中的权限设计原理以及实战，为什么是“试图”？因为这也是摸索着理解的，不一定准</p> <p>若依Vue系统中的权限管理部分的功能都集中在了系统管理菜单模块中，如下图所示。其中权限部分主要涉及到了用户管理、角色管理、菜单管理、部门管理这四个部分。</p> <p><img alt="%E8%8B%A5%E4%BE%9D%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9FRuoYi-Vue%EF%BC%88%E4%BA%8C%EF%BC%89%EF%BC%9A%E6%9D%83%E9%99%90%E7%B3%BB%E7%BB%9F%E8%AE%BE%E8%AE%A1%E8%AF%A6%E8%A7%A3%20-%20%E4%B8%80%E6%9E%9D%E6%A2%85%E7%9A%84%E6%8A%80%E6%9C%AF%E6%94%B6%E5%BD%95%2075091a4d849d41c9ba464571517093f4/2TS3KJER31SHCAKHD1ISTRSMR7.png" data-src="%E8%8B%A5%E4%BE%9D%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9FRuoYi-Vue%EF%BC%88%E4%BA%8C%EF%BC%89%EF%BC%9A%E6%9D%83%E9%99%90%E7%B3%BB%E7%BB%9F%E8%AE%BE%E8%AE%A1%E8%AF%A6%E8%A7%A3%20-%20%E4%B8%80%E6%9E%9D%E6%A2%85%E7%9A%84%E6%8A%80%E6%9C%AF%E6%94%B6%E5%BD%95%2075091a4d849d41c9ba464571517093f4/2TS3KJER31SHCAKHD1ISTRSMR7.png" loading="lazy" class="lazy"></p> <h2 id="一、若依vue系统中的权限分类"><a href="#一、若依vue系统中的权限分类" class="header-anchor">#</a> 一、若依Vue系统中的权限分类</h2> <p>根据观察，若依Vue系统中的权限分为以下几类</p> <ul><li>菜单权限：用户登录系统之后能看到哪些菜单</li> <li>按钮权限：用户在一个页面上能看到哪些按钮，比如新增、删除等按钮</li> <li>接口权限：用户带着认证信息请求后端接口，是否有权限访问，该接口和前端页面上的按钮一一对应</li> <li>数据权限：用户有权限访问后端某个接口，但是不同的用户相同的接口相同的入参，根据权限大小不同，返回的结果应当不一样——权限大的能够看到的数据更多。</li></ul> <h3 id="_1-菜单权限"><a href="#_1-菜单权限" class="header-anchor">#</a> 1.菜单权限</h3> <p>这个比较好理解，拥有不同权限的用户登录系统之后看到的菜单是不一样的，从新建菜单到给一个用户分配菜单权限，上一篇文章已经讲过，不赘述。</p> <p>用户登录之后会请求后端的<code>com.ruoyi.web.controller.system.SysLoginController#getRouters</code>接口获取登录用户的菜单数据：</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>select distinct m.menu_id, m.parent_id, m.menu_name, m.path, m.component, m.visible, m.status, ifnull(m.perms,'') as perms, m.is_frame, m.is_cache, m.menu_type, m.icon, m.order_num, m.create_time
		from sys_menu m
			 left join sys_role_menu rm on m.menu_id = rm.menu_id
			 left join sys_user_role ur on rm.role_id = ur.role_id
			 left join sys_role ro on ur.role_id = ro.role_id
			 left join sys_user u on ur.user_id = u.user_id
		where u.user_id = #{userId} and m.menu_type in ('M', 'C') and m.status = 0  AND ro.status = 0
		order by m.parent_id, m.order_num

</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br></div></div><p>菜单类型（M目录 C菜单 F按钮）；菜单状态（0显示 1隐藏）</p> <p>这是典型的用户-角色-菜单模型。</p> <p>前端会根据该接口返回的数据渲染出不同的菜单。</p> <h3 id="_2-按钮权限"><a href="#_2-按钮权限" class="header-anchor">#</a> 2.按钮权限</h3> <p>新增按钮权限和新增菜单差不多，下图是我在新闻列表页面上新增了一个按钮叫做<code>新闻新增</code>，该按钮的权限分配和菜单的权限分配方法是一样的。</p> <p><img alt="%E8%8B%A5%E4%BE%9D%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9FRuoYi-Vue%EF%BC%88%E4%BA%8C%EF%BC%89%EF%BC%9A%E6%9D%83%E9%99%90%E7%B3%BB%E7%BB%9F%E8%AE%BE%E8%AE%A1%E8%AF%A6%E8%A7%A3%20-%20%E4%B8%80%E6%9E%9D%E6%A2%85%E7%9A%84%E6%8A%80%E6%9C%AF%E6%94%B6%E5%BD%95%2075091a4d849d41c9ba464571517093f4/1GM0K7AFSIPAPK4829O06HUUD9.png" data-src="%E8%8B%A5%E4%BE%9D%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9FRuoYi-Vue%EF%BC%88%E4%BA%8C%EF%BC%89%EF%BC%9A%E6%9D%83%E9%99%90%E7%B3%BB%E7%BB%9F%E8%AE%BE%E8%AE%A1%E8%AF%A6%E8%A7%A3%20-%20%E4%B8%80%E6%9E%9D%E6%A2%85%E7%9A%84%E6%8A%80%E6%9C%AF%E6%94%B6%E5%BD%95%2075091a4d849d41c9ba464571517093f4/1GM0K7AFSIPAPK4829O06HUUD9.png" loading="lazy" class="lazy"></p> <p><img alt="%E8%8B%A5%E4%BE%9D%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9FRuoYi-Vue%EF%BC%88%E4%BA%8C%EF%BC%89%EF%BC%9A%E6%9D%83%E9%99%90%E7%B3%BB%E7%BB%9F%E8%AE%BE%E8%AE%A1%E8%AF%A6%E8%A7%A3%20-%20%E4%B8%80%E6%9E%9D%E6%A2%85%E7%9A%84%E6%8A%80%E6%9C%AF%E6%94%B6%E5%BD%95%2075091a4d849d41c9ba464571517093f4/3TPQMOUVRNBSNH41R9CCOG4OV4.png" data-src="%E8%8B%A5%E4%BE%9D%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9FRuoYi-Vue%EF%BC%88%E4%BA%8C%EF%BC%89%EF%BC%9A%E6%9D%83%E9%99%90%E7%B3%BB%E7%BB%9F%E8%AE%BE%E8%AE%A1%E8%AF%A6%E8%A7%A3%20-%20%E4%B8%80%E6%9E%9D%E6%A2%85%E7%9A%84%E6%8A%80%E6%9C%AF%E6%94%B6%E5%BD%95%2075091a4d849d41c9ba464571517093f4/3TPQMOUVRNBSNH41R9CCOG4OV4.png" loading="lazy" class="lazy"></p> <h3 id="_3-接口权限"><a href="#_3-接口权限" class="header-anchor">#</a> 3.接口权限</h3> <p>每一个按钮基本上都会对应着一个后端的接口，前端会根据权限标志显示或者隐藏按钮，但是如果用户不点击按钮，直接通过http请求工具请求后端咋办？所以接口权限也是要有的，该权限和按钮上权限完全一致。</p> <p>若依系统使用了SpringSecurity框架，接口权限都是基于注解<code>@PreAuthorize</code>实现的，比如，用户管理页面中的修改用户按钮对应的后端接口长这个样子</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>    @PreAuthorize(&quot;@ss.hasPermi('system:user:edit')&quot;)
    @Log(title = &quot;用户管理&quot;, businessType = BusinessType.UPDATE)
    @PutMapping
    public AjaxResult edit(@Validated @RequestBody SysUser user)
    {
        ...
    }

</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><p>和其对应的前端按钮权限标志一样</p> <p><img alt="%E8%8B%A5%E4%BE%9D%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9FRuoYi-Vue%EF%BC%88%E4%BA%8C%EF%BC%89%EF%BC%9A%E6%9D%83%E9%99%90%E7%B3%BB%E7%BB%9F%E8%AE%BE%E8%AE%A1%E8%AF%A6%E8%A7%A3%20-%20%E4%B8%80%E6%9E%9D%E6%A2%85%E7%9A%84%E6%8A%80%E6%9C%AF%E6%94%B6%E5%BD%95%2075091a4d849d41c9ba464571517093f4/2U23041DQ5KH3PPN6E46M5IB6T.png" data-src="%E8%8B%A5%E4%BE%9D%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9FRuoYi-Vue%EF%BC%88%E4%BA%8C%EF%BC%89%EF%BC%9A%E6%9D%83%E9%99%90%E7%B3%BB%E7%BB%9F%E8%AE%BE%E8%AE%A1%E8%AF%A6%E8%A7%A3%20-%20%E4%B8%80%E6%9E%9D%E6%A2%85%E7%9A%84%E6%8A%80%E6%9C%AF%E6%94%B6%E5%BD%95%2075091a4d849d41c9ba464571517093f4/2U23041DQ5KH3PPN6E46M5IB6T.png" loading="lazy" class="lazy"></p> <p>如果没有权限访问接口，则会返回类似如下信息：</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>{
&quot;msg&quot;: &quot;请求访问：/system/user/list，认证失败，无法访问系统资源&quot;,
&quot;code&quot;: 401
}

</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><h3 id="_4-数据权限"><a href="#_4-数据权限" class="header-anchor">#</a> 4.数据权限</h3> <p>用户有权限访问后端某个接口，但是不同的用户相同的接口相同的入参，根据权限大小不同，返回的结果应当不一样——权限大的能够看到的数据更多。</p> <p>体现在若依Vue系统中，举个例子，现在若以系统中有两个用户，一个是超级管理员admin，一个是普通用户kdyzm</p> <p><img alt="%E8%8B%A5%E4%BE%9D%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9FRuoYi-Vue%EF%BC%88%E4%BA%8C%EF%BC%89%EF%BC%9A%E6%9D%83%E9%99%90%E7%B3%BB%E7%BB%9F%E8%AE%BE%E8%AE%A1%E8%AF%A6%E8%A7%A3%20-%20%E4%B8%80%E6%9E%9D%E6%A2%85%E7%9A%84%E6%8A%80%E6%9C%AF%E6%94%B6%E5%BD%95%2075091a4d849d41c9ba464571517093f4/S9PUKL20QCR9GCNN3KCIUHDRA.png" data-src="%E8%8B%A5%E4%BE%9D%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9FRuoYi-Vue%EF%BC%88%E4%BA%8C%EF%BC%89%EF%BC%9A%E6%9D%83%E9%99%90%E7%B3%BB%E7%BB%9F%E8%AE%BE%E8%AE%A1%E8%AF%A6%E8%A7%A3%20-%20%E4%B8%80%E6%9E%9D%E6%A2%85%E7%9A%84%E6%8A%80%E6%9C%AF%E6%94%B6%E5%BD%95%2075091a4d849d41c9ba464571517093f4/S9PUKL20QCR9GCNN3KCIUHDRA.png" loading="lazy" class="lazy"></p> <p>它们两者均有用户管理、菜单管理、角色管理权限，所以它们能够看到相应的菜单并作出相应的操作，比如删除、新增、修改等。这里有个问题，kdyzm应当只能看到一部分数据，而超级管理员应当能够看到所有数据，在若依系统中，是通过对角色<code>数据权限</code>修改进行控制的。</p> <p><img alt="%E8%8B%A5%E4%BE%9D%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9FRuoYi-Vue%EF%BC%88%E4%BA%8C%EF%BC%89%EF%BC%9A%E6%9D%83%E9%99%90%E7%B3%BB%E7%BB%9F%E8%AE%BE%E8%AE%A1%E8%AF%A6%E8%A7%A3%20-%20%E4%B8%80%E6%9E%9D%E6%A2%85%E7%9A%84%E6%8A%80%E6%9C%AF%E6%94%B6%E5%BD%95%2075091a4d849d41c9ba464571517093f4/2BONF6U5H5SNSRK84COBTDGPTQ.png" data-src="%E8%8B%A5%E4%BE%9D%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9FRuoYi-Vue%EF%BC%88%E4%BA%8C%EF%BC%89%EF%BC%9A%E6%9D%83%E9%99%90%E7%B3%BB%E7%BB%9F%E8%AE%BE%E8%AE%A1%E8%AF%A6%E8%A7%A3%20-%20%E4%B8%80%E6%9E%9D%E6%A2%85%E7%9A%84%E6%8A%80%E6%9C%AF%E6%94%B6%E5%BD%95%2075091a4d849d41c9ba464571517093f4/2BONF6U5H5SNSRK84COBTDGPTQ.png" loading="lazy" class="lazy"></p> <p><img alt="%E8%8B%A5%E4%BE%9D%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9FRuoYi-Vue%EF%BC%88%E4%BA%8C%EF%BC%89%EF%BC%9A%E6%9D%83%E9%99%90%E7%B3%BB%E7%BB%9F%E8%AE%BE%E8%AE%A1%E8%AF%A6%E8%A7%A3%20-%20%E4%B8%80%E6%9E%9D%E6%A2%85%E7%9A%84%E6%8A%80%E6%9C%AF%E6%94%B6%E5%BD%95%2075091a4d849d41c9ba464571517093f4/GU3KSDV82C3GHL4EPCEV2I8OH.png" data-src="%E8%8B%A5%E4%BE%9D%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9FRuoYi-Vue%EF%BC%88%E4%BA%8C%EF%BC%89%EF%BC%9A%E6%9D%83%E9%99%90%E7%B3%BB%E7%BB%9F%E8%AE%BE%E8%AE%A1%E8%AF%A6%E8%A7%A3%20-%20%E4%B8%80%E6%9E%9D%E6%A2%85%E7%9A%84%E6%8A%80%E6%9C%AF%E6%94%B6%E5%BD%95%2075091a4d849d41c9ba464571517093f4/GU3KSDV82C3GHL4EPCEV2I8OH.png" loading="lazy" class="lazy"></p> <p>所以，相同的权限，超级管理员能够看到的用户数量和普通用户kdyzm能够看到的用户数量是不一样的。</p> <p>超级管理员看到的用户管理页面：</p> <p><img alt="%E8%8B%A5%E4%BE%9D%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9FRuoYi-Vue%EF%BC%88%E4%BA%8C%EF%BC%89%EF%BC%9A%E6%9D%83%E9%99%90%E7%B3%BB%E7%BB%9F%E8%AE%BE%E8%AE%A1%E8%AF%A6%E8%A7%A3%20-%20%E4%B8%80%E6%9E%9D%E6%A2%85%E7%9A%84%E6%8A%80%E6%9C%AF%E6%94%B6%E5%BD%95%2075091a4d849d41c9ba464571517093f4/2Q0H8GS42KUUEUUH9B8DJQ4U69.png" data-src="%E8%8B%A5%E4%BE%9D%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9FRuoYi-Vue%EF%BC%88%E4%BA%8C%EF%BC%89%EF%BC%9A%E6%9D%83%E9%99%90%E7%B3%BB%E7%BB%9F%E8%AE%BE%E8%AE%A1%E8%AF%A6%E8%A7%A3%20-%20%E4%B8%80%E6%9E%9D%E6%A2%85%E7%9A%84%E6%8A%80%E6%9C%AF%E6%94%B6%E5%BD%95%2075091a4d849d41c9ba464571517093f4/2Q0H8GS42KUUEUUH9B8DJQ4U69.png" loading="lazy" class="lazy"></p> <p>普通用户kdyzm看到的用户管理页面：</p> <p><img alt="%E8%8B%A5%E4%BE%9D%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9FRuoYi-Vue%EF%BC%88%E4%BA%8C%EF%BC%89%EF%BC%9A%E6%9D%83%E9%99%90%E7%B3%BB%E7%BB%9F%E8%AE%BE%E8%AE%A1%E8%AF%A6%E8%A7%A3%20-%20%E4%B8%80%E6%9E%9D%E6%A2%85%E7%9A%84%E6%8A%80%E6%9C%AF%E6%94%B6%E5%BD%95%2075091a4d849d41c9ba464571517093f4/3GI2FKPE84LDGREP4PN2IGNER4.png" data-src="%E8%8B%A5%E4%BE%9D%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9FRuoYi-Vue%EF%BC%88%E4%BA%8C%EF%BC%89%EF%BC%9A%E6%9D%83%E9%99%90%E7%B3%BB%E7%BB%9F%E8%AE%BE%E8%AE%A1%E8%AF%A6%E8%A7%A3%20-%20%E4%B8%80%E6%9E%9D%E6%A2%85%E7%9A%84%E6%8A%80%E6%9C%AF%E6%94%B6%E5%BD%95%2075091a4d849d41c9ba464571517093f4/3GI2FKPE84LDGREP4PN2IGNER4.png" loading="lazy" class="lazy"></p> <h2 id="二、各种类型权限实现原理"><a href="#二、各种类型权限实现原理" class="header-anchor">#</a> 二、各种类型权限实现原理</h2> <h3 id="_1-菜单权限-2"><a href="#_1-菜单权限-2" class="header-anchor">#</a> 1.菜单权限</h3> <p>菜单权限很简单，实际上就是简单的用户-角色-菜单模型，那么菜单是什么时候加载的呢？<code>ruoyi-ui\src\permission.js</code>，加载的逻辑在这个文件中。</p> <p><code>permission.js</code>文件中设置了<a href="https://router.vuejs.org/zh/guide/advanced/navigation-guards.html" target="_blank" rel="noopener noreferrer">导航守卫<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>，每次路由发生变化的时候就会触发router.beforeEach的回调函数。</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>router.beforeEach((to, from, next) =&gt; {
  NProgress.start()
  if (getToken()) {
    /* has token*/
    if (to.path === '/login') {
      next({ path: '/' })
      NProgress.done()
    } else {
      if (store.getters.roles.length === 0) {
        // 判断当前用户是否已拉取完user_info信息
        store.dispatch('GetInfo').then(res =&gt; {
          // 拉取user_info
          const roles = res.roles
          store.dispatch('GenerateRoutes', { roles }).then(accessRoutes =&gt; {
            // 根据roles权限生成可访问的路由表
            router.addRoutes(accessRoutes) // 动态添加可访问路由表
            next({ ...to, replace: true }) // hack方法 确保addRoutes已完成
          })
        }).catch(err =&gt; {
            store.dispatch('LogOut').then(() =&gt; {
              Message.error(err)
              next({ path: '/' })
            })
          })
      } else {
        next()
      }
    }
  } else {
    // 没有token
    if (whiteList.indexOf(to.path) !== -1) {
      // 在免登录白名单，直接进入
      next()
    } else {
      next(`/login?redirect=${to.fullPath}`) // 否则全部重定向到登录页
      NProgress.done()
    }
  }
})

</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br></div></div><p>注意<code>if (store.getters.roles.length === 0) {</code>这段逻辑，可以看出，如果不刷新当前页面，就算给用户添加了新的菜单权限，用户也看不到新的菜单。</p> <h3 id="_2-按钮权限-2"><a href="#_2-按钮权限-2" class="header-anchor">#</a> 2.按钮权限</h3> <p>按钮权限设置上和菜单权限基本上是一样的，是附着于页面中的细粒度权限。按钮权限体现在如果用户没有相应的权限，则看不到相关的按钮。这个是咋实现的呢？</p> <p>先看下系统管理下的菜单管理中的修改、新增和删除按钮前端vue代码</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>&lt;el-table-column label=&quot;操作&quot; align=&quot;center&quot; class-name=&quot;small-padding fixed-width&quot;&gt;
        &lt;template slot-scope=&quot;scope&quot;&gt;
          &lt;el-button size=&quot;mini&quot;
            type=&quot;text&quot;
            icon=&quot;el-icon-edit&quot;
            @click=&quot;handleUpdate(scope.row)&quot;
            v-hasPermi=&quot;['system:menu:edit']&quot;
          &gt;修改&lt;/el-button&gt;
          &lt;el-button
            size=&quot;mini&quot;
            type=&quot;text&quot;
            icon=&quot;el-icon-plus&quot;
            @click=&quot;handleAdd(scope.row)&quot;
            v-hasPermi=&quot;['system:menu:add']&quot;
          &gt;新增&lt;/el-button&gt;
          &lt;el-button
            size=&quot;mini&quot;
            type=&quot;text&quot;
            icon=&quot;el-icon-delete&quot;
            @click=&quot;handleDelete(scope.row)&quot;
            v-hasPermi=&quot;['system:menu:remove']&quot;
          &gt;删除&lt;/el-button&gt;
        &lt;/template&gt;
      &lt;/el-table-column&gt;

</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br></div></div><p>el-button上有个属性<code>v-hasPermi</code>，这实际上是vue的自定义指令，属性值就是创建按钮的时候定义的那个<code>权限标志</code>。其定义在<code>src/directive/permission/index.js</code>文件</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>import hasRole from './hasRole'
import hasPermi from './hasPermi'

const install = function(Vue) {
  Vue.directive('hasRole', hasRole)
  Vue.directive('hasPermi', hasPermi)
}

if (window.Vue) {
  window['hasRole'] = hasRole
  window['hasPermi'] = hasPermi
  Vue.use(install); // eslint-disable-line
}

export default install

</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br></div></div><p>其具体实现逻辑就在同目录的<code>hasPermi.js</code>文件中</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>import store from '@/store'

export default {
  inserted(el, binding, vnode) {
    const { value } = binding
    const all_permission = &quot;*:*:*&quot;;
    const permissions = store.getters &amp;&amp; store.getters.permissions

    if (value &amp;&amp; value instanceof Array &amp;&amp; value.length &gt; 0) {
      const permissionFlag = value

      const hasPermissions = permissions.some(permission =&gt; {
        return all_permission === permission || permissionFlag.includes(permission)
      })

      if (!hasPermissions) {
        el.parentNode &amp;&amp; el.parentNode.removeChild(el)
      }
    } else {
      throw new Error(`请设置操作权限标签值`)
    }
  }
}

</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br></div></div><p>注意代码        <code>el.parentNode &amp;&amp; el.parentNode.removeChild(el)</code>，可以看到，如果没有按钮权限，则会将按钮本身从dom中移除。</p> <h3 id="_3-接口权限-2"><a href="#_3-接口权限-2" class="header-anchor">#</a> 3.接口权限</h3> <p>接口权限和前端的按钮权限一一对应。为的是防止用户绕过按钮直接请求后端接口获取数据。在若依Vue系统中，是使用SpringSecurity的注解<code>@PreAuthorize</code>实现的。</p> <p>虽然只是一个注解，但是它是SpringSecurity+JWT集成的结晶~这个之后再细谈。</p> <h3 id="_4-数据权限-2"><a href="#_4-数据权限-2" class="header-anchor">#</a> 4.数据权限</h3> <p>数据权限实现的关键在于<code>com.ruoyi.framework.aspectj.DataScopeAspect</code>类。该类是一个切面类，凡是加上<code>com.ruoyi.common.annotation.DataScope</code>注解的方法，在执行的时候都会被它拦截。</p> <p>该切面定义了五种权限范围</p> <table><thead><tr><th>name</th> <th>code</th> <th>desc</th></tr></thead> <tbody><tr><td>DATA_SCOPE_ALL</td> <td>1</td> <td>全部数据权限</td></tr> <tr><td>DATA_SCOPE_CUSTOM</td> <td>2</td> <td>自定数据权限</td></tr> <tr><td>DATA_SCOPE_DEPT</td> <td>3</td> <td>部门数据权限</td></tr> <tr><td>DATA_SCOPE_DEPT_AND_CHILD</td> <td>4</td> <td>部门及以下数据权限</td></tr> <tr><td>DATA_SCOPE_SELF</td> <td>5</td> <td>仅本人数据权限</td></tr></tbody></table> <p>该切面的核心逻辑是“拼SQL”，方法执行之前，会给参数的一个params属性添加一个dataScope键值对，key为&quot;dataScope&quot;，值为<code>AND (&quot; + sqlString.substring(4) + &quot;)&quot;</code>样式的一段SQL，这段SQL会根据当前用户所在的部门以及当前用户角色的权限范围发生变化。</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>StringBuilder sqlString = new StringBuilder();
        for (SysRole role : user.getRoles())
        {
            String dataScope = role.getDataScope();
            if (DATA_SCOPE_ALL.equals(dataScope))
            {
                sqlString = new StringBuilder();
                break;
            }
            else if (DATA_SCOPE_CUSTOM.equals(dataScope))
            {
                sqlString.append(StringUtils.format(
                        &quot; OR {}.dept_id IN ( SELECT dept_id FROM sys_role_dept WHERE role_id = {} ) &quot;, deptAlias,
                        role.getRoleId()));
            }
            else if (DATA_SCOPE_DEPT.equals(dataScope))
            {
                sqlString.append(StringUtils.format(&quot; OR {}.dept_id = {} &quot;, deptAlias, user.getDeptId()));
            }
            else if (DATA_SCOPE_DEPT_AND_CHILD.equals(dataScope))
            {
                sqlString.append(StringUtils.format(
                        &quot; OR {}.dept_id IN ( SELECT dept_id FROM sys_dept WHERE dept_id = {} or find_in_set( {} , ancestors ) )&quot;,
                        deptAlias, user.getDeptId(), user.getDeptId()));
            }
            else if (DATA_SCOPE_SELF.equals(dataScope))
            {
                if (StringUtils.isNotBlank(userAlias))
                {
                    sqlString.append(StringUtils.format(&quot; OR {}.user_id = {} &quot;, userAlias, user.getUserId()));
                }
                else
                {
                    // 数据权限为仅本人且没有userAlias别名不查询任何数据
                    sqlString.append(&quot; OR 1=0 &quot;);
                }
            }
        }

</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br></div></div><p>简单来说，这段代码的逻辑就是用户所在的部门权限越高，数据权限范围越大，查出来的结果集将会越大。</p> <p><img alt="%E8%8B%A5%E4%BE%9D%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9FRuoYi-Vue%EF%BC%88%E4%BA%8C%EF%BC%89%EF%BC%9A%E6%9D%83%E9%99%90%E7%B3%BB%E7%BB%9F%E8%AE%BE%E8%AE%A1%E8%AF%A6%E8%A7%A3%20-%20%E4%B8%80%E6%9E%9D%E6%A2%85%E7%9A%84%E6%8A%80%E6%9C%AF%E6%94%B6%E5%BD%95%2075091a4d849d41c9ba464571517093f4/75ASL6GIH1Q1V941RH2JJU5PR.png" data-src="%E8%8B%A5%E4%BE%9D%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9FRuoYi-Vue%EF%BC%88%E4%BA%8C%EF%BC%89%EF%BC%9A%E6%9D%83%E9%99%90%E7%B3%BB%E7%BB%9F%E8%AE%BE%E8%AE%A1%E8%AF%A6%E8%A7%A3%20-%20%E4%B8%80%E6%9E%9D%E6%A2%85%E7%9A%84%E6%8A%80%E6%9C%AF%E6%94%B6%E5%BD%95%2075091a4d849d41c9ba464571517093f4/75ASL6GIH1Q1V941RH2JJU5PR.png" loading="lazy" class="lazy"></p> <p>DataScope注解分别加到了部门列表查询、角色列表查询、用户列表查询的接口上，很明显，这几个接口需要根据不同的人查出不同的结果。</p> <p>以用户列表查询为例，执行sql为</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>    &lt;select id=&quot;selectUserList&quot; parameterType=&quot;SysUser&quot; resultMap=&quot;SysUserResult&quot;&gt;
		select u.user_id, u.dept_id, u.nick_name, u.user_name, u.email, u.avatar, u.phonenumber, u.password, u.sex, u.status, u.del_flag, u.login_ip, u.login_date, u.create_by, u.create_time, u.remark, d.dept_name, d.leader from sys_user u
		left join sys_dept d on u.dept_id = d.dept_id
		where u.del_flag = '0'
		&lt;if test=&quot;userName != null and userName != ''&quot;&gt;
			AND u.user_name like concat('%', #{userName}, '%')
		&lt;/if&gt;
		&lt;if test=&quot;status != null and status != ''&quot;&gt;
			AND u.status = #{status}
		&lt;/if&gt;
		&lt;if test=&quot;phonenumber != null and phonenumber != ''&quot;&gt;
			AND u.phonenumber like concat('%', #{phonenumber}, '%')
		&lt;/if&gt;
		&lt;if test=&quot;params.beginTime != null and params.beginTime != ''&quot;&gt;&lt;!-- 开始时间检索 --&gt;
			AND date_format(u.create_time,'%y%m%d') &amp;gt;= date_format(#{params.beginTime},'%y%m%d')
		&lt;/if&gt;
		&lt;if test=&quot;params.endTime != null and params.endTime != ''&quot;&gt;&lt;!-- 结束时间检索 --&gt;
			AND date_format(u.create_time,'%y%m%d') &amp;lt;= date_format(#{params.endTime},'%y%m%d')
		&lt;/if&gt;
		&lt;if test=&quot;deptId != null and deptId != 0&quot;&gt;
			AND (u.dept_id = #{deptId} OR u.dept_id IN ( SELECT t.dept_id FROM sys_dept t WHERE find_in_set(#{deptId}, ancestors) ))
		&lt;/if&gt;
		&lt;!-- 数据范围过滤 --&gt;
		${params.dataScope}
	&lt;/select&gt;

</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br></div></div><p>其中，有这么一段代码</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>&lt;!-- 数据范围过滤 --&gt;
${params.dataScope}

</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p>实际上<code>DataScopeAspect</code>切面就只干了填充params的dataScope属性这么一件事情。</p> <h2 id="三、若依vue系统springsecurity-jwt"><a href="#三、若依vue系统springsecurity-jwt" class="header-anchor">#</a> 三、若依Vue系统SpringSecurity+JWT</h2> <p>若依Vue系统中从用户登录到后端接口权限校验，都是基于SpringSecurity+JWT实现的，其中，SpringSecurity是核心，jwt只是为了保证token合法性的一种手段（签名防止篡改）。spring security集成的相关代码在<code>ruoyi-framework</code>模块的<code>com.ruoyi.framework.security</code>包以及<code>com.ruoyi.framework.config.SecurityConfig</code>类中。</p> <p><code>SecurityConfig</code>是核心配置类，所有的配置均在该类中。</p> <h3 id="_1-用户登录"><a href="#_1-用户登录" class="header-anchor">#</a> 1.用户登录</h3> <p>用户登录的逻辑在方法<code>com.ruoyi.web.controller.system.SysLoginController#login</code>中，一个典型的登录请求体如下所示</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>{
	&quot;username&quot;: &quot;admin&quot;,
	&quot;password&quot;: &quot;admin123&quot;,
	&quot;code&quot;: &quot;0&quot;,
	&quot;uuid&quot;: &quot;a9fdbcbcb28748b796b5b77ad71bbb97&quot;
}

</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><p>username和password分别是用户名和密码，code为验证码，uuid为验证码的唯一标识。登录成功之后会返回前端一个jwt令牌</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>{
	&quot;msg&quot;: &quot;操作成功&quot;,
	&quot;code&quot;: 200,
	&quot;token&quot;: &quot;eyJhbGciOiJIUzUxMiJ9.eyJsb2dpbl91c2VyX2tleSI6IjIzZjRhNjJjLTY5NzMtNDcxZS04ZmU4LWJmYWQ4YzllNWFkMiJ9.9d3iIaNq62CkjTXlxFOQgdDMOAZiu5tAsEn0cEuV23opT6PAqu_CiaN7kQY8_XhlQrHX5RgZ2bH7LpsiKLLcSw&quot;
}

</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><p>在登录方法中，做了以下几件事情</p> <ul><li>根据uuid获取redis中的验证码并对请求的验证码做验证</li> <li>如果验证码没问题，则对用户名和密码进行校验</li> <li>如果用户名和密码校验成功，则使用token作为key将用户信息保存到redis</li> <li>使用jwt对token签名并返回前端</li></ul> <p>在整个过程中，会抛出一些自定义异常，比如</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>throw new CaptchaExpireException();
throw new CaptchaException();
throw new UserPasswordNotMatchException();
throw new CustomException(e.getMessage());

</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><p>这些异常最终会被全局异常处理器处理掉：<code>com.ruoyi.framework.web.exception.GlobalExceptionHandler</code></p> <h3 id="_2-接口权限校验"><a href="#_2-接口权限校验" class="header-anchor">#</a> 2.接口权限校验</h3> <p>前端请求完成登录接口之后会将token存储到cookie，key为Admin-Token，value是jwt令牌。登录逻辑：<code>user.actions.Login</code>。</p> <p>之后，每次请求后端接口的时候都会带上Authentication Header</p> <p><img alt="%E8%8B%A5%E4%BE%9D%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9FRuoYi-Vue%EF%BC%88%E4%BA%8C%EF%BC%89%EF%BC%9A%E6%9D%83%E9%99%90%E7%B3%BB%E7%BB%9F%E8%AE%BE%E8%AE%A1%E8%AF%A6%E8%A7%A3%20-%20%E4%B8%80%E6%9E%9D%E6%A2%85%E7%9A%84%E6%8A%80%E6%9C%AF%E6%94%B6%E5%BD%95%2075091a4d849d41c9ba464571517093f4/9GQINIAHHR6MA6PP2CPMHG3HS.png" data-src="%E8%8B%A5%E4%BE%9D%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9FRuoYi-Vue%EF%BC%88%E4%BA%8C%EF%BC%89%EF%BC%9A%E6%9D%83%E9%99%90%E7%B3%BB%E7%BB%9F%E8%AE%BE%E8%AE%A1%E8%AF%A6%E8%A7%A3%20-%20%E4%B8%80%E6%9E%9D%E6%A2%85%E7%9A%84%E6%8A%80%E6%9C%AF%E6%94%B6%E5%BD%95%2075091a4d849d41c9ba464571517093f4/9GQINIAHHR6MA6PP2CPMHG3HS.png" loading="lazy" class="lazy"></p> <p>这实际上是通过axios的请求拦截器实现的：详情可见<code>src/utils/request.js</code>文件</p> <p>带着Authentication Header的请求打到后端的时候会经过过滤器<code>com.ruoyi.framework.security.filter.JwtAuthenticationTokenFilter</code>，该过滤器做了以下几件事情</p> <ul><li>从请求头中取出jwt令牌，并对其进行jwt验签，验签若是成功，则取出原始token</li> <li>根据token从redis中取出用户数据</li> <li>将用户信息封装成<code>UsernamePasswordAuthenticationToken</code>对象，并将该对象填充到Spring Security上下文中</li></ul> <p>填充到SpringSecurity上下文才能让Controller接口上的<code>@PreAuthorize</code>注解发挥作用（<strong>存疑，这里若依作者并非使用原生的SpringSecurity提供的spel表达式，也没有用authorities，而是使用了PermissionService类</strong>）。</p> <p>接着，Controller接口正式执行之前会进入<code>com.ruoyi.framework.web.service.PermissionService#hasPermi</code>方法判定权限，这里重新从redis中取出用户数据并进行权限校验，权限校验失败则不再执行接口中逻辑（<strong>存疑，这里并没有使用SpringSecurity上下文中的用户数据，那么<code>JwtAuthenticationTokenFilter</code>中的用户信息填充上下文中的代码是干啥用的</strong>）。</p> <h2 id="四、实战"><a href="#四、实战" class="header-anchor">#</a> 四、实战</h2> <p>上一篇文章讲解了如何创建一个菜单并创建页面，但是是个空页面</p> <p><img alt="%E8%8B%A5%E4%BE%9D%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9FRuoYi-Vue%EF%BC%88%E4%BA%8C%EF%BC%89%EF%BC%9A%E6%9D%83%E9%99%90%E7%B3%BB%E7%BB%9F%E8%AE%BE%E8%AE%A1%E8%AF%A6%E8%A7%A3%20-%20%E4%B8%80%E6%9E%9D%E6%A2%85%E7%9A%84%E6%8A%80%E6%9C%AF%E6%94%B6%E5%BD%95%2075091a4d849d41c9ba464571517093f4/14KU25KR1CG5G5FPKMPG38IN7G.png" data-src="%E8%8B%A5%E4%BE%9D%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9FRuoYi-Vue%EF%BC%88%E4%BA%8C%EF%BC%89%EF%BC%9A%E6%9D%83%E9%99%90%E7%B3%BB%E7%BB%9F%E8%AE%BE%E8%AE%A1%E8%AF%A6%E8%A7%A3%20-%20%E4%B8%80%E6%9E%9D%E6%A2%85%E7%9A%84%E6%8A%80%E6%9C%AF%E6%94%B6%E5%BD%95%2075091a4d849d41c9ba464571517093f4/14KU25KR1CG5G5FPKMPG38IN7G.png" loading="lazy" class="lazy"></p> <p>这篇文章将会讲解如何实现增删查改功能。</p> <p>一切开始之前，新建表news，建表SQL如下</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>CREATE TABLE `news` (
  `id` int(11) NOT NULL AUTO_INCREMENT COMMENT '主键',
  `title` varchar(128) NOT NULL COMMENT '新闻标题',
  `brief` varchar(256) DEFAULT NULL COMMENT '新闻概述',
  `content` text COMMENT '新闻正文',
  `create_time` datetime DEFAULT NULL,
  `create_by` varchar(64) DEFAULT NULL,
  `update_time` datetime DEFAULT NULL,
  `update_by` varchar(64) DEFAULT NULL,
  `delete_flag` tinyint(1) DEFAULT NULL,
  PRIMARY KEY (`id`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4

</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br></div></div><h3 id="_1-前端页面修改"><a href="#_1-前端页面修改" class="header-anchor">#</a> 1.前端页面修改</h3> <p>可以仿照角色管理的页面写，直接将角色管理页面的代码直接拷贝到news文件中，效果如下</p> <p><img alt="%E8%8B%A5%E4%BE%9D%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9FRuoYi-Vue%EF%BC%88%E4%BA%8C%EF%BC%89%EF%BC%9A%E6%9D%83%E9%99%90%E7%B3%BB%E7%BB%9F%E8%AE%BE%E8%AE%A1%E8%AF%A6%E8%A7%A3%20-%20%E4%B8%80%E6%9E%9D%E6%A2%85%E7%9A%84%E6%8A%80%E6%9C%AF%E6%94%B6%E5%BD%95%2075091a4d849d41c9ba464571517093f4/1OOISFU5CSQ6OIC9TD7EHG5KC2.png" data-src="%E8%8B%A5%E4%BE%9D%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9FRuoYi-Vue%EF%BC%88%E4%BA%8C%EF%BC%89%EF%BC%9A%E6%9D%83%E9%99%90%E7%B3%BB%E7%BB%9F%E8%AE%BE%E8%AE%A1%E8%AF%A6%E8%A7%A3%20-%20%E4%B8%80%E6%9E%9D%E6%A2%85%E7%9A%84%E6%8A%80%E6%9C%AF%E6%94%B6%E5%BD%95%2075091a4d849d41c9ba464571517093f4/1OOISFU5CSQ6OIC9TD7EHG5KC2.png" loading="lazy" class="lazy"></p> <p>没错，新闻列表的标题，角色管理的页面。。。</p> <p><img alt="%E8%8B%A5%E4%BE%9D%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9FRuoYi-Vue%EF%BC%88%E4%BA%8C%EF%BC%89%EF%BC%9A%E6%9D%83%E9%99%90%E7%B3%BB%E7%BB%9F%E8%AE%BE%E8%AE%A1%E8%AF%A6%E8%A7%A3%20-%20%E4%B8%80%E6%9E%9D%E6%A2%85%E7%9A%84%E6%8A%80%E6%9C%AF%E6%94%B6%E5%BD%95%2075091a4d849d41c9ba464571517093f4/1IFROUJCO5B7OH3763BRCFMJ9D.png" data-src="%E8%8B%A5%E4%BE%9D%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9FRuoYi-Vue%EF%BC%88%E4%BA%8C%EF%BC%89%EF%BC%9A%E6%9D%83%E9%99%90%E7%B3%BB%E7%BB%9F%E8%AE%BE%E8%AE%A1%E8%AF%A6%E8%A7%A3%20-%20%E4%B8%80%E6%9E%9D%E6%A2%85%E7%9A%84%E6%8A%80%E6%9C%AF%E6%94%B6%E5%BD%95%2075091a4d849d41c9ba464571517093f4/1IFROUJCO5B7OH3763BRCFMJ9D.png" loading="lazy" class="lazy"></p> <p>之后对页面中元素进行修改，使其和上面创建的表结构一致，修改后的页面样子</p> <p><img alt="%E8%8B%A5%E4%BE%9D%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9FRuoYi-Vue%EF%BC%88%E4%BA%8C%EF%BC%89%EF%BC%9A%E6%9D%83%E9%99%90%E7%B3%BB%E7%BB%9F%E8%AE%BE%E8%AE%A1%E8%AF%A6%E8%A7%A3%20-%20%E4%B8%80%E6%9E%9D%E6%A2%85%E7%9A%84%E6%8A%80%E6%9C%AF%E6%94%B6%E5%BD%95%2075091a4d849d41c9ba464571517093f4/1G84GPSKCQB5CLHG539JQB1LOV.png" data-src="%E8%8B%A5%E4%BE%9D%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9FRuoYi-Vue%EF%BC%88%E4%BA%8C%EF%BC%89%EF%BC%9A%E6%9D%83%E9%99%90%E7%B3%BB%E7%BB%9F%E8%AE%BE%E8%AE%A1%E8%AF%A6%E8%A7%A3%20-%20%E4%B8%80%E6%9E%9D%E6%A2%85%E7%9A%84%E6%8A%80%E6%9C%AF%E6%94%B6%E5%BD%95%2075091a4d849d41c9ba464571517093f4/1G84GPSKCQB5CLHG539JQB1LOV.png" loading="lazy" class="lazy"></p> <p>这是预期中的样子，但是内容还是角色管理页面的内容。</p> <h3 id="_2-创建按钮权限"><a href="#_2-创建按钮权限" class="header-anchor">#</a> 2.创建按钮权限</h3> <p>上一步已经完成了页面外观的改造，接下来需要修改页面内容了，首先需要把按钮权限给加上</p> <p><img alt="%E8%8B%A5%E4%BE%9D%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9FRuoYi-Vue%EF%BC%88%E4%BA%8C%EF%BC%89%EF%BC%9A%E6%9D%83%E9%99%90%E7%B3%BB%E7%BB%9F%E8%AE%BE%E8%AE%A1%E8%AF%A6%E8%A7%A3%20-%20%E4%B8%80%E6%9E%9D%E6%A2%85%E7%9A%84%E6%8A%80%E6%9C%AF%E6%94%B6%E5%BD%95%2075091a4d849d41c9ba464571517093f4/1BRPQ63J5ET6E3K73EFL3I0DUB.png" data-src="%E8%8B%A5%E4%BE%9D%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9FRuoYi-Vue%EF%BC%88%E4%BA%8C%EF%BC%89%EF%BC%9A%E6%9D%83%E9%99%90%E7%B3%BB%E7%BB%9F%E8%AE%BE%E8%AE%A1%E8%AF%A6%E8%A7%A3%20-%20%E4%B8%80%E6%9E%9D%E6%A2%85%E7%9A%84%E6%8A%80%E6%9C%AF%E6%94%B6%E5%BD%95%2075091a4d849d41c9ba464571517093f4/1BRPQ63J5ET6E3K73EFL3I0DUB.png" loading="lazy" class="lazy"></p> <p>按照这个样子添加按钮权限，之后把权限标志分配到前端页面中</p> <p><img alt="%E8%8B%A5%E4%BE%9D%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9FRuoYi-Vue%EF%BC%88%E4%BA%8C%EF%BC%89%EF%BC%9A%E6%9D%83%E9%99%90%E7%B3%BB%E7%BB%9F%E8%AE%BE%E8%AE%A1%E8%AF%A6%E8%A7%A3%20-%20%E4%B8%80%E6%9E%9D%E6%A2%85%E7%9A%84%E6%8A%80%E6%9C%AF%E6%94%B6%E5%BD%95%2075091a4d849d41c9ba464571517093f4/DUI2M9IHG5LQ3KOKF8MRUMKNC.png" data-src="%E8%8B%A5%E4%BE%9D%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9FRuoYi-Vue%EF%BC%88%E4%BA%8C%EF%BC%89%EF%BC%9A%E6%9D%83%E9%99%90%E7%B3%BB%E7%BB%9F%E8%AE%BE%E8%AE%A1%E8%AF%A6%E8%A7%A3%20-%20%E4%B8%80%E6%9E%9D%E6%A2%85%E7%9A%84%E6%8A%80%E6%9C%AF%E6%94%B6%E5%BD%95%2075091a4d849d41c9ba464571517093f4/DUI2M9IHG5LQ3KOKF8MRUMKNC.png" loading="lazy" class="lazy"></p> <h3 id="_3-使用代码生成代码"><a href="#_3-使用代码生成代码" class="header-anchor">#</a> 3.使用代码生成代码</h3> <p>在系统工具-代码生成页面中生成news表对应的相关实体类、mapper、xml对象等，可以极大的简化开发过程。</p> <p><img alt="%E8%8B%A5%E4%BE%9D%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9FRuoYi-Vue%EF%BC%88%E4%BA%8C%EF%BC%89%EF%BC%9A%E6%9D%83%E9%99%90%E7%B3%BB%E7%BB%9F%E8%AE%BE%E8%AE%A1%E8%AF%A6%E8%A7%A3%20-%20%E4%B8%80%E6%9E%9D%E6%A2%85%E7%9A%84%E6%8A%80%E6%9C%AF%E6%94%B6%E5%BD%95%2075091a4d849d41c9ba464571517093f4/3GSOUH1U4GT69DE86SQVG9FKHD.png" data-src="%E8%8B%A5%E4%BE%9D%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9FRuoYi-Vue%EF%BC%88%E4%BA%8C%EF%BC%89%EF%BC%9A%E6%9D%83%E9%99%90%E7%B3%BB%E7%BB%9F%E8%AE%BE%E8%AE%A1%E8%AF%A6%E8%A7%A3%20-%20%E4%B8%80%E6%9E%9D%E6%A2%85%E7%9A%84%E6%8A%80%E6%9C%AF%E6%94%B6%E5%BD%95%2075091a4d849d41c9ba464571517093f4/3GSOUH1U4GT69DE86SQVG9FKHD.png" loading="lazy" class="lazy"></p> <h3 id="_4-准备后端接口"><a href="#_4-准备后端接口" class="header-anchor">#</a> 4.准备后端接口</h3> <p>将上一步代码生成器生成的<code>NewsController</code>拿过来改一改就行，修改后的代码如下所示：</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>package com.ruoyi.web.controller.business;

import com.ruoyi.common.annotation.Log;
import com.ruoyi.common.core.controller.BaseController;
import com.ruoyi.common.core.domain.AjaxResult;
import com.ruoyi.common.core.page.TableDataInfo;
import com.ruoyi.common.enums.BusinessType;
import com.ruoyi.common.utils.SecurityUtils;
import com.ruoyi.common.utils.poi.ExcelUtil;
import com.ruoyi.system.domain.News;
import com.ruoyi.system.mapper.NewsMapper;
import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.security.access.prepost.PreAuthorize;
import org.springframework.validation.annotation.Validated;
import org.springframework.web.bind.annotation.*;

import java.util.Date;
import java.util.List;

/**
 * @author kdyzm
 */
@RestController
@RequestMapping(&quot;/business/news&quot;)
public class NewsController extends BaseController {

    @Autowired
    private NewsMapper newsMapper;

    /**
     * 获取新闻列表
     */
    @PreAuthorize(&quot;@ss.hasPermi('business:news:list')&quot;)
    @GetMapping(&quot;/list&quot;)
    public TableDataInfo list(News post) {
        startPage();
        List&lt;News&gt; list = newsMapper.selectNewsList(post);
        return getDataTable(list);
    }

    @Log(title = &quot;新闻管理&quot;, businessType = BusinessType.EXPORT)
    @PreAuthorize(&quot;@ss.hasPermi('business:news:export')&quot;)
    @GetMapping(&quot;/export&quot;)
    public AjaxResult export(News post) {
        List&lt;News&gt; list = newsMapper.selectNewsList(post);
        ExcelUtil&lt;News&gt; util = new ExcelUtil&lt;&gt;(News.class);
        return util.exportExcel(list, &quot;新闻数据&quot;);
    }

    /**
     * 根据新闻编号获取详细信息
     */
    @PreAuthorize(&quot;@ss.hasPermi('business:news:query')&quot;)
    @GetMapping(value = &quot;/{postId}&quot;)
    public AjaxResult getInfo(@PathVariable Long postId) {
        return AjaxResult.success(newsMapper.selectNewsById(postId));
    }

    /**
     * 新增新闻
     */
    @PreAuthorize(&quot;@ss.hasPermi('business:news:add')&quot;)
    @Log(title = &quot;新闻管理&quot;, businessType = BusinessType.INSERT)
    @PostMapping
    public AjaxResult add(@Validated @RequestBody News post) {
        post.setCreateBy(SecurityUtils.getUsername());
        post.setCreateTime(new Date());
        return toAjax(newsMapper.insertNews(post));
    }

    /**
     * 修改新闻
     */
    @PreAuthorize(&quot;@ss.hasPermi('business:news:update')&quot;)
    @Log(title = &quot;新闻管理&quot;, businessType = BusinessType.UPDATE)
    @PutMapping
    public AjaxResult edit(@Validated @RequestBody News post) {
        post.setUpdateBy(SecurityUtils.getUsername());
        return toAjax(newsMapper.updateNews(post));
    }

    /**
     * 删除新闻
     */
    @PreAuthorize(&quot;@ss.hasPermi('business:news:delete')&quot;)
    @Log(title = &quot;新闻管理&quot;, businessType = BusinessType.DELETE)
    @DeleteMapping(&quot;/{postIds}&quot;)
    public AjaxResult remove(@PathVariable Long[] postIds) {
        return toAjax(newsMapper.deleteNewsByIds(postIds));
    }
}

</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br><span class="line-number">53</span><br><span class="line-number">54</span><br><span class="line-number">55</span><br><span class="line-number">56</span><br><span class="line-number">57</span><br><span class="line-number">58</span><br><span class="line-number">59</span><br><span class="line-number">60</span><br><span class="line-number">61</span><br><span class="line-number">62</span><br><span class="line-number">63</span><br><span class="line-number">64</span><br><span class="line-number">65</span><br><span class="line-number">66</span><br><span class="line-number">67</span><br><span class="line-number">68</span><br><span class="line-number">69</span><br><span class="line-number">70</span><br><span class="line-number">71</span><br><span class="line-number">72</span><br><span class="line-number">73</span><br><span class="line-number">74</span><br><span class="line-number">75</span><br><span class="line-number">76</span><br><span class="line-number">77</span><br><span class="line-number">78</span><br><span class="line-number">79</span><br><span class="line-number">80</span><br><span class="line-number">81</span><br><span class="line-number">82</span><br><span class="line-number">83</span><br><span class="line-number">84</span><br><span class="line-number">85</span><br><span class="line-number">86</span><br><span class="line-number">87</span><br><span class="line-number">88</span><br><span class="line-number">89</span><br><span class="line-number">90</span><br><span class="line-number">91</span><br><span class="line-number">92</span><br></div></div><h3 id="_5-修改前端页面请求地址"><a href="#_5-修改前端页面请求地址" class="header-anchor">#</a> 5.修改前端页面请求地址</h3> <p>将生成的代码中的news.js文件放到api目录，并修改其中的接口路径与后端接口地址一一对应。</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>import request from '@/utils/request'

// 查询角色列表
export function listNews(query) {
  return request({
    url: '/business/news/list',
    method: 'get',
    params: query
  })
}

// 查询角色详细
export function getNews(roleId) {
  return request({
    url: '/business/news/' + roleId,
    method: 'get'
  })
}

// 新增角色
export function addNews(data) {
  return request({
    url: '/business/news',
    method: 'post',
    data: data
  })
}

// 修改角色
export function updateNews(data) {
  return request({
    url: '/business/news',
    method: 'put',
    data: data
  })
}

// 删除角色
export function delNews(roleId) {
  return request({
    url: '/business/news/' + roleId,
    method: 'delete'
  })
}

// 导出角色
export function exportNews(query) {
  return request({
    url: '/business/news/export',
    method: 'get',
    params: query
  })
}

</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br><span class="line-number">53</span><br><span class="line-number">54</span><br></div></div><p>然后修改页面中的请求地址使用这里的地址。</p> <h2 id="五、测试"><a href="#五、测试" class="header-anchor">#</a> 五、测试</h2> <h3 id="_1-超级管理员测试"><a href="#_1-超级管理员测试" class="header-anchor">#</a> 1.超级管理员测试</h3> <p>超级管理员拥有最大权限，所有权限校验都会跳过对超级管理员的权限校验。这里先使用超级管理员进行测试可以规避权限问题，大体上先看看能否跑的通。</p> <p>下面是演示超级管理员的CRUD操作。</p> <p><img alt="%E8%8B%A5%E4%BE%9D%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9FRuoYi-Vue%EF%BC%88%E4%BA%8C%EF%BC%89%EF%BC%9A%E6%9D%83%E9%99%90%E7%B3%BB%E7%BB%9F%E8%AE%BE%E8%AE%A1%E8%AF%A6%E8%A7%A3%20-%20%E4%B8%80%E6%9E%9D%E6%A2%85%E7%9A%84%E6%8A%80%E6%9C%AF%E6%94%B6%E5%BD%95%2075091a4d849d41c9ba464571517093f4/1V267CBLE8N9N3O7R7TUQIM81K.gif" data-src="%E8%8B%A5%E4%BE%9D%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9FRuoYi-Vue%EF%BC%88%E4%BA%8C%EF%BC%89%EF%BC%9A%E6%9D%83%E9%99%90%E7%B3%BB%E7%BB%9F%E8%AE%BE%E8%AE%A1%E8%AF%A6%E8%A7%A3%20-%20%E4%B8%80%E6%9E%9D%E6%A2%85%E7%9A%84%E6%8A%80%E6%9C%AF%E6%94%B6%E5%BD%95%2075091a4d849d41c9ba464571517093f4/1V267CBLE8N9N3O7R7TUQIM81K.gif" loading="lazy" class="lazy"></p> <h3 id="_2-普通用户测试"><a href="#_2-普通用户测试" class="header-anchor">#</a> 2.普通用户测试</h3> <p>这里用用户kdyzm进行测试，在测试之前，先看下kdyzm的角色</p> <p><img alt="%E8%8B%A5%E4%BE%9D%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9FRuoYi-Vue%EF%BC%88%E4%BA%8C%EF%BC%89%EF%BC%9A%E6%9D%83%E9%99%90%E7%B3%BB%E7%BB%9F%E8%AE%BE%E8%AE%A1%E8%AF%A6%E8%A7%A3%20-%20%E4%B8%80%E6%9E%9D%E6%A2%85%E7%9A%84%E6%8A%80%E6%9C%AF%E6%94%B6%E5%BD%95%2075091a4d849d41c9ba464571517093f4/2NDBLLTJGCMND7L984CF2B2TUB.png" data-src="%E8%8B%A5%E4%BE%9D%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9FRuoYi-Vue%EF%BC%88%E4%BA%8C%EF%BC%89%EF%BC%9A%E6%9D%83%E9%99%90%E7%B3%BB%E7%BB%9F%E8%AE%BE%E8%AE%A1%E8%AF%A6%E8%A7%A3%20-%20%E4%B8%80%E6%9E%9D%E6%A2%85%E7%9A%84%E6%8A%80%E6%9C%AF%E6%94%B6%E5%BD%95%2075091a4d849d41c9ba464571517093f4/2NDBLLTJGCMND7L984CF2B2TUB.png" loading="lazy" class="lazy"></p> <p>可以看到该用户是运营角色，那么修改角色权限，只给查询、修改、新增权限，不给导出和删除权限，如下所示</p> <p><img alt="%E8%8B%A5%E4%BE%9D%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9FRuoYi-Vue%EF%BC%88%E4%BA%8C%EF%BC%89%EF%BC%9A%E6%9D%83%E9%99%90%E7%B3%BB%E7%BB%9F%E8%AE%BE%E8%AE%A1%E8%AF%A6%E8%A7%A3%20-%20%E4%B8%80%E6%9E%9D%E6%A2%85%E7%9A%84%E6%8A%80%E6%9C%AF%E6%94%B6%E5%BD%95%2075091a4d849d41c9ba464571517093f4/46M75EQAGTEUGNPLA13AFERMK.png" data-src="%E8%8B%A5%E4%BE%9D%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9FRuoYi-Vue%EF%BC%88%E4%BA%8C%EF%BC%89%EF%BC%9A%E6%9D%83%E9%99%90%E7%B3%BB%E7%BB%9F%E8%AE%BE%E8%AE%A1%E8%AF%A6%E8%A7%A3%20-%20%E4%B8%80%E6%9E%9D%E6%A2%85%E7%9A%84%E6%8A%80%E6%9C%AF%E6%94%B6%E5%BD%95%2075091a4d849d41c9ba464571517093f4/46M75EQAGTEUGNPLA13AFERMK.png" loading="lazy" class="lazy"></p> <p>这时候切换登录用户为kdyzm，看看新闻列表页面</p> <p><img alt="%E8%8B%A5%E4%BE%9D%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9FRuoYi-Vue%EF%BC%88%E4%BA%8C%EF%BC%89%EF%BC%9A%E6%9D%83%E9%99%90%E7%B3%BB%E7%BB%9F%E8%AE%BE%E8%AE%A1%E8%AF%A6%E8%A7%A3%20-%20%E4%B8%80%E6%9E%9D%E6%A2%85%E7%9A%84%E6%8A%80%E6%9C%AF%E6%94%B6%E5%BD%95%2075091a4d849d41c9ba464571517093f4/MLHETKL3UDK0PS3T9I3PFSRFT.png" data-src="%E8%8B%A5%E4%BE%9D%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9FRuoYi-Vue%EF%BC%88%E4%BA%8C%EF%BC%89%EF%BC%9A%E6%9D%83%E9%99%90%E7%B3%BB%E7%BB%9F%E8%AE%BE%E8%AE%A1%E8%AF%A6%E8%A7%A3%20-%20%E4%B8%80%E6%9E%9D%E6%A2%85%E7%9A%84%E6%8A%80%E6%9C%AF%E6%94%B6%E5%BD%95%2075091a4d849d41c9ba464571517093f4/MLHETKL3UDK0PS3T9I3PFSRFT.png" loading="lazy" class="lazy"></p> <p>可以看到，kdyzm在新闻列表页面中，看不到导出导出按钮和删除按钮，符合预期设想。</p> <p>好了，若依Vue权限详解部分到此结束了，欢迎关注我的博客 <a href="https://blog.kdyzm.cn/" target="_blank" rel="noopener noreferrer">https://blog.kdyzm.cn<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <p>注意：本文归作者所有，未经作者允许，不得转载</p> <p><a href="https://blog.kdyzm.cn/tag/%E8%8B%A5%E4%BE%9D/" target="_blank" rel="noopener noreferrer">#若依<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> <a href="https://blog.kdyzm.cn/tag/ruoyi/" target="_blank" rel="noopener noreferrer">#ruoyi<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <p>我有话说:</p> <p>名字：</p> <p>邮箱：</p> <p>网址：</p> <div pseudo="-webkit-input-placeholder" id="placeholder" style="display:block !important;">请输入评论内容，不超过1024字</div><div></div> <p>验证码：</p> <h3 id="全部评论-3-条"><a href="#全部评论-3-条" class="header-anchor">#</a> 全部评论: 3 条</h3> <ul><li><p>受教了~ <a href="http://" target="_blank" rel="noopener noreferrer">@test<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>: 存疑那里，因为使用jwtfilter，所以没有在config里面配置formlogin,也就无法使用UsernamePasswordAuthenticationFIlter，所以需要通过jwt将authentication塞入到spring security上下文。</p> <h3 id="一枝梅2022-06-15"><a href="#一枝梅2022-06-15" class="header-anchor">#</a> <a href="https://blog.kdyzm.cn/" target="_blank" rel="noopener noreferrer">一枝梅<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>2022-06-15</h3></li></ul></div> <div class="page-meta"><footer class="page-edit" style="margin:0;"><!----> <!----></footer> <div class="page-views" data-v-66c9020e><i class="fas fa-eye" data-v-66c9020e></i> <span class="view-count" data-v-66c9020e><span id="busuanzi_container_page_pv" style="display: none;" data-v-66c9020e>
            阅读次数: <span id="busuanzi_value_page_pv" data-v-66c9020e>0</span></span></span></div></div> <!----></div> <div class="toc-container-sidebar"><div class="pos-box"><div class="icon-arrow"></div> <div class="scroll-box" style="max-height:86vh"><div style="font-weight:bold;">若依管理系统RuoYi-Vue（二）：权限系统设计详解 - 一枝梅的技术收录</div> <hr> <div class="toc-box"><ul class="toc-sidebar-links"><li><a href="/src/%E7%9F%A5%E8%AF%86%E7%A2%8E%E7%89%87/Java%E7%9B%B8%E5%85%B3/%E8%8B%A5%E4%BE%9D%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9FRuoYi-Vue%EF%BC%88%E4%BA%8C%EF%BC%89%EF%BC%9A%E6%9D%83%E9%99%90%E7%B3%BB%E7%BB%9F%E8%AE%BE%E8%AE%A1%E8%AF%A6%E8%A7%A3%20-%20%E4%B8%80%E6%9E%9D%E6%A2%85%E7%9A%84%E6%8A%80%E6%9C%AF%E6%94%B6%E5%BD%95%2075091a4d849d41c9ba464571517093f4.html#一、若依vue系统中的权限分类" class="toc-sidebar-link">一、若依Vue系统中的权限分类</a><ul class="toc-sidebar-sub-headers"><li class="toc-sidebar-sub-header"><a href="/src/%E7%9F%A5%E8%AF%86%E7%A2%8E%E7%89%87/Java%E7%9B%B8%E5%85%B3/%E8%8B%A5%E4%BE%9D%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9FRuoYi-Vue%EF%BC%88%E4%BA%8C%EF%BC%89%EF%BC%9A%E6%9D%83%E9%99%90%E7%B3%BB%E7%BB%9F%E8%AE%BE%E8%AE%A1%E8%AF%A6%E8%A7%A3%20-%20%E4%B8%80%E6%9E%9D%E6%A2%85%E7%9A%84%E6%8A%80%E6%9C%AF%E6%94%B6%E5%BD%95%2075091a4d849d41c9ba464571517093f4.html#_1-菜单权限" class="toc-sidebar-link">1.菜单权限</a></li><li class="toc-sidebar-sub-header"><a href="/src/%E7%9F%A5%E8%AF%86%E7%A2%8E%E7%89%87/Java%E7%9B%B8%E5%85%B3/%E8%8B%A5%E4%BE%9D%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9FRuoYi-Vue%EF%BC%88%E4%BA%8C%EF%BC%89%EF%BC%9A%E6%9D%83%E9%99%90%E7%B3%BB%E7%BB%9F%E8%AE%BE%E8%AE%A1%E8%AF%A6%E8%A7%A3%20-%20%E4%B8%80%E6%9E%9D%E6%A2%85%E7%9A%84%E6%8A%80%E6%9C%AF%E6%94%B6%E5%BD%95%2075091a4d849d41c9ba464571517093f4.html#_2-按钮权限" class="toc-sidebar-link">2.按钮权限</a></li><li class="toc-sidebar-sub-header"><a href="/src/%E7%9F%A5%E8%AF%86%E7%A2%8E%E7%89%87/Java%E7%9B%B8%E5%85%B3/%E8%8B%A5%E4%BE%9D%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9FRuoYi-Vue%EF%BC%88%E4%BA%8C%EF%BC%89%EF%BC%9A%E6%9D%83%E9%99%90%E7%B3%BB%E7%BB%9F%E8%AE%BE%E8%AE%A1%E8%AF%A6%E8%A7%A3%20-%20%E4%B8%80%E6%9E%9D%E6%A2%85%E7%9A%84%E6%8A%80%E6%9C%AF%E6%94%B6%E5%BD%95%2075091a4d849d41c9ba464571517093f4.html#_3-接口权限" class="toc-sidebar-link">3.接口权限</a></li><li class="toc-sidebar-sub-header"><a href="/src/%E7%9F%A5%E8%AF%86%E7%A2%8E%E7%89%87/Java%E7%9B%B8%E5%85%B3/%E8%8B%A5%E4%BE%9D%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9FRuoYi-Vue%EF%BC%88%E4%BA%8C%EF%BC%89%EF%BC%9A%E6%9D%83%E9%99%90%E7%B3%BB%E7%BB%9F%E8%AE%BE%E8%AE%A1%E8%AF%A6%E8%A7%A3%20-%20%E4%B8%80%E6%9E%9D%E6%A2%85%E7%9A%84%E6%8A%80%E6%9C%AF%E6%94%B6%E5%BD%95%2075091a4d849d41c9ba464571517093f4.html#_4-数据权限" class="toc-sidebar-link">4.数据权限</a></li></ul></li><li><a href="/src/%E7%9F%A5%E8%AF%86%E7%A2%8E%E7%89%87/Java%E7%9B%B8%E5%85%B3/%E8%8B%A5%E4%BE%9D%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9FRuoYi-Vue%EF%BC%88%E4%BA%8C%EF%BC%89%EF%BC%9A%E6%9D%83%E9%99%90%E7%B3%BB%E7%BB%9F%E8%AE%BE%E8%AE%A1%E8%AF%A6%E8%A7%A3%20-%20%E4%B8%80%E6%9E%9D%E6%A2%85%E7%9A%84%E6%8A%80%E6%9C%AF%E6%94%B6%E5%BD%95%2075091a4d849d41c9ba464571517093f4.html#二、各种类型权限实现原理" class="toc-sidebar-link">二、各种类型权限实现原理</a><ul class="toc-sidebar-sub-headers"><li class="toc-sidebar-sub-header"><a href="/src/%E7%9F%A5%E8%AF%86%E7%A2%8E%E7%89%87/Java%E7%9B%B8%E5%85%B3/%E8%8B%A5%E4%BE%9D%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9FRuoYi-Vue%EF%BC%88%E4%BA%8C%EF%BC%89%EF%BC%9A%E6%9D%83%E9%99%90%E7%B3%BB%E7%BB%9F%E8%AE%BE%E8%AE%A1%E8%AF%A6%E8%A7%A3%20-%20%E4%B8%80%E6%9E%9D%E6%A2%85%E7%9A%84%E6%8A%80%E6%9C%AF%E6%94%B6%E5%BD%95%2075091a4d849d41c9ba464571517093f4.html#_1-菜单权限-2" class="toc-sidebar-link">1.菜单权限</a></li><li class="toc-sidebar-sub-header"><a href="/src/%E7%9F%A5%E8%AF%86%E7%A2%8E%E7%89%87/Java%E7%9B%B8%E5%85%B3/%E8%8B%A5%E4%BE%9D%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9FRuoYi-Vue%EF%BC%88%E4%BA%8C%EF%BC%89%EF%BC%9A%E6%9D%83%E9%99%90%E7%B3%BB%E7%BB%9F%E8%AE%BE%E8%AE%A1%E8%AF%A6%E8%A7%A3%20-%20%E4%B8%80%E6%9E%9D%E6%A2%85%E7%9A%84%E6%8A%80%E6%9C%AF%E6%94%B6%E5%BD%95%2075091a4d849d41c9ba464571517093f4.html#_2-按钮权限-2" class="toc-sidebar-link">2.按钮权限</a></li><li class="toc-sidebar-sub-header"><a href="/src/%E7%9F%A5%E8%AF%86%E7%A2%8E%E7%89%87/Java%E7%9B%B8%E5%85%B3/%E8%8B%A5%E4%BE%9D%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9FRuoYi-Vue%EF%BC%88%E4%BA%8C%EF%BC%89%EF%BC%9A%E6%9D%83%E9%99%90%E7%B3%BB%E7%BB%9F%E8%AE%BE%E8%AE%A1%E8%AF%A6%E8%A7%A3%20-%20%E4%B8%80%E6%9E%9D%E6%A2%85%E7%9A%84%E6%8A%80%E6%9C%AF%E6%94%B6%E5%BD%95%2075091a4d849d41c9ba464571517093f4.html#_3-接口权限-2" class="toc-sidebar-link">3.接口权限</a></li><li class="toc-sidebar-sub-header"><a href="/src/%E7%9F%A5%E8%AF%86%E7%A2%8E%E7%89%87/Java%E7%9B%B8%E5%85%B3/%E8%8B%A5%E4%BE%9D%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9FRuoYi-Vue%EF%BC%88%E4%BA%8C%EF%BC%89%EF%BC%9A%E6%9D%83%E9%99%90%E7%B3%BB%E7%BB%9F%E8%AE%BE%E8%AE%A1%E8%AF%A6%E8%A7%A3%20-%20%E4%B8%80%E6%9E%9D%E6%A2%85%E7%9A%84%E6%8A%80%E6%9C%AF%E6%94%B6%E5%BD%95%2075091a4d849d41c9ba464571517093f4.html#_4-数据权限-2" class="toc-sidebar-link">4.数据权限</a></li></ul></li><li><a href="/src/%E7%9F%A5%E8%AF%86%E7%A2%8E%E7%89%87/Java%E7%9B%B8%E5%85%B3/%E8%8B%A5%E4%BE%9D%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9FRuoYi-Vue%EF%BC%88%E4%BA%8C%EF%BC%89%EF%BC%9A%E6%9D%83%E9%99%90%E7%B3%BB%E7%BB%9F%E8%AE%BE%E8%AE%A1%E8%AF%A6%E8%A7%A3%20-%20%E4%B8%80%E6%9E%9D%E6%A2%85%E7%9A%84%E6%8A%80%E6%9C%AF%E6%94%B6%E5%BD%95%2075091a4d849d41c9ba464571517093f4.html#三、若依vue系统springsecurity-jwt" class="toc-sidebar-link">三、若依Vue系统SpringSecurity+JWT</a><ul class="toc-sidebar-sub-headers"><li class="toc-sidebar-sub-header"><a href="/src/%E7%9F%A5%E8%AF%86%E7%A2%8E%E7%89%87/Java%E7%9B%B8%E5%85%B3/%E8%8B%A5%E4%BE%9D%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9FRuoYi-Vue%EF%BC%88%E4%BA%8C%EF%BC%89%EF%BC%9A%E6%9D%83%E9%99%90%E7%B3%BB%E7%BB%9F%E8%AE%BE%E8%AE%A1%E8%AF%A6%E8%A7%A3%20-%20%E4%B8%80%E6%9E%9D%E6%A2%85%E7%9A%84%E6%8A%80%E6%9C%AF%E6%94%B6%E5%BD%95%2075091a4d849d41c9ba464571517093f4.html#_1-用户登录" class="toc-sidebar-link">1.用户登录</a></li><li class="toc-sidebar-sub-header"><a href="/src/%E7%9F%A5%E8%AF%86%E7%A2%8E%E7%89%87/Java%E7%9B%B8%E5%85%B3/%E8%8B%A5%E4%BE%9D%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9FRuoYi-Vue%EF%BC%88%E4%BA%8C%EF%BC%89%EF%BC%9A%E6%9D%83%E9%99%90%E7%B3%BB%E7%BB%9F%E8%AE%BE%E8%AE%A1%E8%AF%A6%E8%A7%A3%20-%20%E4%B8%80%E6%9E%9D%E6%A2%85%E7%9A%84%E6%8A%80%E6%9C%AF%E6%94%B6%E5%BD%95%2075091a4d849d41c9ba464571517093f4.html#_2-接口权限校验" class="toc-sidebar-link">2.接口权限校验</a></li></ul></li><li><a href="/src/%E7%9F%A5%E8%AF%86%E7%A2%8E%E7%89%87/Java%E7%9B%B8%E5%85%B3/%E8%8B%A5%E4%BE%9D%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9FRuoYi-Vue%EF%BC%88%E4%BA%8C%EF%BC%89%EF%BC%9A%E6%9D%83%E9%99%90%E7%B3%BB%E7%BB%9F%E8%AE%BE%E8%AE%A1%E8%AF%A6%E8%A7%A3%20-%20%E4%B8%80%E6%9E%9D%E6%A2%85%E7%9A%84%E6%8A%80%E6%9C%AF%E6%94%B6%E5%BD%95%2075091a4d849d41c9ba464571517093f4.html#四、实战" class="toc-sidebar-link">四、实战</a><ul class="toc-sidebar-sub-headers"><li class="toc-sidebar-sub-header"><a href="/src/%E7%9F%A5%E8%AF%86%E7%A2%8E%E7%89%87/Java%E7%9B%B8%E5%85%B3/%E8%8B%A5%E4%BE%9D%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9FRuoYi-Vue%EF%BC%88%E4%BA%8C%EF%BC%89%EF%BC%9A%E6%9D%83%E9%99%90%E7%B3%BB%E7%BB%9F%E8%AE%BE%E8%AE%A1%E8%AF%A6%E8%A7%A3%20-%20%E4%B8%80%E6%9E%9D%E6%A2%85%E7%9A%84%E6%8A%80%E6%9C%AF%E6%94%B6%E5%BD%95%2075091a4d849d41c9ba464571517093f4.html#_1-前端页面修改" class="toc-sidebar-link">1.前端页面修改</a></li><li class="toc-sidebar-sub-header"><a href="/src/%E7%9F%A5%E8%AF%86%E7%A2%8E%E7%89%87/Java%E7%9B%B8%E5%85%B3/%E8%8B%A5%E4%BE%9D%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9FRuoYi-Vue%EF%BC%88%E4%BA%8C%EF%BC%89%EF%BC%9A%E6%9D%83%E9%99%90%E7%B3%BB%E7%BB%9F%E8%AE%BE%E8%AE%A1%E8%AF%A6%E8%A7%A3%20-%20%E4%B8%80%E6%9E%9D%E6%A2%85%E7%9A%84%E6%8A%80%E6%9C%AF%E6%94%B6%E5%BD%95%2075091a4d849d41c9ba464571517093f4.html#_2-创建按钮权限" class="toc-sidebar-link">2.创建按钮权限</a></li><li class="toc-sidebar-sub-header"><a href="/src/%E7%9F%A5%E8%AF%86%E7%A2%8E%E7%89%87/Java%E7%9B%B8%E5%85%B3/%E8%8B%A5%E4%BE%9D%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9FRuoYi-Vue%EF%BC%88%E4%BA%8C%EF%BC%89%EF%BC%9A%E6%9D%83%E9%99%90%E7%B3%BB%E7%BB%9F%E8%AE%BE%E8%AE%A1%E8%AF%A6%E8%A7%A3%20-%20%E4%B8%80%E6%9E%9D%E6%A2%85%E7%9A%84%E6%8A%80%E6%9C%AF%E6%94%B6%E5%BD%95%2075091a4d849d41c9ba464571517093f4.html#_3-使用代码生成代码" class="toc-sidebar-link">3.使用代码生成代码</a></li><li class="toc-sidebar-sub-header"><a href="/src/%E7%9F%A5%E8%AF%86%E7%A2%8E%E7%89%87/Java%E7%9B%B8%E5%85%B3/%E8%8B%A5%E4%BE%9D%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9FRuoYi-Vue%EF%BC%88%E4%BA%8C%EF%BC%89%EF%BC%9A%E6%9D%83%E9%99%90%E7%B3%BB%E7%BB%9F%E8%AE%BE%E8%AE%A1%E8%AF%A6%E8%A7%A3%20-%20%E4%B8%80%E6%9E%9D%E6%A2%85%E7%9A%84%E6%8A%80%E6%9C%AF%E6%94%B6%E5%BD%95%2075091a4d849d41c9ba464571517093f4.html#_4-准备后端接口" class="toc-sidebar-link">4.准备后端接口</a></li><li class="toc-sidebar-sub-header"><a href="/src/%E7%9F%A5%E8%AF%86%E7%A2%8E%E7%89%87/Java%E7%9B%B8%E5%85%B3/%E8%8B%A5%E4%BE%9D%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9FRuoYi-Vue%EF%BC%88%E4%BA%8C%EF%BC%89%EF%BC%9A%E6%9D%83%E9%99%90%E7%B3%BB%E7%BB%9F%E8%AE%BE%E8%AE%A1%E8%AF%A6%E8%A7%A3%20-%20%E4%B8%80%E6%9E%9D%E6%A2%85%E7%9A%84%E6%8A%80%E6%9C%AF%E6%94%B6%E5%BD%95%2075091a4d849d41c9ba464571517093f4.html#_5-修改前端页面请求地址" class="toc-sidebar-link">5.修改前端页面请求地址</a></li></ul></li><li><a href="/src/%E7%9F%A5%E8%AF%86%E7%A2%8E%E7%89%87/Java%E7%9B%B8%E5%85%B3/%E8%8B%A5%E4%BE%9D%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9FRuoYi-Vue%EF%BC%88%E4%BA%8C%EF%BC%89%EF%BC%9A%E6%9D%83%E9%99%90%E7%B3%BB%E7%BB%9F%E8%AE%BE%E8%AE%A1%E8%AF%A6%E8%A7%A3%20-%20%E4%B8%80%E6%9E%9D%E6%A2%85%E7%9A%84%E6%8A%80%E6%9C%AF%E6%94%B6%E5%BD%95%2075091a4d849d41c9ba464571517093f4.html#五、测试" class="toc-sidebar-link">五、测试</a><ul class="toc-sidebar-sub-headers"><li class="toc-sidebar-sub-header"><a href="/src/%E7%9F%A5%E8%AF%86%E7%A2%8E%E7%89%87/Java%E7%9B%B8%E5%85%B3/%E8%8B%A5%E4%BE%9D%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9FRuoYi-Vue%EF%BC%88%E4%BA%8C%EF%BC%89%EF%BC%9A%E6%9D%83%E9%99%90%E7%B3%BB%E7%BB%9F%E8%AE%BE%E8%AE%A1%E8%AF%A6%E8%A7%A3%20-%20%E4%B8%80%E6%9E%9D%E6%A2%85%E7%9A%84%E6%8A%80%E6%9C%AF%E6%94%B6%E5%BD%95%2075091a4d849d41c9ba464571517093f4.html#_1-超级管理员测试" class="toc-sidebar-link">1.超级管理员测试</a></li><li class="toc-sidebar-sub-header"><a href="/src/%E7%9F%A5%E8%AF%86%E7%A2%8E%E7%89%87/Java%E7%9B%B8%E5%85%B3/%E8%8B%A5%E4%BE%9D%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9FRuoYi-Vue%EF%BC%88%E4%BA%8C%EF%BC%89%EF%BC%9A%E6%9D%83%E9%99%90%E7%B3%BB%E7%BB%9F%E8%AE%BE%E8%AE%A1%E8%AF%A6%E8%A7%A3%20-%20%E4%B8%80%E6%9E%9D%E6%A2%85%E7%9A%84%E6%8A%80%E6%9C%AF%E6%94%B6%E5%BD%95%2075091a4d849d41c9ba464571517093f4.html#_2-普通用户测试" class="toc-sidebar-link">2.普通用户测试</a></li><li class="toc-sidebar-sub-header"><a href="/src/%E7%9F%A5%E8%AF%86%E7%A2%8E%E7%89%87/Java%E7%9B%B8%E5%85%B3/%E8%8B%A5%E4%BE%9D%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9FRuoYi-Vue%EF%BC%88%E4%BA%8C%EF%BC%89%EF%BC%9A%E6%9D%83%E9%99%90%E7%B3%BB%E7%BB%9F%E8%AE%BE%E8%AE%A1%E8%AF%A6%E8%A7%A3%20-%20%E4%B8%80%E6%9E%9D%E6%A2%85%E7%9A%84%E6%8A%80%E6%9C%AF%E6%94%B6%E5%BD%95%2075091a4d849d41c9ba464571517093f4.html#全部评论-3-条" class="toc-sidebar-link">全部评论: 3 条</a></li><li class="toc-sidebar-sub-header"><a href="/src/%E7%9F%A5%E8%AF%86%E7%A2%8E%E7%89%87/Java%E7%9B%B8%E5%85%B3/%E8%8B%A5%E4%BE%9D%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9FRuoYi-Vue%EF%BC%88%E4%BA%8C%EF%BC%89%EF%BC%9A%E6%9D%83%E9%99%90%E7%B3%BB%E7%BB%9F%E8%AE%BE%E8%AE%A1%E8%AF%A6%E8%A7%A3%20-%20%E4%B8%80%E6%9E%9D%E6%A2%85%E7%9A%84%E6%8A%80%E6%9C%AF%E6%94%B6%E5%BD%95%2075091a4d849d41c9ba464571517093f4.html#一枝梅2022-06-15" class="toc-sidebar-link">一枝梅2022-06-15</a></li></ul></li></ul></div></div></div></div></div>  <main class="footer"> <div class="copy-right"><a target="_blank" rel="noreferrer">
              
            </a></div></main></main> <aside class="page-sidebar"> <div class="page-side-toolbar"></div>  </aside></div><div class="global-ui"><div></div><!----></div></div>
    <script src="/assets/js/app.594b08d3.js" defer></script><script src="/assets/js/1.0dbf451f.js" defer></script><script src="/assets/js/116.303522e2.js" defer></script>
  </body>
</html>
