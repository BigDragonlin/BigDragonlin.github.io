<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>MJ大神C++基本知识 | lin</title>
    <meta name="generator" content="VuePress 1.9.10">
    <link rel="icon" href="/favicon.ico">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/all.min.css">
    <meta name="description" content="记录进步的点滴">
    <meta property="og:site_name" content="lin">
    <meta property="og:title" content="MJ大神C++基本知识">
    <meta property="og:type" content="article">
    <meta property="og:url" content="https://bigdragonlin.github.io/src/%E7%9F%A5%E8%AF%86%E7%A2%8E%E7%89%87/C++%E7%9B%B8%E5%85%B3/C++%E5%9F%BA%E6%9C%AC%E7%9F%A5%E8%AF%86.html">
    <meta name="twitter:title" content="MJ大神C++基本知识">
    <meta name="twitter:url" content="https://bigdragonlin.github.io/src/%E7%9F%A5%E8%AF%86%E7%A2%8E%E7%89%87/C++%E7%9B%B8%E5%85%B3/C++%E5%9F%BA%E6%9C%AC%E7%9F%A5%E8%AF%86.html">
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:label1" content="Written by">
    <meta name="twitter:label2" content="Filed under">
    <meta name="twitter:data2" content="程序员, 编程, 计算机">
    <meta property="article:tag" content="程序员">
    <meta name="keywords" content="编程学习路线, 编程知识百科, Java, 编程导航, 前端, 开发, 编程分享, 项目, IT, 求职, 面经">
    
    <link rel="preload" href="/assets/css/0.styles.b0591cca.css" as="style"><link rel="preload" href="/assets/js/app.594b08d3.js" as="script"><link rel="preload" href="/assets/js/1.0dbf451f.js" as="script"><link rel="preload" href="/assets/js/81.c6d78e39.js" as="script"><link rel="prefetch" href="/assets/js/10.9fef656e.js"><link rel="prefetch" href="/assets/js/100.525b17be.js"><link rel="prefetch" href="/assets/js/101.560386e9.js"><link rel="prefetch" href="/assets/js/102.2e0df717.js"><link rel="prefetch" href="/assets/js/103.8bfd9c2e.js"><link rel="prefetch" href="/assets/js/104.2393786d.js"><link rel="prefetch" href="/assets/js/105.f79fadb6.js"><link rel="prefetch" href="/assets/js/106.4cafadd8.js"><link rel="prefetch" href="/assets/js/107.977314ac.js"><link rel="prefetch" href="/assets/js/108.4425c9dc.js"><link rel="prefetch" href="/assets/js/109.b5e7a340.js"><link rel="prefetch" href="/assets/js/11.683739b7.js"><link rel="prefetch" href="/assets/js/110.2ceb0d0a.js"><link rel="prefetch" href="/assets/js/111.a8a6a249.js"><link rel="prefetch" href="/assets/js/112.58a9bdc0.js"><link rel="prefetch" href="/assets/js/113.31b005db.js"><link rel="prefetch" href="/assets/js/114.7fbcc1e6.js"><link rel="prefetch" href="/assets/js/115.9e36cfa7.js"><link rel="prefetch" href="/assets/js/116.303522e2.js"><link rel="prefetch" href="/assets/js/117.a63df5c5.js"><link rel="prefetch" href="/assets/js/118.590bc26e.js"><link rel="prefetch" href="/assets/js/119.3be96c90.js"><link rel="prefetch" href="/assets/js/12.2cf4830a.js"><link rel="prefetch" href="/assets/js/120.0ea9bf5e.js"><link rel="prefetch" href="/assets/js/121.ea6f7cd0.js"><link rel="prefetch" href="/assets/js/122.fa8ab557.js"><link rel="prefetch" href="/assets/js/123.c8821875.js"><link rel="prefetch" href="/assets/js/124.b18f1e9f.js"><link rel="prefetch" href="/assets/js/125.7e860b9c.js"><link rel="prefetch" href="/assets/js/126.b424683a.js"><link rel="prefetch" href="/assets/js/127.3b9fb511.js"><link rel="prefetch" href="/assets/js/128.ddcbf8d6.js"><link rel="prefetch" href="/assets/js/129.e9692f6a.js"><link rel="prefetch" href="/assets/js/13.1b182ba9.js"><link rel="prefetch" href="/assets/js/130.1bf1a2ef.js"><link rel="prefetch" href="/assets/js/131.ce704a36.js"><link rel="prefetch" href="/assets/js/132.8283006a.js"><link rel="prefetch" href="/assets/js/133.1c434a64.js"><link rel="prefetch" href="/assets/js/134.6a7c502b.js"><link rel="prefetch" href="/assets/js/135.36e96a79.js"><link rel="prefetch" href="/assets/js/136.6786da14.js"><link rel="prefetch" href="/assets/js/137.52c00c67.js"><link rel="prefetch" href="/assets/js/138.6938b926.js"><link rel="prefetch" href="/assets/js/139.a3637987.js"><link rel="prefetch" href="/assets/js/14.0d4ef0a2.js"><link rel="prefetch" href="/assets/js/140.4d7278fb.js"><link rel="prefetch" href="/assets/js/141.24c3fb07.js"><link rel="prefetch" href="/assets/js/142.51c920b4.js"><link rel="prefetch" href="/assets/js/143.9477385e.js"><link rel="prefetch" href="/assets/js/144.6ce44da3.js"><link rel="prefetch" href="/assets/js/145.16598dc0.js"><link rel="prefetch" href="/assets/js/146.ddd99b24.js"><link rel="prefetch" href="/assets/js/147.0d7b920c.js"><link rel="prefetch" href="/assets/js/148.aa355be2.js"><link rel="prefetch" href="/assets/js/149.0310e9dc.js"><link rel="prefetch" href="/assets/js/15.d6e0463b.js"><link rel="prefetch" href="/assets/js/150.025fa435.js"><link rel="prefetch" href="/assets/js/151.e4e0c006.js"><link rel="prefetch" href="/assets/js/152.f22e2d03.js"><link rel="prefetch" href="/assets/js/153.3a5ddc18.js"><link rel="prefetch" href="/assets/js/154.eab11cd6.js"><link rel="prefetch" href="/assets/js/155.0c5cf23f.js"><link rel="prefetch" href="/assets/js/156.94995d4d.js"><link rel="prefetch" href="/assets/js/157.01fd429c.js"><link rel="prefetch" href="/assets/js/158.f2a7b03b.js"><link rel="prefetch" href="/assets/js/159.2a678752.js"><link rel="prefetch" href="/assets/js/16.b10b867d.js"><link rel="prefetch" href="/assets/js/160.9a87b2d4.js"><link rel="prefetch" href="/assets/js/161.a1c01a1c.js"><link rel="prefetch" href="/assets/js/162.b309d5eb.js"><link rel="prefetch" href="/assets/js/163.a65f20cb.js"><link rel="prefetch" href="/assets/js/164.95d05154.js"><link rel="prefetch" href="/assets/js/165.5cf122af.js"><link rel="prefetch" href="/assets/js/166.9c6363a6.js"><link rel="prefetch" href="/assets/js/167.5cb6922a.js"><link rel="prefetch" href="/assets/js/168.7e4a8d58.js"><link rel="prefetch" href="/assets/js/169.2749163c.js"><link rel="prefetch" href="/assets/js/17.58cd8f53.js"><link rel="prefetch" href="/assets/js/170.14c350b2.js"><link rel="prefetch" href="/assets/js/171.4bc50f8e.js"><link rel="prefetch" href="/assets/js/172.6718e67c.js"><link rel="prefetch" href="/assets/js/173.dd659939.js"><link rel="prefetch" href="/assets/js/174.98b51446.js"><link rel="prefetch" href="/assets/js/175.d1cc6ac3.js"><link rel="prefetch" href="/assets/js/176.605618d7.js"><link rel="prefetch" href="/assets/js/177.f41afed3.js"><link rel="prefetch" href="/assets/js/178.3e531004.js"><link rel="prefetch" href="/assets/js/179.c34e4549.js"><link rel="prefetch" href="/assets/js/18.0773a3c5.js"><link rel="prefetch" href="/assets/js/180.dcc346d9.js"><link rel="prefetch" href="/assets/js/181.9b3ac2cc.js"><link rel="prefetch" href="/assets/js/182.41850209.js"><link rel="prefetch" href="/assets/js/183.bc9c1f61.js"><link rel="prefetch" href="/assets/js/184.451f388f.js"><link rel="prefetch" href="/assets/js/185.7510e863.js"><link rel="prefetch" href="/assets/js/186.29dd59d0.js"><link rel="prefetch" href="/assets/js/187.65f556e8.js"><link rel="prefetch" href="/assets/js/188.accf6d03.js"><link rel="prefetch" href="/assets/js/189.30515232.js"><link rel="prefetch" href="/assets/js/19.9b138b67.js"><link rel="prefetch" href="/assets/js/190.15d08ade.js"><link rel="prefetch" href="/assets/js/191.c1a42435.js"><link rel="prefetch" href="/assets/js/192.846af3d8.js"><link rel="prefetch" href="/assets/js/193.aa03b0f9.js"><link rel="prefetch" href="/assets/js/194.e98d87ba.js"><link rel="prefetch" href="/assets/js/195.74bf697c.js"><link rel="prefetch" href="/assets/js/196.2581f0e9.js"><link rel="prefetch" href="/assets/js/197.c21bd50a.js"><link rel="prefetch" href="/assets/js/2.90688c22.js"><link rel="prefetch" href="/assets/js/20.80320303.js"><link rel="prefetch" href="/assets/js/21.0e60e06e.js"><link rel="prefetch" href="/assets/js/22.8e85d903.js"><link rel="prefetch" href="/assets/js/23.53a60c49.js"><link rel="prefetch" href="/assets/js/24.0bf3b153.js"><link rel="prefetch" href="/assets/js/25.346029a3.js"><link rel="prefetch" href="/assets/js/26.d93d8326.js"><link rel="prefetch" href="/assets/js/27.1af59ff5.js"><link rel="prefetch" href="/assets/js/28.4dcd80fc.js"><link rel="prefetch" href="/assets/js/29.6807ccd4.js"><link rel="prefetch" href="/assets/js/3.cb4602cc.js"><link rel="prefetch" href="/assets/js/30.4b97d8de.js"><link rel="prefetch" href="/assets/js/31.56f99fbd.js"><link rel="prefetch" href="/assets/js/32.803b8814.js"><link rel="prefetch" href="/assets/js/33.ed99686c.js"><link rel="prefetch" href="/assets/js/34.58387757.js"><link rel="prefetch" href="/assets/js/35.96403a8e.js"><link rel="prefetch" href="/assets/js/36.1f24a1fe.js"><link rel="prefetch" href="/assets/js/37.7074470e.js"><link rel="prefetch" href="/assets/js/38.272465ab.js"><link rel="prefetch" href="/assets/js/39.1d55b379.js"><link rel="prefetch" href="/assets/js/4.78354d3c.js"><link rel="prefetch" href="/assets/js/40.6799ef0c.js"><link rel="prefetch" href="/assets/js/41.a17e5884.js"><link rel="prefetch" href="/assets/js/42.56d0e256.js"><link rel="prefetch" href="/assets/js/43.ba341557.js"><link rel="prefetch" href="/assets/js/44.e996e1a1.js"><link rel="prefetch" href="/assets/js/45.831b5a32.js"><link rel="prefetch" href="/assets/js/46.f5c91c94.js"><link rel="prefetch" href="/assets/js/47.a9e71bdc.js"><link rel="prefetch" href="/assets/js/48.a6c2ccb2.js"><link rel="prefetch" href="/assets/js/49.cf75e86c.js"><link rel="prefetch" href="/assets/js/5.188c7b33.js"><link rel="prefetch" href="/assets/js/50.05ac2200.js"><link rel="prefetch" href="/assets/js/51.36b8a786.js"><link rel="prefetch" href="/assets/js/52.2e0c11e6.js"><link rel="prefetch" href="/assets/js/53.5712d97f.js"><link rel="prefetch" href="/assets/js/54.21eabb0c.js"><link rel="prefetch" href="/assets/js/55.5a0c591a.js"><link rel="prefetch" href="/assets/js/56.8cfc2eb8.js"><link rel="prefetch" href="/assets/js/57.14d120d3.js"><link rel="prefetch" href="/assets/js/58.066a92c4.js"><link rel="prefetch" href="/assets/js/59.fe8fc17d.js"><link rel="prefetch" href="/assets/js/6.101e097c.js"><link rel="prefetch" href="/assets/js/60.0423408f.js"><link rel="prefetch" href="/assets/js/61.cad6d9e6.js"><link rel="prefetch" href="/assets/js/62.7c8846b3.js"><link rel="prefetch" href="/assets/js/63.fa28685a.js"><link rel="prefetch" href="/assets/js/64.1e90a96b.js"><link rel="prefetch" href="/assets/js/65.26bb82be.js"><link rel="prefetch" href="/assets/js/66.f83b85a9.js"><link rel="prefetch" href="/assets/js/67.39d29b92.js"><link rel="prefetch" href="/assets/js/68.94c37c31.js"><link rel="prefetch" href="/assets/js/69.5c9d3af1.js"><link rel="prefetch" href="/assets/js/7.bb657764.js"><link rel="prefetch" href="/assets/js/70.16aaa661.js"><link rel="prefetch" href="/assets/js/71.3487b52f.js"><link rel="prefetch" href="/assets/js/72.f6305994.js"><link rel="prefetch" href="/assets/js/73.0bd3fed1.js"><link rel="prefetch" href="/assets/js/74.eaea9141.js"><link rel="prefetch" href="/assets/js/75.e006189d.js"><link rel="prefetch" href="/assets/js/76.2ebea1e6.js"><link rel="prefetch" href="/assets/js/77.23f40aa3.js"><link rel="prefetch" href="/assets/js/78.fc4f596e.js"><link rel="prefetch" href="/assets/js/79.6f020fc3.js"><link rel="prefetch" href="/assets/js/80.df73a9f7.js"><link rel="prefetch" href="/assets/js/82.78fe38ca.js"><link rel="prefetch" href="/assets/js/83.597e7365.js"><link rel="prefetch" href="/assets/js/84.a1656199.js"><link rel="prefetch" href="/assets/js/85.e52d11f5.js"><link rel="prefetch" href="/assets/js/86.bef0c2dc.js"><link rel="prefetch" href="/assets/js/87.948fd05f.js"><link rel="prefetch" href="/assets/js/88.5915a1d8.js"><link rel="prefetch" href="/assets/js/89.dceee4d9.js"><link rel="prefetch" href="/assets/js/90.396be273.js"><link rel="prefetch" href="/assets/js/91.4f17483e.js"><link rel="prefetch" href="/assets/js/92.26a445ca.js"><link rel="prefetch" href="/assets/js/93.98aecdc4.js"><link rel="prefetch" href="/assets/js/94.63d4c743.js"><link rel="prefetch" href="/assets/js/95.8379772b.js"><link rel="prefetch" href="/assets/js/96.866b061a.js"><link rel="prefetch" href="/assets/js/97.6439b9d7.js"><link rel="prefetch" href="/assets/js/98.c5c0003e.js"><link rel="prefetch" href="/assets/js/99.3449fc15.js"><link rel="prefetch" href="/assets/js/vendors~docsearch.9fd01095.js">
    <link rel="stylesheet" href="/assets/css/0.styles.b0591cca.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container no-sidebar"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><img src="/logo.png" alt="lin" class="logo"> <span class="site-name can-hide">lin</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/知识碎片/" class="nav-link"><!---->
  知识碎片
</a></div><div class="nav-item"><a href="/读书笔记/" class="nav-link"><!---->
  读书笔记
</a></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/知识碎片/" class="nav-link"><!---->
  知识碎片
</a></div><div class="nav-item"><a href="/读书笔记/" class="nav-link"><!---->
  读书笔记
</a></div> <!----></nav>  <!----> </aside> <main class="page"> <div class="content"><div style="width:100%"><div class="theme-default-content custom-content content__default"><h1 id="mj大神c-基本知识"><a href="#mj大神c-基本知识" class="header-anchor">#</a> MJ大神C++基本知识</h1> <h1 id="_1-vs常用快捷键"><a href="#_1-vs常用快捷键" class="header-anchor">#</a> 1.VS常用快捷键</h1> <ul><li><p>调试</p> <ul><li>F9：切换断点</li> <li>Ctrl + F5：开始执行（不调试）</li> <li>F5：开始调试、继续（跳过一个断点）</li> <li>Shift + F5: 停止调试</li> <li>Ctrl + Shift + F5: 重启调试</li> <li>F10：step over</li> <li>F11：step into</li> <li>Shift + F11：step out</li></ul></li> <li><p>其他</p> <ul><li>Ctrl + J：智能提示</li> <li>Tab：选择和使用智能提示内容</li></ul></li> <li><p>组合键</p> <ul><li>Ctrl + M，M：折叠或展开当前方法
✓ 保持按住Ctrl不松开，先按1下M，然后再按1下M
<ul><li>Ctrl + M，O：折叠所有方法
✓ 保持按住Ctrl不松开，先按1下M，然后再按1下O</li> <li>Ctrl + M，L：展开所有方法
✓ 保持按住Ctrl不松开，先按1下M，然后再按1下L</li></ul></li></ul></li></ul> <h1 id="_2-vs环境的搭建"><a href="#_2-vs环境的搭建" class="header-anchor">#</a> 2.VS环境的搭建</h1> <h2 id="_2-1-需要安装的组件"><a href="#_2-1-需要安装的组件" class="header-anchor">#</a> 2.1 需要安装的组件</h2> <p><img alt="Untitled" data-src="MJ%E5%A4%A7%E7%A5%9EC++%E5%9F%BA%E6%9C%AC%E7%9F%A5%E8%AF%86%20f9db4087ded4475a8eee4346f9dd1a31/Untitled.png" loading="lazy" class="lazy"></p> <ul><li>forceutf8（withbom） - 强制转换成utf8</li></ul> <h1 id="_3-常用语法"><a href="#_3-常用语法" class="header-anchor">#</a> 3.常用语法</h1> <h2 id="_3-1-函数重载"><a href="#_3-1-函数重载" class="header-anchor">#</a> 3.1 函数重载</h2> <p>函数重载的规则</p> <ul><li><p>函数重载是通过 name mangling技术或者name decoration技术来实现函数重载的</p></li> <li><p>函数名必须相同</p></li> <li><p>形参必须不同</p></li></ul> <p>学会利用汇编来探究C++对函数重载的本质操作。函数重载在C++上就是编译器给相同函数名加上不同和函数名，以此来实现重载。</p> <p>使用VS来实现查看汇编代码</p> <ul><li>在主函数上打断点</li> <li>f5调试函数</li> <li>alt+8查看汇编代码。f10和f11查看下一步</li></ul> <h2 id="_3-2-默认参数"><a href="#_3-2-默认参数" class="header-anchor">#</a> 3.2 默认参数</h2> <p>默认参数的规则</p> <ul><li>只能从右向左，左边没有默认参数。</li> <li>调用默认参数和调用非默认参数一样（汇编代码相同）</li> <li>如果函数有声明和实现，默认函数只能放到声明当中去。</li> <li>当函数重载的时候，因为有默认参数的问题，所以可能会产生二意性。</li></ul> <h2 id="_3-3-c和c-相互兼容的方法"><a href="#_3-3-c和c-相互兼容的方法" class="header-anchor">#</a> 3.3 C和C++相互兼容的方法</h2> <ul><li><p>在要使用的C语言函数前面声明extern “c”，这种方法不太方方便；</p></li> <li><p>使用extern “C”去包裹所有要引入的函数。</p></li> <li><p>将C语言的头文件内容使用extern “C” 去包裹，在C++中直接使用#include “头文件全名称”。</p></li> <li><p>上述这种方法不能使得C和C++相互兼容。</p></li> <li><p>我们要使用以下方式去处理</p> <div class="language-cpp line-numbers-mode"><pre class="language-cpp"><code><span class="token comment">//头文件</span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">ifdef</span> <span class="token expression">__cplusplus</span></span>
<span class="token keyword">extern</span> <span class="token string">&quot;C&quot;</span> <span class="token punctuation">{</span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">endif</span></span>

要导出的C函数体

<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">ifdef</span> <span class="token expression">__cplusplus</span></span>
<span class="token punctuation">}</span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">endif</span></span>

</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br></div></div></li></ul> <h2 id="_3-4-解决重复引入的问题"><a href="#_3-4-解决重复引入的问题" class="header-anchor">#</a> 3.4 解决重复引入的问题</h2> <ul><li>使用#ifndef #define #endif(兼容性好)</li> <li>#pragma once可以防止整个文件的内容被重复包含（不是所有编译器都支持）</li></ul> <h2 id="_3-5-内联函数"><a href="#_3-5-内联函数" class="header-anchor">#</a> 3.5 内联函数</h2> <p>内联函数会把函数的调用展开，这样会使主程序的体积变大。</p> <p>我们为什么还要使用内联函数呢？</p> <ul><li>内联函数能够提高C++运行效率。</li> <li>使用“inline”关键字只是建议编译器把此函数编译为内联函数，不一定编译成内联函数。比如比较复杂的函数和递归函数。</li> <li>不建议使用宏，宏书写比较随意，而且没有代码提示。</li></ul> <h2 id="_3-6-const"><a href="#_3-6-const" class="header-anchor">#</a> 3.6 Const</h2> <p>以下的指针的含义</p> <p><img alt="Untitled" data-src="MJ%E5%A4%A7%E7%A5%9EC++%E5%9F%BA%E6%9C%AC%E7%9F%A5%E8%AF%86%20f9db4087ded4475a8eee4346f9dd1a31/Untitled%201.png" loading="lazy" class="lazy"></p> <p>小练习</p> <p><img alt="Untitled" data-src="MJ%E5%A4%A7%E7%A5%9EC++%E5%9F%BA%E6%9C%AC%E7%9F%A5%E8%AF%86%20f9db4087ded4475a8eee4346f9dd1a31/Untitled%202.png" loading="lazy" class="lazy"></p> <h2 id="_3-7-引用"><a href="#_3-7-引用" class="header-anchor">#</a> 3.7 引用</h2> <p>我们使用的引用就是是阉割版的指针，这一点可以从汇编机器码中可以看出。</p> <p>&amp;p是取得地址</p> <h1 id="_4-汇编"><a href="#_4-汇编" class="header-anchor">#</a> 4. 汇编</h1> <ul><li><p>汇编的种类</p> <p>汇编根据不同的编译环境分为x86 32bit x64 64bit 汇编。x64可以兼容x86</p></li> <li><p>汇编的两种书写格式</p> <p>根据使用不同编译器编译的代码。汇编分为两种书写格式。</p> <p>一种是Intel风格，另外一种是AT&amp;T风格</p></li> <li><p>汇编的注意事项</p> <p>汇编书写不分大小写</p></li></ul> <p>可以看一下下面的两个课来加深对汇编的理解。</p> <p>ios底层原理（上）</p> <p>利用汇编挖掘编程语言的本质</p> <h2 id="_4-1-at-t汇编和-intel汇编的区别"><a href="#_4-1-at-t汇编和-intel汇编的区别" class="header-anchor">#</a> 4.1 AT&amp;T汇编和 Intel汇编的区别</h2> <p><img alt="Untitled" data-src="MJ%E5%A4%A7%E7%A5%9EC++%E5%9F%BA%E6%9C%AC%E7%9F%A5%E8%AF%86%20f9db4087ded4475a8eee4346f9dd1a31/Untitled%203.png" loading="lazy" class="lazy"></p> <h2 id="_4-2-x64汇编-寄存器"><a href="#_4-2-x64汇编-寄存器" class="header-anchor">#</a> 4.2 x64汇编-寄存器</h2> <p><img alt="Untitled" data-src="MJ%E5%A4%A7%E7%A5%9EC++%E5%9F%BA%E6%9C%AC%E7%9F%A5%E8%AF%86%20f9db4087ded4475a8eee4346f9dd1a31/Untitled%204.png" loading="lazy" class="lazy"></p> <ul><li><p>一般而言</p> <p>R开头的寄存器是64bit，占用8个字节</p> <p>E开头的寄存器都是32bit，占用4个字节</p></li></ul> <h2 id="_4-3-x64汇编要点总结"><a href="#_4-3-x64汇编要点总结" class="header-anchor">#</a> 4.3 x64汇编要点总结</h2> <ul><li><p>mov , dest, src</p> <p>将src的值赋值给dest</p></li> <li><p>[地址值]</p> <p>凡是使用中括号括起来的都是地址值</p></li> <li><p>word，dword,qword</p> <p>word，占用两个字节</p> <p>dword（double word），占用四个字节</p> <p>1个字节 8位</p> <p>qword(quad word)，占用八个字节</p></li> <li><p>call函数</p> <p>call 函数地址</p></li> <li><p>lea dest，[地址值]</p> <p>将地址值赋值给dest</p> <p>等价于 move dest, [地址值]</p> <p>lea : load effect address</p></li> <li><p>ret</p> <p>函数返回值</p></li> <li><p>xor op1,op2</p></li></ul> <p>将op1和op2异或结果给op1</p> <ul><li>add op1,op2</li></ul> <p>等价于 op1 = op1 + op2</p> <ul><li>sub op1,op2</li></ul> <p>等价于op1 = op1 - op2</p> <ul><li>inc op</li></ul> <p>op = ++op</p> <ul><li>dec op</li></ul> <p>op = op - 1</p> <ul><li>jmp [地址]</li></ul> <p>一般来说，以j开头的都是跳转命令</p> <div class="language-cpp line-numbers-mode"><pre class="language-cpp"><code>main<span class="token operator">:</span>
<span class="token number">00007FF</span>6191518B0 <span class="token number">40</span> <span class="token number">55</span>                push        rbp  
<span class="token number">00007FF</span>6191518B2 <span class="token number">57</span>                   push        rdi  
<span class="token number">00007FF</span>6191518B3 <span class="token number">48</span> <span class="token number">81</span> EC <span class="token number">28</span> <span class="token number">01</span> <span class="token number">00</span> <span class="token number">00</span> sub         rsp<span class="token punctuation">,</span><span class="token number">128</span>h  
<span class="token number">00007FF</span>6191518BA <span class="token number">48</span> <span class="token number">8</span>D <span class="token number">6</span>C <span class="token number">24</span> <span class="token number">20</span>       lea         rbp<span class="token punctuation">,</span><span class="token punctuation">[</span>rsp<span class="token operator">+</span><span class="token number">20</span>h<span class="token punctuation">]</span>  
<span class="token number">00007FF</span>6191518BF <span class="token number">48</span> <span class="token number">8</span>B FC             mov         rdi<span class="token punctuation">,</span>rsp  
<span class="token number">00007FF</span>6191518C2 B9 <span class="token number">4</span>A <span class="token number">00</span> <span class="token number">00</span> <span class="token number">00</span>       mov         ecx<span class="token punctuation">,</span><span class="token number">4</span>Ah  
<span class="token number">00007FF</span>6191518C7 B8 CC CC CC CC       mov         eax<span class="token punctuation">,</span><span class="token number">0</span>CCCCCCCCh  
<span class="token number">00007FF</span>6191518CC F3 AB                rep stos    dword ptr <span class="token punctuation">[</span>rdi<span class="token punctuation">]</span>  
<span class="token number">00007FF</span>6191518CE <span class="token number">48</span> <span class="token number">8</span>D <span class="token number">0</span>D <span class="token number">54</span> F7 <span class="token number">00</span> <span class="token number">00</span> lea         rcx<span class="token punctuation">,</span><span class="token punctuation">[</span>__D39A98F2_源@<span class="token function">cpp</span> <span class="token punctuation">(</span><span class="token number">07FF</span>619161029h<span class="token punctuation">)</span><span class="token punctuation">]</span>  
<span class="token number">00007FF</span>6191518D5 E8 AD F7 FF FF       call        <span class="token function">__CheckForDebuggerJustMyCode</span> <span class="token punctuation">(</span><span class="token number">07FF</span>619151087h<span class="token punctuation">)</span>  
																									<span class="token comment">//将1给内存	a  //a=1</span>
<span class="token number">00007FF</span>6191518DA C7 <span class="token number">45</span> <span class="token number">04</span> <span class="token number">01</span> <span class="token number">00</span> <span class="token number">00</span> <span class="token number">00</span> mov         dword ptr <span class="token punctuation">[</span>a<span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token number">1</span>
																									<span class="token comment">//将2给内存  b  //b=2</span>
<span class="token number">00007FF</span>6191518E1 C7 <span class="token number">45</span> <span class="token number">24</span> <span class="token number">02</span> <span class="token number">00</span> <span class="token number">00</span> <span class="token number">00</span> mov         dword ptr <span class="token punctuation">[</span>b<span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token number">2</span>
																									<span class="token comment">//将b赋值个eax寄存器  </span>
<span class="token number">00007FF</span>6191518E8 <span class="token number">8</span>B <span class="token number">45</span> <span class="token number">24</span>             mov         eax<span class="token punctuation">,</span>dword ptr <span class="token punctuation">[</span>b<span class="token punctuation">]</span>  
																									<span class="token operator">/</span>比较 eax寄存器 和 b
<span class="token number">00007FF</span>6191518EB <span class="token number">39</span> <span class="token number">45</span> <span class="token number">04</span>             cmp         dword ptr <span class="token punctuation">[</span>a<span class="token punctuation">]</span><span class="token punctuation">,</span>eax
																									<span class="token comment">//小于等于才跳转</span>
<span class="token number">00007FF</span>6191518EE <span class="token number">7</span>E <span class="token number">07</span>                jle         main<span class="token operator">+</span><span class="token number">47</span>h <span class="token punctuation">(</span><span class="token number">07FF</span>6191518F7h<span class="token punctuation">)</span> 
																									<span class="token comment">//a += 10 </span>
<span class="token number">00007FF</span>6191518F0 C7 <span class="token number">45</span> <span class="token number">04</span> <span class="token number">0</span>A <span class="token number">00</span> <span class="token number">00</span> <span class="token number">00</span> mov         dword ptr <span class="token punctuation">[</span>a<span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token number">0</span>Ah  
<span class="token number">00007FF</span>6191518F7 FF <span class="token number">15</span> F3 E9 <span class="token number">00</span> <span class="token number">00</span>    call        qword ptr <span class="token punctuation">[</span><span class="token function">__imp_getchar</span> <span class="token punctuation">(</span><span class="token number">07FF</span>6191602F0h<span class="token punctuation">)</span><span class="token punctuation">]</span>  
<span class="token number">00007FF</span>6191518FD <span class="token number">33</span> C0                <span class="token operator">xor</span>         eax<span class="token punctuation">,</span>eax  
<span class="token number">00007FF</span>6191518FF <span class="token number">48</span> <span class="token number">8</span>D A5 <span class="token number">08</span> <span class="token number">01</span> <span class="token number">00</span> <span class="token number">00</span> lea         rsp<span class="token punctuation">,</span><span class="token punctuation">[</span>rbp<span class="token operator">+</span><span class="token number">108</span>h<span class="token punctuation">]</span>  
<span class="token number">00007FF</span>619151906 <span class="token number">5F</span>                   pop         rdi  
<span class="token number">00007FF</span>619151907 <span class="token number">5</span>D                   pop         rbp  
<span class="token number">00007FF</span>619151908 C3                   ret
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br></div></div><h2 id="_4-4-内联汇编"><a href="#_4-4-内联汇编" class="header-anchor">#</a> 4.4 内联汇编</h2> <p>我们可以在C++代码中嵌入汇编代码</p> <h2 id="_4-5-变量地址总结"><a href="#_4-5-变量地址总结" class="header-anchor">#</a> 4.5 变量地址总结</h2> <ul><li>学会查看一个变量的内存地址。</li> <li>学会通过内存地址查询这个变量的数据。</li> <li>一个变量的地址值，是它所在字节的最小值。</li></ul> <h2 id="_4-6-寄存器运算特性"><a href="#_4-6-寄存器运算特性" class="header-anchor">#</a> 4.6 寄存器运算特性</h2> <div class="language-cpp line-numbers-mode"><pre class="language-cpp"><code><span class="token number">9</span><span class="token operator">:</span> 	<span class="token keyword">int</span> a <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>
<span class="token number">00007FF</span>6215718DA C7 <span class="token number">45</span> <span class="token number">04</span> <span class="token number">01</span> <span class="token number">00</span> <span class="token number">00</span> <span class="token number">00</span> mov         dword ptr <span class="token punctuation">[</span>rbp<span class="token operator">+</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token number">1</span>  
    <span class="token number">10</span><span class="token operator">:</span> 	<span class="token keyword">int</span> b <span class="token operator">=</span> <span class="token number">2</span><span class="token punctuation">;</span>
<span class="token number">00007FF</span>6215718E1 C7 <span class="token number">45</span> <span class="token number">24</span> <span class="token number">02</span> <span class="token number">00</span> <span class="token number">00</span> <span class="token number">00</span> mov         dword ptr <span class="token punctuation">[</span>rbp<span class="token operator">+</span><span class="token number">24</span>h<span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token number">2</span>  
    <span class="token number">11</span><span class="token operator">:</span> 	a <span class="token operator">=</span> a <span class="token operator">+</span> b<span class="token punctuation">;</span>
<span class="token number">00007FF</span>6215718E8 <span class="token number">8</span>B <span class="token number">45</span> <span class="token number">24</span>             mov         eax<span class="token punctuation">,</span>dword ptr <span class="token punctuation">[</span>rbp<span class="token operator">+</span><span class="token number">24</span>h<span class="token punctuation">]</span>  
<span class="token number">00007FF</span>6215718EB <span class="token number">8</span>B <span class="token number">4</span>D <span class="token number">04</span>             mov         ecx<span class="token punctuation">,</span>dword ptr <span class="token punctuation">[</span>rbp<span class="token operator">+</span><span class="token number">4</span><span class="token punctuation">]</span>  
<span class="token number">00007FF</span>6215718EE <span class="token number">03</span> C8                add         ecx<span class="token punctuation">,</span>eax  
<span class="token number">00007FF</span>6215718F0 <span class="token number">8</span>B C1                mov         eax<span class="token punctuation">,</span>ecx  
<span class="token number">00007FF</span>6215718F2 <span class="token number">89</span> <span class="token number">45</span> <span class="token number">04</span>             mov         dword ptr <span class="token punctuation">[</span>rbp<span class="token operator">+</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">,</span>eax
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br></div></div><h2 id="_4-7-使用汇编分析指针变量"><a href="#_4-7-使用汇编分析指针变量" class="header-anchor">#</a> 4.7 使用汇编分析指针变量</h2> <div class="language-cpp line-numbers-mode"><pre class="language-cpp"><code><span class="token keyword">int</span> a <span class="token operator">=</span> <span class="token number">3</span><span class="token punctuation">;</span>																				<span class="token comment">//将3给[rbp+4]</span>
<span class="token number">00007FF</span>79FAF38BB C7 <span class="token number">45</span> <span class="token number">04</span> <span class="token number">03</span> <span class="token number">00</span> <span class="token number">00</span> <span class="token number">00</span> mov         dword ptr <span class="token punctuation">[</span>rbp<span class="token operator">+</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token number">3</span>  

<span class="token keyword">int</span> <span class="token operator">*</span>p <span class="token operator">=</span> <span class="token operator">&amp;</span>a<span class="token punctuation">;</span>																			<span class="token comment">//将[rbp+4]的地址给rax				</span>
<span class="token number">00007FF</span>79FAF38C2 <span class="token number">48</span> <span class="token number">8</span>D <span class="token number">45</span> <span class="token number">04</span>          lea         rax<span class="token punctuation">,</span><span class="token punctuation">[</span>rbp<span class="token operator">+</span><span class="token number">4</span><span class="token punctuation">]</span>  
																									<span class="token comment">//将[rbp+4]地址给[rbp+28h]</span>
<span class="token number">00007FF</span>79FAF38C6 <span class="token number">48</span> <span class="token number">89</span> <span class="token number">45</span> <span class="token number">28</span>          mov         qword ptr <span class="token punctuation">[</span>rbp<span class="token operator">+</span><span class="token number">28</span>h<span class="token punctuation">]</span><span class="token punctuation">,</span>rax  

<span class="token operator">*</span>p <span class="token operator">=</span> <span class="token number">4</span><span class="token punctuation">;</span>																						<span class="token comment">//将[rbp+28h]地址给rax</span>
<span class="token number">00007FF</span>79FAF38CA <span class="token number">48</span> <span class="token number">8</span>B <span class="token number">45</span> <span class="token number">28</span>          mov         rax<span class="token punctuation">,</span>qword ptr <span class="token punctuation">[</span>rbp<span class="token operator">+</span><span class="token number">28</span>h<span class="token punctuation">]</span>  
																									<span class="token comment">//将4给rax所在的地址</span>
<span class="token number">00007FF</span>79FAF38CE C7 <span class="token number">00</span> <span class="token number">04</span> <span class="token number">00</span> <span class="token number">00</span> <span class="token number">00</span>    mov         dword ptr <span class="token punctuation">[</span>rax<span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token number">4</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br></div></div><h2 id="_4-8-引用的反汇编分析"><a href="#_4-8-引用的反汇编分析" class="header-anchor">#</a> 4.8 引用的反汇编分析</h2> <div class="language-cpp line-numbers-mode"><pre class="language-cpp"><code><span class="token comment">//将5赋值给[rbp+4]   int a = 5</span>
<span class="token number">00007FF</span>7BCF138BB C7 <span class="token number">45</span> <span class="token number">04</span> <span class="token number">05</span> <span class="token number">00</span> <span class="token number">00</span> <span class="token number">00</span> mov         dword ptr <span class="token punctuation">[</span>rbp<span class="token operator">+</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token number">5</span>  

<span class="token comment">//把[rbp+4]地址给rax  int &amp;b = a</span>
<span class="token number">00007FF</span>7BCF138C2 <span class="token number">48</span> <span class="token number">8</span>D <span class="token number">45</span> <span class="token number">04</span>          lea         rax<span class="token punctuation">,</span><span class="token punctuation">[</span>rbp<span class="token operator">+</span><span class="token number">4</span><span class="token punctuation">]</span>  
<span class="token comment">//将[rbp+4]给[rbp+28h]</span>
<span class="token number">00007FF</span>7BCF138C6 <span class="token number">48</span> <span class="token number">89</span> <span class="token number">45</span> <span class="token number">28</span>          mov         qword ptr <span class="token punctuation">[</span>rbp<span class="token operator">+</span><span class="token number">28</span>h<span class="token punctuation">]</span><span class="token punctuation">,</span>rax  

<span class="token comment">//将[rbp+28h]给rax b = 6</span>
<span class="token number">00007FF</span>7BCF138CA <span class="token number">48</span> <span class="token number">8</span>B <span class="token number">45</span> <span class="token number">28</span>          mov         rax<span class="token punctuation">,</span>qword ptr <span class="token punctuation">[</span>rbp<span class="token operator">+</span><span class="token number">28</span>h<span class="token punctuation">]</span>  
<span class="token comment">//将6给rax所在的地址</span>
<span class="token number">00007FF</span>7BCF138CE C7 <span class="token number">00</span> <span class="token number">06</span> <span class="token number">00</span> <span class="token number">00</span> <span class="token number">00</span>    mov         dword ptr <span class="token punctuation">[</span>rax<span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token number">6</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br></div></div><h2 id="_4-9-引用的注意点"><a href="#_4-9-引用的注意点" class="header-anchor">#</a> 4.9 引用的注意点</h2> <div class="language-cpp line-numbers-mode"><pre class="language-cpp"><code><span class="token number">9</span><span class="token operator">:</span> <span class="token keyword">int</span> age <span class="token operator">=</span> <span class="token number">10</span><span class="token punctuation">;</span>
<span class="token number">00007FF</span>6B40738BB C7 <span class="token number">45</span> <span class="token number">04</span> <span class="token number">0</span>A <span class="token number">00</span> <span class="token number">00</span> <span class="token number">00</span> mov         dword ptr <span class="token punctuation">[</span>age<span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token number">0</span>Ah  
    <span class="token number">10</span><span class="token operator">:</span> <span class="token keyword">int</span> <span class="token operator">*</span>p <span class="token operator">=</span><span class="token operator">&amp;</span>age<span class="token punctuation">;</span>
<span class="token number">00007FF</span>6B40738C2 <span class="token number">48</span> <span class="token number">8</span>D <span class="token number">45</span> <span class="token number">04</span>          lea         rax<span class="token punctuation">,</span><span class="token punctuation">[</span>age<span class="token punctuation">]</span>  
<span class="token number">00007FF</span>6B40738C6 <span class="token number">48</span> <span class="token number">89</span> <span class="token number">45</span> <span class="token number">28</span>          mov         qword ptr <span class="token punctuation">[</span>p<span class="token punctuation">]</span><span class="token punctuation">,</span>rax  
    <span class="token number">11</span><span class="token operator">:</span> <span class="token keyword">int</span> <span class="token operator">*</span><span class="token operator">&amp;</span>ref<span class="token operator">=</span> p<span class="token punctuation">;</span>
<span class="token number">00007FF</span>6B40738CA <span class="token number">48</span> <span class="token number">8</span>D <span class="token number">45</span> <span class="token number">28</span>          lea         rax<span class="token punctuation">,</span><span class="token punctuation">[</span>p<span class="token punctuation">]</span>  
<span class="token number">00007FF</span>6B40738CE <span class="token number">48</span> <span class="token number">89</span> <span class="token number">45</span> <span class="token number">48</span>          mov         qword ptr <span class="token punctuation">[</span>ref<span class="token punctuation">]</span><span class="token punctuation">,</span>rax
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><ul><li><p>指针数组与数组指针</p> <div class="language-cpp line-numbers-mode"><pre class="language-cpp"><code><span class="token comment">//指针数组</span>
	<span class="token keyword">int</span> <span class="token operator">*</span>p1<span class="token punctuation">;</span>
	<span class="token keyword">int</span> <span class="token operator">*</span>p2<span class="token punctuation">;</span>
	<span class="token keyword">int</span> <span class="token operator">*</span>p3<span class="token punctuation">;</span>
	<span class="token keyword">int</span> <span class="token operator">*</span>arr<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">{</span>p1<span class="token punctuation">,</span>p2<span class="token punctuation">,</span>p3<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token comment">//数组指针</span>
<span class="token keyword">int</span><span class="token punctuation">(</span><span class="token operator">*</span>arr<span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div></li> <li><p>引用数组和数组引用</p> <div class="language-cpp line-numbers-mode"><pre class="language-cpp"><code>	<span class="token comment">//引用数组(这种写法是错误的)</span>
	<span class="token keyword">int</span> <span class="token operator">&amp;</span>p1<span class="token punctuation">;</span>
	<span class="token keyword">int</span> <span class="token operator">&amp;</span>p2<span class="token punctuation">;</span>
	<span class="token keyword">int</span> <span class="token operator">&amp;</span>p3<span class="token punctuation">;</span>
	<span class="token keyword">int</span> <span class="token operator">&amp;</span>arr<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">{</span>p1<span class="token punctuation">,</span>p2<span class="token punctuation">,</span>p3<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token comment">//数组引用</span>
<span class="token keyword">int</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>arr<span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div></li> <li><p>不存在【引用的引用、指向引用的指针、引用数组】</p></li></ul> <h2 id="_4-10-常引用-const-reference"><a href="#_4-10-常引用-const-reference" class="header-anchor">#</a> 4.10 常引用 const reference</h2> <ul><li>常量引用可以类比常量指针。常引用使得引用变成“只读”的。</li> <li>就把 <code>&amp;</code> 看成 <code>*</code> 就可了</li></ul> <h2 id="_4-11-const引用的特点"><a href="#_4-11-const引用的特点" class="header-anchor">#</a> 4.11 const引用的特点</h2> <ul><li>可以指向临时数据(常量、表达式、函数返回值等)</li></ul> <p><img alt="Untitled" data-src="MJ%E5%A4%A7%E7%A5%9EC++%E5%9F%BA%E6%9C%AC%E7%9F%A5%E8%AF%86%20f9db4087ded4475a8eee4346f9dd1a31/Untitled%205.png" loading="lazy" class="lazy"></p> <ul><li><p>可以指向不同类型的数据</p> <div class="language-cpp line-numbers-mode"><pre class="language-cpp"><code>  <span class="token keyword">int</span> a <span class="token operator">=</span> <span class="token number">5</span><span class="token punctuation">;</span>
	<span class="token keyword">const</span> <span class="token keyword">double</span> <span class="token operator">&amp;</span>b <span class="token operator">=</span> a<span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><ul><li>注意以下情况</li></ul> <div class="language-cpp line-numbers-mode"><pre class="language-cpp"><code>	<span class="token keyword">int</span> a <span class="token operator">=</span> <span class="token number">5</span><span class="token punctuation">;</span>
	<span class="token keyword">const</span> <span class="token keyword">long</span> <span class="token operator">&amp;</span>b <span class="token operator">=</span> a<span class="token punctuation">;</span>
	a <span class="token operator">=</span> <span class="token number">10</span><span class="token punctuation">;</span>
	cout <span class="token operator">&lt;&lt;</span> <span class="token string">&quot;a的值是&quot;</span> <span class="token operator">&lt;&lt;</span> a<span class="token operator">&lt;&lt;</span>endl<span class="token punctuation">;</span>
	cout <span class="token operator">&lt;&lt;</span> <span class="token string">&quot;b的值是&quot;</span> <span class="token operator">&lt;&lt;</span> b<span class="token operator">&lt;&lt;</span>endl<span class="token punctuation">;</span>

<span class="token comment">//a = 10,b=5</span>

<span class="token comment">//int a = 5</span>
 mov         dword ptr <span class="token punctuation">[</span>a<span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token number">5</span>  

<span class="token comment">//将a的值给寄存器eax </span>
mov         eax<span class="token punctuation">,</span>dword ptr <span class="token punctuation">[</span>a<span class="token punctuation">]</span>  
<span class="token comment">//将eax的值给内存空间[rbp+44h] </span>
<span class="token comment">//int temp = a; </span>
 mov         dword ptr <span class="token punctuation">[</span>rbp<span class="token operator">+</span><span class="token number">44</span>h<span class="token punctuation">]</span><span class="token punctuation">,</span>eax

<span class="token comment">//将[rbp+44h]的地址给rax  </span>
<span class="token comment">//int &amp;b = temp;   </span>
 lea         rax<span class="token punctuation">,</span><span class="token punctuation">[</span>rbp<span class="token operator">+</span><span class="token number">44</span>h<span class="token punctuation">]</span>  
 mov         qword ptr <span class="token punctuation">[</span>b<span class="token punctuation">]</span><span class="token punctuation">,</span>rax

   
 mov         dword ptr <span class="token punctuation">[</span>a<span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token number">0</span>Ah

<span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span>
<span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span>
  <span class="token keyword">int</span> a <span class="token operator">=</span> <span class="token number">5</span><span class="token punctuation">;</span>
	<span class="token keyword">const</span> <span class="token keyword">int</span> <span class="token operator">&amp;</span>b <span class="token operator">=</span> a<span class="token punctuation">;</span>
	a <span class="token operator">=</span> <span class="token number">10</span><span class="token punctuation">;</span>
	cout <span class="token operator">&lt;&lt;</span> <span class="token string">&quot;a的值是&quot;</span> <span class="token operator">&lt;&lt;</span> a<span class="token operator">&lt;&lt;</span>endl<span class="token punctuation">;</span>
	cout <span class="token operator">&lt;&lt;</span> <span class="token string">&quot;b的值是&quot;</span> <span class="token operator">&lt;&lt;</span> b<span class="token operator">&lt;&lt;</span>endl<span class="token punctuation">;</span>

<span class="token comment">//a=10,b=10</span>

<span class="token comment">//int a = 5;</span>
mov         dword ptr <span class="token punctuation">[</span>a<span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token number">5</span>  

<span class="token comment">//int &amp;b = a;</span>
 lea         rax<span class="token punctuation">,</span><span class="token punctuation">[</span>a<span class="token punctuation">]</span>  
 mov         qword ptr <span class="token punctuation">[</span>b<span class="token punctuation">]</span><span class="token punctuation">,</span>rax  

<span class="token comment">//a= 10</span>
mov         dword ptr <span class="token punctuation">[</span>a<span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token number">0</span>Ah
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br></div></div><ul><li>作为函数参数时(此规则也适用于const指针)
<ul><li>可以接受const和非const3实参(非const引用，只能接受非const实参)</li> <li>可以跟非const引用构成重载</li></ul></li></ul></li></ul> <h1 id="_5-面向对象"><a href="#_5-面向对象" class="header-anchor">#</a> 5. 面向对象</h1> <h2 id="_5-1-面向对象的知识点"><a href="#_5-1-面向对象的知识点" class="header-anchor">#</a> 5.1 面向对象的知识点</h2> <ul><li>封装、继承、多态</li></ul> <h2 id="_5-2-类"><a href="#_5-2-类" class="header-anchor">#</a> 5.2 类</h2> <ul><li>会使用struct、class定义和引入类。知道和java定义和引入类的区别。</li> <li>struct 和 class定义的区别
<ul><li>struct 默认访问权限是public</li> <li>class默认访问权限是private</li></ul></li></ul> <h2 id="_5-3-c-编程规范"><a href="#_5-3-c-编程规范" class="header-anchor">#</a> 5.3 C++编程规范</h2> <p><a href="MJ%E5%A4%A7%E7%A5%9EC++%E5%9F%BA%E6%9C%AC%E7%9F%A5%E8%AF%86%20f9db4087ded4475a8eee4346f9dd1a31/%25E5%258D%258E%25E4%25B8%25BA%25E7%25BC%2596%25E7%25A8%258B%25E8%25A7%2584%25E8%258C%2583.pdf">华为编程规范.pdf</a></p> <ul><li>变量名规范参考
<ul><li>全局变量：g_ globle</li> <li>成员变量：m_ member</li> <li>静态变量：s_ static</li> <li>常量：c_ const</li> <li>使用驼峰标识</li></ul></li></ul> <h2 id="_5-4-对象的内存布局"><a href="#_5-4-对象的内存布局" class="header-anchor">#</a> 5.4 对象的内存布局</h2> <ul><li><code>分别使用常规方法和指针方法访问对象</code></li></ul> <div class="language-cpp line-numbers-mode"><pre class="language-cpp"><code>	MyStruct myStruct<span class="token punctuation">;</span>
	myStruct<span class="token punctuation">.</span><span class="token function">sum</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

	MyStruct myStruct2<span class="token punctuation">;</span>
	MyStruct <span class="token operator">*</span>p <span class="token operator">=</span> <span class="token operator">&amp;</span>myStruct2<span class="token punctuation">;</span>
	p<span class="token operator">-&gt;</span><span class="token function">sum</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><ul><li><p>用汇编看两种对象的区别</p> <p>几乎完全一样</p></li> <li><p>分析两种访问方式的内存布局</p> <p>两种对象的大小看它的成员变量的大小。</p> <p>注意<code>p</code>和<code>*p</code>的区别</p> <div class="language-cpp line-numbers-mode"><pre class="language-cpp"><code>  MyStruct myStruct<span class="token punctuation">;</span>
	myStruct<span class="token punctuation">.</span><span class="token function">sum</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">//在主方法中引入的类是在栈空间中，会自动回收</span>
	cout <span class="token operator">&lt;&lt;</span> <span class="token string">&quot;myStruct大小是&quot;</span> <span class="token operator">&lt;&lt;</span> <span class="token keyword">sizeof</span><span class="token punctuation">(</span>myStruct<span class="token punctuation">)</span><span class="token operator">&lt;&lt;</span>endl<span class="token punctuation">;</span>
<span class="token comment">//myStruct大小是4。一个int占4个字节</span>

	MyStruct myStruct2<span class="token punctuation">;</span>
	MyStruct <span class="token operator">*</span>p <span class="token operator">=</span> <span class="token operator">&amp;</span>myStruct2<span class="token punctuation">;</span>
	cout <span class="token operator">&lt;&lt;</span> <span class="token string">&quot;myStruct p大小是&quot;</span> <span class="token operator">&lt;&lt;</span> <span class="token keyword">sizeof</span><span class="token punctuation">(</span>p<span class="token punctuation">)</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
<span class="token comment">//myStruct p大小是8</span>

	cout <span class="token operator">&lt;&lt;</span> <span class="token string">&quot;myStruct *p大小是&quot;</span> <span class="token operator">&lt;&lt;</span> <span class="token keyword">sizeof</span><span class="token punctuation">(</span><span class="token operator">*</span>p<span class="token punctuation">)</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
<span class="token comment">//myStruct *p大小是4</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br></div></div></li> <li><p>为什么类中的方法不占内存？</p> <div class="language-cpp line-numbers-mode"><pre class="language-cpp"><code>		<span class="token number">38</span><span class="token operator">:</span> 	MyStruct myStruct<span class="token punctuation">;</span>
<span class="token number">00007FF</span>7D8BB66AB <span class="token number">48</span> <span class="token number">8</span>D <span class="token number">4</span>D <span class="token number">08</span>          lea         rcx<span class="token punctuation">,</span><span class="token punctuation">[</span>myStruct<span class="token punctuation">]</span>  
<span class="token comment">//访问函数的成员变量，就是访问函数的</span>
<span class="token number">00007FF</span>7D8BB66AF E8 <span class="token number">89</span> AD FF FF       call        <span class="token class-name">MyStruct</span><span class="token double-colon punctuation">::</span><span class="token function">MyStruct</span> <span class="token punctuation">(</span><span class="token number">07FF</span>7D8BB143Dh<span class="token punctuation">)</span> 
 
    <span class="token number">39</span><span class="token operator">:</span> 	myStruct<span class="token punctuation">.</span><span class="token function">sum</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token number">00007FF</span>7D8BB66B4 <span class="token number">48</span> <span class="token number">8</span>D <span class="token number">4</span>D <span class="token number">08</span>          lea         rcx<span class="token punctuation">,</span><span class="token punctuation">[</span>myStruct<span class="token punctuation">]</span>  
<span class="token number">00007FF</span>7D8BB66B8 E8 <span class="token number">8F</span> AD FF FF       call        <span class="token class-name">MyStruct</span><span class="token double-colon punctuation">::</span><span class="token function">sum</span> <span class="token punctuation">(</span><span class="token number">07FF</span>7D8BB144Ch<span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><p>类中方法只保留一份，当我们使用的时候才会去访问，这样可以比较节省空间。</p> <p>保留在内存当中</p></li> <li><p>查看引入的类内存结构</p> <ul><li>获取类的内存地址</li> <li>获取类中变量的内存地址</li> <li>学会使用内存分析工具</li> <li>对象的内存布局</li></ul> <p><img alt="Untitled" data-src="MJ%E5%A4%A7%E7%A5%9EC++%E5%9F%BA%E6%9C%AC%E7%9F%A5%E8%AF%86%20f9db4087ded4475a8eee4346f9dd1a31/Untitled%206.png" loading="lazy" class="lazy"></p></li></ul> <h2 id="_5-5-this关键字"><a href="#_5-5-this关键字" class="header-anchor">#</a> 5.5 this关键字</h2> <ul><li><p>不同对象如何访问同一个方法的？使用this指针，隐式传入刚才创建的对象地址。</p></li> <li><p>可以不可以有这种形式 <code>this.name</code>？不行，this本质还是指针，只能通过“指针→变量”的方式访问。</p></li></ul> <h2 id="_5-6-指针访问对象成员的本质"><a href="#_5-6-指针访问对象成员的本质" class="header-anchor">#</a> 5.6 指针访问对象成员的本质</h2> <ul><li>通过.直接访问</li></ul> <div class="language-cpp line-numbers-mode"><pre class="language-cpp"><code><span class="token number">22</span><span class="token operator">:</span> 	myStruct1<span class="token punctuation">.</span>num1 <span class="token operator">=</span> <span class="token number">10</span><span class="token punctuation">;</span>
<span class="token number">00007FF</span>76BA31E7A C7 <span class="token number">45</span> <span class="token number">08</span> <span class="token number">0</span>A <span class="token number">00</span> <span class="token number">00</span> <span class="token number">00</span> mov         dword ptr <span class="token punctuation">[</span>rbp<span class="token operator">+</span><span class="token number">8</span><span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token number">0</span>Ah  

    <span class="token number">23</span><span class="token operator">:</span> 	myStruct1<span class="token punctuation">.</span>num2 <span class="token operator">=</span> <span class="token number">20</span><span class="token punctuation">;</span>
<span class="token number">00007FF</span>76BA31E81 C7 <span class="token number">45</span> <span class="token number">0</span>C <span class="token number">14</span> <span class="token number">00</span> <span class="token number">00</span> <span class="token number">00</span> mov         dword ptr <span class="token punctuation">[</span>rbp<span class="token operator">+</span><span class="token number">0</span>Ch<span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token number">14</span>h  

    <span class="token number">24</span><span class="token operator">:</span> 	myStruct1<span class="token punctuation">.</span>num3 <span class="token operator">=</span> <span class="token number">30</span><span class="token punctuation">;</span>
<span class="token number">00007FF</span>76BA31E88 C7 <span class="token number">45</span> <span class="token number">10</span> <span class="token number">1</span>E <span class="token number">00</span> <span class="token number">00</span> <span class="token number">00</span> mov         dword ptr <span class="token punctuation">[</span>rbp<span class="token operator">+</span><span class="token number">10</span>h<span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token number">1</span>Eh
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><ul><li>通过指针来访问</li></ul> <div class="language-cpp line-numbers-mode"><pre class="language-cpp"><code><span class="token number">21</span><span class="token operator">:</span> 	MyStruct myStruct1<span class="token punctuation">;</span>
    <span class="token number">22</span><span class="token operator">:</span> 	MyStruct <span class="token operator">*</span>p <span class="token operator">=</span> <span class="token operator">&amp;</span>myStruct1<span class="token punctuation">;</span>
<span class="token number">00007FF</span>701981E8B <span class="token number">48</span> <span class="token number">8</span>D <span class="token number">45</span> <span class="token number">08</span>          lea         rax<span class="token punctuation">,</span><span class="token punctuation">[</span>rbp<span class="token operator">+</span><span class="token number">8</span><span class="token punctuation">]</span>  
<span class="token number">00007FF</span>701981E8F <span class="token number">48</span> <span class="token number">89</span> <span class="token number">45</span> <span class="token number">38</span>          mov         qword ptr <span class="token punctuation">[</span>rbp<span class="token operator">+</span><span class="token number">38</span>h<span class="token punctuation">]</span><span class="token punctuation">,</span>rax  
    <span class="token number">23</span><span class="token operator">:</span> 	p<span class="token operator">-&gt;</span>num1 <span class="token operator">=</span> <span class="token number">10</span><span class="token punctuation">;</span>
<span class="token number">00007FF</span>701981E93 <span class="token number">48</span> <span class="token number">8</span>B <span class="token number">45</span> <span class="token number">38</span>          mov         rax<span class="token punctuation">,</span>qword ptr <span class="token punctuation">[</span>rbp<span class="token operator">+</span><span class="token number">38</span>h<span class="token punctuation">]</span>  
<span class="token number">00007FF</span>701981E97 C7 <span class="token number">00</span> <span class="token number">0</span>A <span class="token number">00</span> <span class="token number">00</span> <span class="token number">00</span>    mov         dword ptr <span class="token punctuation">[</span>rax<span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token number">0</span>Ah  
    <span class="token number">24</span><span class="token operator">:</span> 	p<span class="token operator">-&gt;</span>num2 <span class="token operator">=</span> <span class="token number">20</span><span class="token punctuation">;</span>
<span class="token number">00007FF</span>701981E9D <span class="token number">48</span> <span class="token number">8</span>B <span class="token number">45</span> <span class="token number">38</span>          mov         rax<span class="token punctuation">,</span>qword ptr <span class="token punctuation">[</span>rbp<span class="token operator">+</span><span class="token number">38</span>h<span class="token punctuation">]</span>  
<span class="token number">00007FF</span>701981EA1 C7 <span class="token number">40</span> <span class="token number">04</span> <span class="token number">14</span> <span class="token number">00</span> <span class="token number">00</span> <span class="token number">00</span> mov         dword ptr <span class="token punctuation">[</span>rax<span class="token operator">+</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token number">14</span>h  
    <span class="token number">25</span><span class="token operator">:</span> 	p<span class="token operator">-&gt;</span>num3 <span class="token operator">=</span> <span class="token number">30</span><span class="token punctuation">;</span>
<span class="token number">00007FF</span>701981EA8 <span class="token number">48</span> <span class="token number">8</span>B <span class="token number">45</span> <span class="token number">38</span>          mov         rax<span class="token punctuation">,</span>qword ptr <span class="token punctuation">[</span>rbp<span class="token operator">+</span><span class="token number">38</span>h<span class="token punctuation">]</span>  
<span class="token number">00007FF</span>701981EAC C7 <span class="token number">40</span> <span class="token number">08</span> <span class="token number">1</span>E <span class="token number">00</span> <span class="token number">00</span> <span class="token number">00</span> mov         dword ptr <span class="token punctuation">[</span>rax<span class="token operator">+</span><span class="token number">8</span><span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token number">1</span>Eh  
    <span class="token number">26</span><span class="token operator">:</span> <span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br></div></div><ul><li>思考题</li></ul> <div class="language-cpp line-numbers-mode"><pre class="language-cpp"><code>  Person person<span class="token punctuation">;</span>
	person<span class="token punctuation">.</span>id <span class="token operator">=</span> <span class="token number">10</span><span class="token punctuation">;</span>
	person<span class="token punctuation">.</span>age <span class="token operator">=</span> <span class="token number">20</span><span class="token punctuation">;</span>
	person<span class="token punctuation">.</span>height <span class="token operator">=</span> <span class="token number">30</span><span class="token punctuation">;</span>
	Person <span class="token operator">*</span>p <span class="token operator">=</span> <span class="token punctuation">(</span>Person <span class="token operator">*</span><span class="token punctuation">)</span><span class="token operator">&amp;</span>person<span class="token punctuation">.</span>age<span class="token punctuation">;</span>
	p<span class="token operator">-&gt;</span>id <span class="token operator">=</span> <span class="token number">40</span><span class="token punctuation">;</span>
	p<span class="token operator">-&gt;</span>age <span class="token operator">=</span> <span class="token number">50</span><span class="token punctuation">;</span>

	person<span class="token punctuation">.</span><span class="token function">display</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//隐式传入this属性的值</span>
	<span class="token comment">//id = 10 age=40  height=50</span>

	p<span class="token operator">-&gt;</span><span class="token function">display</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//使用的age传的，不是从id传的，height没有值，被CCCCC填充</span>
	<span class="token comment">//id = 40 age=50  height=越界</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br></div></div><ul><li>汇编解答</li></ul> <div class="language-cpp line-numbers-mode"><pre class="language-cpp"><code><span class="token number">22</span><span class="token operator">:</span> 	Person person<span class="token punctuation">;</span>
    <span class="token number">23</span><span class="token operator">:</span> 	person<span class="token punctuation">.</span>id <span class="token operator">=</span> <span class="token number">10</span><span class="token punctuation">;</span>
<span class="token number">00007FF</span>62F2F245B C7 <span class="token number">45</span> <span class="token number">08</span> <span class="token number">0</span>A <span class="token number">00</span> <span class="token number">00</span> <span class="token number">00</span> mov         dword ptr <span class="token punctuation">[</span>rbp<span class="token operator">+</span><span class="token number">8</span><span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token number">0</span>Ah  
    <span class="token number">24</span><span class="token operator">:</span> 	person<span class="token punctuation">.</span>age <span class="token operator">=</span> <span class="token number">20</span><span class="token punctuation">;</span>
<span class="token number">00007FF</span>62F2F2462 C7 <span class="token number">45</span> <span class="token number">0</span>C <span class="token number">14</span> <span class="token number">00</span> <span class="token number">00</span> <span class="token number">00</span> mov         dword ptr <span class="token punctuation">[</span>rbp<span class="token operator">+</span><span class="token number">0</span>Ch<span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token number">14</span>h  
    <span class="token number">25</span><span class="token operator">:</span> 	person<span class="token punctuation">.</span>height <span class="token operator">=</span> <span class="token number">30</span><span class="token punctuation">;</span>
<span class="token number">00007FF</span>62F2F2469 C7 <span class="token number">45</span> <span class="token number">10</span> <span class="token number">1</span>E <span class="token number">00</span> <span class="token number">00</span> <span class="token number">00</span> mov         dword ptr <span class="token punctuation">[</span>rbp<span class="token operator">+</span><span class="token number">10</span>h<span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token number">1</span>Eh  

    <span class="token number">26</span><span class="token operator">:</span> 	Person <span class="token operator">*</span>p <span class="token operator">=</span> <span class="token punctuation">(</span>Person <span class="token operator">*</span><span class="token punctuation">)</span><span class="token operator">&amp;</span>person<span class="token punctuation">.</span>age<span class="token punctuation">;</span>
<span class="token number">00007FF</span>62F2F2470 <span class="token number">48</span> <span class="token number">8</span>D <span class="token number">45</span> <span class="token number">0</span>C          lea         rax<span class="token punctuation">,</span><span class="token punctuation">[</span>rbp<span class="token operator">+</span><span class="token number">0</span>Ch<span class="token punctuation">]</span>  
<span class="token number">00007FF</span>62F2F2474 <span class="token number">48</span> <span class="token number">89</span> <span class="token number">45</span> <span class="token number">38</span>          mov         qword ptr <span class="token punctuation">[</span>rbp<span class="token operator">+</span><span class="token number">38</span>h<span class="token punctuation">]</span><span class="token punctuation">,</span>rax  
    <span class="token number">27</span><span class="token operator">:</span> 	p<span class="token operator">-&gt;</span>id <span class="token operator">=</span> <span class="token number">40</span><span class="token punctuation">;</span>
<span class="token number">00007FF</span>62F2F2478 <span class="token number">48</span> <span class="token number">8</span>B <span class="token number">45</span> <span class="token number">38</span>          mov         rax<span class="token punctuation">,</span>qword ptr <span class="token punctuation">[</span>rbp<span class="token operator">+</span><span class="token number">38</span>h<span class="token punctuation">]</span>  
<span class="token number">00007FF</span>62F2F247C C7 <span class="token number">00</span> <span class="token number">28</span> <span class="token number">00</span> <span class="token number">00</span> <span class="token number">00</span>    mov         dword ptr <span class="token punctuation">[</span>rax<span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token number">28</span>h  
    <span class="token number">28</span><span class="token operator">:</span> 	p<span class="token operator">-&gt;</span>age <span class="token operator">=</span> <span class="token number">50</span><span class="token punctuation">;</span>
<span class="token number">00007FF</span>62F2F2482 <span class="token number">48</span> <span class="token number">8</span>B <span class="token number">45</span> <span class="token number">38</span>          mov         rax<span class="token punctuation">,</span>qword ptr <span class="token punctuation">[</span>rbp<span class="token operator">+</span><span class="token number">38</span>h<span class="token punctuation">]</span>  
<span class="token number">00007FF</span>62F2F2486 C7 <span class="token number">40</span> <span class="token number">04</span> <span class="token number">32</span> <span class="token number">00</span> <span class="token number">00</span> <span class="token number">00</span> mov         dword ptr <span class="token punctuation">[</span>rax<span class="token operator">+</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token number">32</span>h  
    <span class="token number">29</span><span class="token operator">:</span> 	person<span class="token punctuation">.</span><span class="token function">display</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token number">00007FF</span>62F2F248D <span class="token number">48</span> <span class="token number">8</span>D <span class="token number">4</span>D <span class="token number">08</span>          lea         rcx<span class="token punctuation">,</span><span class="token punctuation">[</span>rbp<span class="token operator">+</span><span class="token number">8</span><span class="token punctuation">]</span>  
<span class="token number">00007FF</span>62F2F2491 E8 <span class="token number">29</span> F0 FF FF       call        <span class="token number">00007FF</span>62F2F14BF  
    <span class="token number">30</span><span class="token operator">:</span> 	<span class="token comment">//id = 10 age=40  height=50</span>

    <span class="token number">31</span><span class="token operator">:</span> 	p<span class="token operator">-&gt;</span><span class="token function">display</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token number">00007FF</span>62F2F2496 <span class="token number">48</span> <span class="token number">8</span>B <span class="token number">4</span>D <span class="token number">38</span>          mov         rcx<span class="token punctuation">,</span>qword ptr <span class="token punctuation">[</span>rbp<span class="token operator">+</span><span class="token number">38</span>h<span class="token punctuation">]</span>  
<span class="token number">00007FF</span>62F2F249A E8 <span class="token number">20</span> F0 FF FF       call        <span class="token number">00007FF</span>62F2F14BF  
    <span class="token number">32</span><span class="token operator">:</span> 	<span class="token comment">//id = 40 age=50  height=越界 CCCCCC</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br></div></div><ul><li><p>为什么会被CCCCC填充？</p> <p>cccc是栈空间填充代码，当调用函数的时候会被自动创建。可以通过汇编来进行证明。</p></li></ul> <h2 id="_5-7-内存空间的布局"><a href="#_5-7-内存空间的布局" class="header-anchor">#</a> 5.7 内存空间的布局</h2> <ul><li><p>代码段</p> <p>用来存放代码</p></li> <li><p>数据段</p> <p>用来存放全局变量</p></li> <li><p>堆空间</p> <p>自由向操作系统申请</p></li> <li><p>栈空间</p> <p>用来存放局部变量，由垃圾回收器自动回收。</p></li></ul> <h2 id="_5-8-堆空间"><a href="#_5-8-堆空间" class="header-anchor">#</a> 5.8 堆空间</h2> <ul><li><p>在程序运行过程中，程序可以根据自己的需要，自由向操作系统申请堆空间。</p></li> <li><p>堆空间的申请和释放</p> <ul><li>要使用的格式 变量名 =（强转相应格式的 指针）malloc（要申请几个字节）</li> <li>malloc 是member allocation 内存分配的简称</li> <li>使用free（）来清除申请的堆空间。</li></ul></li> <li><p>常用</p> <p>new \ delete
new [] \ delete []</p> <p>使用 汇编查看其内存变化过程</p></li> <li><p>注意</p> <ul><li>内存分配成功后，会返回一段内存分配的地址（起始地址）</li> <li>申请和释放必须一对一，有内存申请，必须要有内存释放，不然会出现内存泄露的情况。</li> <li>*p在函数调用完之后销毁，但是如果没有进行内存释放，则堆空间的数据会一直存在</li></ul></li></ul> <p><img alt="Untitled" data-src="MJ%E5%A4%A7%E7%A5%9EC++%E5%9F%BA%E6%9C%AC%E7%9F%A5%E8%AF%86%20f9db4087ded4475a8eee4346f9dd1a31/Untitled%207.png" loading="lazy" class="lazy"></p> <h2 id="_5-9-堆空间的初始化问题"><a href="#_5-9-堆空间的初始化问题" class="header-anchor">#</a> 5.9 堆空间的初始化问题</h2> <ul><li>使用vs的局部变量和内存，观察下列初始化情况。</li></ul> <div class="language-cpp line-numbers-mode"><pre class="language-cpp"><code>	<span class="token keyword">int</span> <span class="token operator">*</span>p1 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token keyword">int</span><span class="token punctuation">;</span>
	<span class="token keyword">int</span> <span class="token operator">*</span>p2 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token keyword">int</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token keyword">int</span> <span class="token operator">*</span>p3 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token keyword">int</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token keyword">int</span> <span class="token operator">*</span>p4 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token keyword">int</span><span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
	<span class="token keyword">int</span> <span class="token operator">*</span>p5 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token keyword">int</span><span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token keyword">int</span> <span class="token operator">*</span>p6 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token keyword">int</span><span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
	<span class="token keyword">int</span> <span class="token operator">*</span>p7 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token keyword">int</span><span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">{</span><span class="token number">1</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
	<span class="token keyword">int</span> <span class="token operator">*</span>p8 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token keyword">int</span><span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">{</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
	<span class="token keyword">int</span> <span class="token operator">*</span>p9 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token keyword">int</span><span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">{</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br></div></div><h2 id="_5-10-memset"><a href="#_5-10-memset" class="header-anchor">#</a> 5.10 memset</h2> <ul><li><p>memset内存快速初始化的函数</p> <div class="language-cpp line-numbers-mode"><pre class="language-cpp"><code>Person person<span class="token punctuation">;</span>
	Person <span class="token operator">*</span>p <span class="token operator">=</span> <span class="token operator">&amp;</span>person<span class="token punctuation">;</span>
	<span class="token function">memset</span><span class="token punctuation">(</span>p<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token keyword">sizeof</span><span class="token punctuation">(</span>person<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div></li></ul> <h2 id="_5-11-构造函数-constructor"><a href="#_5-11-构造函数-constructor" class="header-anchor">#</a> 5.11 构造函数（Constructor）</h2> <ul><li>无参构造函数能够在新建对象的时候自动调用。</li> <li>使用<code>mallca</code>申请空间的函数没办法自动调用，因为这是C中也可以使用的申请空间的方法。使用new可以自动调动。</li> <li>注意使用无参构造和声明函数的区别</li></ul> <h2 id="_5-12-默认情况下-成员变量的初始化"><a href="#_5-12-默认情况下-成员变量的初始化" class="header-anchor">#</a> 5.12 默认情况下，成员变量的初始化</h2> <div class="language-cpp line-numbers-mode"><pre class="language-cpp"><code><span class="token keyword">struct</span> <span class="token class-name">Person</span>
<span class="token punctuation">{</span>
	<span class="token keyword">int</span> m_age<span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token comment">//成员变量被初始化为零</span>
Person person1<span class="token punctuation">;</span>
<span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
	<span class="token comment">//栈空间，成员变量不会被初始化</span>
	Person person2<span class="token punctuation">;</span>

	<span class="token comment">//堆空间，成员变量不会被初始化</span>
	Person <span class="token operator">*</span>p1 <span class="token operator">=</span> <span class="token keyword">new</span> Person<span class="token punctuation">;</span> 
	<span class="token comment">//成员变量被初始化为零</span>
	Person <span class="token operator">*</span>p2 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token function">Person</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token comment">//成员变量不会被初始化</span>
	Person <span class="token operator">*</span>p3 <span class="token operator">=</span> <span class="token keyword">new</span> Person<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
	<span class="token comment">//成员变量会被初始化为零</span>
	Person <span class="token operator">*</span>p4 <span class="token operator">=</span> <span class="token keyword">new</span> Person<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token comment">//成员变量会被初始化为零</span>
	Person <span class="token operator">*</span>p5 <span class="token operator">=</span> <span class="token keyword">new</span> Person<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br></div></div><h2 id="_5-13-成员变量的手动初始化"><a href="#_5-13-成员变量的手动初始化" class="header-anchor">#</a> 5.13 成员变量的手动初始化</h2> <div class="language-cpp line-numbers-mode"><pre class="language-cpp"><code><span class="token function">Person</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
<span class="token comment">//this是传入指针 0 是传入初始化值 sizeof(Person) 是要初始化数量</span>
        <span class="token function">memset</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token keyword">sizeof</span><span class="token punctuation">(</span>Person<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><h2 id="_5-14-析构函数-destructor"><a href="#_5-14-析构函数-destructor" class="header-anchor">#</a> 5.14 析构函数（Destructor）</h2> <ul><li><p>代码</p> <div class="language-cpp line-numbers-mode"><pre class="language-cpp"><code><span class="token keyword">struct</span> <span class="token class-name">Person</span>
<span class="token punctuation">{</span>
	<span class="token function">Person</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
		cout <span class="token operator">&lt;&lt;</span> <span class="token string">&quot;打印无参构造&quot;</span>  <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
	<span class="token punctuation">}</span>

	<span class="token operator">~</span><span class="token function">Person</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
		cout <span class="token operator">&lt;&lt;</span> <span class="token string">&quot;打印有参构造&quot;</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>

	<span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br></div></div></li> <li><p>特点</p> <p>函数以<code>~</code>开头，与类同名，没有返回值，有且只有一个析构函数</p></li> <li><p>注意</p> <ul><li>使用<code>malloc</code>分配的对象不会调用析构函数</li> <li>在堆空间使用析构函数</li> <li>构造函数和析构函数都必须要是$<code>public</code>$</li></ul></li></ul> <h2 id="_5-15-内存管理"><a href="#_5-15-内存管理" class="header-anchor">#</a> 5.15 内存管理</h2> <div class="language-cpp line-numbers-mode"><pre class="language-cpp"><code><span class="token punctuation">{</span>
		Person person<span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><ul><li><p>我们需要手动回收person中的age属性么？</p> <p>不需要，当大括号中的代码运行完成之后，会被自动回收。</p></li> <li><p>析构函数在实际开发中的作用</p></li> <li><p>在对象中申请的堆内存空间，一般在~类的无参构造中回收</p></li> <li><p>说出下面代码所在的内存位置</p></li></ul> <p><img alt="Untitled" data-src="MJ%E5%A4%A7%E7%A5%9EC++%E5%9F%BA%E6%9C%AC%E7%9F%A5%E8%AF%86%20f9db4087ded4475a8eee4346f9dd1a31/Untitled%208.png" loading="lazy" class="lazy"></p> <p><img alt="Untitled" data-src="MJ%E5%A4%A7%E7%A5%9EC++%E5%9F%BA%E6%9C%AC%E7%9F%A5%E8%AF%86%20f9db4087ded4475a8eee4346f9dd1a31/Untitled%209.png" loading="lazy" class="lazy"></p> <p><img alt="Untitled" data-src="MJ%E5%A4%A7%E7%A5%9EC++%E5%9F%BA%E6%9C%AC%E7%9F%A5%E8%AF%86%20f9db4087ded4475a8eee4346f9dd1a31/Untitled%2010.png" loading="lazy" class="lazy"></p> <p><img alt="Untitled" data-src="MJ%E5%A4%A7%E7%A5%9EC++%E5%9F%BA%E6%9C%AC%E7%9F%A5%E8%AF%86%20f9db4087ded4475a8eee4346f9dd1a31/Untitled%2011.png" loading="lazy" class="lazy"></p> <h2 id="_5-16-声明和实现的分离"><a href="#_5-16-声明和实现的分离" class="header-anchor">#</a> 5.16 声明和实现的分离</h2> <p>类似于java中的接口和实现。C++更加灵活些。</p> <h2 id="_5-17-命名空间"><a href="#_5-17-命名空间" class="header-anchor">#</a> 5.17 命名空间</h2> <p>命名空间的概念就是java中导包。</p> <h2 id="_5-18-命名空间的嵌套"><a href="#_5-18-命名空间的嵌套" class="header-anchor">#</a> 5.18 命名空间的嵌套</h2> <p>C++可以通过::来实现命名空间的取值和嵌套</p> <h2 id="_5-19-命名空间的合并"><a href="#_5-19-命名空间的合并" class="header-anchor">#</a> 5.19 命名空间的合并</h2> <p>相同名字的命名空间会合并</p> <h2 id="_5-20-继承"><a href="#_5-20-继承" class="header-anchor">#</a> 5.20 继承</h2> <div class="language-cpp line-numbers-mode"><pre class="language-cpp"><code><span class="token keyword">struct</span> <span class="token class-name">Person</span>
<span class="token punctuation">{</span>
    
    <span class="token keyword">int</span> age<span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token keyword">struct</span> <span class="token class-name">Student</span> <span class="token operator">:</span> <span class="token base-clause"><span class="token class-name">Person</span></span>
<span class="token punctuation">{</span>
    <span class="token keyword">int</span> id<span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    Student student<span class="token punctuation">;</span>
    cout <span class="token operator">&lt;&lt;</span> <span class="token keyword">sizeof</span><span class="token punctuation">(</span>student<span class="token punctuation">)</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
    <span class="token function">getchar</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br></div></div><h2 id="_5-21-继承后对象的内存布局"><a href="#_5-21-继承后对象的内存布局" class="header-anchor">#</a> 5.21 继承后对象的内存布局</h2> <ul><li>继承后，父类的内存地址在前面，子类的内存地址后面；可以通过汇编来证明。</li></ul> <h2 id="_5-22-成员访问权限"><a href="#_5-22-成员访问权限" class="header-anchor">#</a> 5.22 成员访问权限</h2> <ul><li><p>成员访问权限，继承方式有三种</p> <ul><li><p>public</p> <p>其它的对象可以访问。开发中使用的最多</p></li> <li><p>private</p> <p>C++默认继承方式，子类可以访问，子类的子类无法访问。</p></li> <li><p>protected</p> <p>只有子类可以访问</p></li></ul></li> <li><p>子类访问父类，权限是下面提到的最小的那个</p> <ul><li>子类继承的访问权限</li> <li>父类本身的访问权限</li></ul></li> <li><p>访问权限不影响内存布局，它会把父类的内存没有限制的照搬下来。</p></li> <li><p>使用struct继承的类，默认继承public,使用class继承的类，默认使用private。</p></li></ul> <h2 id="_5-23-初始化列表"><a href="#_5-23-初始化列表" class="header-anchor">#</a> 5.23 初始化列表</h2> <div class="language-cpp line-numbers-mode"><pre class="language-cpp"><code>  <span class="token keyword">int</span> m_id<span class="token punctuation">;</span>
	<span class="token keyword">int</span> m_age<span class="token punctuation">;</span>
	
<span class="token comment">//法1</span>
	<span class="token function">person</span><span class="token punctuation">(</span><span class="token keyword">int</span> id<span class="token punctuation">,</span> <span class="token keyword">int</span> age<span class="token punctuation">)</span> <span class="token operator">:</span> <span class="token function">m_id</span><span class="token punctuation">(</span>id<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">m_age</span><span class="token punctuation">(</span>age<span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token comment">//法2</span>
	<span class="token function">person</span><span class="token punctuation">(</span><span class="token keyword">int</span> id<span class="token punctuation">,</span> <span class="token keyword">int</span> age<span class="token punctuation">)</span> <span class="token punctuation">{</span>
		m_id <span class="token operator">=</span> id<span class="token punctuation">;</span>
		m_age <span class="token operator">=</span> age<span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br></div></div><ul><li>如果函数声明和实现是分离的话
<ul><li>初始化列表只能写在函数的实现中去。</li> <li>默认参数只能写在函数的声明中去。
<ul><li>更好的查bug</li></ul></li></ul></li></ul> <h2 id="_5-24-构造函数的相互调用"><a href="#_5-24-构造函数的相互调用" class="header-anchor">#</a> 5.24 构造函数的相互调用</h2> <div class="language-cpp line-numbers-mode"><pre class="language-cpp"><code><span class="token keyword">struct</span>  <span class="token class-name">Person</span>
<span class="token punctuation">{</span>
	<span class="token keyword">int</span> m_id<span class="token punctuation">;</span>
	<span class="token keyword">int</span> m_age<span class="token punctuation">;</span>

	<span class="token operator">*</span><span class="token operator">*</span><span class="token function">Person</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
		<span class="token function">Person</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span><span class="token punctuation">;</span><span class="token operator">*</span><span class="token operator">*</span>

	<span class="token operator">*</span><span class="token operator">*</span><span class="token function">Person</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">:</span> <span class="token function">Person</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">;</span><span class="token operator">*</span><span class="token operator">*</span>
	<span class="token function">Person</span><span class="token punctuation">(</span><span class="token keyword">int</span> id<span class="token punctuation">,</span> <span class="token keyword">int</span> age<span class="token punctuation">)</span> <span class="token operator">:</span> <span class="token function">m_id</span><span class="token punctuation">(</span>id<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">m_age</span><span class="token punctuation">(</span>age<span class="token punctuation">)</span> <span class="token punctuation">{</span>
	
	<span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
	Person person<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br></div></div><p><strong><code>Person() {Person(0, 0);};	Person() : Person(0, 0) {};</code></strong></p> <p>区别。</p> <p>汇编解答</p> <div class="language-cpp line-numbers-mode"><pre class="language-cpp"><code><span class="token number">11</span><span class="token operator">:</span> 	<span class="token function">Person</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
<span class="token number">00007FF</span>7BB961E60 <span class="token number">48</span> <span class="token number">89</span> <span class="token number">4</span>C <span class="token number">24</span> <span class="token number">08</span>       mov         qword ptr <span class="token punctuation">[</span>rsp<span class="token operator">+</span><span class="token number">8</span><span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token operator">*</span><span class="token operator">*</span>rcx<span class="token operator">*</span><span class="token operator">*</span>  <span class="token comment">//rcx是传入对象的地址值</span>
<span class="token number">00007FF</span>7BB961E65 <span class="token number">55</span>                   push        rbp  
<span class="token number">00007FF</span>7BB961E66 <span class="token number">57</span>                   push        rdi  
<span class="token number">00007FF</span>7BB961E67 <span class="token number">48</span> <span class="token number">81</span> EC <span class="token number">08</span> <span class="token number">01</span> <span class="token number">00</span> <span class="token number">00</span> sub         rsp<span class="token punctuation">,</span><span class="token number">108</span>h  
<span class="token number">00007FF</span>7BB961E6E <span class="token number">48</span> <span class="token number">8</span>D <span class="token number">6</span>C <span class="token number">24</span> <span class="token number">20</span>       lea         rbp<span class="token punctuation">,</span><span class="token punctuation">[</span>rsp<span class="token operator">+</span><span class="token number">20</span>h<span class="token punctuation">]</span>  
<span class="token number">00007FF</span>7BB961E73 <span class="token number">48</span> <span class="token number">8</span>B FC             mov         rdi<span class="token punctuation">,</span>rsp  
<span class="token number">00007FF</span>7BB961E76 B9 <span class="token number">42</span> <span class="token number">00</span> <span class="token number">00</span> <span class="token number">00</span>       mov         ecx<span class="token punctuation">,</span><span class="token number">42</span>h  
<span class="token number">00007FF</span>7BB961E7B B8 CC CC CC CC       mov         eax<span class="token punctuation">,</span><span class="token number">0</span>CCCCCCCCh  
<span class="token number">00007FF</span>7BB961E80 F3 AB                rep stos    dword ptr <span class="token punctuation">[</span>rdi<span class="token punctuation">]</span>  
<span class="token number">00007FF</span>7BB961E82 <span class="token number">48</span> <span class="token number">8</span>B <span class="token number">8</span>C <span class="token number">24</span> <span class="token number">28</span> <span class="token number">01</span> <span class="token number">00</span> <span class="token number">00</span> mov         rcx<span class="token punctuation">,</span>qword ptr <span class="token punctuation">[</span>rsp<span class="token operator">+</span><span class="token number">128</span>h<span class="token punctuation">]</span>  
<span class="token number">00007FF</span>7BB961E8A <span class="token number">48</span> <span class="token number">8</span>D <span class="token number">0</span>D <span class="token number">98</span> <span class="token number">11</span> <span class="token number">01</span> <span class="token number">00</span> lea         rcx<span class="token punctuation">,</span><span class="token punctuation">[</span>__D39A98F2_源@<span class="token function">cpp</span> <span class="token punctuation">(</span><span class="token number">07FF</span>7BB973029h<span class="token punctuation">)</span><span class="token punctuation">]</span>  
<span class="token number">00007FF</span>7BB961E91 E8 <span class="token number">0F</span> F2 FF FF       call        <span class="token function">__CheckForDebuggerJustMyCode</span> <span class="token punctuation">(</span><span class="token number">07FF</span>7BB9610A5h<span class="token punctuation">)</span>  
    <span class="token number">12</span><span class="token operator">:</span> 		<span class="token function">Person</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token number">00007FF</span>7BB961E96 <span class="token number">45</span> <span class="token number">33</span> C0             <span class="token operator">xor</span>         r8d<span class="token punctuation">,</span>r8d  
<span class="token number">00007FF</span>7BB961E99 <span class="token number">33</span> D2                <span class="token operator">xor</span>         edx<span class="token punctuation">,</span>edx  
<span class="token number">00007FF</span>7BB961E9B <span class="token number">48</span> <span class="token number">8</span>D <span class="token number">8</span>D C4 <span class="token number">00</span> <span class="token number">00</span> <span class="token number">00</span> lea         rcx<span class="token punctuation">,</span><span class="token punctuation">[</span>rbp<span class="token operator">+</span><span class="token number">0</span>C4h<span class="token punctuation">]</span>  
<span class="token number">00007FF</span>7BB961EA2 E8 <span class="token number">8</span>C F5 FF FF       call        <span class="token class-name">Person</span><span class="token double-colon punctuation">::</span><span class="token function">Person</span> <span class="token punctuation">(</span><span class="token number">07FF</span>7BB961433h<span class="token punctuation">)</span>  
    <span class="token number">13</span><span class="token operator">:</span> 	<span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token number">13</span><span class="token operator">:</span> 	<span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token number">00007FF</span>7529D1EA7 <span class="token number">48</span> <span class="token number">8</span>B <span class="token number">85</span> <span class="token number">00</span> <span class="token number">01</span> <span class="token number">00</span> <span class="token number">00</span> mov         rax<span class="token punctuation">,</span>qword ptr <span class="token punctuation">[</span><span class="token keyword">this</span><span class="token punctuation">]</span>  
<span class="token number">00007FF</span>7529D1EAE <span class="token number">48</span> <span class="token number">8</span>D A5 E8 <span class="token number">00</span> <span class="token number">00</span> <span class="token number">00</span> lea         rsp<span class="token punctuation">,</span><span class="token punctuation">[</span>rbp<span class="token operator">+</span><span class="token number">0E8</span>h<span class="token punctuation">]</span>  
<span class="token number">00007FF</span>7529D1EB5 <span class="token number">5F</span>                   pop         rdi  
<span class="token number">00007FF</span>7529D1EB6 <span class="token number">5</span>D                   pop         rbp  
<span class="token number">00007FF</span>7529D1EB7 C3                   ret
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br></div></div><div class="language-cpp line-numbers-mode"><pre class="language-cpp"><code><span class="token number">15</span><span class="token operator">:</span> 	<span class="token function">Person</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">:</span> <span class="token function">Person</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token number">00007FF</span>752751E60 <span class="token number">48</span> <span class="token number">89</span> <span class="token number">4</span>C <span class="token number">24</span> <span class="token number">08</span>       mov         qword ptr <span class="token punctuation">[</span>rsp<span class="token operator">+</span><span class="token number">8</span><span class="token punctuation">]</span><span class="token punctuation">,</span>rcx  
<span class="token number">00007FF</span>752751E65 <span class="token number">55</span>                   push        rbp  
<span class="token number">00007FF</span>752751E66 <span class="token number">57</span>                   push        rdi  
<span class="token number">00007FF</span>752751E67 <span class="token number">48</span> <span class="token number">81</span> EC E8 <span class="token number">00</span> <span class="token number">00</span> <span class="token number">00</span> sub         rsp<span class="token punctuation">,</span><span class="token number">0E8</span>h  
<span class="token number">00007FF</span>752751E6E <span class="token number">48</span> <span class="token number">8</span>D <span class="token number">6</span>C <span class="token number">24</span> <span class="token number">20</span>       lea         rbp<span class="token punctuation">,</span><span class="token punctuation">[</span>rsp<span class="token operator">+</span><span class="token number">20</span>h<span class="token punctuation">]</span>  
<span class="token number">00007FF</span>752751E73 <span class="token number">48</span> <span class="token number">8</span>B FC             mov         rdi<span class="token punctuation">,</span>rsp  
<span class="token number">00007FF</span>752751E76 B9 <span class="token number">3</span>A <span class="token number">00</span> <span class="token number">00</span> <span class="token number">00</span>       mov         ecx<span class="token punctuation">,</span><span class="token number">3</span>Ah  
<span class="token number">00007FF</span>752751E7B B8 CC CC CC CC       mov         eax<span class="token punctuation">,</span><span class="token number">0</span>CCCCCCCCh  
<span class="token number">00007FF</span>752751E80 F3 AB                rep stos    dword ptr <span class="token punctuation">[</span>rdi<span class="token punctuation">]</span>  
<span class="token number">00007FF</span>752751E82 <span class="token number">48</span> <span class="token number">8</span>B <span class="token number">8</span>C <span class="token number">24</span> <span class="token number">08</span> <span class="token number">01</span> <span class="token number">00</span> <span class="token number">00</span> mov         rcx<span class="token punctuation">,</span>qword ptr <span class="token punctuation">[</span>rsp<span class="token operator">+</span><span class="token number">108</span>h<span class="token punctuation">]</span>  
<span class="token number">00007FF</span>752751E8A <span class="token number">48</span> <span class="token number">8</span>D <span class="token number">0</span>D <span class="token number">98</span> <span class="token number">11</span> <span class="token number">01</span> <span class="token number">00</span> lea         rcx<span class="token punctuation">,</span><span class="token punctuation">[</span>__D39A98F2_源@<span class="token function">cpp</span> <span class="token punctuation">(</span><span class="token number">07FF</span>752763029h<span class="token punctuation">)</span><span class="token punctuation">]</span>  
<span class="token number">00007FF</span>752751E91 E8 <span class="token number">0F</span> F2 FF FF       call        <span class="token function">__CheckForDebuggerJustMyCode</span> <span class="token punctuation">(</span><span class="token number">07FF</span>7527510A5h<span class="token punctuation">)</span>  
<span class="token number">00007FF</span>752751E96 <span class="token number">45</span> <span class="token number">33</span> C0             <span class="token operator">xor</span>         r8d<span class="token punctuation">,</span>r8d  
<span class="token number">00007FF</span>752751E99 <span class="token number">33</span> D2                <span class="token operator">xor</span>         edx<span class="token punctuation">,</span>edx  
<span class="token number">00007FF</span>752751E9B <span class="token number">48</span> <span class="token number">8</span>B <span class="token number">8</span>D E0 <span class="token number">00</span> <span class="token number">00</span> <span class="token number">00</span> mov         rcx<span class="token punctuation">,</span>qword ptr <span class="token punctuation">[</span><span class="token keyword">this</span><span class="token punctuation">]</span>  
<span class="token number">00007FF</span>752751EA2 E8 <span class="token number">8</span>C F5 FF FF       call        <span class="token class-name">Person</span><span class="token double-colon punctuation">::</span><span class="token function">Person</span> <span class="token punctuation">(</span><span class="token number">07FF</span>752751433h<span class="token punctuation">)</span>  
<span class="token number">00007FF</span>752751EA7 <span class="token number">48</span> <span class="token number">8</span>B <span class="token number">85</span> E0 <span class="token number">00</span> <span class="token number">00</span> <span class="token number">00</span> mov         rax<span class="token punctuation">,</span>qword ptr <span class="token punctuation">[</span><span class="token keyword">this</span><span class="token punctuation">]</span>  
<span class="token number">00007FF</span>752751EAE <span class="token number">48</span> <span class="token number">8</span>D A5 C8 <span class="token number">00</span> <span class="token number">00</span> <span class="token number">00</span> lea         rsp<span class="token punctuation">,</span><span class="token punctuation">[</span>rbp<span class="token operator">+</span><span class="token number">0</span>C8h<span class="token punctuation">]</span>  
<span class="token number">00007FF</span>752751EB5 <span class="token number">5F</span>                   pop         rdi  
<span class="token number">00007FF</span>752751EB6 <span class="token number">5</span>D                   pop         rbp  
<span class="token number">00007FF</span>752751EB7 C3                   ret
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br></div></div><h2 id="_5-25-父类的构造函数"><a href="#_5-25-父类的构造函数" class="header-anchor">#</a> 5.25 父类的构造函数</h2> <ul><li><p>子类参构造函数会默认实现父类的构造函数</p> <div class="language-cpp line-numbers-mode"><pre class="language-cpp"><code><span class="token keyword">struct</span> <span class="token class-name">Person</span>
<span class="token punctuation">{</span>
    <span class="token keyword">int</span> m_age<span class="token punctuation">;</span>
    <span class="token function">Person</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        cout <span class="token operator">&lt;&lt;</span> <span class="token string">&quot;打印Person&quot;</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token keyword">struct</span> <span class="token class-name">Student</span> <span class="token operator">:</span> <span class="token base-clause"><span class="token class-name">Person</span></span>
<span class="token punctuation">{</span>
    <span class="token keyword">int</span> id<span class="token punctuation">;</span>
    <span class="token function">Student</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        cout <span class="token operator">&lt;&lt;</span> <span class="token string">&quot;打印student&quot;</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

 
<span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    Student student<span class="token punctuation">;</span>
    <span class="token function">getchar</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br></div></div></li> <li><p>子类构造函数如果调用父类有参构造函数，那么就不会调用父类无参构造函数</p> <div class="language-cpp line-numbers-mode"><pre class="language-cpp"><code><span class="token keyword">struct</span> <span class="token class-name">Person</span>
<span class="token punctuation">{</span>
    <span class="token keyword">int</span> m_age<span class="token punctuation">;</span>
    <span class="token function">Person</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        cout <span class="token operator">&lt;&lt;</span> <span class="token string">&quot;打印Person&quot;</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token function">Person</span><span class="token punctuation">(</span><span class="token keyword">int</span> a<span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        cout <span class="token operator">&lt;&lt;</span> <span class="token string">&quot;打印有参&quot;</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token keyword">struct</span> <span class="token class-name">Student</span> <span class="token operator">:</span> <span class="token base-clause"><span class="token class-name">Person</span></span>
<span class="token punctuation">{</span>
    <span class="token keyword">int</span> id<span class="token punctuation">;</span>
    <span class="token function">Student</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">:</span><span class="token function">Person</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        cout <span class="token operator">&lt;&lt;</span> <span class="token string">&quot;打印student&quot;</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    Student student<span class="token punctuation">;</span>
    <span class="token function">getchar</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br></div></div></li> <li><p>如果父类缺少无参构造函数，子类的构造函数必须显式调用父类的有参构造函数</p></li></ul> <div class="language-cpp line-numbers-mode"><pre class="language-cpp"><code><span class="token keyword">class</span> <span class="token class-name">Person</span>
<span class="token punctuation">{</span>
<span class="token keyword">private</span><span class="token operator">:</span>
    <span class="token keyword">int</span> p_age<span class="token punctuation">;</span>
<span class="token keyword">public</span><span class="token operator">:</span>
    <span class="token function">Person</span><span class="token punctuation">(</span><span class="token comment">/* args */</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">Person</span><span class="token punctuation">(</span><span class="token keyword">int</span> age<span class="token punctuation">)</span><span class="token operator">:</span><span class="token function">p_age</span><span class="token punctuation">(</span>age<span class="token punctuation">)</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
    <span class="token operator">~</span><span class="token function">Person</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token keyword">class</span> <span class="token class-name">Student</span> <span class="token operator">:</span> <span class="token base-clause"><span class="token class-name">Person</span></span>
<span class="token punctuation">{</span>
<span class="token keyword">private</span><span class="token operator">:</span>
    <span class="token keyword">int</span> num<span class="token punctuation">;</span>
<span class="token keyword">public</span><span class="token operator">:</span>
    <span class="token function">Student</span><span class="token punctuation">(</span><span class="token keyword">int</span> a <span class="token punctuation">,</span> <span class="token keyword">int</span> b<span class="token punctuation">)</span><span class="token operator">:</span><span class="token function">num</span><span class="token punctuation">(</span>a<span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token function">Person</span><span class="token punctuation">(</span>b<span class="token punctuation">)</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
    <span class="token operator">~</span><span class="token function">Student</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br></div></div><ul><li>显示父类构造，然后是子类构造；先是子类析构，再是父类析构。</li></ul> <h2 id="_5-26-父类指针、子类指针"><a href="#_5-26-父类指针、子类指针" class="header-anchor">#</a> 5.26 父类指针、子类指针</h2> <ul><li><p>父类指针指向子类对象（开发中常用，是安全的）</p> <p><code>Person *p = new Student;</code></p> <p><img alt="Untitled" data-src="MJ%E5%A4%A7%E7%A5%9EC++%E5%9F%BA%E6%9C%AC%E7%9F%A5%E8%AF%86%20f9db4087ded4475a8eee4346f9dd1a31/Untitled%2012.png" loading="lazy" class="lazy"></p></li> <li><p>子类的指针指向父类的对象，不安全，有可能会造成内存越界</p> <p><code>Student *s = new Person;</code></p> <p><img alt="Untitled" data-src="MJ%E5%A4%A7%E7%A5%9EC++%E5%9F%BA%E6%9C%AC%E7%9F%A5%E8%AF%86%20f9db4087ded4475a8eee4346f9dd1a31/Untitled%2013.png" loading="lazy" class="lazy"></p></li></ul> <h2 id="_5-27-什么是多态"><a href="#_5-27-什么是多态" class="header-anchor">#</a> 5.27 什么是多态</h2> <ul><li>同一操作作用于不同的对象，可以有不同的解释，产生不同的执行结果</li> <li>默认情况下，C++不存在多态。通过汇编来观察</li> <li>在运行的时候，可以识别真正对象类型，调用子类的对象</li></ul> <h2 id="_5-28-虚函数"><a href="#_5-28-虚函数" class="header-anchor">#</a> 5.28 虚函数</h2> <ul><li>要使用多态，父类的方法要用<code>virtual</code>修饰才行</li> <li>如果父类的方法使用虚函数来修饰的话，那么子类的方法自动也变成使用虚函数来修饰。</li></ul> <h2 id="_5-29-虚表"><a href="#_5-29-虚表" class="header-anchor">#</a> 5.29 虚表</h2> <ul><li>使用汇编分析虚表的调用过程</li></ul> <p><img alt="Untitled" data-src="MJ%E5%A4%A7%E7%A5%9EC++%E5%9F%BA%E6%9C%AC%E7%9F%A5%E8%AF%86%20f9db4087ded4475a8eee4346f9dd1a31/Untitled%2014.png" loading="lazy" class="lazy"></p> <ul><li><p>不管是在堆还是栈中都共用一张虚表</p> <p>fc 9b 13 00</p> <p>fc 9b 13 00</p> <p>由内存来证明，所有对象共用一张虚表</p></li> <li><p>只要父类中有虚函数，就有虚表。</p></li></ul> <h2 id="_5-30-调用父类的成员函数"><a href="#_5-30-调用父类的成员函数" class="header-anchor">#</a> 5.30 调用父类的成员函数</h2> <ul><li><p>如果我们只是相对父类的功能进行扩展的话，可以使用这种方式。这个很像Spring中的handler处理器。</p> <div class="language-cpp line-numbers-mode"><pre class="language-cpp"><code><span class="token keyword">struct</span> <span class="token class-name">Animals</span>
<span class="token punctuation">{</span>
    <span class="token keyword">int</span> age<span class="token punctuation">;</span>
    <span class="token keyword">virtual</span> <span class="token keyword">void</span> <span class="token function">speak</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        cout <span class="token operator">&lt;&lt;</span> <span class="token string">&quot;animals speak&quot;</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token keyword">struct</span> <span class="token class-name">Cat</span> <span class="token operator">:</span> <span class="token base-clause"><span class="token class-name">Animals</span></span>
<span class="token punctuation">{</span>
    <span class="token keyword">int</span> life<span class="token punctuation">;</span>
    <span class="token keyword">virtual</span> <span class="token keyword">void</span> <span class="token function">speak</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        <span class="token class-name">Animals</span><span class="token double-colon punctuation">::</span><span class="token function">speak</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        cout <span class="token operator">&lt;&lt;</span> <span class="token string">&quot;cat speak&quot;</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br></div></div></li></ul> <h2 id="_5-31-虚析构函数"><a href="#_5-31-虚析构函数" class="header-anchor">#</a> 5.31 虚析构函数</h2> <ul><li>如果存在父类指针指向子类对象的情况，应该将父类的析构函数声明为虚函数（虚析构函数）。</li> <li>只要父类的析构函数是虚函数，那么子类的析构函数也是虚构函数。</li> <li>只要父类的方法是虚函数，那么继承它的的子类的析构函数也是虚函数。</li></ul> <div class="language-cpp line-numbers-mode"><pre class="language-cpp"><code><span class="token keyword">struct</span> <span class="token class-name">Animals</span>
<span class="token punctuation">{</span>
    <span class="token keyword">int</span> age<span class="token punctuation">;</span>
    <span class="token keyword">virtual</span> <span class="token keyword">void</span> <span class="token function">speak</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        cout <span class="token operator">&lt;&lt;</span> <span class="token string">&quot;animals speak&quot;</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">virtual</span> <span class="token operator">~</span><span class="token function">Animals</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        cout <span class="token operator">&lt;&lt;</span> <span class="token string">&quot;调用Animals的析构函数&quot;</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token keyword">struct</span> <span class="token class-name">Cat</span> <span class="token operator">:</span> <span class="token base-clause"><span class="token class-name">Animals</span></span>
<span class="token punctuation">{</span>
    <span class="token keyword">int</span> life<span class="token punctuation">;</span>
    <span class="token keyword">void</span> <span class="token function">speak</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        <span class="token class-name">Animals</span><span class="token double-colon punctuation">::</span><span class="token function">speak</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        cout <span class="token operator">&lt;&lt;</span> <span class="token string">&quot;cat speak&quot;</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token operator">~</span><span class="token function">Cat</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        cout <span class="token operator">&lt;&lt;</span> <span class="token string">&quot;调用cat的析构函数&quot;</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    Animals <span class="token operator">*</span>a <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token function">Cat</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    a<span class="token operator">-&gt;</span><span class="token function">speak</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">delete</span><span class="token punctuation">(</span>a<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">getchar</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br></div></div><h2 id="_5-32-纯虚函数-实现类"><a href="#_5-32-纯虚函数-实现类" class="header-anchor">#</a> 5.32 纯虚函数，实现类</h2> <ul><li>没有函数实现的类叫做纯虚函数。</li> <li>只要有一个纯虚函数，就把其叫做抽象类，这个可以类比java中的interface。</li> <li>抽象类也可以包括非纯虚函数，属性和方法也能和抽象类写在一起。</li> <li>如果父类是抽象类，子类没有完全重写这个抽象类的话，子类也是抽象类。</li></ul> <h2 id="_5-33-多继承"><a href="#_5-33-多继承" class="header-anchor">#</a> 5.33 多继承</h2> <ul><li>C++允许一个类可以有多个父类（不建议使用，会增加程序设计复杂度）。</li></ul> <p><img alt="Untitled" data-src="MJ%E5%A4%A7%E7%A5%9EC++%E5%9F%BA%E6%9C%AC%E7%9F%A5%E8%AF%86%20f9db4087ded4475a8eee4346f9dd1a31/Untitled%2015.png" loading="lazy" class="lazy"></p> <ul><li>C++继承的内存结构只和继承的顺序有关，先继承的内存在前面，后继承的内存在后面。</li></ul> <h2 id="_5-34-多继承体系下函数的调用"><a href="#_5-34-多继承体系下函数的调用" class="header-anchor">#</a> 5.34 多继承体系下函数的调用</h2> <div class="language-cpp line-numbers-mode"><pre class="language-cpp"><code><span class="token keyword">class</span> <span class="token class-name">Student</span>
<span class="token punctuation">{</span>
<span class="token keyword">private</span><span class="token operator">:</span>
    <span class="token keyword">int</span> m_score<span class="token punctuation">;</span>
<span class="token keyword">public</span><span class="token operator">:</span>
    <span class="token function">Student</span><span class="token punctuation">(</span><span class="token keyword">int</span> score<span class="token punctuation">)</span><span class="token operator">:</span><span class="token function">m_score</span><span class="token punctuation">(</span>score<span class="token punctuation">)</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
    <span class="token operator">~</span><span class="token function">Student</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token keyword">class</span> <span class="token class-name">Worker</span>
<span class="token punctuation">{</span>
<span class="token keyword">private</span><span class="token operator">:</span>
    <span class="token keyword">int</span> m_salary<span class="token punctuation">;</span>
<span class="token keyword">public</span><span class="token operator">:</span>
    <span class="token function">Worker</span><span class="token punctuation">(</span><span class="token keyword">int</span> salary<span class="token punctuation">)</span><span class="token operator">:</span><span class="token function">m_salary</span><span class="token punctuation">(</span>salary<span class="token punctuation">)</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
    <span class="token operator">~</span><span class="token function">Worker</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token keyword">class</span> <span class="token class-name">UnderGuaduate</span> <span class="token operator">:</span> <span class="token base-clause"><span class="token class-name">Student</span><span class="token punctuation">,</span><span class="token class-name">Worker</span></span>
<span class="token punctuation">{</span>
<span class="token keyword">private</span><span class="token operator">:</span>
<span class="token keyword">int</span> m_age<span class="token punctuation">;</span>
<span class="token keyword">public</span><span class="token operator">:</span>
    <span class="token function">UnderGuaduate</span><span class="token punctuation">(</span><span class="token keyword">int</span> score<span class="token punctuation">,</span><span class="token keyword">int</span> salary<span class="token punctuation">,</span><span class="token keyword">int</span> age<span class="token punctuation">)</span><span class="token operator">:</span><span class="token function">m_age</span><span class="token punctuation">(</span>age<span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token function">Worker</span><span class="token punctuation">(</span><span class="token number">3000</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token function">Student</span><span class="token punctuation">(</span><span class="token number">90</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br></div></div><h2 id="_5-35-多继承"><a href="#_5-35-多继承" class="header-anchor">#</a> 5.35 多继承</h2> <ul><li>如果子类继承的多个父类都有虚函数，那么子类对象就会产生对应的多张虚表</li></ul> <h2 id="_5-36-同名函数"><a href="#_5-36-同名函数" class="header-anchor">#</a> 5.36 同名函数</h2> <div class="language-cpp line-numbers-mode"><pre class="language-cpp"><code><span class="token keyword">struct</span> <span class="token class-name">Student</span>
<span class="token punctuation">{</span>
    <span class="token keyword">virtual</span> <span class="token keyword">void</span> <span class="token function">sing</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span><span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token keyword">struct</span> <span class="token class-name">Worker</span>
<span class="token punctuation">{</span>
    <span class="token keyword">virtual</span> <span class="token keyword">void</span> <span class="token function">sing</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span><span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token keyword">struct</span> <span class="token class-name">UnderGraduate</span> <span class="token operator">:</span> <span class="token base-clause"><span class="token class-name">Student</span><span class="token punctuation">,</span><span class="token class-name">Worker</span></span>
<span class="token punctuation">{</span>
    <span class="token keyword">void</span> <span class="token function">sing</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span><span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
   UnderGraduate ug<span class="token punctuation">;</span>
   <span class="token comment">//调用自己的sing</span>
   ug<span class="token punctuation">.</span><span class="token function">sing</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
   <span class="token comment">//调用父亲的sing</span>
   ug<span class="token punctuation">.</span><span class="token class-name">Student</span><span class="token double-colon punctuation">::</span><span class="token function">sing</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br></div></div><h2 id="_5-37-菱形继承"><a href="#_5-37-菱形继承" class="header-anchor">#</a> 5.37 菱形继承</h2> <ul><li>菱形继承问题
<ul><li>最底下子类从基类继承的成员变量冗余、重复</li> <li>最底下子类无法访问基类的成员，有二义性</li></ul></li></ul> <div class="language-cpp line-numbers-mode"><pre class="language-cpp"><code><span class="token keyword">struct</span> <span class="token class-name">Person</span>
<span class="token punctuation">{</span>
    <span class="token keyword">virtual</span> <span class="token keyword">void</span> <span class="token function">drink</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span><span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token keyword">struct</span> <span class="token class-name">Student</span> <span class="token operator">:</span> <span class="token base-clause"><span class="token class-name">Person</span></span>
<span class="token punctuation">{</span>
    <span class="token keyword">virtual</span> <span class="token keyword">void</span> <span class="token function">sing</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span><span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token keyword">struct</span> <span class="token class-name">Worker</span> <span class="token operator">:</span> <span class="token base-clause"><span class="token class-name">Person</span></span>
<span class="token punctuation">{</span>
    <span class="token keyword">virtual</span> <span class="token keyword">void</span> <span class="token function">eat</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span><span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token keyword">struct</span> <span class="token class-name">UnderGraduate</span> <span class="token operator">:</span> <span class="token base-clause"><span class="token class-name">Student</span><span class="token punctuation">,</span><span class="token class-name">Worker</span></span>
<span class="token punctuation">{</span>
    <span class="token keyword">void</span> <span class="token function">sing</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span><span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
   UnderGraduate ug<span class="token punctuation">;</span>
   <span class="token comment">//exception &quot;UnderGraduate::drink&quot; 不明确C/C++(266)</span>
   ug<span class="token punctuation">.</span><span class="token function">drink</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br></div></div><h2 id="_5-38-虚继承"><a href="#_5-38-虚继承" class="header-anchor">#</a> 5.38 虚继承</h2> <ul><li>虚继承可以解决菱形继承的问题</li> <li><code>Person</code>类被称为基类</li></ul> <p><img alt="Untitled" data-src="MJ%E5%A4%A7%E7%A5%9EC++%E5%9F%BA%E6%9C%AC%E7%9F%A5%E8%AF%86%20f9db4087ded4475a8eee4346f9dd1a31/Untitled%2016.png" loading="lazy" class="lazy"></p> <div class="language-cpp line-numbers-mode"><pre class="language-cpp"><code><span class="token keyword">struct</span> <span class="token class-name">Person</span>
<span class="token punctuation">{</span>
    <span class="token keyword">virtual</span> <span class="token keyword">void</span> <span class="token function">drink</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span><span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token keyword">struct</span> <span class="token class-name">Student</span> <span class="token operator">:</span> <span class="token base-clause"><span class="token keyword">virtual</span> <span class="token class-name">Person</span></span>
<span class="token punctuation">{</span>
    <span class="token keyword">virtual</span> <span class="token keyword">void</span> <span class="token function">sing</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span><span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token keyword">struct</span> <span class="token class-name">Worker</span> <span class="token operator">:</span> <span class="token base-clause"><span class="token keyword">virtual</span> <span class="token class-name">Person</span></span>
<span class="token punctuation">{</span>
    <span class="token keyword">virtual</span> <span class="token keyword">void</span> <span class="token function">eat</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span><span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token keyword">struct</span> <span class="token class-name">UnderGraduate</span> <span class="token operator">:</span> <span class="token base-clause"><span class="token class-name">Student</span><span class="token punctuation">,</span><span class="token class-name">Worker</span></span>
<span class="token punctuation">{</span>
    <span class="token keyword">void</span> <span class="token function">sing</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span><span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
   UnderGraduate ug<span class="token punctuation">;</span>
   ug<span class="token punctuation">.</span><span class="token function">drink</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br></div></div><p><img alt="Untitled" data-src="MJ%E5%A4%A7%E7%A5%9EC++%E5%9F%BA%E6%9C%AC%E7%9F%A5%E8%AF%86%20f9db4087ded4475a8eee4346f9dd1a31/Untitled%2017.png" loading="lazy" class="lazy"></p> <h2 id="_5-39-多继承应用场景"><a href="#_5-39-多继承应用场景" class="header-anchor">#</a> 5.39 多继承应用场景</h2> <ul><li>可以类比Java中的接口</li></ul> <div class="language-cpp line-numbers-mode"><pre class="language-cpp"><code><span class="token keyword">struct</span> <span class="token class-name">Nurse</span>
<span class="token punctuation">{</span>
    <span class="token keyword">virtual</span> <span class="token keyword">void</span> <span class="token function">careabout</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
    <span class="token keyword">virtual</span> <span class="token keyword">void</span> <span class="token function">daZhen</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token keyword">struct</span>  <span class="token class-name">Teacher</span>
<span class="token punctuation">{</span>
    <span class="token keyword">virtual</span> <span class="token keyword">void</span> <span class="token function">cook</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
    <span class="token keyword">virtual</span> <span class="token keyword">void</span> <span class="token function">play</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token keyword">struct</span>  <span class="token class-name">UnderGurduate</span> <span class="token operator">:</span> <span class="token base-clause"><span class="token class-name">Nurse</span><span class="token punctuation">,</span><span class="token class-name">Teacher</span></span>
<span class="token punctuation">{</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br></div></div><h2 id="_5-40-static成员变量"><a href="#_5-40-static成员变量" class="header-anchor">#</a> 5.40 static成员变量</h2> <ul><li><p>被static修饰的成员叫做静态成员</p></li> <li><p>静态成员变量</p> <ul><li>存在全局区，整个内存上面个就一份。</li> <li>必须初始化，必须在类外面进行初始化。不能直接在类里面写。</li> <li>不论是静态变量还是静态方法，都必须要初始化，相当于在ds注册。date segment</li></ul> <div class="language-cpp line-numbers-mode"><pre class="language-cpp"><code><span class="token keyword">struct</span> <span class="token class-name">Nurse</span>
<span class="token punctuation">{</span>
    <span class="token keyword">static</span> <span class="token keyword">int</span> i<span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token keyword">int</span> Nurse<span class="token double-colon punctuation">::</span>i <span class="token operator">=</span> <span class="token number">4</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><ul><li>可以设定访问权限（public,private,protect），达到局域共享的目的。</li> <li>如果类的声明和实现分离，我们要在<code>.cpp</code>文件中堆静态成员变量进行初始化。</li></ul></li></ul> <h2 id="_5-41-static成员函数"><a href="#_5-41-static成员函数" class="header-anchor">#</a> 5.41 static成员函数</h2> <ul><li><p>被static修饰的成员函数</p></li> <li><p>和创建类相关的都不能使用，不能使用this指针</p></li> <li><p>构造函数和析构函数不能是静态的</p></li> <li><p>声明和实现相分离的时候，实现不能使用static，和静态成员变量是一样的</p> <div class="language-cpp line-numbers-mode"><pre class="language-cpp"><code><span class="token keyword">struct</span> <span class="token class-name">Nurse</span>
<span class="token punctuation">{</span>
	<span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">test</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token keyword">void</span> <span class="token class-name">Nurse</span><span class="token double-colon punctuation">::</span><span class="token function">test</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>

<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div></li></ul> <h2 id="_5-42-static汇编分析"><a href="#_5-42-static汇编分析" class="header-anchor">#</a> 5.42 static汇编分析</h2> <ul><li>看到<code>ebp,esp</code>都是栈空间</li> <li>静态成员变量汇编分析</li></ul> <div class="language-cpp line-numbers-mode"><pre class="language-cpp"><code>		<span class="token number">17</span><span class="token operator">:</span> 	Nurse n<span class="token punctuation">;</span>
    <span class="token number">18</span><span class="token operator">:</span> 	n<span class="token punctuation">.</span>salary <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>
<span class="token comment">//将1赋值给寄存器</span>
 mov         dword ptr <span class="token punctuation">[</span>ebp<span class="token operator">-</span><span class="token number">8</span><span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token number">1</span>  
    <span class="token number">19</span><span class="token operator">:</span> 	n<span class="token punctuation">.</span>age <span class="token operator">=</span> <span class="token number">20</span><span class="token punctuation">;</span>
<span class="token comment">//将2赋值给某个内存地址。 ds是date segment的简称</span>
 mov         dword ptr ds<span class="token operator">:</span><span class="token punctuation">[</span><span class="token number">00</span>CCC138h<span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token number">14</span>h  
    <span class="token number">20</span><span class="token operator">:</span> 	Nurse<span class="token double-colon punctuation">::</span>age <span class="token operator">=</span> <span class="token number">10</span><span class="token punctuation">;</span>
 mov         dword ptr ds<span class="token operator">:</span><span class="token punctuation">[</span><span class="token number">00</span>CCC138h<span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token number">0</span>Ah

<span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span>        <span class="token operator">--</span>
<span class="token comment">//注意赋值给静态成员变量和全局作用域的变量的区别。没有区别</span>
<span class="token number">24</span><span class="token operator">:</span> 	b <span class="token operator">=</span> <span class="token number">3</span><span class="token punctuation">;</span>
 mov         dword ptr ds<span class="token operator">:</span><span class="token punctuation">[</span><span class="token number">00</span>C5C478h<span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token number">3</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br></div></div><ul><li><p>静态方法汇编对比分析</p> <div class="language-cpp line-numbers-mode"><pre class="language-cpp"><code><span class="token number">21</span><span class="token operator">:</span> 	Nurse n<span class="token punctuation">;</span>
    <span class="token number">22</span><span class="token operator">:</span> 	n<span class="token punctuation">.</span><span class="token function">sum</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">//将n的指针地址传给寄存器ecx</span>
 lea         ecx<span class="token punctuation">,</span><span class="token punctuation">[</span>ebp<span class="token operator">-</span><span class="token number">9</span><span class="token punctuation">]</span>  
<span class="token comment">//调用函数内存地址</span>
 call        <span class="token number">00</span>A61401
  
    <span class="token number">23</span><span class="token operator">:</span> 	n<span class="token punctuation">.</span>play<span class="token punctuation">;</span>
    <span class="token number">24</span><span class="token operator">:</span> 	<span class="token class-name">Nurse</span><span class="token double-colon punctuation">::</span><span class="token function">play</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">//直接调用函数内存地址 静态方法</span>
 call        <span class="token number">00</span>A6140B
<span class="token comment">//直接调用函数内存地址 全局区方法</span>
    <span class="token number">25</span><span class="token operator">:</span> 	<span class="token function">play</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
 call        <span class="token number">00</span>A61406
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br></div></div></li> <li><p>static如果继承了有什么情况</p> <div class="language-cpp line-numbers-mode"><pre class="language-cpp"><code><span class="token keyword">struct</span>  <span class="token class-name">Person</span>
<span class="token punctuation">{</span>
	<span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">play</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token keyword">void</span> <span class="token class-name">Person</span><span class="token double-colon punctuation">::</span><span class="token function">play</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token keyword">struct</span> <span class="token class-name">Nurse</span><span class="token operator">:</span><span class="token base-clause"><span class="token class-name">Person</span></span>
<span class="token punctuation">{</span>
	<span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">play</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token keyword">void</span> <span class="token class-name">Nurse</span><span class="token double-colon punctuation">::</span><span class="token function">play</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
	<span class="token comment">//两个打印的地址值不一样,.为什么不一样呀？好像就是应该不一样的，重写的话，父类方法和子类方法应该是不一样的。</span>
	cout <span class="token operator">&lt;&lt;</span> Nurse<span class="token double-colon punctuation">::</span>play <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
	cout <span class="token operator">&lt;&lt;</span> Person<span class="token double-colon punctuation">::</span>play <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br></div></div></li></ul> <h2 id="_5-43-static应用"><a href="#_5-43-static应用" class="header-anchor">#</a> 5.43 static应用</h2> <ul><li>统计调用类的次数</li></ul> <div class="language-cpp line-numbers-mode"><pre class="language-cpp"><code><span class="token keyword">class</span> <span class="token class-name">Car</span>
<span class="token punctuation">{</span>
<span class="token keyword">private</span><span class="token operator">:</span>
    <span class="token keyword">static</span> <span class="token keyword">int</span> mc_carNumber<span class="token punctuation">;</span>
<span class="token keyword">public</span><span class="token operator">:</span>
    <span class="token function">Car</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        mc_carNumber<span class="token operator">++</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">;</span>
    <span class="token operator">~</span><span class="token function">Car</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        mc_carNumber<span class="token operator">--</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">;</span>

    <span class="token keyword">static</span> <span class="token keyword">int</span> <span class="token function">getCarNum</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token keyword">int</span> Car<span class="token double-colon punctuation">::</span>mc_carNumber <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>

<span class="token keyword">int</span> <span class="token class-name">Car</span><span class="token double-colon punctuation">::</span><span class="token function">getCarNum</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    <span class="token keyword">return</span> mc_carNumber<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    <span class="token keyword">new</span> Car<span class="token punctuation">;</span>
    Car car<span class="token punctuation">;</span>
    cout <span class="token operator">&lt;&lt;</span> <span class="token string">&quot;Car类被使用了&quot;</span> <span class="token operator">&lt;&lt;</span> <span class="token class-name">Car</span><span class="token double-colon punctuation">::</span><span class="token function">getCarNum</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">&lt;&lt;</span> <span class="token string">&quot;次&quot;</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
    <span class="token function">getchar</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br></div></div><ul><li>注意：在实际开发中要考虑多线程安全问题。</li></ul> <h2 id="_5-44-static单例模式"><a href="#_5-44-static单例模式" class="header-anchor">#</a> 5.44 static单例模式</h2> <ul><li>保证某个类只能创建一个</li> <li>创建单例模式
<ul><li><p>构造函数私有化</p></li> <li><p>定义一个static成员变量，指向唯一的对象</p></li> <li><p>提供一个公共的访问单例的接口</p> <div class="language-cpp line-numbers-mode"><pre class="language-cpp"><code><span class="token keyword">class</span> <span class="token class-name">Rocket</span>
<span class="token punctuation">{</span>
<span class="token keyword">private</span><span class="token operator">:</span>
	<span class="token function">Rocket</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token comment">//可以</span>
	<span class="token operator">~</span><span class="token function">Rocket</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
	<span class="token keyword">static</span> Rocket <span class="token operator">*</span>ms_rocket<span class="token punctuation">;</span>

<span class="token keyword">public</span><span class="token operator">:</span>
<span class="token comment">//返回的是rocket的指针</span>
	<span class="token keyword">static</span> Rocket <span class="token operator">*</span><span class="token function">shareRocket</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
	<span class="token punctuation">{</span>
		<span class="token keyword">if</span> <span class="token punctuation">(</span>ms_rocket <span class="token operator">==</span> <span class="token constant">NULL</span><span class="token punctuation">)</span>
		<span class="token punctuation">{</span>
			ms_rocket <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token function">Rocket</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token punctuation">}</span>
		<span class="token keyword">return</span> ms_rocket<span class="token punctuation">;</span>
	<span class="token punctuation">}</span>

	<span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">clear_Rocket</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
	<span class="token punctuation">{</span>
		<span class="token keyword">if</span> <span class="token punctuation">(</span>ms_rocket <span class="token operator">!=</span> <span class="token constant">NULL</span><span class="token punctuation">)</span>
		<span class="token punctuation">{</span>
			<span class="token comment">/* 如果删除的时候不用用NULL填充，会产生野指针
			野指针就是指针指向的位置是不可知的（随机的、不正确的、没有明确限制的）
			指针变量在定义时如果未初始化，其值是随机的，指针变量的值是别的变量的地址，
			意味着指针指向了一个地址是不确定的变量，此时去解引用就是去访问了一个不确定的地址，所以结果是不可知的。
			 */</span>
			ms_rocket <span class="token operator">=</span> <span class="token constant">NULL</span><span class="token punctuation">;</span>
			<span class="token keyword">delete</span> ms_rocket<span class="token punctuation">;</span>
		<span class="token punctuation">}</span>
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
Rocket <span class="token operator">*</span>Rocket<span class="token double-colon punctuation">::</span>ms_rocket <span class="token operator">=</span> <span class="token constant">NULL</span><span class="token punctuation">;</span>

<span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
	Rocket <span class="token operator">*</span>p1 <span class="token operator">=</span> <span class="token class-name">Rocket</span><span class="token double-colon punctuation">::</span><span class="token function">shareRocket</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	Rocket <span class="token operator">*</span>p2 <span class="token operator">=</span> <span class="token class-name">Rocket</span><span class="token double-colon punctuation">::</span><span class="token function">shareRocket</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	cout <span class="token operator">&lt;&lt;</span> <span class="token string">&quot;p1&quot;</span> <span class="token operator">&lt;&lt;</span> p1 <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
	cout <span class="token operator">&lt;&lt;</span> <span class="token string">&quot;p2&quot;</span> <span class="token operator">&lt;&lt;</span> p2 <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
	<span class="token class-name">Rocket</span><span class="token double-colon punctuation">::</span><span class="token function">clear_Rocket</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token function">getchar</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br></div></div></li></ul></li></ul> <h2 id="_5-45-new、delete-误区"><a href="#_5-45-new、delete-误区" class="header-anchor">#</a> 5.45 new、delete 误区</h2> <div class="language-cpp line-numbers-mode"><pre class="language-cpp"><code>	<span class="token keyword">int</span> <span class="token operator">*</span>p <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token keyword">int</span><span class="token punctuation">;</span>
	<span class="token operator">*</span>p <span class="token operator">=</span> <span class="token number">10</span><span class="token punctuation">;</span>
	cout <span class="token operator">&lt;&lt;</span> <span class="token string">&quot;*p的值是&quot;</span> <span class="token operator">&lt;&lt;</span> <span class="token operator">*</span>p <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
	cout <span class="token operator">&lt;&lt;</span> <span class="token string">&quot;p的地址是&quot;</span> <span class="token operator">&lt;&lt;</span> p <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
<span class="token comment">// 告诉编译器，原来指向的堆内存我不用了，不是用零去填充的</span>
	<span class="token keyword">delete</span> p<span class="token punctuation">;</span>
	p <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token keyword">int</span><span class="token punctuation">;</span>
	<span class="token operator">*</span>p <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>
	cout <span class="token operator">&lt;&lt;</span> <span class="token string">&quot;*p的值是&quot;</span> <span class="token operator">&lt;&lt;</span> <span class="token operator">*</span>p <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
	cout <span class="token operator">&lt;&lt;</span> <span class="token string">&quot;p的地址是&quot;</span> <span class="token operator">&lt;&lt;</span> p <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br></div></div><h2 id="_5-46-const成员、引用成员"><a href="#_5-46-const成员、引用成员" class="header-anchor">#</a> 5.46 const成员、引用成员</h2> <ul><li><p>const</p> <ul><li>可以是成员变量</li> <li>也可是成员函数</li></ul></li> <li><p>const成员变量</p> <ul><li>必须被初始化</li> <li>可以在定义的时候初始化</li> <li>也可通过初始化函数初始化（非static）</li></ul></li> <li><p>const成员函数</p> <ul><li>const关键字写在参数列表后边，定义和实现都要写const关键字</li> <li>const对<code>static</code>是只读的</li> <li>const修饰的成员变量和非const修饰的成员变量构成重载
<ul><li>非const对象优先调用const对象</li> <li>const对象无法调用非const对象。只能调用const对象和static对象</li></ul></li></ul></li></ul> <div class="language-cpp line-numbers-mode"><pre class="language-cpp"><code><span class="token keyword">class</span> <span class="token class-name">Rocket</span>
<span class="token punctuation">{</span>
<span class="token keyword">private</span><span class="token operator">:</span>
	<span class="token comment">//被const修饰的成员变量</span>
	<span class="token keyword">static</span> <span class="token keyword">const</span> <span class="token keyword">int</span> msc_a <span class="token operator">=</span> <span class="token number">10</span><span class="token punctuation">;</span>
	
    <span class="token comment">//初始化const对象</span>
    <span class="token keyword">const</span> <span class="token keyword">int</span> c_c <span class="token operator">=</span> <span class="token number">11</span><span class="token punctuation">;</span>

    <span class="token comment">//外部初始化const对象；</span>
    <span class="token keyword">const</span> <span class="token keyword">int</span> c_b<span class="token punctuation">;</span>
<span class="token keyword">public</span><span class="token operator">:</span>
    <span class="token function">Rocket</span><span class="token punctuation">(</span><span class="token keyword">int</span> b<span class="token punctuation">)</span><span class="token operator">:</span><span class="token function">c_b</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">;</span>

	<span class="token comment">//被const修饰的非静态成员函数</span>
	<span class="token keyword">void</span> <span class="token function">show</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">const</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">;</span>

	<span class="token comment">//不能这样写，而且这样写没有意义</span>
    <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">add</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">const</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br></div></div><ul><li>引用类型成员</li></ul> <h2 id="_5-47-拷贝构造"><a href="#_5-47-拷贝构造" class="header-anchor">#</a> 5.47 拷贝构造</h2> <ul><li>对象创建完，就要调用构造函数</li> <li>利用已经创建好的函数创建函数，就称为拷贝</li> <li>拷贝格式是固定的，接受一个const引用作为参数 <code>const Car &amp;car</code></li> <li>不写拷贝构造函数，默认会把所有成员变量拷贝</li> <li>创建新对象的时候，会使用拷贝构造函数</li></ul> <div class="language-cpp line-numbers-mode"><pre class="language-cpp"><code><span class="token keyword">private</span><span class="token operator">:</span>
	<span class="token keyword">int</span> m_price<span class="token punctuation">;</span>
	<span class="token keyword">int</span> m_length<span class="token punctuation">;</span>
<span class="token keyword">public</span><span class="token operator">:</span>
	<span class="token function">Car</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
		cout <span class="token operator">&lt;&lt;</span> <span class="token string">&quot;调用Car的无参构造&quot;</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
	<span class="token punctuation">}</span><span class="token punctuation">;</span>

	<span class="token function">Car</span><span class="token punctuation">(</span><span class="token keyword">int</span> price<span class="token punctuation">)</span> <span class="token operator">:</span> <span class="token function">m_price</span><span class="token punctuation">(</span>price<span class="token punctuation">)</span>
	<span class="token punctuation">{</span>
		cout <span class="token operator">&lt;&lt;</span> <span class="token string">&quot;调用Car的有参构造&quot;</span> <span class="token operator">&lt;&lt;</span>m_price<span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
	<span class="token punctuation">}</span><span class="token punctuation">;</span>
	
	<span class="token function">Car</span><span class="token punctuation">(</span><span class="token keyword">const</span> Car <span class="token operator">&amp;</span>car<span class="token punctuation">)</span><span class="token operator">:</span><span class="token function">m_price</span><span class="token punctuation">(</span>car<span class="token punctuation">.</span>m_price<span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token function">m_length</span><span class="token punctuation">(</span>car<span class="token punctuation">.</span>m_length<span class="token punctuation">)</span><span class="token punctuation">{</span>
		cout <span class="token operator">&lt;&lt;</span> <span class="token string">&quot;正在调用拷贝构造函数&quot;</span> <span class="token operator">&lt;&lt;</span> m_price <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
	<span class="token punctuation">}</span>

	<span class="token operator">~</span><span class="token function">Car</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
		cout <span class="token operator">&lt;&lt;</span> <span class="token string">&quot;调用Car的析构函数&quot;</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
	<span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
	Car <span class="token function">car</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	Car <span class="token function">car2</span><span class="token punctuation">(</span>car<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br></div></div><h2 id="_5-48-拷贝构造-父类"><a href="#_5-48-拷贝构造-父类" class="header-anchor">#</a> 5.48 拷贝构造 父类</h2> <ul><li>拷贝父类的成员变量</li> <li>如果要全部拷贝父类的成员变量</li></ul> <div class="language-cpp line-numbers-mode"><pre class="language-cpp"><code><span class="token keyword">class</span> <span class="token class-name">Person</span>
<span class="token punctuation">{</span>
<span class="token keyword">public</span><span class="token operator">:</span>
	<span class="token keyword">int</span> m_age <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>
	<span class="token function">Person</span><span class="token punctuation">(</span><span class="token keyword">int</span> age<span class="token punctuation">)</span><span class="token operator">:</span><span class="token function">m_age</span><span class="token punctuation">(</span>age<span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token keyword">class</span> <span class="token class-name">Car</span> <span class="token operator">:</span> <span class="token base-clause"><span class="token class-name">Person</span></span>
<span class="token punctuation">{</span>
<span class="token keyword">private</span><span class="token operator">:</span>
	<span class="token keyword">int</span> m_price<span class="token punctuation">;</span>
	<span class="token keyword">int</span> m_length<span class="token punctuation">;</span>
<span class="token keyword">public</span><span class="token operator">:</span>
	<span class="token function">Car</span><span class="token punctuation">(</span><span class="token keyword">int</span> price<span class="token punctuation">,</span> <span class="token keyword">int</span> age<span class="token punctuation">)</span> <span class="token operator">:</span><span class="token function">Person</span><span class="token punctuation">(</span>age<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">m_price</span><span class="token punctuation">(</span>price<span class="token punctuation">)</span> <span class="token punctuation">{</span>
		cout <span class="token operator">&lt;&lt;</span> <span class="token string">&quot;调用Car的有参构造&quot;</span> <span class="token operator">&lt;&lt;</span> m_price <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
	<span class="token punctuation">}</span><span class="token punctuation">;</span>
	<span class="token comment">//拷贝构造函数</span>
	<span class="token function">Car</span><span class="token punctuation">(</span><span class="token keyword">const</span> Car <span class="token operator">&amp;</span>car<span class="token punctuation">)</span> <span class="token operator">:</span><span class="token function">m_price</span><span class="token punctuation">(</span>car<span class="token punctuation">.</span>m_price<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">m_length</span><span class="token punctuation">(</span>car<span class="token punctuation">.</span>m_length<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">Person</span><span class="token punctuation">(</span>car<span class="token punctuation">.</span>m_age<span class="token punctuation">)</span> 
	<span class="token punctuation">{</span>
		cout <span class="token operator">&lt;&lt;</span> <span class="token string">&quot;car拷贝&quot;</span> <span class="token operator">&lt;&lt;</span>m_price<span class="token operator">&lt;&lt;</span>m_length<span class="token operator">&lt;&lt;</span>m_age<span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
	<span class="token punctuation">}</span><span class="token punctuation">;</span>
	
<span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
	Car <span class="token function">car</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	Car <span class="token function">car1</span><span class="token punctuation">(</span>car<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br></div></div><h2 id="_5-49-拷贝构造-注意点"><a href="#_5-49-拷贝构造-注意点" class="header-anchor">#</a> 5.49 拷贝构造 注意点</h2> <div class="language-cpp line-numbers-mode"><pre class="language-cpp"><code>  Car <span class="token function">car</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//调用构造函数</span>
	Car car2 <span class="token operator">=</span> car<span class="token punctuation">;</span> <span class="token comment">//调用拷贝构造函数。等价于 Car2（car）</span>
	Car <span class="token function">car3</span><span class="token punctuation">(</span>car2<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//调用拷贝构造函数</span>
	
	<span class="token comment">//car4 = car3是一个赋值操作（默认是浅拷贝），并不会调用构造函数</span>
	Car car4<span class="token punctuation">;</span>
	car4 <span class="token operator">=</span> car3<span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><ul><li><p>问题</p> <div class="language-cpp line-numbers-mode"><pre class="language-cpp"><code><span class="token keyword">class</span> <span class="token class-name">Person</span>
<span class="token punctuation">{</span>
<span class="token keyword">private</span><span class="token operator">:</span>
<span class="token keyword">public</span><span class="token operator">:</span>
	<span class="token keyword">int</span> m_age<span class="token punctuation">;</span>
	<span class="token function">Person</span><span class="token punctuation">(</span><span class="token keyword">int</span> age <span class="token operator">=</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token operator">:</span><span class="token function">m_age</span><span class="token punctuation">(</span>age<span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token keyword">class</span> <span class="token class-name">Car</span> <span class="token operator">:</span> <span class="token base-clause"><span class="token class-name">Person</span></span>
<span class="token punctuation">{</span>
<span class="token keyword">private</span><span class="token operator">:</span>
	<span class="token keyword">int</span> m_price<span class="token punctuation">;</span>
	<span class="token keyword">int</span> m_length<span class="token punctuation">;</span>
	<span class="token keyword">char</span> <span class="token operator">*</span>m_name
<span class="token keyword">public</span><span class="token operator">:</span>
	<span class="token function">Car</span><span class="token punctuation">(</span><span class="token keyword">int</span> price<span class="token punctuation">,</span> <span class="token keyword">char</span> <span class="token operator">*</span>c <span class="token operator">=</span> <span class="token constant">NULL</span><span class="token punctuation">)</span> <span class="token operator">:</span><span class="token function">m_price</span><span class="token punctuation">(</span>price<span class="token punctuation">)</span>，<span class="token function">m_name</span><span class="token punctuation">(</span>name<span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
	<span class="token keyword">void</span> <span class="token function">display</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
		cout <span class="token operator">&lt;&lt;</span> <span class="token string">&quot;price is &quot;</span> <span class="token operator">&lt;&lt;</span> m_price <span class="token operator">&lt;&lt;</span> <span class="token string">&quot;length id&quot;</span> <span class="token operator">&lt;&lt;</span> m_length <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
	<span class="token keyword">const</span> <span class="token keyword">char</span> <span class="token operator">*</span>name1 <span class="token operator">=</span> <span class="token string">&quot;bmw&quot;</span><span class="token punctuation">;</span>
	<span class="token keyword">char</span> name2<span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">{</span> <span class="token char">'b'</span><span class="token punctuation">,</span><span class="token char">'m'</span><span class="token punctuation">,</span><span class="token char">'w'</span><span class="token punctuation">,</span> <span class="token char">'\0'</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token comment">//堆内存对象又指向栈内存，这样做不太安全。我们name2拷贝一份出来，这样做就比较安全了</span>
	Car <span class="token operator">*</span>car <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token function">Car</span><span class="token punctuation">(</span><span class="token number">100</span><span class="token punctuation">,</span> name2<span class="token punctuation">)</span><span class="token punctuation">;</span>

	<span class="token function">getchar</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br></div></div></li> <li><p>解决方法</p> <div class="language-cpp line-numbers-mode"><pre class="language-cpp"><code><span class="token keyword">class</span> <span class="token class-name">Car</span>
<span class="token punctuation">{</span>
<span class="token keyword">private</span><span class="token operator">:</span>
	<span class="token keyword">int</span> m_price<span class="token punctuation">;</span>
	<span class="token keyword">int</span> m_length<span class="token punctuation">;</span>
	<span class="token keyword">char</span> <span class="token operator">*</span>m_name<span class="token punctuation">;</span>
<span class="token keyword">public</span><span class="token operator">:</span>
	<span class="token function">Car</span><span class="token punctuation">(</span><span class="token keyword">int</span> price<span class="token punctuation">,</span> <span class="token keyword">char</span> <span class="token operator">*</span>name <span class="token operator">=</span> <span class="token constant">NULL</span><span class="token punctuation">)</span> <span class="token operator">:</span><span class="token function">m_price</span><span class="token punctuation">(</span>price<span class="token punctuation">)</span> <span class="token punctuation">{</span>
		<span class="token keyword">if</span> <span class="token punctuation">(</span>name <span class="token operator">==</span> <span class="token constant">NULL</span><span class="token punctuation">)</span>
		<span class="token punctuation">{</span>
			<span class="token keyword">return</span><span class="token punctuation">;</span>
		<span class="token punctuation">}</span>
		<span class="token comment">//申请堆内存空间，并且把堆内存初始化。</span>
		<span class="token comment">//在这里，我们先计算出原来name占用的字节大小，然后加1，使用0来填充，这样可以避免出现内存读取问题</span>
		m_name <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token keyword">char</span><span class="token punctuation">[</span><span class="token function">strlen</span><span class="token punctuation">(</span>name<span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">;</span>

		<span class="token function">strcpy</span><span class="token punctuation">(</span>m_name<span class="token punctuation">,</span> name<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>

	<span class="token operator">~</span><span class="token function">Car</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
		<span class="token comment">//释放堆空间</span>
		<span class="token keyword">if</span> <span class="token punctuation">(</span>m_name <span class="token operator">!=</span> <span class="token constant">NULL</span><span class="token punctuation">)</span>
		<span class="token punctuation">{</span>
			<span class="token keyword">delete</span><span class="token punctuation">[</span><span class="token punctuation">]</span> m_name<span class="token punctuation">;</span>
			m_name <span class="token operator">=</span> <span class="token constant">NULL</span><span class="token punctuation">;</span>
		<span class="token punctuation">}</span>
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
	<span class="token keyword">const</span> <span class="token keyword">char</span> <span class="token operator">*</span>name1 <span class="token operator">=</span> <span class="token string">&quot;bmw&quot;</span><span class="token punctuation">;</span>
	<span class="token keyword">char</span> name2<span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">{</span> <span class="token char">'b'</span><span class="token punctuation">,</span><span class="token char">'m'</span><span class="token punctuation">,</span><span class="token char">'w'</span><span class="token punctuation">,</span> <span class="token char">'\0'</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
	Car <span class="token operator">*</span>car <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token function">Car</span><span class="token punctuation">(</span><span class="token number">100</span><span class="token punctuation">,</span> name2<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token function">getchar</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br></div></div></li></ul> <h2 id="_5-50-拷贝构造-浅拷贝"><a href="#_5-50-拷贝构造-浅拷贝" class="header-anchor">#</a> 5.50 拷贝构造 浅拷贝</h2> <ul><li><p>char的一些基础知识</p> <div class="language-cpp line-numbers-mode"><pre class="language-cpp"><code>	<span class="token keyword">const</span> <span class="token keyword">char</span> <span class="token operator">*</span>name1 <span class="token operator">=</span> <span class="token string">&quot;bmw&quot;</span><span class="token punctuation">;</span>
	<span class="token comment">//必须要在字符数组最后加'\0'。防止越界</span>
	<span class="token keyword">char</span> name2<span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">{</span> <span class="token char">'b'</span><span class="token punctuation">,</span><span class="token char">'m'</span><span class="token punctuation">,</span><span class="token char">'w'</span><span class="token punctuation">,</span> <span class="token char">'\0'</span><span class="token punctuation">}</span><span class="token punctuation">;</span>

	cout <span class="token operator">&lt;&lt;</span> <span class="token string">&quot;name:&quot;</span> <span class="token operator">&lt;&lt;</span> name2 <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
	cout <span class="token operator">&lt;&lt;</span> <span class="token string">&quot;name1:&quot;</span> <span class="token operator">&lt;&lt;</span> <span class="token function">strlen</span><span class="token punctuation">(</span>name1<span class="token punctuation">)</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
	cout <span class="token operator">&lt;&lt;</span> <span class="token string">&quot;name2:&quot;</span> <span class="token operator">&lt;&lt;</span> <span class="token function">strlen</span><span class="token punctuation">(</span>name2<span class="token punctuation">)</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
	<span class="token function">getchar</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div></li> <li><p>编译器默认提供的拷贝方式是浅拷贝（shallow copy）</p></li> <li><p>只要是堆空间指向栈空间都很危险</p></li> <li><p>野指针，指向一段被回收的内存</p></li></ul> <h2 id="_5-51-拷贝构造-深拷贝"><a href="#_5-51-拷贝构造-深拷贝" class="header-anchor">#</a> 5.51 拷贝构造 深拷贝</h2> <ul><li>浅拷贝只会拷贝地址值</li> <li>深拷贝将指针指向的内存空间指向新的存储空间</li> <li>当成员变量是指针的时候，我们要考虑到深拷贝，基本数据类型本来就是深拷贝</li></ul> <div class="language-cpp line-numbers-mode"><pre class="language-cpp"><code><span class="token keyword">class</span> <span class="token class-name">Test</span> <span class="token punctuation">{</span>
<span class="token keyword">private</span><span class="token operator">:</span>
	<span class="token keyword">char</span><span class="token operator">*</span> p<span class="token punctuation">;</span>
<span class="token keyword">public</span><span class="token operator">:</span>
	<span class="token function">Test</span><span class="token punctuation">(</span><span class="token keyword">const</span> <span class="token keyword">char</span><span class="token operator">*</span> str<span class="token punctuation">)</span> <span class="token punctuation">{</span>
		p <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token keyword">char</span><span class="token punctuation">[</span><span class="token function">strlen</span><span class="token punctuation">(</span>str<span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
		<span class="token function">strcpy_s</span><span class="token punctuation">(</span>p<span class="token punctuation">,</span><span class="token function">strlen</span><span class="token punctuation">(</span>p<span class="token punctuation">)</span><span class="token punctuation">,</span> str<span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">&quot;Test cntr.%s\n&quot;</span><span class="token punctuation">,</span> p<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>

	<span class="token comment">//为什么这了是引用？</span>
	<span class="token comment">//拷贝构造函数的const date d会对原来的d1进行实例化，</span>
	<span class="token comment">//调用自身，但被调用后又实例化，再次调用拷贝构造函数，形成无限递归，所以只能引用原来的d2</span>
	<span class="token function">Test</span><span class="token punctuation">(</span><span class="token keyword">const</span> Test <span class="token operator">&amp;</span>t<span class="token punctuation">)</span> <span class="token punctuation">{</span>
		p <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token keyword">char</span><span class="token punctuation">[</span><span class="token function">strlen</span><span class="token punctuation">(</span>t<span class="token punctuation">.</span>p<span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
		<span class="token function">strcpy_s</span><span class="token punctuation">(</span>p<span class="token punctuation">,</span><span class="token function">strlen</span><span class="token punctuation">(</span>p<span class="token punctuation">)</span><span class="token punctuation">,</span>t<span class="token punctuation">.</span>p<span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">&quot;Test const cntr.%s\n&quot;</span><span class="token punctuation">,</span> p<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>

	<span class="token operator">~</span><span class="token function">Test</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
		<span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">&quot;~Test cntr.%s\n&quot;</span><span class="token punctuation">,</span> p<span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token keyword">delete</span><span class="token punctuation">[</span><span class="token punctuation">]</span>p<span class="token punctuation">;</span>
		p <span class="token operator">=</span> <span class="token constant">NULL</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
	Test <span class="token function">t1</span><span class="token punctuation">(</span><span class="token string">&quot;hello&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	Test <span class="token function">t2</span><span class="token punctuation">(</span>t1<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br></div></div><h2 id="_5-52-总结"><a href="#_5-52-总结" class="header-anchor">#</a> 5.52 总结</h2> <ul><li><p>编译器默认的拷贝类型是浅拷贝</p></li> <li><p>不自定义拷贝的话，默认拷贝所有成员变量</p></li> <li><p>如果成员变量是指针的话，拷贝指针地址。这会引起混乱。可能会引起空间多次free问题</p></li> <li><p>如果需要实现深拷贝，要自定义深拷贝函数</p></li> <li><p>将指针指向的成员变量，拷贝到新的内存空间</p></li></ul> <h2 id="_5-53-对象类型的参数和返回值"><a href="#_5-53-对象类型的参数和返回值" class="header-anchor">#</a> 5.53 对象类型的参数和返回值</h2> <ul><li>使用对象类型作为函数的参数或者返回值，可能会产生一些不必要的中间对象</li></ul> <div class="language-cpp line-numbers-mode"><pre class="language-cpp"><code><span class="token keyword">class</span> <span class="token class-name">Car</span>
<span class="token punctuation">{</span>
	<span class="token keyword">int</span> m_price<span class="token punctuation">;</span>
	<span class="token keyword">char</span><span class="token operator">*</span> m_name<span class="token punctuation">;</span>
<span class="token keyword">public</span><span class="token operator">:</span>
	<span class="token function">Car</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
		cout <span class="token operator">&lt;&lt;</span> <span class="token string">&quot;Car() - &quot;</span> <span class="token operator">&lt;&lt;</span> <span class="token keyword">this</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
	<span class="token punctuation">}</span>

	<span class="token function">Car</span><span class="token punctuation">(</span><span class="token keyword">const</span> Car <span class="token operator">&amp;</span>car<span class="token punctuation">)</span> <span class="token punctuation">{</span>
		cout <span class="token operator">&lt;&lt;</span> <span class="token string">&quot;Car(const Car &amp;) -&quot;</span> <span class="token operator">&lt;&lt;</span> <span class="token keyword">this</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
	
	<span class="token keyword">void</span> <span class="token function">run</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
		cout <span class="token operator">&lt;&lt;</span> <span class="token string">&quot;run()&quot;</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
	<span class="token operator">~</span><span class="token function">Car</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token comment">//Car car1 = car。会调用拷贝函数。可以使用引用或者指针</span>
<span class="token keyword">void</span> <span class="token function">test</span><span class="token punctuation">(</span>Car car1<span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
	Car car<span class="token punctuation">;</span>
	<span class="token function">test</span><span class="token punctuation">(</span>car<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token function">getchar</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token comment">//两个地址不一样</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br></div></div><ul><li><p>C++一般写引用和指针传参，不用对象传参</p> <div class="language-cpp line-numbers-mode"><pre class="language-cpp"><code><span class="token keyword">class</span> <span class="token class-name">Car</span>
<span class="token punctuation">{</span>
	<span class="token keyword">int</span> m_price<span class="token punctuation">;</span>
	<span class="token keyword">char</span><span class="token operator">*</span> m_name<span class="token punctuation">;</span>
<span class="token keyword">public</span><span class="token operator">:</span>
	<span class="token function">Car</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
		cout <span class="token operator">&lt;&lt;</span> <span class="token string">&quot;Car() - &quot;</span> <span class="token operator">&lt;&lt;</span> <span class="token keyword">this</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
	<span class="token punctuation">}</span>

	<span class="token function">Car</span><span class="token punctuation">(</span><span class="token keyword">const</span> Car <span class="token operator">&amp;</span>car<span class="token punctuation">)</span> <span class="token punctuation">{</span>
		cout <span class="token operator">&lt;&lt;</span> <span class="token string">&quot;Car(const Car &amp;) -&quot;</span> <span class="token operator">&lt;&lt;</span> <span class="token keyword">this</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
	
	<span class="token keyword">void</span> <span class="token function">run</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
		cout <span class="token operator">&lt;&lt;</span> <span class="token string">&quot;run()&quot;</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
	<span class="token operator">~</span><span class="token function">Car</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token comment">//Car car1 = car。会调用拷贝函数。可以使用引用或者指针</span>
<span class="token keyword">void</span> <span class="token function">test</span><span class="token punctuation">(</span>Car <span class="token operator">&amp;</span>car1<span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
	Car car<span class="token punctuation">;</span>
	<span class="token function">test</span><span class="token punctuation">(</span>car<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token function">getchar</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token comment">//两个地址不一样</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br></div></div></li> <li><p>使用函数作为返回值</p> <p><img alt="Untitled" data-src="MJ%E5%A4%A7%E7%A5%9EC++%E5%9F%BA%E6%9C%AC%E7%9F%A5%E8%AF%86%20f9db4087ded4475a8eee4346f9dd1a31/Untitled%2018.png" loading="lazy" class="lazy"></p></li></ul> <h2 id="_5-54-匿名对象-临时对象"><a href="#_5-54-匿名对象-临时对象" class="header-anchor">#</a> 5.54 匿名对象（临时对象）</h2> <ul><li><p>没有变量名，没有被指针指向的对象，调用完马上调用析构。</p> <div class="language-cpp line-numbers-mode"><pre class="language-cpp"><code><span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>

	<span class="token function">Car</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div></li></ul> <h2 id="_5-55-隐式构造、explicit"><a href="#_5-55-隐式构造、explicit" class="header-anchor">#</a> 5.55 隐式构造、explicit</h2> <ul><li><p>某些情况下，会调用单参数的构造函数</p> <div class="language-cpp line-numbers-mode"><pre class="language-cpp"><code><span class="token keyword">class</span> <span class="token class-name">Car</span>
<span class="token punctuation">{</span>
	<span class="token keyword">int</span> m_price<span class="token punctuation">;</span>
	<span class="token keyword">char</span><span class="token operator">*</span> m_name<span class="token punctuation">;</span>
<span class="token keyword">public</span><span class="token operator">:</span>
	<span class="token function">Car</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
		cout <span class="token operator">&lt;&lt;</span> <span class="token string">&quot;Car() - &quot;</span> <span class="token operator">&lt;&lt;</span> <span class="token keyword">this</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
	
	<span class="token operator">~</span><span class="token function">Car</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
		cout <span class="token operator">&lt;&lt;</span> <span class="token string">&quot;~Car() - &quot;</span> <span class="token operator">&lt;&lt;</span> <span class="token keyword">this</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
	<span class="token punctuation">}</span>

	<span class="token function">Car</span><span class="token punctuation">(</span><span class="token keyword">int</span> price<span class="token punctuation">)</span><span class="token punctuation">{</span><span class="token punctuation">}</span>

	<span class="token function">Car</span><span class="token punctuation">(</span><span class="token keyword">const</span> Car <span class="token operator">&amp;</span>car<span class="token punctuation">)</span> <span class="token punctuation">{</span>
		cout <span class="token operator">&lt;&lt;</span> <span class="token string">&quot;Car(const Car &amp;) -&quot;</span> <span class="token operator">&lt;&lt;</span> <span class="token keyword">this</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
	
	<span class="token keyword">void</span> <span class="token function">run</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
		cout <span class="token operator">&lt;&lt;</span> <span class="token string">&quot;run()&quot;</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token comment">//Car car1 = car。会调用拷贝函数</span>
<span class="token keyword">void</span> <span class="token function">test</span><span class="token punctuation">(</span>Car <span class="token operator">&amp;</span>car1<span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">;</span>

Car <span class="token function">test1</span><span class="token punctuation">(</span>Car car<span class="token punctuation">)</span><span class="token punctuation">{</span>
	Car car<span class="token punctuation">;</span>
	<span class="token keyword">return</span> car<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>

	<span class="token comment">//调用无参构造</span>
	Car car<span class="token punctuation">;</span>
	<span class="token comment">//调用一个参数的构造</span>
	Car <span class="token function">car1</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token comment">//调用引用构造</span>
	Car car2 <span class="token operator">=</span> car<span class="token punctuation">;</span>
	<span class="token comment">//调用一个参数的构造。相当于Car car3(20);</span>
	Car car3 <span class="token operator">=</span> <span class="token number">20</span><span class="token punctuation">;</span>
	<span class="token comment">//相当于Car（20）</span>
	<span class="token function">test</span><span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br></div></div></li> <li><p>可以通过关键字explicit禁止掉隐式构造</p> <div class="language-cpp line-numbers-mode"><pre class="language-cpp"><code><span class="token keyword">explicit</span> <span class="token function">Car</span><span class="token punctuation">(</span><span class="token keyword">int</span> price<span class="token punctuation">)</span><span class="token punctuation">{</span><span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div></li></ul> <h2 id="_5-56-编译器自动生成的构造函数"><a href="#_5-56-编译器自动生成的构造函数" class="header-anchor">#</a> 5.56 编译器自动生成的构造函数</h2> <ul><li><p>某些情况下，编译器会给类生成无参构造函数。</p> <ul><li>成员变量在声明的同时进行了初始化
<ul><li><code>int a = 10</code></li></ul></li> <li>有定义虚函数
<ul><li><code>virtual void run(){}</code></li> <li>一旦是虚函数，前头会添加4个字节的虚表地址</li></ul></li> <li>虚继承了其它类
<ul><li><code>void student : virtural person (){}</code></li></ul></li> <li>包含了对象类型的成员，且这个成员有构造函数（编译器生成或自定义）</li> <li>父类有构造函数（编译器生成或自定义）</li></ul></li> <li><p>对象创建完成之后，还需要一些额外的操作，比如初始化成员变量，这个时候编译器会自动生成构造函数</p></li></ul> <h2 id="_5-57-友元"><a href="#_5-57-友元" class="header-anchor">#</a> 5.57 友元</h2> <ul><li><p>友元函数</p> <ul><li>如果函数A是函数B的友元函数，函数A可以访问函数B的任何函数变量</li> <li>把要访问的声明添加到被访问类中的任何地方，一般写在private下面，这样比较清晰。</li></ul> <div class="language-cpp line-numbers-mode"><pre class="language-cpp"><code><span class="token keyword">class</span> <span class="token class-name">Point</span> <span class="token punctuation">{</span>
<span class="token keyword">private</span><span class="token operator">:</span>
	<span class="token keyword">int</span> m_x<span class="token punctuation">;</span>
	<span class="token keyword">int</span> m_y<span class="token punctuation">;</span>
<span class="token keyword">public</span><span class="token operator">:</span>
	<span class="token function">Point</span><span class="token punctuation">(</span><span class="token keyword">int</span> x<span class="token punctuation">,</span> <span class="token keyword">int</span> y<span class="token punctuation">)</span> <span class="token operator">:</span> <span class="token function">m_x</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">m_y</span><span class="token punctuation">(</span>y<span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
	<span class="token keyword">int</span> <span class="token function">getX</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token keyword">return</span> m_x<span class="token punctuation">;</span> <span class="token punctuation">}</span><span class="token punctuation">;</span>
	<span class="token keyword">int</span> <span class="token function">getY</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token keyword">return</span> m_y<span class="token punctuation">;</span> <span class="token punctuation">}</span><span class="token punctuation">;</span>
	<span class="token keyword">void</span> <span class="token function">display</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
		cout <span class="token operator">&lt;&lt;</span> <span class="token string">&quot;(&quot;</span> <span class="token operator">&lt;&lt;</span> m_x <span class="token operator">&lt;&lt;</span><span class="token string">&quot;,&quot;</span> <span class="token operator">&lt;&lt;</span> m_y <span class="token operator">&lt;&lt;</span> <span class="token string">&quot;)&quot;</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
	<span class="token punctuation">}</span>

	
<span class="token punctuation">}</span><span class="token punctuation">;</span>
Point <span class="token function">add</span><span class="token punctuation">(</span>Point p1<span class="token punctuation">,</span> Point p2<span class="token punctuation">)</span> <span class="token punctuation">{</span>
	<span class="token keyword">int</span> x <span class="token operator">=</span> <span class="token punctuation">(</span>p1<span class="token punctuation">.</span><span class="token function">getX</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> p2<span class="token punctuation">.</span><span class="token function">getX</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">/</span> <span class="token number">2</span><span class="token punctuation">;</span>
	<span class="token keyword">int</span> y <span class="token operator">=</span> <span class="token punctuation">(</span>p1<span class="token punctuation">.</span><span class="token function">getY</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> p2<span class="token punctuation">.</span><span class="token function">getY</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">/</span> <span class="token number">2</span><span class="token punctuation">;</span>
	<span class="token keyword">return</span> <span class="token function">Point</span><span class="token punctuation">(</span>x<span class="token punctuation">,</span> y<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
	Point <span class="token function">p1</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	Point <span class="token function">p2</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	Point p3 <span class="token operator">=</span> <span class="token function">add</span><span class="token punctuation">(</span>p1<span class="token punctuation">,</span> p2<span class="token punctuation">)</span><span class="token punctuation">;</span>
	p3<span class="token punctuation">.</span><span class="token function">display</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br></div></div><ul><li>友元函数</li></ul> <div class="language-cpp line-numbers-mode"><pre class="language-cpp"><code><span class="token keyword">class</span> <span class="token class-name">Point</span> <span class="token punctuation">{</span>
<span class="token keyword">private</span><span class="token operator">:</span>
	<span class="token keyword">friend</span> Point <span class="token function">add</span><span class="token punctuation">(</span>Point p1<span class="token punctuation">,</span> Point p2<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token keyword">int</span> m_x<span class="token punctuation">;</span>
	<span class="token keyword">int</span> m_y<span class="token punctuation">;</span>
<span class="token keyword">public</span><span class="token operator">:</span>
	<span class="token function">Point</span><span class="token punctuation">(</span><span class="token keyword">int</span> x<span class="token punctuation">,</span> <span class="token keyword">int</span> y<span class="token punctuation">)</span> <span class="token operator">:</span> <span class="token function">m_x</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">m_y</span><span class="token punctuation">(</span>y<span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
	<span class="token keyword">int</span> <span class="token function">getX</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token keyword">return</span> m_x<span class="token punctuation">;</span> <span class="token punctuation">}</span><span class="token punctuation">;</span>
	<span class="token keyword">int</span> <span class="token function">getY</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token keyword">return</span> m_y<span class="token punctuation">;</span> <span class="token punctuation">}</span><span class="token punctuation">;</span>
	<span class="token keyword">void</span> <span class="token function">display</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
		cout <span class="token operator">&lt;&lt;</span> <span class="token string">&quot;(&quot;</span> <span class="token operator">&lt;&lt;</span> m_x <span class="token operator">&lt;&lt;</span><span class="token string">&quot;,&quot;</span> <span class="token operator">&lt;&lt;</span> m_y <span class="token operator">&lt;&lt;</span> <span class="token string">&quot;)&quot;</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
	<span class="token punctuation">}</span>

	
<span class="token punctuation">}</span><span class="token punctuation">;</span>
Point <span class="token function">add</span><span class="token punctuation">(</span>Point p1<span class="token punctuation">,</span> Point p2<span class="token punctuation">)</span> <span class="token punctuation">{</span>
<span class="token comment">//可以访问私有的成员变量</span>
	<span class="token keyword">int</span> x <span class="token operator">=</span> <span class="token punctuation">(</span>p1<span class="token punctuation">.</span>m_x <span class="token operator">+</span> p2<span class="token punctuation">.</span>m_x<span class="token punctuation">)</span> <span class="token operator">/</span> <span class="token number">2</span><span class="token punctuation">;</span>
	<span class="token keyword">int</span> y <span class="token operator">=</span> <span class="token punctuation">(</span>p1<span class="token punctuation">.</span>m_y <span class="token operator">+</span> p2<span class="token punctuation">.</span>m_y<span class="token punctuation">)</span> <span class="token operator">/</span> <span class="token number">2</span><span class="token punctuation">;</span>
	<span class="token keyword">return</span> <span class="token function">Point</span><span class="token punctuation">(</span>x<span class="token punctuation">,</span> y<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
	Point <span class="token function">p1</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	Point <span class="token function">p2</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	Point p3 <span class="token operator">=</span> <span class="token function">add</span><span class="token punctuation">(</span>p1<span class="token punctuation">,</span> p2<span class="token punctuation">)</span><span class="token punctuation">;</span>
	p3<span class="token punctuation">.</span><span class="token function">display</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br></div></div></li> <li><p>友元类</p> <ul><li>友元类就是友元类，友元函数就是友元函数</li> <li>虽然破坏了函数的封装性，但是提高了程序的运行速度</li></ul> <div class="language-cpp line-numbers-mode"><pre class="language-cpp"><code><span class="token keyword">class</span> <span class="token class-name">Point</span> <span class="token punctuation">{</span>
<span class="token keyword">private</span><span class="token operator">:</span>
	<span class="token keyword">friend</span> <span class="token keyword">class</span> <span class="token class-name">Math</span><span class="token punctuation">;</span>
	<span class="token keyword">int</span> m_x<span class="token punctuation">;</span>
	<span class="token keyword">int</span> m_y<span class="token punctuation">;</span>
<span class="token keyword">public</span><span class="token operator">:</span>
	<span class="token function">Point</span><span class="token punctuation">(</span><span class="token keyword">int</span> x<span class="token punctuation">,</span> <span class="token keyword">int</span> y<span class="token punctuation">)</span> <span class="token operator">:</span> <span class="token function">m_x</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">m_y</span><span class="token punctuation">(</span>y<span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
	<span class="token keyword">int</span> <span class="token function">getX</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token keyword">return</span> m_x<span class="token punctuation">;</span> <span class="token punctuation">}</span><span class="token punctuation">;</span>
	<span class="token keyword">int</span> <span class="token function">getY</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token keyword">return</span> m_y<span class="token punctuation">;</span> <span class="token punctuation">}</span><span class="token punctuation">;</span>
	<span class="token keyword">void</span> <span class="token function">display</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
		cout <span class="token operator">&lt;&lt;</span> <span class="token string">&quot;(&quot;</span> <span class="token operator">&lt;&lt;</span> m_x <span class="token operator">&lt;&lt;</span><span class="token string">&quot;,&quot;</span> <span class="token operator">&lt;&lt;</span> m_y <span class="token operator">&lt;&lt;</span> <span class="token string">&quot;)&quot;</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
	<span class="token punctuation">}</span>

	
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token keyword">class</span> <span class="token class-name">Math</span>
<span class="token punctuation">{</span>
<span class="token keyword">public</span><span class="token operator">:</span>
	<span class="token keyword">static</span> Point <span class="token function">add</span><span class="token punctuation">(</span>Point p1<span class="token punctuation">,</span> Point p2<span class="token punctuation">)</span> <span class="token punctuation">{</span>
		<span class="token keyword">int</span> x <span class="token operator">=</span> <span class="token punctuation">(</span>p1<span class="token punctuation">.</span>m_x <span class="token operator">+</span> p2<span class="token punctuation">.</span>m_x<span class="token punctuation">)</span> <span class="token operator">/</span> <span class="token number">2</span><span class="token punctuation">;</span>
		<span class="token keyword">int</span> y <span class="token operator">=</span> <span class="token punctuation">(</span>p1<span class="token punctuation">.</span>m_y <span class="token operator">+</span> p2<span class="token punctuation">.</span>m_y<span class="token punctuation">)</span> <span class="token operator">/</span> <span class="token number">2</span><span class="token punctuation">;</span>
		<span class="token keyword">return</span> <span class="token function">Point</span><span class="token punctuation">(</span>x<span class="token punctuation">,</span> y<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
	Point <span class="token function">p1</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	Point <span class="token function">p2</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	Point p3 <span class="token operator">=</span> <span class="token class-name">Math</span><span class="token double-colon punctuation">::</span><span class="token function">add</span><span class="token punctuation">(</span>p1<span class="token punctuation">,</span> p2<span class="token punctuation">)</span><span class="token punctuation">;</span>
	p3<span class="token punctuation">.</span><span class="token function">display</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br></div></div></li></ul> <h2 id="_5-58-内部类"><a href="#_5-58-内部类" class="header-anchor">#</a> 5.58 内部类</h2> <ul><li>如果A类定义在B类的类体中，可以称A类是B类的内部类。</li> <li>特点
<ul><li>支持public，private，protect权限</li> <li>成员函数可以访问外部类的所有成员</li> <li>成员函数可以不带类名的访问其外部类的static成员</li> <li>不会影响外部类的内存布局</li> <li>可以定义和实现分离</li></ul></li></ul> <h2 id="_5-59-局部类"><a href="#_5-59-局部类" class="header-anchor">#</a> 5.59 局部类</h2> <ul><li>在一个函数体内部的类，称之为局部类</li> <li>特点
<ul><li>作用域仅在函数体内部</li> <li>其所有定义必须在函数体内部，不允许使用static修饰</li> <li>成员函数不能直接访问函数的局部变量（static变量除外）</li></ul></li></ul> <h1 id="_6-其它语法"><a href="#_6-其它语法" class="header-anchor">#</a> 6.其它语法</h1> <h2 id="_6-1-运算符重载1"><a href="#_6-1-运算符重载1" class="header-anchor">#</a> 6.1 运算符重载1</h2> <ul><li><p>可以为运算符添加一些新的功能</p> <div class="language-cpp line-numbers-mode"><pre class="language-cpp"><code><span class="token keyword">class</span> <span class="token class-name">Point</span> <span class="token punctuation">{</span>
<span class="token keyword">private</span><span class="token operator">:</span>
	<span class="token keyword">friend</span> Point <span class="token keyword">operator</span><span class="token operator">+</span> <span class="token punctuation">(</span>Point p1<span class="token punctuation">,</span> Point p2<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token keyword">int</span> m_x<span class="token punctuation">;</span>
	<span class="token keyword">int</span> m_y<span class="token punctuation">;</span>
<span class="token keyword">public</span><span class="token operator">:</span>
	<span class="token function">Point</span><span class="token punctuation">(</span><span class="token keyword">int</span> x<span class="token punctuation">,</span> <span class="token keyword">int</span> y<span class="token punctuation">)</span> <span class="token operator">:</span> <span class="token function">m_x</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">m_y</span><span class="token punctuation">(</span>y<span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
	<span class="token keyword">int</span> <span class="token function">getX</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token keyword">return</span> m_x<span class="token punctuation">;</span> <span class="token punctuation">}</span><span class="token punctuation">;</span>
	<span class="token keyword">int</span> <span class="token function">getY</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token keyword">return</span> m_y<span class="token punctuation">;</span> <span class="token punctuation">}</span><span class="token punctuation">;</span>
	<span class="token keyword">void</span> <span class="token function">display</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
		cout <span class="token operator">&lt;&lt;</span> <span class="token string">&quot;(&quot;</span> <span class="token operator">&lt;&lt;</span> m_x <span class="token operator">&lt;&lt;</span><span class="token string">&quot;,&quot;</span> <span class="token operator">&lt;&lt;</span> m_y <span class="token operator">&lt;&lt;</span> <span class="token string">&quot;)&quot;</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
	<span class="token punctuation">}</span>

	
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token comment">//这样做会产生中间值</span>
Point <span class="token keyword">operator</span><span class="token operator">+</span> <span class="token punctuation">(</span>Point p1<span class="token punctuation">,</span> Point p2<span class="token punctuation">)</span> <span class="token punctuation">{</span>
	<span class="token keyword">return</span> <span class="token function">Point</span><span class="token punctuation">(</span>p1<span class="token punctuation">.</span><span class="token function">getX</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> p2<span class="token punctuation">.</span><span class="token function">getX</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> p1<span class="token punctuation">.</span><span class="token function">getY</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> p2<span class="token punctuation">.</span><span class="token function">getY</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
	Point <span class="token function">p1</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	Point <span class="token function">p2</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	Point p3 <span class="token operator">=</span> p1<span class="token operator">+</span>p2<span class="token punctuation">;</span>
	p3<span class="token punctuation">.</span><span class="token function">display</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br></div></div></li></ul> <h2 id="_6-2-运算符重载2-完善"><a href="#_6-2-运算符重载2-完善" class="header-anchor">#</a> 6.2 运算符重载2-完善</h2> <ul><li>完善1</li></ul> <div class="language-cpp line-numbers-mode"><pre class="language-cpp"><code><span class="token keyword">class</span> <span class="token class-name">Point</span> <span class="token punctuation">{</span>
<span class="token keyword">private</span><span class="token operator">:</span>
	<span class="token keyword">friend</span> Point <span class="token keyword">operator</span><span class="token operator">+</span> <span class="token punctuation">(</span><span class="token keyword">const</span> Point<span class="token operator">&amp;</span> p1<span class="token punctuation">,</span> <span class="token keyword">const</span> Point<span class="token operator">&amp;</span> p2<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token keyword">int</span> m_x<span class="token punctuation">;</span>
	<span class="token keyword">int</span> m_y<span class="token punctuation">;</span>
<span class="token keyword">public</span><span class="token operator">:</span>
	<span class="token function">Point</span><span class="token punctuation">(</span><span class="token keyword">int</span> x<span class="token punctuation">,</span> <span class="token keyword">int</span> y<span class="token punctuation">)</span> <span class="token operator">:</span> <span class="token function">m_x</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">m_y</span><span class="token punctuation">(</span>y<span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
	<span class="token keyword">int</span> <span class="token function">getX</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token keyword">return</span> m_x<span class="token punctuation">;</span> <span class="token punctuation">}</span><span class="token punctuation">;</span>
	<span class="token keyword">int</span> <span class="token function">getY</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token keyword">return</span> m_y<span class="token punctuation">;</span> <span class="token punctuation">}</span><span class="token punctuation">;</span>
	<span class="token keyword">void</span> <span class="token function">display</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
		cout <span class="token operator">&lt;&lt;</span> <span class="token string">&quot;(&quot;</span> <span class="token operator">&lt;&lt;</span> m_x <span class="token operator">&lt;&lt;</span><span class="token string">&quot;,&quot;</span> <span class="token operator">&lt;&lt;</span> m_y <span class="token operator">&lt;&lt;</span> <span class="token string">&quot;)&quot;</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
	<span class="token punctuation">}</span>

	
<span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token comment">//用引用来接受，可以避免中间量的产生</span>
<span class="token comment">//用const来修饰，可以同时修饰const和非const</span>
Point <span class="token keyword">operator</span><span class="token operator">+</span> <span class="token punctuation">(</span><span class="token keyword">const</span> Point <span class="token operator">&amp;</span>p1<span class="token punctuation">,</span> <span class="token keyword">const</span> Point <span class="token operator">&amp;</span>p2<span class="token punctuation">)</span> <span class="token punctuation">{</span>
	<span class="token keyword">return</span> <span class="token function">Point</span><span class="token punctuation">(</span>p1<span class="token punctuation">.</span>m_x<span class="token operator">+</span>p2<span class="token punctuation">.</span>m_x<span class="token punctuation">,</span>p1<span class="token punctuation">.</span>m_y<span class="token operator">+</span>p2<span class="token punctuation">.</span>m_y<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
	<span class="token keyword">const</span> Point <span class="token function">p1</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	Point <span class="token function">p2</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	Point p3 <span class="token operator">=</span> p1<span class="token operator">+</span>p2<span class="token punctuation">;</span>
	Point p3 <span class="token operator">=</span> p1<span class="token operator">+</span>p2<span class="token operator">+</span>p3<span class="token punctuation">;</span>
	p3<span class="token punctuation">.</span><span class="token function">display</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br></div></div><ul><li>完善2</li></ul> <div class="language-cpp line-numbers-mode"><pre class="language-cpp"><code><span class="token keyword">class</span> <span class="token class-name">Point</span> <span class="token punctuation">{</span>
<span class="token keyword">private</span><span class="token operator">:</span>
	<span class="token keyword">int</span> m_x<span class="token punctuation">;</span>
	<span class="token keyword">int</span> m_y<span class="token punctuation">;</span>
<span class="token keyword">public</span><span class="token operator">:</span>
	<span class="token function">Point</span><span class="token punctuation">(</span><span class="token keyword">int</span> x<span class="token punctuation">,</span> <span class="token keyword">int</span> y<span class="token punctuation">)</span> <span class="token operator">:</span> <span class="token function">m_x</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">m_y</span><span class="token punctuation">(</span>y<span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
	
	<span class="token keyword">int</span> <span class="token function">getX</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token keyword">return</span> m_x<span class="token punctuation">;</span> <span class="token punctuation">}</span><span class="token punctuation">;</span>
	<span class="token keyword">int</span> <span class="token function">getY</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token keyword">return</span> m_y<span class="token punctuation">;</span> <span class="token punctuation">}</span><span class="token punctuation">;</span>
	
	<span class="token keyword">void</span> <span class="token function">display</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
		cout <span class="token operator">&lt;&lt;</span> <span class="token string">&quot;(&quot;</span> <span class="token operator">&lt;&lt;</span> m_x <span class="token operator">&lt;&lt;</span><span class="token string">&quot;,&quot;</span> <span class="token operator">&lt;&lt;</span> m_y <span class="token operator">&lt;&lt;</span> <span class="token string">&quot;)&quot;</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
	<span class="token punctuation">}</span>

	Point <span class="token keyword">operator</span><span class="token operator">+</span> <span class="token punctuation">(</span><span class="token keyword">const</span> Point<span class="token operator">&amp;</span> p1<span class="token punctuation">)</span> <span class="token punctuation">{</span>
		<span class="token comment">//this.m_x + p1.m_x</span>
		<span class="token keyword">return</span> <span class="token function">Point</span><span class="token punctuation">(</span>m_x <span class="token operator">+</span> p1<span class="token punctuation">.</span>m_x<span class="token punctuation">,</span> m_y <span class="token operator">+</span> p1<span class="token punctuation">.</span>m_y<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
	Point <span class="token function">p1</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	Point <span class="token function">p2</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	Point <span class="token function">p3</span><span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token comment">//本质是p1.operator+(p2)</span>
	Point p4 <span class="token operator">=</span> p1 <span class="token operator">+</span> p2 <span class="token operator">+</span> p3<span class="token punctuation">;</span>
	p4<span class="token punctuation">.</span><span class="token function">display</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br></div></div><h2 id="_6-3-运算符重载3-更多运算符。"><a href="#_6-3-运算符重载3-更多运算符。" class="header-anchor">#</a> 6.3 运算符重载3-更多运算符。</h2> <ul><li>重载+、-、</li></ul> <div class="language-cpp line-numbers-mode"><pre class="language-cpp"><code><span class="token keyword">class</span> <span class="token class-name">Point</span> <span class="token punctuation">{</span>
<span class="token keyword">private</span><span class="token operator">:</span>
	<span class="token keyword">int</span> m_x<span class="token punctuation">;</span>
	<span class="token keyword">int</span> m_y<span class="token punctuation">;</span>
<span class="token keyword">public</span><span class="token operator">:</span>
	<span class="token function">Point</span><span class="token punctuation">(</span><span class="token keyword">int</span> x<span class="token punctuation">,</span> <span class="token keyword">int</span> y<span class="token punctuation">)</span> <span class="token operator">:</span> <span class="token function">m_x</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">m_y</span><span class="token punctuation">(</span>y<span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
	
	<span class="token keyword">int</span> <span class="token function">getX</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token keyword">return</span> m_x<span class="token punctuation">;</span> <span class="token punctuation">}</span><span class="token punctuation">;</span>
	<span class="token keyword">int</span> <span class="token function">getY</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token keyword">return</span> m_y<span class="token punctuation">;</span> <span class="token punctuation">}</span><span class="token punctuation">;</span>
	
	<span class="token keyword">void</span> <span class="token function">display</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
		cout <span class="token operator">&lt;&lt;</span> <span class="token string">&quot;(&quot;</span> <span class="token operator">&lt;&lt;</span> m_x <span class="token operator">&lt;&lt;</span><span class="token string">&quot;,&quot;</span> <span class="token operator">&lt;&lt;</span> m_y <span class="token operator">&lt;&lt;</span> <span class="token string">&quot;)&quot;</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
	<span class="token punctuation">}</span>

	<span class="token comment">//函数开头的 const 用来修饰函数的返回值，表示返回值是 const 类型，也就是不能被修改，例如const char* getname()。</span>
	<span class="token comment">//函数头部的结尾加上 const 表示常成员函数，这种函数只能读取成员变量的值，而不能修改成员变量的值，例如char* getname() const。</span>
	<span class="token keyword">const</span> Point <span class="token keyword">operator</span><span class="token operator">+</span> <span class="token punctuation">(</span><span class="token keyword">const</span> Point<span class="token operator">&amp;</span> p1<span class="token punctuation">)</span> <span class="token keyword">const</span><span class="token punctuation">{</span>
		<span class="token comment">//this.m_x + p1.m_x</span>
		<span class="token keyword">return</span> <span class="token function">Point</span><span class="token punctuation">(</span>m_x <span class="token operator">+</span> p1<span class="token punctuation">.</span>m_x<span class="token punctuation">,</span> m_y <span class="token operator">+</span> p1<span class="token punctuation">.</span>m_y<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
	<span class="token keyword">const</span> Point <span class="token function">p1</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	Point <span class="token function">p2</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	Point <span class="token function">p3</span><span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token comment">//本质是p1.operator+(p2).operator(p3)</span>
	Point p4 <span class="token operator">=</span> p1 <span class="token operator">+</span> p2 <span class="token operator">+</span> p3<span class="token punctuation">;</span>
	p4<span class="token punctuation">.</span><span class="token function">display</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br></div></div><ul><li><p>重载+=、==、!=、负号、++、--、&lt;&lt;、&gt;&gt;</p> <div class="language-cpp line-numbers-mode"><pre class="language-cpp"><code><span class="token keyword">class</span> <span class="token class-name">Point</span> <span class="token punctuation">{</span>
<span class="token keyword">private</span><span class="token operator">:</span>
	<span class="token comment">//friend void operator&lt;&lt;(ostream&amp; cout, const Point&amp; p);</span>
	<span class="token keyword">friend</span> ostream<span class="token operator">&amp;</span> <span class="token keyword">operator</span><span class="token operator">&lt;&lt;</span><span class="token punctuation">(</span>ostream<span class="token operator">&amp;</span> cout<span class="token punctuation">,</span> <span class="token keyword">const</span> Point<span class="token operator">&amp;</span> p<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token keyword">friend</span> istream<span class="token operator">&amp;</span> <span class="token keyword">operator</span><span class="token operator">&gt;&gt;</span><span class="token punctuation">(</span>istream<span class="token operator">&amp;</span> cin<span class="token punctuation">,</span> Point<span class="token operator">&amp;</span> p<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token keyword">int</span> m_x<span class="token punctuation">;</span>
	<span class="token keyword">int</span> m_y<span class="token punctuation">;</span>
<span class="token keyword">public</span><span class="token operator">:</span>
	<span class="token function">Point</span><span class="token punctuation">(</span><span class="token keyword">int</span> x<span class="token punctuation">,</span> <span class="token keyword">int</span> y<span class="token punctuation">)</span> <span class="token operator">:</span> <span class="token function">m_x</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">m_y</span><span class="token punctuation">(</span>y<span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
	
	<span class="token keyword">int</span> <span class="token function">getX</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token keyword">return</span> m_x<span class="token punctuation">;</span> <span class="token punctuation">}</span><span class="token punctuation">;</span>
	<span class="token keyword">int</span> <span class="token function">getY</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token keyword">return</span> m_y<span class="token punctuation">;</span> <span class="token punctuation">}</span><span class="token punctuation">;</span>
	
	<span class="token keyword">void</span> <span class="token function">display</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
		cout <span class="token operator">&lt;&lt;</span> <span class="token string">&quot;(&quot;</span> <span class="token operator">&lt;&lt;</span> m_x <span class="token operator">&lt;&lt;</span><span class="token string">&quot;,&quot;</span> <span class="token operator">&lt;&lt;</span> m_y <span class="token operator">&lt;&lt;</span> <span class="token string">&quot;)&quot;</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
	<span class="token punctuation">}</span>

	<span class="token comment">//函数开头的 const 用来修饰函数的返回值，表示返回值是 const 类型，也就是不能被修改，例如const char* getname()。</span>
	<span class="token comment">//函数头部的结尾加上 const 表示常成员函数，这种函数只能读取成员变量的值，而不能修改成员变量的值，例如char* getname() const。</span>
	<span class="token keyword">const</span> Point <span class="token keyword">operator</span><span class="token operator">+</span> <span class="token punctuation">(</span><span class="token keyword">const</span> Point<span class="token operator">&amp;</span> p1<span class="token punctuation">)</span> <span class="token keyword">const</span><span class="token punctuation">{</span>
		<span class="token comment">//this.m_x + p1.m_x</span>
		<span class="token keyword">return</span> <span class="token function">Point</span><span class="token punctuation">(</span>m_x <span class="token operator">+</span> p1<span class="token punctuation">.</span>m_x<span class="token punctuation">,</span> m_y <span class="token operator">+</span> p1<span class="token punctuation">.</span>m_y<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>

	 <span class="token keyword">const</span> Point <span class="token keyword">operator</span><span class="token operator">-</span><span class="token punctuation">(</span><span class="token keyword">const</span> Point<span class="token operator">&amp;</span> p1<span class="token punctuation">)</span> <span class="token keyword">const</span><span class="token punctuation">{</span>
		<span class="token keyword">return</span> <span class="token function">Point</span><span class="token punctuation">(</span>m_x <span class="token operator">-</span> p1<span class="token punctuation">.</span>m_x<span class="token punctuation">,</span> m_y <span class="token operator">-</span> p1<span class="token punctuation">.</span>m_y<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>

	 Point <span class="token operator">&amp;</span><span class="token keyword">operator</span><span class="token operator">+=</span><span class="token punctuation">(</span><span class="token keyword">const</span> Point <span class="token operator">&amp;</span>p1<span class="token punctuation">)</span> <span class="token punctuation">{</span>
		 m_x <span class="token operator">+=</span> p1<span class="token punctuation">.</span>m_x<span class="token punctuation">;</span>
		 m_y <span class="token operator">+=</span> p1<span class="token punctuation">.</span>m_y<span class="token punctuation">;</span>		
		 <span class="token keyword">return</span> <span class="token operator">*</span><span class="token keyword">this</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>

	 <span class="token keyword">bool</span> <span class="token keyword">operator</span><span class="token operator">==</span><span class="token punctuation">(</span><span class="token keyword">const</span> Point<span class="token operator">&amp;</span> p<span class="token punctuation">)</span> <span class="token punctuation">{</span>
		 <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>m_x<span class="token operator">==</span>p<span class="token punctuation">.</span>m_x<span class="token punctuation">)</span><span class="token operator">&amp;&amp;</span> <span class="token punctuation">(</span>m_x <span class="token operator">==</span> p<span class="token punctuation">.</span>m_x<span class="token punctuation">)</span><span class="token punctuation">)</span>
		 <span class="token punctuation">{</span>
			 <span class="token keyword">return</span> <span class="token number">1</span><span class="token punctuation">;</span>
		 <span class="token punctuation">}</span>
		 <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
	 <span class="token punctuation">}</span>

	 <span class="token keyword">bool</span> <span class="token keyword">operator</span><span class="token operator">!=</span><span class="token punctuation">(</span><span class="token keyword">const</span> Point<span class="token operator">&amp;</span> point<span class="token punctuation">)</span> <span class="token keyword">const</span> <span class="token punctuation">{</span>
		 <span class="token keyword">return</span> <span class="token punctuation">(</span>m_x <span class="token operator">!=</span> point<span class="token punctuation">.</span>m_x<span class="token punctuation">)</span> <span class="token operator">||</span> <span class="token punctuation">(</span>m_y <span class="token operator">!=</span> point<span class="token punctuation">.</span>m_y<span class="token punctuation">)</span><span class="token punctuation">;</span>
	 <span class="token punctuation">}</span>

	 Point <span class="token operator">&amp;</span><span class="token keyword">operator</span><span class="token operator">-</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
		 m_x <span class="token operator">=</span> <span class="token operator">-</span>m_x<span class="token punctuation">;</span>
		 m_y <span class="token operator">=</span> <span class="token operator">-</span>m_y<span class="token punctuation">;</span>
		 <span class="token keyword">return</span> <span class="token operator">*</span><span class="token keyword">this</span><span class="token punctuation">;</span>
	 <span class="token punctuation">}</span><span class="token punctuation">;</span>

	 <span class="token comment">//前置++</span>
	 Point <span class="token operator">&amp;</span><span class="token keyword">operator</span><span class="token operator">++</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
		 m_x<span class="token operator">++</span><span class="token punctuation">;</span>
		 m_y<span class="token operator">++</span><span class="token punctuation">;</span>
		 <span class="token keyword">return</span> <span class="token operator">*</span><span class="token keyword">this</span><span class="token punctuation">;</span>
	 <span class="token punctuation">}</span><span class="token punctuation">;</span>

	 <span class="token comment">//后置++</span>
	 Point<span class="token operator">&amp;</span> <span class="token keyword">operator</span><span class="token operator">++</span><span class="token punctuation">(</span><span class="token keyword">int</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
		 Point <span class="token function">old</span><span class="token punctuation">(</span>m_x<span class="token punctuation">,</span> m_y<span class="token punctuation">)</span><span class="token punctuation">;</span>
		 m_x<span class="token operator">++</span><span class="token punctuation">;</span>
		 m_y<span class="token operator">++</span><span class="token punctuation">;</span>
		 <span class="token keyword">return</span> old<span class="token punctuation">;</span>
	 <span class="token punctuation">}</span><span class="token punctuation">;</span>

	 <span class="token comment">//前置--</span>
	 Point <span class="token operator">&amp;</span><span class="token keyword">operator</span><span class="token operator">--</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
		 m_x<span class="token operator">--</span><span class="token punctuation">;</span>
		 m_y<span class="token operator">--</span><span class="token punctuation">;</span>
		 <span class="token keyword">return</span> <span class="token operator">*</span><span class="token keyword">this</span><span class="token punctuation">;</span>
	 <span class="token punctuation">}</span><span class="token punctuation">;</span>
	 
	 <span class="token comment">//后置--</span>
	 Point <span class="token operator">&amp;</span><span class="token keyword">operator</span><span class="token operator">--</span><span class="token punctuation">(</span><span class="token keyword">int</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
		 Point <span class="token function">old</span><span class="token punctuation">(</span>m_x<span class="token punctuation">,</span> m_y<span class="token punctuation">)</span><span class="token punctuation">;</span>
		 m_x<span class="token operator">--</span><span class="token punctuation">;</span>
		 m_y<span class="token operator">--</span><span class="token punctuation">;</span>
		 <span class="token keyword">return</span> old<span class="token punctuation">;</span>
	 <span class="token punctuation">}</span><span class="token punctuation">;</span>

	 <span class="token comment">/*void operator&lt;&lt;(const Point &amp;p){
		 cout&lt;&lt; &quot;(&quot;&lt;&lt; p.m_x &lt;&lt; &quot;,&quot; &lt;&lt; p.m_y &lt;&lt; &quot;)inner&quot; &lt;&lt; endl;
	 };*/</span>

<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token comment">//ostream -&gt; output stream</span>

<span class="token comment">//void operator&lt;&lt;(ostream&amp; cout, const Point&amp; p) {</span>
<span class="token comment">//	cout &lt;&lt; &quot;(&quot; &lt;&lt; p.m_x &lt;&lt; &quot;,&quot; &lt;&lt; p.m_y &lt;&lt; &quot;)out&quot;  ;</span>
<span class="token comment">//}</span>

ostream <span class="token operator">&amp;</span><span class="token keyword">operator</span><span class="token operator">&lt;&lt;</span><span class="token punctuation">(</span>ostream<span class="token operator">&amp;</span> cout<span class="token punctuation">,</span> <span class="token keyword">const</span> Point<span class="token operator">&amp;</span> p<span class="token punctuation">)</span> <span class="token punctuation">{</span>
	cout <span class="token operator">&lt;&lt;</span> <span class="token string">&quot;(&quot;</span> <span class="token operator">&lt;&lt;</span> p<span class="token punctuation">.</span>m_x <span class="token operator">&lt;&lt;</span> <span class="token string">&quot;,&quot;</span> <span class="token operator">&lt;&lt;</span> p<span class="token punctuation">.</span>m_y <span class="token operator">&lt;&lt;</span> <span class="token string">&quot;)out&quot;</span>  <span class="token punctuation">;</span>
	<span class="token keyword">return</span> cout<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token comment">//istream -&gt; input stream</span>
<span class="token comment">//这里Point不要const,因为cosnt后就不能改值了</span>
istream<span class="token operator">&amp;</span> <span class="token keyword">operator</span><span class="token operator">&gt;&gt;</span><span class="token punctuation">(</span>istream<span class="token operator">&amp;</span> cin<span class="token punctuation">,</span> Point<span class="token operator">&amp;</span> p<span class="token punctuation">)</span> <span class="token punctuation">{</span>
	cin <span class="token operator">&gt;&gt;</span> p<span class="token punctuation">.</span>m_x<span class="token punctuation">;</span>
	cin <span class="token operator">&gt;&gt;</span> p<span class="token punctuation">.</span>m_y<span class="token punctuation">;</span>
	<span class="token keyword">return</span> cin<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
	<span class="token keyword">const</span> Point <span class="token function">p1</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	Point <span class="token function">p2</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	Point <span class="token function">p3</span><span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	
	<span class="token comment">//本质是p1.operator+(p2).operator(p3)</span>
	<span class="token comment">//Point p4 = p1 + p2 + p3;</span>
	<span class="token comment">//p4.display();</span>
	
	<span class="token comment">/*Point p5 = p2 - p1 - p3;
	p5.display();*/</span>

	<span class="token comment">/*p3+=p2;
	p3.display();*/</span>

	<span class="token comment">/*cout &lt;&lt; &quot;ok&quot; &lt;&lt; (p2==p3) &lt;&lt; endl;*/</span>

	<span class="token comment">//cout &lt;&lt; &quot;ok&quot; &lt;&lt; (p2!=p3) &lt;&lt; endl;</span>
	
	
	<span class="token comment">/* (-p2).display();*/</span>

	<span class="token comment">/*(++p2).display();
	*/</span>

	<span class="token comment">//(--p2).display();</span>

	<span class="token comment">//cout &lt;&lt; p3;</span>

	<span class="token comment">//cout &lt;&lt; p3 &lt;&lt; p2;</span>

	<span class="token comment">/*cin &gt;&gt; p2;
	cout &lt;&lt; p2;*/</span>

<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br><span class="line-number">53</span><br><span class="line-number">54</span><br><span class="line-number">55</span><br><span class="line-number">56</span><br><span class="line-number">57</span><br><span class="line-number">58</span><br><span class="line-number">59</span><br><span class="line-number">60</span><br><span class="line-number">61</span><br><span class="line-number">62</span><br><span class="line-number">63</span><br><span class="line-number">64</span><br><span class="line-number">65</span><br><span class="line-number">66</span><br><span class="line-number">67</span><br><span class="line-number">68</span><br><span class="line-number">69</span><br><span class="line-number">70</span><br><span class="line-number">71</span><br><span class="line-number">72</span><br><span class="line-number">73</span><br><span class="line-number">74</span><br><span class="line-number">75</span><br><span class="line-number">76</span><br><span class="line-number">77</span><br><span class="line-number">78</span><br><span class="line-number">79</span><br><span class="line-number">80</span><br><span class="line-number">81</span><br><span class="line-number">82</span><br><span class="line-number">83</span><br><span class="line-number">84</span><br><span class="line-number">85</span><br><span class="line-number">86</span><br><span class="line-number">87</span><br><span class="line-number">88</span><br><span class="line-number">89</span><br><span class="line-number">90</span><br><span class="line-number">91</span><br><span class="line-number">92</span><br><span class="line-number">93</span><br><span class="line-number">94</span><br><span class="line-number">95</span><br><span class="line-number">96</span><br><span class="line-number">97</span><br><span class="line-number">98</span><br><span class="line-number">99</span><br><span class="line-number">100</span><br><span class="line-number">101</span><br><span class="line-number">102</span><br><span class="line-number">103</span><br><span class="line-number">104</span><br><span class="line-number">105</span><br><span class="line-number">106</span><br><span class="line-number">107</span><br><span class="line-number">108</span><br><span class="line-number">109</span><br><span class="line-number">110</span><br><span class="line-number">111</span><br><span class="line-number">112</span><br><span class="line-number">113</span><br><span class="line-number">114</span><br><span class="line-number">115</span><br><span class="line-number">116</span><br><span class="line-number">117</span><br><span class="line-number">118</span><br><span class="line-number">119</span><br><span class="line-number">120</span><br><span class="line-number">121</span><br><span class="line-number">122</span><br><span class="line-number">123</span><br><span class="line-number">124</span><br><span class="line-number">125</span><br><span class="line-number">126</span><br><span class="line-number">127</span><br><span class="line-number">128</span><br><span class="line-number">129</span><br><span class="line-number">130</span><br><span class="line-number">131</span><br><span class="line-number">132</span><br><span class="line-number">133</span><br><span class="line-number">134</span><br><span class="line-number">135</span><br><span class="line-number">136</span><br><span class="line-number">137</span><br><span class="line-number">138</span><br><span class="line-number">139</span><br><span class="line-number">140</span><br><span class="line-number">141</span><br><span class="line-number">142</span><br></div></div></li></ul> <h2 id="_6-4-运算符重载7-单例模式的完善"><a href="#_6-4-运算符重载7-单例模式的完善" class="header-anchor">#</a> 6.4 运算符重载7-单例模式的完善</h2> <div class="language-cpp line-numbers-mode"><pre class="language-cpp"><code><span class="token keyword">class</span> <span class="token class-name">Rocket</span>
<span class="token punctuation">{</span>
<span class="token keyword">private</span><span class="token operator">:</span>
	<span class="token function">Rocket</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
	<span class="token comment">//可以</span>
	<span class="token operator">~</span><span class="token function">Rocket</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
	<span class="token keyword">static</span> Rocket<span class="token operator">*</span> ms_rocket<span class="token punctuation">;</span>

	<span class="token comment">//将赋值函数私有化</span>
	<span class="token keyword">void</span> <span class="token keyword">operator</span><span class="token operator">=</span><span class="token punctuation">(</span><span class="token keyword">const</span> Rocket <span class="token operator">&amp;</span>r<span class="token punctuation">)</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
	
	<span class="token comment">//将拷贝函数私有化</span>
	<span class="token function">Rocket</span><span class="token punctuation">(</span><span class="token keyword">const</span> Rocket<span class="token operator">&amp;</span> r<span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token keyword">public</span><span class="token operator">:</span>
	<span class="token comment">//返回的是rocket的指针</span>
	<span class="token keyword">static</span> Rocket<span class="token operator">*</span> <span class="token function">shareRocket</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
	<span class="token punctuation">{</span>
		<span class="token keyword">if</span> <span class="token punctuation">(</span>ms_rocket <span class="token operator">==</span> <span class="token constant">NULL</span><span class="token punctuation">)</span>
		<span class="token punctuation">{</span>
			ms_rocket <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token function">Rocket</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token punctuation">}</span>
		<span class="token keyword">return</span> ms_rocket<span class="token punctuation">;</span>
	<span class="token punctuation">}</span>

	<span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">clear_Rocket</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
	<span class="token punctuation">{</span>
		<span class="token keyword">if</span> <span class="token punctuation">(</span>ms_rocket <span class="token operator">!=</span> <span class="token constant">NULL</span><span class="token punctuation">)</span>
		<span class="token punctuation">{</span>
			ms_rocket <span class="token operator">=</span> <span class="token constant">NULL</span><span class="token punctuation">;</span>
			<span class="token keyword">delete</span> ms_rocket<span class="token punctuation">;</span>
		<span class="token punctuation">}</span>
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
Rocket<span class="token operator">*</span> Rocket<span class="token double-colon punctuation">::</span>ms_rocket <span class="token operator">=</span> <span class="token constant">NULL</span><span class="token punctuation">;</span>

<span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
	Rocket<span class="token operator">*</span> p1 <span class="token operator">=</span> <span class="token class-name">Rocket</span><span class="token double-colon punctuation">::</span><span class="token function">shareRocket</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	Rocket<span class="token operator">*</span> p2 <span class="token operator">=</span> <span class="token class-name">Rocket</span><span class="token double-colon punctuation">::</span><span class="token function">shareRocket</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

	<span class="token comment">//两个同样的指针相互指没有意义</span>
	p2<span class="token operator">=</span>p1<span class="token punctuation">;</span>

	<span class="token comment">//调用拷贝构造</span>
	Rocket<span class="token operator">*</span> <span class="token function">p3</span><span class="token punctuation">(</span>p2<span class="token punctuation">)</span><span class="token punctuation">;</span>
	
	cout <span class="token operator">&lt;&lt;</span> <span class="token string">&quot;p1&quot;</span> <span class="token operator">&lt;&lt;</span> p1 <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
	cout <span class="token operator">&lt;&lt;</span> <span class="token string">&quot;p2&quot;</span> <span class="token operator">&lt;&lt;</span> p2 <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
	<span class="token class-name">Rocket</span><span class="token double-colon punctuation">::</span><span class="token function">clear_Rocket</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token function">getchar</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br></div></div><h2 id="_6-5-运算符重载-父类"><a href="#_6-5-运算符重载-父类" class="header-anchor">#</a> 6.5 运算符重载-父类</h2> <div class="language-cpp line-numbers-mode"><pre class="language-cpp"><code><span class="token keyword">class</span> <span class="token class-name">Person</span> <span class="token punctuation">{</span>
<span class="token keyword">public</span><span class="token operator">:</span>
	<span class="token keyword">int</span> m_age<span class="token punctuation">;</span>
	Person <span class="token operator">&amp;</span><span class="token keyword">operator</span><span class="token operator">=</span><span class="token punctuation">(</span><span class="token keyword">const</span> Person <span class="token operator">&amp;</span>person<span class="token punctuation">)</span> <span class="token punctuation">{</span>
		m_age <span class="token operator">=</span> person<span class="token punctuation">.</span>m_age<span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token keyword">class</span> <span class="token class-name">Student</span> <span class="token operator">:</span> <span class="token base-clause"><span class="token keyword">public</span> <span class="token class-name">Person</span></span> <span class="token punctuation">{</span>
<span class="token keyword">public</span><span class="token operator">:</span>
	<span class="token keyword">int</span> m_score<span class="token punctuation">;</span>
	Student <span class="token operator">&amp;</span><span class="token keyword">operator</span><span class="token operator">=</span><span class="token punctuation">(</span><span class="token keyword">const</span> Student <span class="token operator">&amp;</span>student<span class="token punctuation">)</span> <span class="token punctuation">{</span>
		Person<span class="token double-colon punctuation">::</span><span class="token keyword">operator</span><span class="token operator">=</span><span class="token punctuation">(</span>student<span class="token punctuation">)</span><span class="token punctuation">;</span>
		m_score <span class="token operator">=</span> student<span class="token punctuation">.</span>m_score<span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
	Student stu1<span class="token punctuation">;</span>
	stu1<span class="token punctuation">.</span>m_age <span class="token operator">=</span> <span class="token number">20</span><span class="token punctuation">;</span>
	stu1<span class="token punctuation">.</span>m_score <span class="token operator">=</span> <span class="token number">100</span><span class="token punctuation">;</span>

	Student stu2<span class="token punctuation">;</span>

	stu2 <span class="token operator">=</span> stu1<span class="token punctuation">;</span>

	<span class="token function">getchar</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br></div></div><h2 id="_6-6-运算符重载9-仿函数-函数对象"><a href="#_6-6-运算符重载9-仿函数-函数对象" class="header-anchor">#</a> 6.6 运算符重载9-仿函数（函数对象）</h2> <ul><li>将一个对象当作一个函数一样使用。</li> <li>对比普通函数，它可以作为对象保存状态。</li></ul> <h2 id="_6-7-模板1"><a href="#_6-7-模板1" class="header-anchor">#</a> 6.7 模板1</h2> <ul><li><p>泛型，是一种将参数类型参数化的技术，以此来达到代码复用</p> <div class="language-cpp line-numbers-mode"><pre class="language-cpp"><code><span class="token keyword">class</span> <span class="token class-name">Point</span>
<span class="token punctuation">{</span>

	<span class="token keyword">int</span> m_x<span class="token punctuation">;</span>
	<span class="token keyword">int</span> m_y<span class="token punctuation">;</span>
<span class="token keyword">public</span><span class="token operator">:</span>
	<span class="token keyword">void</span> <span class="token function">dispaly</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
	
	<span class="token function">Point</span><span class="token punctuation">(</span><span class="token keyword">int</span> x<span class="token punctuation">,</span> <span class="token keyword">int</span> y<span class="token punctuation">)</span> <span class="token operator">:</span><span class="token function">m_x</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">m_y</span><span class="token punctuation">(</span>y<span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">;</span>

	 <span class="token keyword">const</span> Point <span class="token keyword">operator</span><span class="token operator">+</span><span class="token punctuation">(</span><span class="token keyword">const</span> Point<span class="token operator">&amp;</span> p<span class="token punctuation">)</span><span class="token keyword">const</span><span class="token punctuation">{</span>
		<span class="token keyword">return</span> <span class="token function">Point</span><span class="token punctuation">(</span>m_x<span class="token operator">+</span>p<span class="token punctuation">.</span>m_x<span class="token punctuation">,</span> m_y <span class="token operator">+</span> p<span class="token punctuation">.</span>m_y<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span><span class="token punctuation">;</span>
	<span class="token operator">~</span><span class="token function">Point</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token comment">//int add(int x,int y) {</span>
<span class="token comment">//	return x + y;</span>
<span class="token comment">//}</span>
<span class="token comment">//</span>
<span class="token comment">//double add(double x, double y) {</span>
<span class="token comment">//	return x + y;</span>
<span class="token comment">//}</span>
<span class="token comment">//</span>
<span class="token comment">//Point add(const Point&amp; a, const Point&amp; b) {</span>
<span class="token comment">//	return a+b;</span>
<span class="token comment">//}</span>

<span class="token comment">//使用泛型</span>
<span class="token keyword">template</span> <span class="token operator">&lt;</span><span class="token keyword">typename</span> <span class="token class-name">T</span><span class="token operator">&gt;</span> T <span class="token function">add</span><span class="token punctuation">(</span>T a<span class="token punctuation">,</span> T b<span class="token punctuation">)</span><span class="token punctuation">{</span>
	<span class="token keyword">return</span> a <span class="token operator">+</span> b<span class="token punctuation">;</span>
	<span class="token punctuation">}</span>

<span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
	<span class="token generic-function"><span class="token function">add</span><span class="token generic class-name"><span class="token operator">&lt;</span><span class="token keyword">int</span><span class="token operator">&gt;</span></span></span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token function">add</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token function">add</span><span class="token punctuation">(</span><span class="token number">1.4</span><span class="token punctuation">,</span> <span class="token number">2.3</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token function">add</span><span class="token punctuation">(</span><span class="token function">Point</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token function">Point</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br></div></div></li> <li><p>汇编理解</p> <div class="language-cpp line-numbers-mode"><pre class="language-cpp"><code><span class="token generic-function"><span class="token function">add</span><span class="token generic class-name"><span class="token operator">&lt;</span><span class="token keyword">int</span><span class="token operator">&gt;</span></span></span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
 push        <span class="token number">2</span>  
 push        <span class="token number">1</span>  
 call        <span class="token generic-function"><span class="token function">add</span><span class="token generic class-name"><span class="token operator">&lt;</span><span class="token keyword">int</span><span class="token operator">&gt;</span></span></span> <span class="token punctuation">(</span><span class="token number">0</span>CD10D7h<span class="token punctuation">)</span>  

<span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">-</span>
<span class="token keyword">return</span> a <span class="token operator">+</span> b<span class="token punctuation">;</span>
 mov         eax<span class="token punctuation">,</span>dword ptr <span class="token punctuation">[</span>a<span class="token punctuation">]</span>  
 add         eax<span class="token punctuation">,</span>dword ptr <span class="token punctuation">[</span>b<span class="token punctuation">]</span>
<span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">-</span>

 add         esp<span class="token punctuation">,</span><span class="token number">8</span>  

	<span class="token function">add</span><span class="token punctuation">(</span><span class="token number">1.4</span><span class="token punctuation">,</span> <span class="token number">2.3</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
 sub         esp<span class="token punctuation">,</span><span class="token number">8</span>  
 movsd       xmm0<span class="token punctuation">,</span>mmword ptr <span class="token punctuation">[</span>__real@<span class="token number">4002666666666666</span> <span class="token punctuation">(</span><span class="token number">0</span>CD7B40h<span class="token punctuation">)</span><span class="token punctuation">]</span>  
 movsd       mmword ptr <span class="token punctuation">[</span>esp<span class="token punctuation">]</span><span class="token punctuation">,</span>xmm0  
 sub         esp<span class="token punctuation">,</span><span class="token number">8</span>  
 movsd       xmm0<span class="token punctuation">,</span>mmword ptr <span class="token punctuation">[</span>__real@<span class="token number">3ff</span>6666666666666 <span class="token punctuation">(</span><span class="token number">0</span>CD7B30h<span class="token punctuation">)</span><span class="token punctuation">]</span>  
 movsd       mmword ptr <span class="token punctuation">[</span>esp<span class="token punctuation">]</span><span class="token punctuation">,</span>xmm0  
 call        <span class="token generic-function"><span class="token function">add</span><span class="token generic class-name"><span class="token operator">&lt;</span><span class="token keyword">double</span><span class="token operator">&gt;</span></span></span> <span class="token punctuation">(</span><span class="token number">0</span>CD1032h<span class="token punctuation">)</span>  
 fstp        <span class="token function">st</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span>  
 add         esp<span class="token punctuation">,</span><span class="token number">10</span>h  

	<span class="token function">add</span><span class="token punctuation">(</span><span class="token function">Point</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token function">Point</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
 push        <span class="token number">4</span>  
 push        <span class="token number">2</span>  
 lea         ecx<span class="token punctuation">,</span><span class="token punctuation">[</span>ebp<span class="token operator">-</span><span class="token number">0</span>CCh<span class="token punctuation">]</span>  
 call        <span class="token class-name">Point</span><span class="token double-colon punctuation">::</span><span class="token function">Point</span> <span class="token punctuation">(</span><span class="token number">0</span>CD10B9h<span class="token punctuation">)</span>  
 mov         ecx<span class="token punctuation">,</span>dword ptr <span class="token punctuation">[</span>eax<span class="token operator">+</span><span class="token number">4</span><span class="token punctuation">]</span>  
 push        ecx  
 mov         edx<span class="token punctuation">,</span>dword ptr <span class="token punctuation">[</span>eax<span class="token punctuation">]</span>  
 push        edx  
 push        <span class="token number">2</span>  
 push        <span class="token number">1</span>  
 lea         ecx<span class="token punctuation">,</span><span class="token punctuation">[</span>ebp<span class="token operator">-</span><span class="token number">0</span>DCh<span class="token punctuation">]</span>  
 call        <span class="token class-name">Point</span><span class="token double-colon punctuation">::</span><span class="token function">Point</span> <span class="token punctuation">(</span><span class="token number">0</span>CD10B9h<span class="token punctuation">)</span>  
 mov         ecx<span class="token punctuation">,</span>dword ptr <span class="token punctuation">[</span>eax<span class="token operator">+</span><span class="token number">4</span><span class="token punctuation">]</span>  
 push        ecx  
 mov         edx<span class="token punctuation">,</span>dword ptr <span class="token punctuation">[</span>eax<span class="token punctuation">]</span>  
 push        edx  
 lea         eax<span class="token punctuation">,</span><span class="token punctuation">[</span>ebp<span class="token operator">-</span><span class="token number">0</span>ECh<span class="token punctuation">]</span>  
 push        eax  
 call        <span class="token generic-function"><span class="token function">add</span><span class="token generic class-name"><span class="token operator">&lt;</span>Point<span class="token operator">&gt;</span></span></span> <span class="token punctuation">(</span><span class="token number">0</span>CD1370h<span class="token punctuation">)</span>  

<span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">-</span>
 <span class="token keyword">return</span> a <span class="token operator">+</span> b<span class="token punctuation">;</span>
 lea         eax<span class="token punctuation">,</span><span class="token punctuation">[</span>b<span class="token punctuation">]</span>  
 push        eax  
 mov         ecx<span class="token punctuation">,</span>dword ptr <span class="token punctuation">[</span>ebp<span class="token operator">+</span><span class="token number">8</span><span class="token punctuation">]</span>  
 push        ecx  
 lea         ecx<span class="token punctuation">,</span><span class="token punctuation">[</span>a<span class="token punctuation">]</span>  
 call        Point<span class="token double-colon punctuation">::</span><span class="token keyword">operator</span><span class="token operator">+</span> <span class="token punctuation">(</span><span class="token number">0</span>CD10FFh<span class="token punctuation">)</span>  
 mov         eax<span class="token punctuation">,</span>dword ptr <span class="token punctuation">[</span>ebp<span class="token operator">+</span><span class="token number">8</span><span class="token punctuation">]</span>
<span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">-</span>

 add         esp<span class="token punctuation">,</span><span class="token number">14</span>h
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br><span class="line-number">53</span><br><span class="line-number">54</span><br><span class="line-number">55</span><br><span class="line-number">56</span><br><span class="line-number">57</span><br></div></div></li></ul> <h2 id="_6-8-模板2-编译细节"><a href="#_6-8-模板2-编译细节" class="header-anchor">#</a> 6.8 模板2-编译细节</h2> <ul><li>模板没有被使用的时候，是不会生成出来的。没什么用</li> <li>模板的声明和实现分离出来<code>.h</code> <code>.cpp</code>，可能会导致错误</li> <li>一般将模板的声明和实现放到一个统一的hpp文件中。</li></ul> <p><img alt="Untitled" data-src="MJ%E5%A4%A7%E7%A5%9EC++%E5%9F%BA%E6%9C%AC%E7%9F%A5%E8%AF%86%20f9db4087ded4475a8eee4346f9dd1a31/Untitled%2019.png" loading="lazy" class="lazy"></p> <p><img alt="Untitled" data-src="MJ%E5%A4%A7%E7%A5%9EC++%E5%9F%BA%E6%9C%AC%E7%9F%A5%E8%AF%86%20f9db4087ded4475a8eee4346f9dd1a31/Untitled%2020.png" loading="lazy" class="lazy"></p> <h2 id="_6-9-模板3-动态数组"><a href="#_6-9-模板3-动态数组" class="header-anchor">#</a> 6.9 模板3-动态数组</h2> <div class="language-cpp line-numbers-mode"><pre class="language-cpp"><code><span class="token keyword">class</span> <span class="token class-name">Array</span>
<span class="token punctuation">{</span>
<span class="token keyword">public</span><span class="token operator">:</span>
	<span class="token function">Array</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
		<span class="token comment">//默认给array三个字节</span>
		<span class="token keyword">if</span> <span class="token punctuation">(</span>m_date <span class="token operator">==</span> <span class="token constant">NULL</span><span class="token punctuation">)</span>
		<span class="token punctuation">{</span>
			<span class="token comment">//默认给array三个字节</span>
			m_capacity <span class="token operator">=</span> <span class="token number">3</span><span class="token punctuation">;</span>
			m_date <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token keyword">int</span><span class="token punctuation">[</span>m_capacity<span class="token punctuation">]</span><span class="token punctuation">;</span>
			<span class="token keyword">return</span><span class="token punctuation">;</span>
		<span class="token punctuation">}</span>
	<span class="token punctuation">}</span>
	<span class="token function">Array</span><span class="token punctuation">(</span><span class="token keyword">int</span> i<span class="token punctuation">)</span> <span class="token punctuation">{</span>
		<span class="token keyword">if</span> <span class="token punctuation">(</span>m_date <span class="token operator">==</span> <span class="token constant">NULL</span><span class="token punctuation">)</span>
		<span class="token punctuation">{</span>
			<span class="token comment">//默认给array三个字节</span>
			m_capacity <span class="token operator">=</span> <span class="token punctuation">(</span>i <span class="token operator">&gt;=</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token operator">?</span> i <span class="token operator">:</span> <span class="token number">3</span><span class="token punctuation">;</span>
			m_date <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token keyword">int</span><span class="token punctuation">[</span>m_capacity<span class="token punctuation">]</span><span class="token punctuation">;</span>
			<span class="token keyword">return</span><span class="token punctuation">;</span>
		<span class="token punctuation">}</span>
	<span class="token punctuation">}</span><span class="token punctuation">;</span>
	<span class="token operator">~</span><span class="token function">Array</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
		cout <span class="token operator">&lt;&lt;</span> <span class="token string">&quot;进入析构函数&quot;</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
		<span class="token keyword">if</span> <span class="token punctuation">(</span>m_date <span class="token operator">!=</span> <span class="token constant">NULL</span><span class="token punctuation">)</span>
		<span class="token punctuation">{</span>
			<span class="token keyword">delete</span><span class="token punctuation">[</span><span class="token punctuation">]</span> m_date<span class="token punctuation">;</span>
			m_date <span class="token operator">=</span> <span class="token constant">NULL</span><span class="token punctuation">;</span>
		<span class="token punctuation">}</span>
	<span class="token punctuation">}</span><span class="token punctuation">;</span>

	<span class="token keyword">void</span> <span class="token function">add</span><span class="token punctuation">(</span><span class="token keyword">int</span> i<span class="token punctuation">)</span> <span class="token punctuation">{</span>
		<span class="token keyword">if</span> <span class="token punctuation">(</span>m_size <span class="token operator">&lt;</span> m_capacity<span class="token punctuation">)</span>
		<span class="token punctuation">{</span>
			m_date<span class="token punctuation">[</span>m_size<span class="token punctuation">]</span> <span class="token operator">=</span> i<span class="token punctuation">;</span>
		<span class="token punctuation">}</span>
		<span class="token keyword">else</span>
		<span class="token punctuation">{</span>
			m_capacity <span class="token operator">+=</span> <span class="token number">5</span><span class="token punctuation">;</span>
			m_date<span class="token punctuation">[</span>m_size<span class="token punctuation">]</span> <span class="token operator">=</span> i<span class="token punctuation">;</span>
		<span class="token punctuation">}</span>
		m_size<span class="token operator">++</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>

	<span class="token keyword">int</span> <span class="token function">get</span><span class="token punctuation">(</span><span class="token keyword">int</span> index<span class="token punctuation">)</span> <span class="token punctuation">{</span>
		<span class="token keyword">if</span> <span class="token punctuation">(</span>index <span class="token operator">&lt;=</span><span class="token number">0</span> <span class="token operator">||</span> index <span class="token operator">&gt;</span> m_capacity<span class="token punctuation">)</span>
		<span class="token punctuation">{</span>
			<span class="token keyword">throw</span> <span class="token string">&quot;数组下标越界，检查数下标&quot;</span><span class="token punctuation">;</span>
		<span class="token punctuation">}</span>
		<span class="token keyword">return</span> m_date<span class="token punctuation">[</span>index<span class="token punctuation">]</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
<span class="token keyword">private</span><span class="token operator">:</span>
	<span class="token keyword">int</span><span class="token operator">*</span> m_date<span class="token punctuation">;</span>
	<span class="token comment">//元素个数</span>
	<span class="token keyword">int</span> m_size<span class="token punctuation">;</span>
	<span class="token comment">//元素空间</span>
	<span class="token keyword">int</span> m_capacity<span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
	Array array<span class="token punctuation">;</span>
	array<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	array<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	array<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	array<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	array<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

	cout <span class="token operator">&lt;&lt;</span> array<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br><span class="line-number">53</span><br><span class="line-number">54</span><br><span class="line-number">55</span><br><span class="line-number">56</span><br><span class="line-number">57</span><br><span class="line-number">58</span><br><span class="line-number">59</span><br><span class="line-number">60</span><br><span class="line-number">61</span><br><span class="line-number">62</span><br><span class="line-number">63</span><br><span class="line-number">64</span><br><span class="line-number">65</span><br><span class="line-number">66</span><br><span class="line-number">67</span><br><span class="line-number">68</span><br><span class="line-number">69</span><br><span class="line-number">70</span><br></div></div><h2 id="_6-10-模板4-类模板"><a href="#_6-10-模板4-类模板" class="header-anchor">#</a> 6.10 模板4-类模板</h2> <div class="language-cpp line-numbers-mode"><pre class="language-cpp"><code><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">pragma</span> <span class="token expression">once</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;iostream&gt;</span></span>
<span class="token keyword">using</span> <span class="token keyword">namespace</span> std<span class="token punctuation">;</span>

<span class="token keyword">template</span> <span class="token operator">&lt;</span><span class="token keyword">typename</span> <span class="token class-name">Item</span><span class="token operator">&gt;</span>
<span class="token keyword">class</span> <span class="token class-name">Array</span> <span class="token punctuation">{</span>
	<span class="token keyword">friend</span> ostream <span class="token operator">&amp;</span><span class="token keyword">operator</span><span class="token operator">&lt;&lt;</span><span class="token operator">&lt;</span><span class="token operator">&gt;</span><span class="token punctuation">(</span>ostream <span class="token operator">&amp;</span><span class="token punctuation">,</span> <span class="token keyword">const</span> Array<span class="token operator">&lt;</span>Item<span class="token operator">&gt;</span> <span class="token operator">&amp;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token comment">// 用于指向首元素</span>
	Item <span class="token operator">*</span>m_data<span class="token punctuation">;</span>
	<span class="token comment">// 元素个数</span>
	<span class="token keyword">int</span> m_size<span class="token punctuation">;</span>
	<span class="token comment">// 容量</span>
	<span class="token keyword">int</span> m_capacity<span class="token punctuation">;</span>
	<span class="token keyword">void</span> <span class="token function">checkIndex</span><span class="token punctuation">(</span><span class="token keyword">int</span> index<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">public</span><span class="token operator">:</span>
	<span class="token function">Array</span><span class="token punctuation">(</span><span class="token keyword">int</span> capacity <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token operator">~</span><span class="token function">Array</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token keyword">void</span> <span class="token function">add</span><span class="token punctuation">(</span>Item value<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token keyword">void</span> <span class="token function">remove</span><span class="token punctuation">(</span><span class="token keyword">int</span> index<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token keyword">void</span> <span class="token function">insert</span><span class="token punctuation">(</span><span class="token keyword">int</span> index<span class="token punctuation">,</span> Item value<span class="token punctuation">)</span><span class="token punctuation">;</span>
	Item <span class="token function">get</span><span class="token punctuation">(</span><span class="token keyword">int</span> index<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token keyword">int</span> <span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	Item <span class="token keyword">operator</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">(</span><span class="token keyword">int</span> index<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token keyword">template</span> <span class="token operator">&lt;</span><span class="token keyword">typename</span> <span class="token class-name">Item</span><span class="token operator">&gt;</span>
<span class="token class-name">Array</span><span class="token operator">&lt;</span>Item<span class="token operator">&gt;</span><span class="token double-colon punctuation">::</span><span class="token function">Array</span><span class="token punctuation">(</span><span class="token keyword">int</span> capacity<span class="token punctuation">)</span> <span class="token punctuation">{</span>
	m_capacity <span class="token operator">=</span> <span class="token punctuation">(</span>capacity <span class="token operator">&gt;</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token operator">?</span> capacity <span class="token operator">:</span> <span class="token number">10</span><span class="token punctuation">;</span>

	<span class="token comment">// 申请堆空间</span>
	m_data <span class="token operator">=</span> <span class="token keyword">new</span> Item<span class="token punctuation">[</span>m_capacity<span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">template</span> <span class="token operator">&lt;</span><span class="token keyword">typename</span> <span class="token class-name">Item</span><span class="token operator">&gt;</span>
Array<span class="token operator">&lt;</span>Item<span class="token operator">&gt;</span><span class="token double-colon punctuation">::</span><span class="token operator">~</span><span class="token function">Array</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
	<span class="token keyword">if</span> <span class="token punctuation">(</span>m_data <span class="token operator">==</span> <span class="token constant">NULL</span><span class="token punctuation">)</span> <span class="token keyword">return</span><span class="token punctuation">;</span>
	<span class="token keyword">delete</span><span class="token punctuation">[</span><span class="token punctuation">]</span> m_data<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">template</span> <span class="token operator">&lt;</span><span class="token keyword">typename</span> <span class="token class-name">Item</span><span class="token operator">&gt;</span>
<span class="token keyword">void</span> <span class="token class-name">Array</span><span class="token operator">&lt;</span>Item<span class="token operator">&gt;</span><span class="token double-colon punctuation">::</span><span class="token function">checkIndex</span><span class="token punctuation">(</span><span class="token keyword">int</span> index<span class="token punctuation">)</span> <span class="token punctuation">{</span>
	<span class="token keyword">if</span> <span class="token punctuation">(</span>index <span class="token operator">&lt;</span> <span class="token number">0</span> <span class="token operator">||</span> index <span class="token operator">&gt;=</span> m_size<span class="token punctuation">)</span> <span class="token punctuation">{</span>
		<span class="token comment">// 报错：抛异常</span>
		<span class="token keyword">throw</span> <span class="token string">&quot;数组下标越界&quot;</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">template</span> <span class="token operator">&lt;</span><span class="token keyword">typename</span> <span class="token class-name">Item</span><span class="token operator">&gt;</span>
<span class="token keyword">void</span> <span class="token class-name">Array</span><span class="token operator">&lt;</span>Item<span class="token operator">&gt;</span><span class="token double-colon punctuation">::</span><span class="token function">add</span><span class="token punctuation">(</span>Item value<span class="token punctuation">)</span> <span class="token punctuation">{</span>
	<span class="token keyword">if</span> <span class="token punctuation">(</span>m_size <span class="token operator">==</span> m_capacity<span class="token punctuation">)</span> <span class="token punctuation">{</span>
		<span class="token comment">// 扩容</span>
		<span class="token comment">/*
		1.申请一块更大的新空间
		2.将旧空间的数据拷贝到新空间
		3.释放旧空间
		*/</span>
		cout <span class="token operator">&lt;&lt;</span> <span class="token string">&quot;空间不够&quot;</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
		<span class="token keyword">return</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>

	m_data<span class="token punctuation">[</span>m_size<span class="token operator">++</span><span class="token punctuation">]</span> <span class="token operator">=</span> value<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">template</span> <span class="token operator">&lt;</span><span class="token keyword">typename</span> <span class="token class-name">Item</span><span class="token operator">&gt;</span>
<span class="token keyword">void</span> <span class="token class-name">Array</span><span class="token operator">&lt;</span>Item<span class="token operator">&gt;</span><span class="token double-colon punctuation">::</span><span class="token function">remove</span><span class="token punctuation">(</span><span class="token keyword">int</span> index<span class="token punctuation">)</span> <span class="token punctuation">{</span>
	<span class="token function">checkIndex</span><span class="token punctuation">(</span>index<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token punctuation">}</span>

<span class="token keyword">template</span> <span class="token operator">&lt;</span><span class="token keyword">typename</span> <span class="token class-name">Item</span><span class="token operator">&gt;</span>
<span class="token keyword">void</span> <span class="token class-name">Array</span><span class="token operator">&lt;</span>Item<span class="token operator">&gt;</span><span class="token double-colon punctuation">::</span><span class="token function">insert</span><span class="token punctuation">(</span><span class="token keyword">int</span> index<span class="token punctuation">,</span> Item value<span class="token punctuation">)</span> <span class="token punctuation">{</span>
	
<span class="token punctuation">}</span>

<span class="token keyword">template</span> <span class="token operator">&lt;</span><span class="token keyword">typename</span> <span class="token class-name">Item</span><span class="token operator">&gt;</span>
Item <span class="token class-name">Array</span><span class="token operator">&lt;</span>Item<span class="token operator">&gt;</span><span class="token double-colon punctuation">::</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token keyword">int</span> index<span class="token punctuation">)</span> <span class="token punctuation">{</span>
	<span class="token function">checkIndex</span><span class="token punctuation">(</span>index<span class="token punctuation">)</span><span class="token punctuation">;</span>

	<span class="token keyword">return</span> m_data<span class="token punctuation">[</span>index<span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">template</span> <span class="token operator">&lt;</span><span class="token keyword">typename</span> <span class="token class-name">Item</span><span class="token operator">&gt;</span>
<span class="token keyword">int</span> <span class="token class-name">Array</span><span class="token operator">&lt;</span>Item<span class="token operator">&gt;</span><span class="token double-colon punctuation">::</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
	<span class="token keyword">return</span> m_size<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">template</span> <span class="token operator">&lt;</span><span class="token keyword">typename</span> <span class="token class-name">Item</span><span class="token operator">&gt;</span>
Item Array<span class="token operator">&lt;</span>Item<span class="token operator">&gt;</span><span class="token double-colon punctuation">::</span><span class="token keyword">operator</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">(</span><span class="token keyword">int</span> index<span class="token punctuation">)</span> <span class="token punctuation">{</span>
	<span class="token keyword">return</span> <span class="token function">get</span><span class="token punctuation">(</span>index<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">template</span> <span class="token operator">&lt;</span><span class="token keyword">typename</span> <span class="token class-name">Item</span><span class="token operator">&gt;</span>
ostream <span class="token operator">&amp;</span><span class="token keyword">operator</span><span class="token operator">&lt;&lt;</span><span class="token operator">&lt;</span><span class="token operator">&gt;</span><span class="token punctuation">(</span>ostream <span class="token operator">&amp;</span>cout<span class="token punctuation">,</span> <span class="token keyword">const</span> Array<span class="token operator">&lt;</span>Item<span class="token operator">&gt;</span> <span class="token operator">&amp;</span>array<span class="token punctuation">)</span>
<span class="token punctuation">{</span>
	cout <span class="token operator">&lt;&lt;</span> <span class="token string">&quot;[&quot;</span><span class="token punctuation">;</span>

	<span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> array<span class="token punctuation">.</span>m_size<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
		<span class="token keyword">if</span> <span class="token punctuation">(</span>i <span class="token operator">!=</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
			cout <span class="token operator">&lt;&lt;</span> <span class="token string">&quot;, &quot;</span><span class="token punctuation">;</span>
		<span class="token punctuation">}</span>
		cout <span class="token operator">&lt;&lt;</span> array<span class="token punctuation">.</span>m_data<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>

	<span class="token keyword">return</span> cout <span class="token operator">&lt;&lt;</span> <span class="token string">&quot;]&quot;</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br><span class="line-number">53</span><br><span class="line-number">54</span><br><span class="line-number">55</span><br><span class="line-number">56</span><br><span class="line-number">57</span><br><span class="line-number">58</span><br><span class="line-number">59</span><br><span class="line-number">60</span><br><span class="line-number">61</span><br><span class="line-number">62</span><br><span class="line-number">63</span><br><span class="line-number">64</span><br><span class="line-number">65</span><br><span class="line-number">66</span><br><span class="line-number">67</span><br><span class="line-number">68</span><br><span class="line-number">69</span><br><span class="line-number">70</span><br><span class="line-number">71</span><br><span class="line-number">72</span><br><span class="line-number">73</span><br><span class="line-number">74</span><br><span class="line-number">75</span><br><span class="line-number">76</span><br><span class="line-number">77</span><br><span class="line-number">78</span><br><span class="line-number">79</span><br><span class="line-number">80</span><br><span class="line-number">81</span><br><span class="line-number">82</span><br><span class="line-number">83</span><br><span class="line-number">84</span><br><span class="line-number">85</span><br><span class="line-number">86</span><br><span class="line-number">87</span><br><span class="line-number">88</span><br><span class="line-number">89</span><br><span class="line-number">90</span><br><span class="line-number">91</span><br><span class="line-number">92</span><br><span class="line-number">93</span><br><span class="line-number">94</span><br><span class="line-number">95</span><br><span class="line-number">96</span><br><span class="line-number">97</span><br><span class="line-number">98</span><br><span class="line-number">99</span><br><span class="line-number">100</span><br><span class="line-number">101</span><br><span class="line-number">102</span><br><span class="line-number">103</span><br><span class="line-number">104</span><br><span class="line-number">105</span><br></div></div><h2 id="_6-11-模板5-动态数组的删除和插入"><a href="#_6-11-模板5-动态数组的删除和插入" class="header-anchor">#</a> 6.11 模板5-动态数组的删除和插入</h2> <ul><li>完成动态数组的删除</li> <li>完成动态数组的插入</li> <li>删除和插入都是挪动元素</li></ul> <h2 id="_6-12-类型转换"><a href="#_6-12-类型转换" class="header-anchor">#</a> 6.12 类型转换</h2> <ul><li><p>C语言类型转换风格</p> <ul><li>type（express）</li> <li>（typer）express</li></ul></li> <li><p>C++有4个类型转换符</p> <ul><li>static_cast</li> <li>dynamic_cast</li> <li>reinterpret_cast</li> <li>const_cast</li> <li>使用格式<code>xx_cast&lt;type&gt;(expression)</code></li></ul></li> <li><p>两种办法，一种C特性，一种C++特性，都可以</p></li></ul> <h2 id="_6-13-类型转换1-const-cast"><a href="#_6-13-类型转换1-const-cast" class="header-anchor">#</a> 6.13 类型转换1-const_cast</h2> <ul><li>将常量类型转变为非常量类型。</li></ul> <div class="language-cpp line-numbers-mode"><pre class="language-cpp"><code>	<span class="token keyword">const</span> <span class="token keyword">int</span><span class="token operator">*</span> a <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token keyword">int</span><span class="token punctuation">[</span><span class="token number">12</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
	<span class="token keyword">int</span><span class="token operator">*</span> b <span class="token operator">=</span> <span class="token generic-function"><span class="token function">const_cast</span><span class="token generic class-name"><span class="token operator">&lt;</span><span class="token keyword">int</span><span class="token operator">*</span><span class="token operator">&gt;</span></span></span><span class="token punctuation">(</span>a<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token keyword">int</span> <span class="token operator">*</span>c <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token keyword">int</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	b <span class="token operator">=</span> c<span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><h2 id="_6-14-类型转换2-dynamic-cast"><a href="#_6-14-类型转换2-dynamic-cast" class="header-anchor">#</a> 6.14 类型转换2-dynamic_cast</h2> <ul><li>一般用于多态</li> <li>和C的强制转换相比，多了运行安全检测</li></ul> <div class="language-cpp line-numbers-mode"><pre class="language-cpp"><code>  Person<span class="token operator">*</span> p1 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token function">Person</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	Person<span class="token operator">*</span> p5 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token function">Person</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	Person<span class="token operator">*</span> p2 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token function">Children</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

	Children<span class="token operator">*</span> p3 <span class="token operator">=</span> <span class="token punctuation">(</span>Children<span class="token operator">*</span><span class="token punctuation">)</span>p1<span class="token punctuation">;</span>
	Children<span class="token operator">*</span> p4 <span class="token operator">=</span> <span class="token generic-function"><span class="token function">dynamic_cast</span><span class="token generic class-name"><span class="token operator">&lt;</span>Children<span class="token operator">*</span><span class="token operator">&gt;</span></span></span><span class="token punctuation">(</span>p5<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//NULL</span>

	Children<span class="token operator">*</span> p6 <span class="token operator">=</span> <span class="token generic-function"><span class="token function">dynamic_cast</span><span class="token generic class-name"><span class="token operator">&lt;</span>Children<span class="token operator">*</span><span class="token operator">&gt;</span></span></span><span class="token punctuation">(</span>p2<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><h2 id="_6-15-类型转换3-static-cast"><a href="#_6-15-类型转换3-static-cast" class="header-anchor">#</a> 6.15 类型转换3-static_cast</h2> <ul><li>对比dynamic_cast，缺乏运行时安全检测</li> <li>不能交叉转换（不是同一继承体系的，无法转换）</li> <li>常用于基本数据类型的转换、非const转成const</li> <li>使用范围较广</li></ul> <h2 id="_6-16-类型转换5-reinterpret-cast"><a href="#_6-16-类型转换5-reinterpret-cast" class="header-anchor">#</a> 6.16 类型转换5-reinterpret_cast</h2> <ul><li>完全按位复制</li></ul> <h2 id="_6-17-c-11"><a href="#_6-17-c-11" class="header-anchor">#</a> 6.17 C++11</h2> <ul><li><p>auto</p> <ul><li>可以接受任意类型的变量，编译器会自动判断</li> <li>必须要有初始值</li> <li>不会影响效率</li></ul></li> <li><p>decltype</p> <ul><li>显示变量类型</li></ul> <div class="language-cpp line-numbers-mode"><pre class="language-cpp"><code><span class="token keyword">decltype</span><span class="token punctuation">(</span>name<span class="token punctuation">)</span> age<span class="token punctuation">;</span>
age <span class="token operator">=</span> <span class="token number">12</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div></li> <li><p>nullptr</p> <ul><li>空指针 <code>int *p = nullptr</code></li></ul> <div class="language-cpp line-numbers-mode"><pre class="language-cpp"><code><span class="token keyword">int</span><span class="token operator">*</span> p <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token keyword">int</span><span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token comment">//回收指针p指向的空间</span>
<span class="token keyword">delete</span> p<span class="token punctuation">;</span>
<span class="token comment">//将指针p指向空</span>
p <span class="token operator">=</span> <span class="token keyword">nullptr</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div></li> <li><p>快速遍历</p> <ul><li><code>for(int i : arr){}</code>类比<code>java for(int i in range())</code></li></ul></li> <li><p>数组简写</p> <ul><li><code>int arr[] = {}</code>; <code>int arr[ ] {}</code></li></ul> <div class="language-cpp line-numbers-mode"><pre class="language-cpp"><code>  <span class="token keyword">int</span> m<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">{</span> <span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">,</span><span class="token number">5</span><span class="token punctuation">,</span><span class="token number">6</span> <span class="token punctuation">}</span><span class="token punctuation">;</span>
	<span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> a<span class="token operator">:</span>m<span class="token punctuation">)</span>
	<span class="token punctuation">{</span>
		cout <span class="token operator">&lt;&lt;</span> a <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div></li></ul> <h2 id="_6-18-lambda1"><a href="#_6-18-lambda1" class="header-anchor">#</a> 6.18 Lambda1</h2> <div class="language-cpp line-numbers-mode"><pre class="language-cpp"><code><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;iostream&gt;</span><span class="token expression"><span class="token punctuation">;</span></span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;typeinfo&gt;</span><span class="token expression"><span class="token punctuation">;</span></span></span>
<span class="token keyword">using</span> <span class="token keyword">namespace</span> std<span class="token punctuation">;</span>

<span class="token keyword">int</span> <span class="token function">add</span><span class="token punctuation">(</span><span class="token keyword">int</span> a<span class="token punctuation">,</span> <span class="token keyword">int</span> b<span class="token punctuation">)</span>
<span class="token punctuation">{</span>
	<span class="token keyword">return</span> a <span class="token operator">+</span> b<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">int</span> <span class="token function">jian</span><span class="token punctuation">(</span><span class="token keyword">int</span> a<span class="token punctuation">,</span> <span class="token keyword">int</span> b<span class="token punctuation">)</span>
<span class="token punctuation">{</span>
	<span class="token keyword">return</span> a <span class="token operator">-</span> b<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">int</span> <span class="token function">exec</span><span class="token punctuation">(</span><span class="token keyword">int</span> a<span class="token punctuation">,</span> <span class="token keyword">int</span> b<span class="token punctuation">,</span> <span class="token keyword">int</span> <span class="token punctuation">(</span><span class="token operator">*</span>p<span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token keyword">int</span> a<span class="token punctuation">,</span> <span class="token keyword">int</span> b<span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
	<span class="token keyword">return</span> <span class="token function">p</span><span class="token punctuation">(</span>a<span class="token punctuation">,</span> b<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
	<span class="token comment">/*
	//最简单的lambda表达式
	([] {cout &lt;&lt; &quot;hello world&quot;; })();
	*/</span>

	<span class="token comment">// void (*p)() = [] {cout &lt;&lt; &quot;测试labda表达式复用&quot;; }</span>

	<span class="token comment">//使用auto指向lambda 。</span>
	<span class="token keyword">auto</span> p <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
	<span class="token punctuation">{</span>
		cout <span class="token operator">&lt;&lt;</span> <span class="token string">&quot;测试labda表达式复用&quot;</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
	<span class="token punctuation">}</span><span class="token punctuation">;</span>
	<span class="token function">p</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token function">p</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

	<span class="token comment">//有返回值的lambda函数</span>
	<span class="token keyword">auto</span> m <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">(</span><span class="token keyword">int</span> a<span class="token punctuation">,</span> <span class="token keyword">int</span> b<span class="token punctuation">)</span><span class="token operator">-&gt;</span>
	<span class="token keyword">int</span>
	<span class="token punctuation">{</span>
		<span class="token keyword">return</span> a <span class="token operator">+</span> b<span class="token punctuation">;</span>
	<span class="token punctuation">}</span><span class="token punctuation">;</span>
	<span class="token comment">//可以省略 -&gt;int 自动推断</span>
	<span class="token keyword">auto</span> n <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">(</span><span class="token keyword">int</span> a<span class="token punctuation">,</span> <span class="token keyword">int</span> b<span class="token punctuation">)</span>
	<span class="token punctuation">{</span>
		<span class="token keyword">return</span> a <span class="token operator">+</span> b<span class="token punctuation">;</span>
	<span class="token punctuation">}</span><span class="token punctuation">;</span>
	<span class="token comment">//查看数据类型</span>
	cout <span class="token operator">&lt;&lt;</span> <span class="token keyword">typeid</span><span class="token punctuation">(</span>m<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">name</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br></div></div><h2 id="_6-19-lambda2-变量捕获"><a href="#_6-19-lambda2-变量捕获" class="header-anchor">#</a> 6.19 Lambda2 变量捕获</h2> <ul><li><p>为什么要用捕获？</p></li> <li><p>值捕获</p> <div class="language-cpp line-numbers-mode"><pre class="language-cpp"><code>	<span class="token keyword">int</span> a <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>
	<span class="token keyword">int</span> b <span class="token operator">=</span> <span class="token number">2</span><span class="token punctuation">;</span>

	<span class="token comment">//值捕获</span>
	<span class="token keyword">auto</span> p <span class="token operator">=</span> <span class="token punctuation">[</span>a<span class="token punctuation">,</span> b<span class="token punctuation">]</span>
	<span class="token punctuation">{</span>
		cout <span class="token operator">&lt;&lt;</span> <span class="token string">&quot;打印a:&quot;</span> <span class="token operator">&lt;&lt;</span> a <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
		cout <span class="token operator">&lt;&lt;</span> <span class="token string">&quot;打印b:&quot;</span> <span class="token operator">&lt;&lt;</span> b <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
	<span class="token punctuation">}</span><span class="token punctuation">;</span>
	<span class="token function">p</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br></div></div></li> <li><p>隐式捕获（值捕获）</p> <div class="language-cpp line-numbers-mode"><pre class="language-cpp"><code>	<span class="token keyword">int</span> a <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>
	<span class="token keyword">int</span> b <span class="token operator">=</span> <span class="token number">2</span><span class="token punctuation">;</span>

	<span class="token comment">//隐式捕获（值捕获）</span>
	<span class="token keyword">auto</span> q <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token operator">=</span><span class="token punctuation">]</span>
	<span class="token punctuation">{</span>
		cout <span class="token operator">&lt;&lt;</span> <span class="token string">&quot;打印a:&quot;</span> <span class="token operator">&lt;&lt;</span> a <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
		cout <span class="token operator">&lt;&lt;</span> <span class="token string">&quot;打印b:&quot;</span> <span class="token operator">&lt;&lt;</span> b <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
	<span class="token punctuation">}</span><span class="token punctuation">;</span>
	<span class="token function">q</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br></div></div></li> <li><p>a是值捕获，其它都是引用捕获</p> <div class="language-cpp line-numbers-mode"><pre class="language-cpp"><code>	<span class="token keyword">int</span> a <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>
	<span class="token keyword">int</span> b <span class="token operator">=</span> <span class="token number">2</span><span class="token punctuation">;</span>
	<span class="token keyword">int</span> c <span class="token operator">=</span> <span class="token number">3</span><span class="token punctuation">;</span>

	<span class="token comment">//a是值捕获，其它都是引用捕获</span>
	<span class="token keyword">auto</span> q <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token operator">&amp;</span><span class="token punctuation">,</span>a<span class="token punctuation">]</span>
	<span class="token punctuation">{</span>
		cout <span class="token operator">&lt;&lt;</span> <span class="token string">&quot;打印a:&quot;</span> <span class="token operator">&lt;&lt;</span> a <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
		cout <span class="token operator">&lt;&lt;</span> <span class="token string">&quot;打印b:&quot;</span> <span class="token operator">&lt;&lt;</span> b <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
		cout <span class="token operator">&lt;&lt;</span> <span class="token string">&quot;打印c:&quot;</span> <span class="token operator">&lt;&lt;</span> c <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
	<span class="token punctuation">}</span><span class="token punctuation">;</span>
	<span class="token function">q</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br></div></div></li> <li><p>a是引用捕获，其它都是值捕获</p> <div class="language-cpp line-numbers-mode"><pre class="language-cpp"><code>	<span class="token keyword">int</span> a <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>
	<span class="token keyword">int</span> b <span class="token operator">=</span> <span class="token number">2</span><span class="token punctuation">;</span>
	<span class="token keyword">int</span> c <span class="token operator">=</span> <span class="token number">3</span><span class="token punctuation">;</span>

	<span class="token comment">//a是引用捕获，其它都是值捕获</span>
	<span class="token keyword">auto</span> q <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token operator">&amp;</span>a<span class="token punctuation">,</span>b<span class="token punctuation">,</span>c<span class="token punctuation">]</span>
	<span class="token punctuation">{</span>
		cout <span class="token operator">&lt;&lt;</span> <span class="token string">&quot;打印a:&quot;</span> <span class="token operator">&lt;&lt;</span> a <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
		cout <span class="token operator">&lt;&lt;</span> <span class="token string">&quot;打印b:&quot;</span> <span class="token operator">&lt;&lt;</span> b <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
		cout <span class="token operator">&lt;&lt;</span> <span class="token string">&quot;打印c:&quot;</span> <span class="token operator">&lt;&lt;</span> c <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
	<span class="token punctuation">}</span><span class="token punctuation">;</span>
	<span class="token function">q</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br></div></div></li> <li><p>隐式捕获，地址捕获</p> <div class="language-cpp line-numbers-mode"><pre class="language-cpp"><code>	<span class="token keyword">int</span> a <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>
	<span class="token keyword">int</span> b <span class="token operator">=</span> <span class="token number">2</span><span class="token punctuation">;</span>
	<span class="token keyword">int</span> c <span class="token operator">=</span> <span class="token number">3</span><span class="token punctuation">;</span>

	<span class="token comment">//隐式捕获，地址捕获</span>
	<span class="token keyword">auto</span> q <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token operator">&amp;</span><span class="token punctuation">]</span>
	<span class="token punctuation">{</span>
		cout <span class="token operator">&lt;&lt;</span> <span class="token string">&quot;打印a:&quot;</span> <span class="token operator">&lt;&lt;</span> a <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
		cout <span class="token operator">&lt;&lt;</span> <span class="token string">&quot;打印b:&quot;</span> <span class="token operator">&lt;&lt;</span> b <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
		cout <span class="token operator">&lt;&lt;</span> <span class="token string">&quot;打印c:&quot;</span> <span class="token operator">&lt;&lt;</span> c <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
	<span class="token punctuation">}</span><span class="token punctuation">;</span>
	<span class="token function">q</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br></div></div></li> <li><p>a是地址捕获，其余都是值捕获</p> <div class="language-cpp line-numbers-mode"><pre class="language-cpp"><code>	<span class="token keyword">int</span> a <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>
	<span class="token keyword">int</span> b <span class="token operator">=</span> <span class="token number">2</span><span class="token punctuation">;</span>
	<span class="token keyword">int</span> c <span class="token operator">=</span> <span class="token number">3</span><span class="token punctuation">;</span>
	<span class="token comment">//a是地址捕获，其余都是值捕获</span>
	<span class="token keyword">auto</span> q <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token operator">=</span><span class="token punctuation">,</span><span class="token operator">&amp;</span>a<span class="token punctuation">]</span>
	<span class="token punctuation">{</span>
		cout <span class="token operator">&lt;&lt;</span> <span class="token string">&quot;打印a:&quot;</span> <span class="token operator">&lt;&lt;</span> a <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
		cout <span class="token operator">&lt;&lt;</span> <span class="token string">&quot;打印b:&quot;</span> <span class="token operator">&lt;&lt;</span> b <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
		cout <span class="token operator">&lt;&lt;</span> <span class="token string">&quot;打印c:&quot;</span> <span class="token operator">&lt;&lt;</span> c <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
	<span class="token punctuation">}</span><span class="token punctuation">;</span>
	<span class="token function">q</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br></div></div></li> <li><p>mutable</p> <div class="language-cpp line-numbers-mode"><pre class="language-cpp"><code>	<span class="token keyword">int</span> a <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>
	<span class="token keyword">int</span> b <span class="token operator">=</span> <span class="token number">2</span><span class="token punctuation">;</span>
	<span class="token keyword">int</span> c <span class="token operator">=</span> <span class="token number">3</span><span class="token punctuation">;</span>

	<span class="token keyword">auto</span> q <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token operator">=</span><span class="token punctuation">]</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
	<span class="token keyword">mutable</span><span class="token punctuation">{</span>
		<span class="token comment">//默认情况下，值捕获传来的值都是readOnly，不能改。加上mutable关键字之后相当于将外部值copy一份给内部</span>
		<span class="token operator">++</span>a<span class="token punctuation">;</span>
		cout <span class="token operator">&lt;&lt;</span> <span class="token string">&quot;打印a:&quot;</span> <span class="token operator">&lt;&lt;</span> a <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
		cout <span class="token operator">&lt;&lt;</span> <span class="token string">&quot;打印b:&quot;</span> <span class="token operator">&lt;&lt;</span> b <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
		cout <span class="token operator">&lt;&lt;</span> <span class="token string">&quot;打印c:&quot;</span> <span class="token operator">&lt;&lt;</span> c <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
	<span class="token punctuation">}</span><span class="token punctuation">;</span>
	<span class="token function">q</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br></div></div></li></ul> <h2 id="_6-20-c-14、c-17"><a href="#_6-20-c-14、c-17" class="header-anchor">#</a> 6.20 C++14、C++17</h2> <ul><li>泛型lambda表达式</li> <li>对捕获的变量进行初始化</li></ul> <h2 id="_6-21-异常1-捕捉"><a href="#_6-21-异常1-捕捉" class="header-anchor">#</a> 6.21 异常1- 捕捉</h2> <ul><li><p>错误</p> <ul><li>编程过程中常见的错误</li> <li>运行错误，语法错误</li> <li>异常</li></ul></li> <li><p>异常</p> <ul><li>异常是程序运行中发生的错误，比如内存不够</li></ul> <div class="language-cpp line-numbers-mode"><pre class="language-cpp"><code>cout <span class="token operator">&lt;&lt;</span> <span class="token number">1</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
	<span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> <span class="token number">1000</span><span class="token punctuation">;</span> <span class="token operator">++</span>i<span class="token punctuation">)</span>
	<span class="token punctuation">{</span>
		<span class="token keyword">try</span>
		<span class="token punctuation">{</span>
			<span class="token keyword">int</span><span class="token operator">*</span> p <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token keyword">int</span><span class="token punctuation">[</span><span class="token number">9999999</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token comment">//三个点是接受所有异常</span>
		<span class="token punctuation">}</span><span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">)</span>
		<span class="token punctuation">{</span>
			cout <span class="token operator">&lt;&lt;</span> <span class="token string">&quot;内存溢出异常&quot;</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
			<span class="token keyword">break</span><span class="token punctuation">;</span>
		<span class="token punctuation">}</span>
		
	<span class="token punctuation">}</span>
	cout <span class="token operator">&lt;&lt;</span> <span class="token number">2</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br></div></div></li></ul> <h2 id="_6-22-异常2-抛出"><a href="#_6-22-异常2-抛出" class="header-anchor">#</a> 6.22 异常2-抛出</h2> <ul><li>抛出的异常如果没有被处理，要抛到上层，如果最后都没有被处理的化话，程序就会停止</li> <li>必须严格异常接受定义严格</li></ul> <div class="language-cpp line-numbers-mode"><pre class="language-cpp"><code><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;iostream&gt;</span><span class="token expression"><span class="token punctuation">;</span></span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;typeinfo&gt;</span><span class="token expression"><span class="token punctuation">;</span></span></span>
<span class="token keyword">using</span> <span class="token keyword">namespace</span> std<span class="token punctuation">;</span>

<span class="token keyword">int</span> <span class="token function">chu</span><span class="token punctuation">(</span><span class="token keyword">int</span> a<span class="token punctuation">,</span><span class="token keyword">int</span> b<span class="token punctuation">)</span>
<span class="token punctuation">{</span>
	<span class="token keyword">if</span> <span class="token punctuation">(</span>b<span class="token operator">==</span><span class="token number">0</span><span class="token punctuation">)</span>
	<span class="token punctuation">{</span>
		<span class="token keyword">throw</span> <span class="token string">&quot;抛出异常&quot;</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
	<span class="token keyword">return</span> a <span class="token operator">/</span> b<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
	<span class="token keyword">int</span> a <span class="token operator">=</span> <span class="token number">8</span><span class="token punctuation">;</span>
	<span class="token keyword">int</span> b <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
	<span class="token keyword">try</span>
	<span class="token punctuation">{</span>
		<span class="token function">chu</span><span class="token punctuation">(</span>a<span class="token punctuation">,</span> b<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
	<span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token keyword">const</span> <span class="token keyword">char</span> <span class="token operator">*</span>exception<span class="token punctuation">)</span>
	<span class="token punctuation">{</span>
		cout <span class="token operator">&lt;&lt;</span> exception<span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
<span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i<span class="token punctuation">)</span>
	<span class="token punctuation">{</span>
		cout <span class="token operator">&lt;&lt;</span> <span class="token string">&quot;抛出数字异常&quot;</span> <span class="token operator">&lt;&lt;</span> i <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br></div></div><h2 id="_6-23-异常3-自定义"><a href="#_6-23-异常3-自定义" class="header-anchor">#</a> 6.23 异常3-自定义</h2> <ul><li><p>自定义异常</p> <div class="language-cpp line-numbers-mode"><pre class="language-cpp"><code><span class="token keyword">class</span> <span class="token class-name">Exception</span> <span class="token punctuation">{</span>
<span class="token keyword">public</span><span class="token operator">:</span>
	<span class="token keyword">virtual</span> <span class="token keyword">const</span> <span class="token keyword">char</span><span class="token operator">*</span> <span class="token function">what</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">const</span> <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
	<span class="token keyword">virtual</span> <span class="token keyword">int</span> <span class="token function">code</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">const</span> <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token keyword">class</span> <span class="token class-name">DivideException</span> <span class="token operator">:</span> <span class="token base-clause"><span class="token keyword">public</span> <span class="token class-name">Exception</span></span> <span class="token punctuation">{</span>
<span class="token keyword">public</span><span class="token operator">:</span>
	<span class="token keyword">const</span> <span class="token keyword">char</span><span class="token operator">*</span> <span class="token function">what</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">const</span> <span class="token punctuation">{</span>
		<span class="token keyword">return</span> <span class="token string">&quot;不能除以0&quot;</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>

	<span class="token keyword">int</span> <span class="token function">code</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">const</span> <span class="token punctuation">{</span>
		<span class="token keyword">return</span> <span class="token number">202</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token keyword">class</span> <span class="token class-name">AddException</span> <span class="token operator">:</span> <span class="token base-clause"><span class="token keyword">public</span> <span class="token class-name">Exception</span></span> <span class="token punctuation">{</span>
<span class="token keyword">public</span><span class="token operator">:</span>
	<span class="token keyword">const</span> <span class="token keyword">char</span><span class="token operator">*</span> <span class="token function">what</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">const</span> <span class="token punctuation">{</span>
		<span class="token keyword">return</span> <span class="token string">&quot;加法有问题&quot;</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>

	<span class="token keyword">int</span> <span class="token function">code</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">const</span> <span class="token punctuation">{</span>
		<span class="token keyword">return</span> <span class="token number">201</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token keyword">int</span> <span class="token function">divide</span><span class="token punctuation">(</span><span class="token keyword">int</span> v1<span class="token punctuation">,</span> <span class="token keyword">int</span> v2<span class="token punctuation">)</span> <span class="token punctuation">{</span>
	<span class="token keyword">if</span> <span class="token punctuation">(</span>v2 <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
		<span class="token comment">// 抛出异常</span>
		<span class="token keyword">throw</span> <span class="token function">DivideException</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
	<span class="token keyword">return</span> v1 <span class="token operator">/</span> v2<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
	cout <span class="token operator">&lt;&lt;</span> <span class="token number">1</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>

	<span class="token keyword">try</span> <span class="token punctuation">{</span>
		<span class="token keyword">int</span> a <span class="token operator">=</span> <span class="token number">10</span><span class="token punctuation">;</span>
		<span class="token keyword">int</span> b <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
		cout <span class="token operator">&lt;&lt;</span> <span class="token function">divide</span><span class="token punctuation">(</span>a<span class="token punctuation">,</span> b<span class="token punctuation">)</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
	<span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token keyword">const</span> Exception<span class="token operator">&amp;</span> exception<span class="token punctuation">)</span> <span class="token punctuation">{</span>
		cout <span class="token operator">&lt;&lt;</span> <span class="token string">&quot;产生异常了：&quot;</span> <span class="token operator">&lt;&lt;</span> exception<span class="token punctuation">.</span><span class="token function">what</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br></div></div></li> <li><p>标准异常</p> <p><img alt="Untitled" data-src="MJ%E5%A4%A7%E7%A5%9EC++%E5%9F%BA%E6%9C%AC%E7%9F%A5%E8%AF%86%20f9db4087ded4475a8eee4346f9dd1a31/Untitled%2021.png" loading="lazy" class="lazy"></p> <div class="language-cpp line-numbers-mode"><pre class="language-cpp"><code>cout <span class="token operator">&lt;&lt;</span> <span class="token number">1</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
	<span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> <span class="token number">1000</span><span class="token punctuation">;</span> <span class="token operator">++</span>i<span class="token punctuation">)</span>
	<span class="token punctuation">{</span>
		<span class="token keyword">try</span>
		<span class="token punctuation">{</span>
			<span class="token keyword">int</span><span class="token operator">*</span> p <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token keyword">int</span><span class="token punctuation">[</span><span class="token number">9999999</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
			<span class="token comment">//三个点是接受所有异常</span>
		<span class="token punctuation">}</span>

<span class="token comment">//抛出标准异常</span>
		<span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token keyword">const</span> exception <span class="token operator">&amp;</span>c<span class="token punctuation">)</span>
		<span class="token punctuation">{</span>
			cout <span class="token operator">&lt;&lt;</span> <span class="token string">&quot;内存溢出异常&quot;</span> <span class="token operator">&lt;&lt;</span>c<span class="token punctuation">.</span><span class="token function">what</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
			<span class="token keyword">break</span><span class="token punctuation">;</span>
		<span class="token punctuation">}</span>

	<span class="token punctuation">}</span>
	cout <span class="token operator">&lt;&lt;</span> <span class="token number">2</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br></div></div></li></ul> <h2 id="_6-24-智能指针-auto-ptr"><a href="#_6-24-智能指针-auto-ptr" class="header-anchor">#</a> 6.24 智能指针-auto_ptr</h2> <ul><li><p>传统指针存在的问题</p> <ul><li>需要手动管理指针</li> <li>容易出现内存泄漏</li> <li>释放之后产生野指针</li></ul></li> <li><p>智能指针就是为了解决传统指针出现的问题</p> <ul><li>auto_ptr (不推荐使用)</li> <li>shared_ptr</li> <li>weak_ptr 为了解决循环引用</li> <li>unique_ptr 不能多个指针指向同一块内存空间</li></ul></li></ul> <div class="language-cpp line-numbers-mode"><pre class="language-cpp"><code><span class="token keyword">class</span> <span class="token class-name">Person</span>
<span class="token punctuation">{</span>
<span class="token keyword">public</span><span class="token operator">:</span>
	<span class="token function">Person</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> cout <span class="token operator">&lt;&lt;</span> <span class="token string">&quot;构造&quot;</span><span class="token operator">&lt;&lt;</span>endl<span class="token punctuation">;</span> <span class="token punctuation">}</span><span class="token punctuation">;</span>
	<span class="token operator">~</span><span class="token function">Person</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> cout <span class="token operator">&lt;&lt;</span> <span class="token string">&quot;析构&quot;</span><span class="token operator">&lt;&lt;</span>endl<span class="token punctuation">;</span> <span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
	auto_ptr<span class="token operator">&lt;</span>Person<span class="token operator">&gt;</span> <span class="token function">p</span><span class="token punctuation">(</span><span class="token keyword">new</span> Person<span class="token punctuation">)</span><span class="token punctuation">;</span>
	p<span class="token punctuation">;</span>	
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br></div></div><h2 id="_6-25-智能指针-自己实现"><a href="#_6-25-智能指针-自己实现" class="header-anchor">#</a> 6.25 智能指针-自己实现</h2> <div class="language-cpp line-numbers-mode"><pre class="language-cpp"><code><span class="token keyword">class</span> <span class="token class-name">SmartPointer</span> <span class="token punctuation">{</span>
<span class="token keyword">private</span><span class="token operator">:</span>
	T <span class="token operator">*</span>m_obj<span class="token punctuation">;</span>
<span class="token keyword">public</span><span class="token operator">:</span>
	<span class="token function">SmartPointer</span><span class="token punctuation">(</span>T <span class="token operator">*</span>obj<span class="token punctuation">)</span> <span class="token operator">:</span><span class="token function">m_obj</span><span class="token punctuation">(</span>obj<span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
	<span class="token operator">~</span><span class="token function">SmartPointer</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
		<span class="token keyword">if</span> <span class="token punctuation">(</span>m_obj <span class="token operator">==</span> <span class="token keyword">nullptr</span><span class="token punctuation">)</span> <span class="token keyword">return</span><span class="token punctuation">;</span>

		<span class="token keyword">delete</span> m_obj<span class="token punctuation">;</span>
	<span class="token punctuation">}</span>

	T <span class="token operator">*</span><span class="token keyword">operator</span><span class="token operator">-&gt;</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
		<span class="token keyword">return</span> m_obj<span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br></div></div><h2 id="_6-26-智能指针-shared-ptr"><a href="#_6-26-智能指针-shared-ptr" class="header-anchor">#</a> 6.26 智能指针-shared_ptr</h2> <ul><li>解决了auto_ptr不能处理数组的问题</li></ul> <div class="language-cpp line-numbers-mode"><pre class="language-cpp"><code>	cout <span class="token operator">&lt;&lt;</span> <span class="token string">&quot;1&quot;</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
	shared_ptr<span class="token operator">&lt;</span>Person<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token operator">&gt;</span> <span class="token function">p</span><span class="token punctuation">(</span><span class="token keyword">new</span> Person<span class="token punctuation">[</span><span class="token number">12</span><span class="token punctuation">]</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	p<span class="token punctuation">;</span>
	cout <span class="token operator">&lt;&lt;</span> <span class="token string">&quot;2&quot;</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><ul><li><p>当多个shared_ptr智能指针对象指向同一个shared_ptr的时候，最后一个shared_ptr作用范围结束之后，这个shared_ptr才会被释放</p> <div class="language-cpp line-numbers-mode"><pre class="language-cpp"><code>	cout <span class="token operator">&lt;&lt;</span> <span class="token string">&quot;构造&quot;</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
	shared_ptr<span class="token operator">&lt;</span>Person<span class="token operator">&gt;</span> <span class="token function">p</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token function">Person</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	shared_ptr<span class="token operator">&lt;</span>Person<span class="token operator">&gt;</span> p1 <span class="token operator">=</span> p<span class="token punctuation">;</span>
	shared_ptr<span class="token operator">&lt;</span>Person<span class="token operator">&gt;</span> p3 <span class="token operator">=</span> p1 <span class="token punctuation">;</span>
	cout <span class="token operator">&lt;&lt;</span> <span class="token string">&quot;析构&quot;</span><span class="token operator">&lt;&lt;</span>endl<span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div></li> <li><p>shared_ptr原理</p> <ul><li>引用计数法</li></ul> <div class="language-cpp line-numbers-mode"><pre class="language-cpp"><code>	cout <span class="token operator">&lt;&lt;</span> <span class="token string">&quot;构造&quot;</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
	shared_ptr<span class="token operator">&lt;</span>Person<span class="token operator">&gt;</span> <span class="token function">p</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token function">Person</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	cout <span class="token operator">&lt;&lt;</span> p<span class="token punctuation">.</span><span class="token function">use_count</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
	shared_ptr<span class="token operator">&lt;</span>Person<span class="token operator">&gt;</span> p1 <span class="token operator">=</span> p<span class="token punctuation">;</span>
	cout <span class="token operator">&lt;&lt;</span> p1<span class="token punctuation">.</span><span class="token function">use_count</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
	shared_ptr<span class="token operator">&lt;</span>Person<span class="token operator">&gt;</span> p3 <span class="token operator">=</span> p1 <span class="token punctuation">;</span>
	cout <span class="token operator">&lt;&lt;</span> p3<span class="token punctuation">.</span><span class="token function">use_count</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
	cout <span class="token operator">&lt;&lt;</span> <span class="token string">&quot;析构&quot;</span><span class="token operator">&lt;&lt;</span>endl<span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><ul><li>引用计数法会产生循环引用的问题</li> <li>Java的垃圾回收是可达性分析</li></ul></li> <li><p>产生了两次析构</p> <div class="language-cpp line-numbers-mode"><pre class="language-cpp"><code><span class="token keyword">class</span> <span class="token class-name">Person</span>
<span class="token punctuation">{</span>
<span class="token keyword">public</span><span class="token operator">:</span>
	<span class="token keyword">int</span> a<span class="token punctuation">;</span>
	<span class="token function">Person</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> cout <span class="token operator">&lt;&lt;</span> <span class="token string">&quot;构造&quot;</span><span class="token operator">&lt;&lt;</span>endl<span class="token punctuation">;</span> <span class="token punctuation">}</span><span class="token punctuation">;</span>
	<span class="token operator">~</span><span class="token function">Person</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> cout <span class="token operator">&lt;&lt;</span> <span class="token string">&quot;析构&quot;</span><span class="token operator">&lt;&lt;</span>endl<span class="token punctuation">;</span> <span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
	Person<span class="token operator">*</span> p <span class="token operator">=</span> <span class="token keyword">new</span> Person<span class="token punctuation">;</span>
	<span class="token punctuation">{</span>
		shared_ptr<span class="token operator">&lt;</span>Person<span class="token operator">&gt;</span> <span class="token function">p1</span><span class="token punctuation">(</span>p<span class="token punctuation">)</span> <span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
	<span class="token punctuation">{</span>
		shared_ptr<span class="token operator">&lt;</span>Person<span class="token operator">&gt;</span> <span class="token function">p2</span><span class="token punctuation">(</span>p<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>

<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br></div></div></li></ul> <h2 id="_6-27-智能指针-循环引用、weak-ptr"><a href="#_6-27-智能指针-循环引用、weak-ptr" class="header-anchor">#</a> 6.27 智能指针-循环引用、weak_ptr</h2> <div class="language-cpp line-numbers-mode"><pre class="language-cpp"><code><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;iostream&gt;</span><span class="token expression"><span class="token punctuation">;</span></span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;typeinfo&gt;</span><span class="token expression"><span class="token punctuation">;</span></span></span>
<span class="token keyword">class</span> <span class="token class-name">Person</span><span class="token punctuation">;</span>
<span class="token keyword">using</span> <span class="token keyword">namespace</span> std<span class="token punctuation">;</span>

<span class="token keyword">class</span> <span class="token class-name">Car</span>
<span class="token punctuation">{</span>
<span class="token keyword">public</span><span class="token operator">:</span>
	<span class="token function">Car</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span> cout <span class="token operator">&lt;&lt;</span> <span class="token string">&quot;ca构造&quot;</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span> <span class="token punctuation">}</span>
	<span class="token operator">~</span><span class="token function">Car</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span> cout <span class="token operator">&lt;&lt;</span> <span class="token string">&quot;ca析构&quot;</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span> <span class="token punctuation">}</span>
	shared_ptr<span class="token operator">&lt;</span>Person<span class="token operator">&gt;</span> c <span class="token operator">=</span> <span class="token keyword">nullptr</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token keyword">class</span> <span class="token class-name">Person</span>
<span class="token punctuation">{</span>
<span class="token keyword">public</span><span class="token operator">:</span>
	<span class="token function">Person</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> cout <span class="token operator">&lt;&lt;</span> <span class="token string">&quot;Person构造&quot;</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span> <span class="token punctuation">}</span>
	<span class="token operator">~</span><span class="token function">Person</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> cout <span class="token operator">&lt;&lt;</span> <span class="token string">&quot;Person析构&quot;</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span> <span class="token punctuation">}</span>
	shared_ptr<span class="token operator">&lt;</span>Car<span class="token operator">&gt;</span> p <span class="token operator">=</span> <span class="token keyword">nullptr</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
	cout <span class="token operator">&lt;&lt;</span> <span class="token string">&quot;1&quot;</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
	<span class="token punctuation">{</span>
		shared_ptr<span class="token operator">&lt;</span>Car<span class="token operator">&gt;</span> <span class="token function">c</span><span class="token punctuation">(</span><span class="token keyword">new</span> Car<span class="token punctuation">)</span><span class="token punctuation">;</span>
		shared_ptr<span class="token operator">&lt;</span>Person<span class="token operator">&gt;</span> <span class="token function">p</span><span class="token punctuation">(</span><span class="token keyword">new</span> Person<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">//导致循环引用</span>
		c<span class="token operator">-&gt;</span>c <span class="token operator">=</span> p<span class="token punctuation">;</span>
		p<span class="token operator">-&gt;</span>p <span class="token operator">=</span> c<span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
	cout <span class="token operator">&lt;&lt;</span> <span class="token string">&quot;2&quot;</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br></div></div><div class="language-cpp line-numbers-mode"><pre class="language-cpp"><code><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;iostream&gt;</span><span class="token expression"><span class="token punctuation">;</span></span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;typeinfo&gt;</span><span class="token expression"><span class="token punctuation">;</span></span></span>
<span class="token keyword">class</span> <span class="token class-name">Person</span><span class="token punctuation">;</span>
<span class="token keyword">using</span> <span class="token keyword">namespace</span> std<span class="token punctuation">;</span>

<span class="token keyword">class</span> <span class="token class-name">Car</span>
<span class="token punctuation">{</span>
<span class="token keyword">public</span><span class="token operator">:</span>
	<span class="token function">Car</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span> cout <span class="token operator">&lt;&lt;</span> <span class="token string">&quot;ca构造&quot;</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span> <span class="token punctuation">}</span>
	<span class="token operator">~</span><span class="token function">Car</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span> cout <span class="token operator">&lt;&lt;</span> <span class="token string">&quot;ca析构&quot;</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span> <span class="token punctuation">}</span>
	shared_ptr<span class="token operator">&lt;</span>Person<span class="token operator">&gt;</span> p <span class="token operator">=</span> <span class="token keyword">nullptr</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token keyword">class</span> <span class="token class-name">Person</span>
<span class="token punctuation">{</span>
<span class="token keyword">public</span><span class="token operator">:</span>
	<span class="token function">Person</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> cout <span class="token operator">&lt;&lt;</span> <span class="token string">&quot;Person构造&quot;</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span> <span class="token punctuation">}</span>
	<span class="token operator">~</span><span class="token function">Person</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> cout <span class="token operator">&lt;&lt;</span> <span class="token string">&quot;Person析构&quot;</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span> <span class="token punctuation">}</span>
<span class="token comment">//使用weak_ptr破除强引用</span>
	weak_ptr<span class="token operator">&lt;</span>Car<span class="token operator">&gt;</span> c <span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
	cout <span class="token operator">&lt;&lt;</span> <span class="token string">&quot;1&quot;</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
	<span class="token punctuation">{</span>
		shared_ptr<span class="token operator">&lt;</span>Car<span class="token operator">&gt;</span> <span class="token function">c</span><span class="token punctuation">(</span><span class="token keyword">new</span> Car<span class="token punctuation">)</span><span class="token punctuation">;</span>
		shared_ptr<span class="token operator">&lt;</span>Person<span class="token operator">&gt;</span> <span class="token function">p</span><span class="token punctuation">(</span><span class="token keyword">new</span> Person<span class="token punctuation">)</span><span class="token punctuation">;</span>
		c<span class="token operator">-&gt;</span>p <span class="token operator">=</span> p<span class="token punctuation">;</span>
		p<span class="token operator">-&gt;</span>c <span class="token operator">=</span> c<span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
	cout <span class="token operator">&lt;&lt;</span> <span class="token string">&quot;2&quot;</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br></div></div><h2 id="_6-28-智能指针-unique-ptr"><a href="#_6-28-智能指针-unique-ptr" class="header-anchor">#</a> 6.28 智能指针-unique_ptr</h2> <ul><li>unique_ptr也会对一个对象产生强引用，它可以确保同一时间只有1个指针指向对象</li></ul> <div class="language-cpp line-numbers-mode"><pre class="language-cpp"><code><span class="token comment">//不能下面这样	</span>
	cout <span class="token operator">&lt;&lt;</span> <span class="token string">&quot;构造&quot;</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
	shared_ptr<span class="token operator">&lt;</span>Person<span class="token operator">&gt;</span> <span class="token function">p</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token function">Person</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	cout <span class="token operator">&lt;&lt;</span> p<span class="token punctuation">.</span><span class="token function">use_count</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
	shared_ptr<span class="token operator">&lt;</span>Person<span class="token operator">&gt;</span> p1 <span class="token operator">=</span> p<span class="token punctuation">;</span>
	cout <span class="token operator">&lt;&lt;</span> p1<span class="token punctuation">.</span><span class="token function">use_count</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
	shared_ptr<span class="token operator">&lt;</span>Person<span class="token operator">&gt;</span> p3 <span class="token operator">=</span> p1 <span class="token punctuation">;</span>
	cout <span class="token operator">&lt;&lt;</span> p3<span class="token punctuation">.</span><span class="token function">use_count</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
	cout <span class="token operator">&lt;&lt;</span> <span class="token string">&quot;析构&quot;</span><span class="token operator">&lt;&lt;</span>endl<span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br></div></div><ul><li><p>使用std：move转移unique_ptr的指向权</p> <div class="language-cpp line-numbers-mode"><pre class="language-cpp"><code>	unique_ptr<span class="token operator">&lt;</span>Person<span class="token operator">&gt;</span><span class="token function">p</span><span class="token punctuation">(</span><span class="token keyword">new</span> Person<span class="token punctuation">)</span><span class="token punctuation">;</span>
	unique_ptr<span class="token operator">&lt;</span>Person<span class="token operator">&gt;</span>p1 <span class="token operator">=</span> std<span class="token double-colon punctuation">::</span><span class="token function">move</span><span class="token punctuation">(</span>p<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><h1 id="_7-外挂开发"><a href="#_7-外挂开发" class="header-anchor">#</a> 7.外挂开发</h1> <h2 id="_7-1创建mfc应用"><a href="#_7-1创建mfc应用" class="header-anchor">#</a> 7.1创建MFC应用</h2> <ul><li>在百度上搜在VS上如何配置MFC应用环境</li> <li>创建基于对话框的简单环境</li></ul> <h2 id="_7-2绑定函数和事件"><a href="#_7-2绑定函数和事件" class="header-anchor">#</a> 7.2绑定函数和事件</h2> <ul><li>在事件属性界面更改要绑定事件的id</li> <li>在Dlg头文件中注册kill事件函数</li> <li>在Dlg.cpp文件中实现kill事件函数</li> <li>在BEGIN_MESSAGE_MAP中绑定事件ID和函数</li></ul> <p>简单做法</p> <ul><li>拖拽对话框编辑工具</li> <li>更改事件ID</li> <li>双击事件对话框注册函数</li></ul> <h2 id="_7-3打印调试"><a href="#_7-3打印调试" class="header-anchor">#</a> 7.3打印调试</h2> <ul><li><p>Trace法</p> <div class="language-cpp line-numbers-mode"><pre class="language-cpp"><code>	<span class="token keyword">int</span> age <span class="token operator">=</span> <span class="token number">10</span><span class="token punctuation">;</span>
	<span class="token function">TRACE</span><span class="token punctuation">(</span><span class="token string">&quot;age is %d\n&quot;</span><span class="token punctuation">,</span> age<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div></li> <li><p>AfxMessageBox</p> <div class="language-cpp line-numbers-mode"><pre class="language-cpp"><code><span class="token function">AfxMessageBox</span><span class="token punctuation">(</span><span class="token function">CString</span><span class="token punctuation">(</span><span class="token string">&quot;这是一个afxMessageBox&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div></li> <li><p>格式化输出</p> <div class="language-cpp line-numbers-mode"><pre class="language-cpp"><code><span class="token comment">//使用MessageBox弹窗格式化输出</span>
	<span class="token comment">// 定义cstring</span>
	CString str<span class="token punctuation">;</span>
	<span class="token comment">// 格式化</span>
	str<span class="token punctuation">.</span><span class="token function">Format</span><span class="token punctuation">(</span><span class="token function">CString</span><span class="token punctuation">(</span><span class="token string">&quot;my age is %d\n&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span>age<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token function">MessageBox</span><span class="token punctuation">(</span>str<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div></li> <li><p>使用宏进行格式化</p> <div class="language-cpp line-numbers-mode"><pre class="language-cpp"><code> <span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name function">log</span><span class="token expression"><span class="token punctuation">(</span>t<span class="token punctuation">,</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">)</span></span><span class="token punctuation">\</span>
	<span class="token expression">CString str<span class="token punctuation">;</span></span><span class="token punctuation">\</span>
	<span class="token expression">str<span class="token punctuation">.</span><span class="token function">Format</span><span class="token punctuation">(</span><span class="token function">CString</span><span class="token punctuation">(</span>t<span class="token punctuation">)</span><span class="token punctuation">,</span>__VA_ARGS__<span class="token punctuation">)</span><span class="token punctuation">;</span></span><span class="token punctuation">\</span>
	<span class="token expression"><span class="token function">AfxMessageBox</span><span class="token punctuation">(</span>str<span class="token punctuation">)</span><span class="token punctuation">;</span></span></span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div></li></ul></li></ul> <h2 id="_7-4打开百度"><a href="#_7-4打开百度" class="header-anchor">#</a> 7.4打开百度</h2> <div class="language-cpp line-numbers-mode"><pre class="language-cpp"><code><span class="token function">ShellExecute</span><span class="token punctuation">(</span>
		<span class="token constant">NULL</span><span class="token punctuation">,</span>
		<span class="token function">CString</span><span class="token punctuation">(</span><span class="token string">&quot;open&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
		<span class="token function">CString</span><span class="token punctuation">(</span><span class="token string">&quot;www.baidu.com&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
		<span class="token constant">NULL</span><span class="token punctuation">,</span>
		<span class="token constant">NULL</span><span class="token punctuation">,</span>
		<span class="token constant">NULL</span>
	<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><h2 id="_7-5单选框状态的读取和修改"><a href="#_7-5单选框状态的读取和修改" class="header-anchor">#</a> 7.5单选框状态的读取和修改</h2> <div class="language-cpp line-numbers-mode"><pre class="language-cpp"><code><span class="token comment">//单选框状态的读取</span>
<span class="token keyword">bool</span> state <span class="token operator">=</span>  <span class="token function">IsDlgButtonChecked</span><span class="token punctuation">(</span>IDC_SUN<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div></div> <div class="page-meta"><footer class="page-edit" style="margin:0;"><!----> <!----></footer> <div class="page-views" data-v-66c9020e><i class="fas fa-eye" data-v-66c9020e></i> <span class="view-count" data-v-66c9020e><span id="busuanzi_container_page_pv" style="display: none;" data-v-66c9020e>
            阅读次数: <span id="busuanzi_value_page_pv" data-v-66c9020e>0</span></span></span></div></div> <!----></div> <div class="toc-container-sidebar"><div class="pos-box"><div class="icon-arrow"></div> <div class="scroll-box" style="max-height:86vh"><div style="font-weight:bold;">MJ大神C++基本知识</div> <hr> <div class="toc-box"><ul class="toc-sidebar-links"><li><a href="/src/%E7%9F%A5%E8%AF%86%E7%A2%8E%E7%89%87/C++%E7%9B%B8%E5%85%B3/C++%E5%9F%BA%E6%9C%AC%E7%9F%A5%E8%AF%86.html#_2-1-需要安装的组件" class="toc-sidebar-link">2.1 需要安装的组件</a><ul class="toc-sidebar-sub-headers"></ul></li><li><a href="/src/%E7%9F%A5%E8%AF%86%E7%A2%8E%E7%89%87/C++%E7%9B%B8%E5%85%B3/C++%E5%9F%BA%E6%9C%AC%E7%9F%A5%E8%AF%86.html#_3-1-函数重载" class="toc-sidebar-link">3.1 函数重载</a><ul class="toc-sidebar-sub-headers"></ul></li><li><a href="/src/%E7%9F%A5%E8%AF%86%E7%A2%8E%E7%89%87/C++%E7%9B%B8%E5%85%B3/C++%E5%9F%BA%E6%9C%AC%E7%9F%A5%E8%AF%86.html#_3-2-默认参数" class="toc-sidebar-link">3.2 默认参数</a><ul class="toc-sidebar-sub-headers"></ul></li><li><a href="/src/%E7%9F%A5%E8%AF%86%E7%A2%8E%E7%89%87/C++%E7%9B%B8%E5%85%B3/C++%E5%9F%BA%E6%9C%AC%E7%9F%A5%E8%AF%86.html#_3-3-c和c-相互兼容的方法" class="toc-sidebar-link">3.3 C和C++相互兼容的方法</a><ul class="toc-sidebar-sub-headers"></ul></li><li><a href="/src/%E7%9F%A5%E8%AF%86%E7%A2%8E%E7%89%87/C++%E7%9B%B8%E5%85%B3/C++%E5%9F%BA%E6%9C%AC%E7%9F%A5%E8%AF%86.html#_3-4-解决重复引入的问题" class="toc-sidebar-link">3.4 解决重复引入的问题</a><ul class="toc-sidebar-sub-headers"></ul></li><li><a href="/src/%E7%9F%A5%E8%AF%86%E7%A2%8E%E7%89%87/C++%E7%9B%B8%E5%85%B3/C++%E5%9F%BA%E6%9C%AC%E7%9F%A5%E8%AF%86.html#_3-5-内联函数" class="toc-sidebar-link">3.5 内联函数</a><ul class="toc-sidebar-sub-headers"></ul></li><li><a href="/src/%E7%9F%A5%E8%AF%86%E7%A2%8E%E7%89%87/C++%E7%9B%B8%E5%85%B3/C++%E5%9F%BA%E6%9C%AC%E7%9F%A5%E8%AF%86.html#_3-6-const" class="toc-sidebar-link">3.6 Const</a><ul class="toc-sidebar-sub-headers"></ul></li><li><a href="/src/%E7%9F%A5%E8%AF%86%E7%A2%8E%E7%89%87/C++%E7%9B%B8%E5%85%B3/C++%E5%9F%BA%E6%9C%AC%E7%9F%A5%E8%AF%86.html#_3-7-引用" class="toc-sidebar-link">3.7 引用</a><ul class="toc-sidebar-sub-headers"></ul></li><li><a href="/src/%E7%9F%A5%E8%AF%86%E7%A2%8E%E7%89%87/C++%E7%9B%B8%E5%85%B3/C++%E5%9F%BA%E6%9C%AC%E7%9F%A5%E8%AF%86.html#_4-1-at-t汇编和-intel汇编的区别" class="toc-sidebar-link">4.1 AT&amp;T汇编和 Intel汇编的区别</a><ul class="toc-sidebar-sub-headers"></ul></li><li><a href="/src/%E7%9F%A5%E8%AF%86%E7%A2%8E%E7%89%87/C++%E7%9B%B8%E5%85%B3/C++%E5%9F%BA%E6%9C%AC%E7%9F%A5%E8%AF%86.html#_4-2-x64汇编-寄存器" class="toc-sidebar-link">4.2 x64汇编-寄存器</a><ul class="toc-sidebar-sub-headers"></ul></li><li><a href="/src/%E7%9F%A5%E8%AF%86%E7%A2%8E%E7%89%87/C++%E7%9B%B8%E5%85%B3/C++%E5%9F%BA%E6%9C%AC%E7%9F%A5%E8%AF%86.html#_4-3-x64汇编要点总结" class="toc-sidebar-link">4.3 x64汇编要点总结</a><ul class="toc-sidebar-sub-headers"></ul></li><li><a href="/src/%E7%9F%A5%E8%AF%86%E7%A2%8E%E7%89%87/C++%E7%9B%B8%E5%85%B3/C++%E5%9F%BA%E6%9C%AC%E7%9F%A5%E8%AF%86.html#_4-4-内联汇编" class="toc-sidebar-link">4.4 内联汇编</a><ul class="toc-sidebar-sub-headers"></ul></li><li><a href="/src/%E7%9F%A5%E8%AF%86%E7%A2%8E%E7%89%87/C++%E7%9B%B8%E5%85%B3/C++%E5%9F%BA%E6%9C%AC%E7%9F%A5%E8%AF%86.html#_4-5-变量地址总结" class="toc-sidebar-link">4.5 变量地址总结</a><ul class="toc-sidebar-sub-headers"></ul></li><li><a href="/src/%E7%9F%A5%E8%AF%86%E7%A2%8E%E7%89%87/C++%E7%9B%B8%E5%85%B3/C++%E5%9F%BA%E6%9C%AC%E7%9F%A5%E8%AF%86.html#_4-6-寄存器运算特性" class="toc-sidebar-link">4.6 寄存器运算特性</a><ul class="toc-sidebar-sub-headers"></ul></li><li><a href="/src/%E7%9F%A5%E8%AF%86%E7%A2%8E%E7%89%87/C++%E7%9B%B8%E5%85%B3/C++%E5%9F%BA%E6%9C%AC%E7%9F%A5%E8%AF%86.html#_4-7-使用汇编分析指针变量" class="toc-sidebar-link">4.7 使用汇编分析指针变量</a><ul class="toc-sidebar-sub-headers"></ul></li><li><a href="/src/%E7%9F%A5%E8%AF%86%E7%A2%8E%E7%89%87/C++%E7%9B%B8%E5%85%B3/C++%E5%9F%BA%E6%9C%AC%E7%9F%A5%E8%AF%86.html#_4-8-引用的反汇编分析" class="toc-sidebar-link">4.8 引用的反汇编分析</a><ul class="toc-sidebar-sub-headers"></ul></li><li><a href="/src/%E7%9F%A5%E8%AF%86%E7%A2%8E%E7%89%87/C++%E7%9B%B8%E5%85%B3/C++%E5%9F%BA%E6%9C%AC%E7%9F%A5%E8%AF%86.html#_4-9-引用的注意点" class="toc-sidebar-link">4.9 引用的注意点</a><ul class="toc-sidebar-sub-headers"></ul></li><li><a href="/src/%E7%9F%A5%E8%AF%86%E7%A2%8E%E7%89%87/C++%E7%9B%B8%E5%85%B3/C++%E5%9F%BA%E6%9C%AC%E7%9F%A5%E8%AF%86.html#_4-10-常引用-const-reference" class="toc-sidebar-link">4.10 常引用 const reference</a><ul class="toc-sidebar-sub-headers"></ul></li><li><a href="/src/%E7%9F%A5%E8%AF%86%E7%A2%8E%E7%89%87/C++%E7%9B%B8%E5%85%B3/C++%E5%9F%BA%E6%9C%AC%E7%9F%A5%E8%AF%86.html#_4-11-const引用的特点" class="toc-sidebar-link">4.11 const引用的特点</a><ul class="toc-sidebar-sub-headers"></ul></li><li><a href="/src/%E7%9F%A5%E8%AF%86%E7%A2%8E%E7%89%87/C++%E7%9B%B8%E5%85%B3/C++%E5%9F%BA%E6%9C%AC%E7%9F%A5%E8%AF%86.html#_5-1-面向对象的知识点" class="toc-sidebar-link">5.1 面向对象的知识点</a><ul class="toc-sidebar-sub-headers"></ul></li><li><a href="/src/%E7%9F%A5%E8%AF%86%E7%A2%8E%E7%89%87/C++%E7%9B%B8%E5%85%B3/C++%E5%9F%BA%E6%9C%AC%E7%9F%A5%E8%AF%86.html#_5-2-类" class="toc-sidebar-link">5.2 类</a><ul class="toc-sidebar-sub-headers"></ul></li><li><a href="/src/%E7%9F%A5%E8%AF%86%E7%A2%8E%E7%89%87/C++%E7%9B%B8%E5%85%B3/C++%E5%9F%BA%E6%9C%AC%E7%9F%A5%E8%AF%86.html#_5-3-c-编程规范" class="toc-sidebar-link">5.3 C++编程规范</a><ul class="toc-sidebar-sub-headers"></ul></li><li><a href="/src/%E7%9F%A5%E8%AF%86%E7%A2%8E%E7%89%87/C++%E7%9B%B8%E5%85%B3/C++%E5%9F%BA%E6%9C%AC%E7%9F%A5%E8%AF%86.html#_5-4-对象的内存布局" class="toc-sidebar-link">5.4 对象的内存布局</a><ul class="toc-sidebar-sub-headers"></ul></li><li><a href="/src/%E7%9F%A5%E8%AF%86%E7%A2%8E%E7%89%87/C++%E7%9B%B8%E5%85%B3/C++%E5%9F%BA%E6%9C%AC%E7%9F%A5%E8%AF%86.html#_5-5-this关键字" class="toc-sidebar-link">5.5 this关键字</a><ul class="toc-sidebar-sub-headers"></ul></li><li><a href="/src/%E7%9F%A5%E8%AF%86%E7%A2%8E%E7%89%87/C++%E7%9B%B8%E5%85%B3/C++%E5%9F%BA%E6%9C%AC%E7%9F%A5%E8%AF%86.html#_5-6-指针访问对象成员的本质" class="toc-sidebar-link">5.6 指针访问对象成员的本质</a><ul class="toc-sidebar-sub-headers"></ul></li><li><a href="/src/%E7%9F%A5%E8%AF%86%E7%A2%8E%E7%89%87/C++%E7%9B%B8%E5%85%B3/C++%E5%9F%BA%E6%9C%AC%E7%9F%A5%E8%AF%86.html#_5-7-内存空间的布局" class="toc-sidebar-link">5.7 内存空间的布局</a><ul class="toc-sidebar-sub-headers"></ul></li><li><a href="/src/%E7%9F%A5%E8%AF%86%E7%A2%8E%E7%89%87/C++%E7%9B%B8%E5%85%B3/C++%E5%9F%BA%E6%9C%AC%E7%9F%A5%E8%AF%86.html#_5-8-堆空间" class="toc-sidebar-link">5.8 堆空间</a><ul class="toc-sidebar-sub-headers"></ul></li><li><a href="/src/%E7%9F%A5%E8%AF%86%E7%A2%8E%E7%89%87/C++%E7%9B%B8%E5%85%B3/C++%E5%9F%BA%E6%9C%AC%E7%9F%A5%E8%AF%86.html#_5-9-堆空间的初始化问题" class="toc-sidebar-link">5.9 堆空间的初始化问题</a><ul class="toc-sidebar-sub-headers"></ul></li><li><a href="/src/%E7%9F%A5%E8%AF%86%E7%A2%8E%E7%89%87/C++%E7%9B%B8%E5%85%B3/C++%E5%9F%BA%E6%9C%AC%E7%9F%A5%E8%AF%86.html#_5-10-memset" class="toc-sidebar-link">5.10 memset</a><ul class="toc-sidebar-sub-headers"></ul></li><li><a href="/src/%E7%9F%A5%E8%AF%86%E7%A2%8E%E7%89%87/C++%E7%9B%B8%E5%85%B3/C++%E5%9F%BA%E6%9C%AC%E7%9F%A5%E8%AF%86.html#_5-11-构造函数-constructor" class="toc-sidebar-link">5.11 构造函数（Constructor）</a><ul class="toc-sidebar-sub-headers"></ul></li><li><a href="/src/%E7%9F%A5%E8%AF%86%E7%A2%8E%E7%89%87/C++%E7%9B%B8%E5%85%B3/C++%E5%9F%BA%E6%9C%AC%E7%9F%A5%E8%AF%86.html#_5-12-默认情况下-成员变量的初始化" class="toc-sidebar-link">5.12 默认情况下，成员变量的初始化</a><ul class="toc-sidebar-sub-headers"></ul></li><li><a href="/src/%E7%9F%A5%E8%AF%86%E7%A2%8E%E7%89%87/C++%E7%9B%B8%E5%85%B3/C++%E5%9F%BA%E6%9C%AC%E7%9F%A5%E8%AF%86.html#_5-13-成员变量的手动初始化" class="toc-sidebar-link">5.13 成员变量的手动初始化</a><ul class="toc-sidebar-sub-headers"></ul></li><li><a href="/src/%E7%9F%A5%E8%AF%86%E7%A2%8E%E7%89%87/C++%E7%9B%B8%E5%85%B3/C++%E5%9F%BA%E6%9C%AC%E7%9F%A5%E8%AF%86.html#_5-14-析构函数-destructor" class="toc-sidebar-link">5.14 析构函数（Destructor）</a><ul class="toc-sidebar-sub-headers"></ul></li><li><a href="/src/%E7%9F%A5%E8%AF%86%E7%A2%8E%E7%89%87/C++%E7%9B%B8%E5%85%B3/C++%E5%9F%BA%E6%9C%AC%E7%9F%A5%E8%AF%86.html#_5-15-内存管理" class="toc-sidebar-link">5.15 内存管理</a><ul class="toc-sidebar-sub-headers"></ul></li><li><a href="/src/%E7%9F%A5%E8%AF%86%E7%A2%8E%E7%89%87/C++%E7%9B%B8%E5%85%B3/C++%E5%9F%BA%E6%9C%AC%E7%9F%A5%E8%AF%86.html#_5-16-声明和实现的分离" class="toc-sidebar-link">5.16 声明和实现的分离</a><ul class="toc-sidebar-sub-headers"></ul></li><li><a href="/src/%E7%9F%A5%E8%AF%86%E7%A2%8E%E7%89%87/C++%E7%9B%B8%E5%85%B3/C++%E5%9F%BA%E6%9C%AC%E7%9F%A5%E8%AF%86.html#_5-17-命名空间" class="toc-sidebar-link">5.17 命名空间</a><ul class="toc-sidebar-sub-headers"></ul></li><li><a href="/src/%E7%9F%A5%E8%AF%86%E7%A2%8E%E7%89%87/C++%E7%9B%B8%E5%85%B3/C++%E5%9F%BA%E6%9C%AC%E7%9F%A5%E8%AF%86.html#_5-18-命名空间的嵌套" class="toc-sidebar-link">5.18 命名空间的嵌套</a><ul class="toc-sidebar-sub-headers"></ul></li><li><a href="/src/%E7%9F%A5%E8%AF%86%E7%A2%8E%E7%89%87/C++%E7%9B%B8%E5%85%B3/C++%E5%9F%BA%E6%9C%AC%E7%9F%A5%E8%AF%86.html#_5-19-命名空间的合并" class="toc-sidebar-link">5.19 命名空间的合并</a><ul class="toc-sidebar-sub-headers"></ul></li><li><a href="/src/%E7%9F%A5%E8%AF%86%E7%A2%8E%E7%89%87/C++%E7%9B%B8%E5%85%B3/C++%E5%9F%BA%E6%9C%AC%E7%9F%A5%E8%AF%86.html#_5-20-继承" class="toc-sidebar-link">5.20 继承</a><ul class="toc-sidebar-sub-headers"></ul></li><li><a href="/src/%E7%9F%A5%E8%AF%86%E7%A2%8E%E7%89%87/C++%E7%9B%B8%E5%85%B3/C++%E5%9F%BA%E6%9C%AC%E7%9F%A5%E8%AF%86.html#_5-21-继承后对象的内存布局" class="toc-sidebar-link">5.21 继承后对象的内存布局</a><ul class="toc-sidebar-sub-headers"></ul></li><li><a href="/src/%E7%9F%A5%E8%AF%86%E7%A2%8E%E7%89%87/C++%E7%9B%B8%E5%85%B3/C++%E5%9F%BA%E6%9C%AC%E7%9F%A5%E8%AF%86.html#_5-22-成员访问权限" class="toc-sidebar-link">5.22 成员访问权限</a><ul class="toc-sidebar-sub-headers"></ul></li><li><a href="/src/%E7%9F%A5%E8%AF%86%E7%A2%8E%E7%89%87/C++%E7%9B%B8%E5%85%B3/C++%E5%9F%BA%E6%9C%AC%E7%9F%A5%E8%AF%86.html#_5-23-初始化列表" class="toc-sidebar-link">5.23 初始化列表</a><ul class="toc-sidebar-sub-headers"></ul></li><li><a href="/src/%E7%9F%A5%E8%AF%86%E7%A2%8E%E7%89%87/C++%E7%9B%B8%E5%85%B3/C++%E5%9F%BA%E6%9C%AC%E7%9F%A5%E8%AF%86.html#_5-24-构造函数的相互调用" class="toc-sidebar-link">5.24 构造函数的相互调用</a><ul class="toc-sidebar-sub-headers"></ul></li><li><a href="/src/%E7%9F%A5%E8%AF%86%E7%A2%8E%E7%89%87/C++%E7%9B%B8%E5%85%B3/C++%E5%9F%BA%E6%9C%AC%E7%9F%A5%E8%AF%86.html#_5-25-父类的构造函数" class="toc-sidebar-link">5.25 父类的构造函数</a><ul class="toc-sidebar-sub-headers"></ul></li><li><a href="/src/%E7%9F%A5%E8%AF%86%E7%A2%8E%E7%89%87/C++%E7%9B%B8%E5%85%B3/C++%E5%9F%BA%E6%9C%AC%E7%9F%A5%E8%AF%86.html#_5-26-父类指针、子类指针" class="toc-sidebar-link">5.26 父类指针、子类指针</a><ul class="toc-sidebar-sub-headers"></ul></li><li><a href="/src/%E7%9F%A5%E8%AF%86%E7%A2%8E%E7%89%87/C++%E7%9B%B8%E5%85%B3/C++%E5%9F%BA%E6%9C%AC%E7%9F%A5%E8%AF%86.html#_5-27-什么是多态" class="toc-sidebar-link">5.27 什么是多态</a><ul class="toc-sidebar-sub-headers"></ul></li><li><a href="/src/%E7%9F%A5%E8%AF%86%E7%A2%8E%E7%89%87/C++%E7%9B%B8%E5%85%B3/C++%E5%9F%BA%E6%9C%AC%E7%9F%A5%E8%AF%86.html#_5-28-虚函数" class="toc-sidebar-link">5.28 虚函数</a><ul class="toc-sidebar-sub-headers"></ul></li><li><a href="/src/%E7%9F%A5%E8%AF%86%E7%A2%8E%E7%89%87/C++%E7%9B%B8%E5%85%B3/C++%E5%9F%BA%E6%9C%AC%E7%9F%A5%E8%AF%86.html#_5-29-虚表" class="toc-sidebar-link">5.29 虚表</a><ul class="toc-sidebar-sub-headers"></ul></li><li><a href="/src/%E7%9F%A5%E8%AF%86%E7%A2%8E%E7%89%87/C++%E7%9B%B8%E5%85%B3/C++%E5%9F%BA%E6%9C%AC%E7%9F%A5%E8%AF%86.html#_5-30-调用父类的成员函数" class="toc-sidebar-link">5.30 调用父类的成员函数</a><ul class="toc-sidebar-sub-headers"></ul></li><li><a href="/src/%E7%9F%A5%E8%AF%86%E7%A2%8E%E7%89%87/C++%E7%9B%B8%E5%85%B3/C++%E5%9F%BA%E6%9C%AC%E7%9F%A5%E8%AF%86.html#_5-31-虚析构函数" class="toc-sidebar-link">5.31 虚析构函数</a><ul class="toc-sidebar-sub-headers"></ul></li><li><a href="/src/%E7%9F%A5%E8%AF%86%E7%A2%8E%E7%89%87/C++%E7%9B%B8%E5%85%B3/C++%E5%9F%BA%E6%9C%AC%E7%9F%A5%E8%AF%86.html#_5-32-纯虚函数-实现类" class="toc-sidebar-link">5.32 纯虚函数，实现类</a><ul class="toc-sidebar-sub-headers"></ul></li><li><a href="/src/%E7%9F%A5%E8%AF%86%E7%A2%8E%E7%89%87/C++%E7%9B%B8%E5%85%B3/C++%E5%9F%BA%E6%9C%AC%E7%9F%A5%E8%AF%86.html#_5-33-多继承" class="toc-sidebar-link">5.33 多继承</a><ul class="toc-sidebar-sub-headers"></ul></li><li><a href="/src/%E7%9F%A5%E8%AF%86%E7%A2%8E%E7%89%87/C++%E7%9B%B8%E5%85%B3/C++%E5%9F%BA%E6%9C%AC%E7%9F%A5%E8%AF%86.html#_5-34-多继承体系下函数的调用" class="toc-sidebar-link">5.34 多继承体系下函数的调用</a><ul class="toc-sidebar-sub-headers"></ul></li><li><a href="/src/%E7%9F%A5%E8%AF%86%E7%A2%8E%E7%89%87/C++%E7%9B%B8%E5%85%B3/C++%E5%9F%BA%E6%9C%AC%E7%9F%A5%E8%AF%86.html#_5-35-多继承" class="toc-sidebar-link">5.35 多继承</a><ul class="toc-sidebar-sub-headers"></ul></li><li><a href="/src/%E7%9F%A5%E8%AF%86%E7%A2%8E%E7%89%87/C++%E7%9B%B8%E5%85%B3/C++%E5%9F%BA%E6%9C%AC%E7%9F%A5%E8%AF%86.html#_5-36-同名函数" class="toc-sidebar-link">5.36 同名函数</a><ul class="toc-sidebar-sub-headers"></ul></li><li><a href="/src/%E7%9F%A5%E8%AF%86%E7%A2%8E%E7%89%87/C++%E7%9B%B8%E5%85%B3/C++%E5%9F%BA%E6%9C%AC%E7%9F%A5%E8%AF%86.html#_5-37-菱形继承" class="toc-sidebar-link">5.37 菱形继承</a><ul class="toc-sidebar-sub-headers"></ul></li><li><a href="/src/%E7%9F%A5%E8%AF%86%E7%A2%8E%E7%89%87/C++%E7%9B%B8%E5%85%B3/C++%E5%9F%BA%E6%9C%AC%E7%9F%A5%E8%AF%86.html#_5-38-虚继承" class="toc-sidebar-link">5.38 虚继承</a><ul class="toc-sidebar-sub-headers"></ul></li><li><a href="/src/%E7%9F%A5%E8%AF%86%E7%A2%8E%E7%89%87/C++%E7%9B%B8%E5%85%B3/C++%E5%9F%BA%E6%9C%AC%E7%9F%A5%E8%AF%86.html#_5-39-多继承应用场景" class="toc-sidebar-link">5.39 多继承应用场景</a><ul class="toc-sidebar-sub-headers"></ul></li><li><a href="/src/%E7%9F%A5%E8%AF%86%E7%A2%8E%E7%89%87/C++%E7%9B%B8%E5%85%B3/C++%E5%9F%BA%E6%9C%AC%E7%9F%A5%E8%AF%86.html#_5-40-static成员变量" class="toc-sidebar-link">5.40 static成员变量</a><ul class="toc-sidebar-sub-headers"></ul></li><li><a href="/src/%E7%9F%A5%E8%AF%86%E7%A2%8E%E7%89%87/C++%E7%9B%B8%E5%85%B3/C++%E5%9F%BA%E6%9C%AC%E7%9F%A5%E8%AF%86.html#_5-41-static成员函数" class="toc-sidebar-link">5.41 static成员函数</a><ul class="toc-sidebar-sub-headers"></ul></li><li><a href="/src/%E7%9F%A5%E8%AF%86%E7%A2%8E%E7%89%87/C++%E7%9B%B8%E5%85%B3/C++%E5%9F%BA%E6%9C%AC%E7%9F%A5%E8%AF%86.html#_5-42-static汇编分析" class="toc-sidebar-link">5.42 static汇编分析</a><ul class="toc-sidebar-sub-headers"></ul></li><li><a href="/src/%E7%9F%A5%E8%AF%86%E7%A2%8E%E7%89%87/C++%E7%9B%B8%E5%85%B3/C++%E5%9F%BA%E6%9C%AC%E7%9F%A5%E8%AF%86.html#_5-43-static应用" class="toc-sidebar-link">5.43 static应用</a><ul class="toc-sidebar-sub-headers"></ul></li><li><a href="/src/%E7%9F%A5%E8%AF%86%E7%A2%8E%E7%89%87/C++%E7%9B%B8%E5%85%B3/C++%E5%9F%BA%E6%9C%AC%E7%9F%A5%E8%AF%86.html#_5-44-static单例模式" class="toc-sidebar-link">5.44 static单例模式</a><ul class="toc-sidebar-sub-headers"></ul></li><li><a href="/src/%E7%9F%A5%E8%AF%86%E7%A2%8E%E7%89%87/C++%E7%9B%B8%E5%85%B3/C++%E5%9F%BA%E6%9C%AC%E7%9F%A5%E8%AF%86.html#_5-45-new、delete-误区" class="toc-sidebar-link">5.45 new、delete 误区</a><ul class="toc-sidebar-sub-headers"></ul></li><li><a href="/src/%E7%9F%A5%E8%AF%86%E7%A2%8E%E7%89%87/C++%E7%9B%B8%E5%85%B3/C++%E5%9F%BA%E6%9C%AC%E7%9F%A5%E8%AF%86.html#_5-46-const成员、引用成员" class="toc-sidebar-link">5.46 const成员、引用成员</a><ul class="toc-sidebar-sub-headers"></ul></li><li><a href="/src/%E7%9F%A5%E8%AF%86%E7%A2%8E%E7%89%87/C++%E7%9B%B8%E5%85%B3/C++%E5%9F%BA%E6%9C%AC%E7%9F%A5%E8%AF%86.html#_5-47-拷贝构造" class="toc-sidebar-link">5.47 拷贝构造</a><ul class="toc-sidebar-sub-headers"></ul></li><li><a href="/src/%E7%9F%A5%E8%AF%86%E7%A2%8E%E7%89%87/C++%E7%9B%B8%E5%85%B3/C++%E5%9F%BA%E6%9C%AC%E7%9F%A5%E8%AF%86.html#_5-48-拷贝构造-父类" class="toc-sidebar-link">5.48 拷贝构造 父类</a><ul class="toc-sidebar-sub-headers"></ul></li><li><a href="/src/%E7%9F%A5%E8%AF%86%E7%A2%8E%E7%89%87/C++%E7%9B%B8%E5%85%B3/C++%E5%9F%BA%E6%9C%AC%E7%9F%A5%E8%AF%86.html#_5-49-拷贝构造-注意点" class="toc-sidebar-link">5.49 拷贝构造 注意点</a><ul class="toc-sidebar-sub-headers"></ul></li><li><a href="/src/%E7%9F%A5%E8%AF%86%E7%A2%8E%E7%89%87/C++%E7%9B%B8%E5%85%B3/C++%E5%9F%BA%E6%9C%AC%E7%9F%A5%E8%AF%86.html#_5-50-拷贝构造-浅拷贝" class="toc-sidebar-link">5.50 拷贝构造 浅拷贝</a><ul class="toc-sidebar-sub-headers"></ul></li><li><a href="/src/%E7%9F%A5%E8%AF%86%E7%A2%8E%E7%89%87/C++%E7%9B%B8%E5%85%B3/C++%E5%9F%BA%E6%9C%AC%E7%9F%A5%E8%AF%86.html#_5-51-拷贝构造-深拷贝" class="toc-sidebar-link">5.51 拷贝构造 深拷贝</a><ul class="toc-sidebar-sub-headers"></ul></li><li><a href="/src/%E7%9F%A5%E8%AF%86%E7%A2%8E%E7%89%87/C++%E7%9B%B8%E5%85%B3/C++%E5%9F%BA%E6%9C%AC%E7%9F%A5%E8%AF%86.html#_5-52-总结" class="toc-sidebar-link">5.52 总结</a><ul class="toc-sidebar-sub-headers"></ul></li><li><a href="/src/%E7%9F%A5%E8%AF%86%E7%A2%8E%E7%89%87/C++%E7%9B%B8%E5%85%B3/C++%E5%9F%BA%E6%9C%AC%E7%9F%A5%E8%AF%86.html#_5-53-对象类型的参数和返回值" class="toc-sidebar-link">5.53 对象类型的参数和返回值</a><ul class="toc-sidebar-sub-headers"></ul></li><li><a href="/src/%E7%9F%A5%E8%AF%86%E7%A2%8E%E7%89%87/C++%E7%9B%B8%E5%85%B3/C++%E5%9F%BA%E6%9C%AC%E7%9F%A5%E8%AF%86.html#_5-54-匿名对象-临时对象" class="toc-sidebar-link">5.54 匿名对象（临时对象）</a><ul class="toc-sidebar-sub-headers"></ul></li><li><a href="/src/%E7%9F%A5%E8%AF%86%E7%A2%8E%E7%89%87/C++%E7%9B%B8%E5%85%B3/C++%E5%9F%BA%E6%9C%AC%E7%9F%A5%E8%AF%86.html#_5-55-隐式构造、explicit" class="toc-sidebar-link">5.55 隐式构造、explicit</a><ul class="toc-sidebar-sub-headers"></ul></li><li><a href="/src/%E7%9F%A5%E8%AF%86%E7%A2%8E%E7%89%87/C++%E7%9B%B8%E5%85%B3/C++%E5%9F%BA%E6%9C%AC%E7%9F%A5%E8%AF%86.html#_5-56-编译器自动生成的构造函数" class="toc-sidebar-link">5.56 编译器自动生成的构造函数</a><ul class="toc-sidebar-sub-headers"></ul></li><li><a href="/src/%E7%9F%A5%E8%AF%86%E7%A2%8E%E7%89%87/C++%E7%9B%B8%E5%85%B3/C++%E5%9F%BA%E6%9C%AC%E7%9F%A5%E8%AF%86.html#_5-57-友元" class="toc-sidebar-link">5.57 友元</a><ul class="toc-sidebar-sub-headers"></ul></li><li><a href="/src/%E7%9F%A5%E8%AF%86%E7%A2%8E%E7%89%87/C++%E7%9B%B8%E5%85%B3/C++%E5%9F%BA%E6%9C%AC%E7%9F%A5%E8%AF%86.html#_5-58-内部类" class="toc-sidebar-link">5.58 内部类</a><ul class="toc-sidebar-sub-headers"></ul></li><li><a href="/src/%E7%9F%A5%E8%AF%86%E7%A2%8E%E7%89%87/C++%E7%9B%B8%E5%85%B3/C++%E5%9F%BA%E6%9C%AC%E7%9F%A5%E8%AF%86.html#_5-59-局部类" class="toc-sidebar-link">5.59 局部类</a><ul class="toc-sidebar-sub-headers"></ul></li><li><a href="/src/%E7%9F%A5%E8%AF%86%E7%A2%8E%E7%89%87/C++%E7%9B%B8%E5%85%B3/C++%E5%9F%BA%E6%9C%AC%E7%9F%A5%E8%AF%86.html#_6-1-运算符重载1" class="toc-sidebar-link">6.1 运算符重载1</a><ul class="toc-sidebar-sub-headers"></ul></li><li><a href="/src/%E7%9F%A5%E8%AF%86%E7%A2%8E%E7%89%87/C++%E7%9B%B8%E5%85%B3/C++%E5%9F%BA%E6%9C%AC%E7%9F%A5%E8%AF%86.html#_6-2-运算符重载2-完善" class="toc-sidebar-link">6.2 运算符重载2-完善</a><ul class="toc-sidebar-sub-headers"></ul></li><li><a href="/src/%E7%9F%A5%E8%AF%86%E7%A2%8E%E7%89%87/C++%E7%9B%B8%E5%85%B3/C++%E5%9F%BA%E6%9C%AC%E7%9F%A5%E8%AF%86.html#_6-3-运算符重载3-更多运算符。" class="toc-sidebar-link">6.3 运算符重载3-更多运算符。</a><ul class="toc-sidebar-sub-headers"></ul></li><li><a href="/src/%E7%9F%A5%E8%AF%86%E7%A2%8E%E7%89%87/C++%E7%9B%B8%E5%85%B3/C++%E5%9F%BA%E6%9C%AC%E7%9F%A5%E8%AF%86.html#_6-4-运算符重载7-单例模式的完善" class="toc-sidebar-link">6.4 运算符重载7-单例模式的完善</a><ul class="toc-sidebar-sub-headers"></ul></li><li><a href="/src/%E7%9F%A5%E8%AF%86%E7%A2%8E%E7%89%87/C++%E7%9B%B8%E5%85%B3/C++%E5%9F%BA%E6%9C%AC%E7%9F%A5%E8%AF%86.html#_6-5-运算符重载-父类" class="toc-sidebar-link">6.5 运算符重载-父类</a><ul class="toc-sidebar-sub-headers"></ul></li><li><a href="/src/%E7%9F%A5%E8%AF%86%E7%A2%8E%E7%89%87/C++%E7%9B%B8%E5%85%B3/C++%E5%9F%BA%E6%9C%AC%E7%9F%A5%E8%AF%86.html#_6-6-运算符重载9-仿函数-函数对象" class="toc-sidebar-link">6.6 运算符重载9-仿函数（函数对象）</a><ul class="toc-sidebar-sub-headers"></ul></li><li><a href="/src/%E7%9F%A5%E8%AF%86%E7%A2%8E%E7%89%87/C++%E7%9B%B8%E5%85%B3/C++%E5%9F%BA%E6%9C%AC%E7%9F%A5%E8%AF%86.html#_6-7-模板1" class="toc-sidebar-link">6.7 模板1</a><ul class="toc-sidebar-sub-headers"></ul></li><li><a href="/src/%E7%9F%A5%E8%AF%86%E7%A2%8E%E7%89%87/C++%E7%9B%B8%E5%85%B3/C++%E5%9F%BA%E6%9C%AC%E7%9F%A5%E8%AF%86.html#_6-8-模板2-编译细节" class="toc-sidebar-link">6.8 模板2-编译细节</a><ul class="toc-sidebar-sub-headers"></ul></li><li><a href="/src/%E7%9F%A5%E8%AF%86%E7%A2%8E%E7%89%87/C++%E7%9B%B8%E5%85%B3/C++%E5%9F%BA%E6%9C%AC%E7%9F%A5%E8%AF%86.html#_6-9-模板3-动态数组" class="toc-sidebar-link">6.9 模板3-动态数组</a><ul class="toc-sidebar-sub-headers"></ul></li><li><a href="/src/%E7%9F%A5%E8%AF%86%E7%A2%8E%E7%89%87/C++%E7%9B%B8%E5%85%B3/C++%E5%9F%BA%E6%9C%AC%E7%9F%A5%E8%AF%86.html#_6-10-模板4-类模板" class="toc-sidebar-link">6.10 模板4-类模板</a><ul class="toc-sidebar-sub-headers"></ul></li><li><a href="/src/%E7%9F%A5%E8%AF%86%E7%A2%8E%E7%89%87/C++%E7%9B%B8%E5%85%B3/C++%E5%9F%BA%E6%9C%AC%E7%9F%A5%E8%AF%86.html#_6-11-模板5-动态数组的删除和插入" class="toc-sidebar-link">6.11 模板5-动态数组的删除和插入</a><ul class="toc-sidebar-sub-headers"></ul></li><li><a href="/src/%E7%9F%A5%E8%AF%86%E7%A2%8E%E7%89%87/C++%E7%9B%B8%E5%85%B3/C++%E5%9F%BA%E6%9C%AC%E7%9F%A5%E8%AF%86.html#_6-12-类型转换" class="toc-sidebar-link">6.12 类型转换</a><ul class="toc-sidebar-sub-headers"></ul></li><li><a href="/src/%E7%9F%A5%E8%AF%86%E7%A2%8E%E7%89%87/C++%E7%9B%B8%E5%85%B3/C++%E5%9F%BA%E6%9C%AC%E7%9F%A5%E8%AF%86.html#_6-13-类型转换1-const-cast" class="toc-sidebar-link">6.13 类型转换1-const_cast</a><ul class="toc-sidebar-sub-headers"></ul></li><li><a href="/src/%E7%9F%A5%E8%AF%86%E7%A2%8E%E7%89%87/C++%E7%9B%B8%E5%85%B3/C++%E5%9F%BA%E6%9C%AC%E7%9F%A5%E8%AF%86.html#_6-14-类型转换2-dynamic-cast" class="toc-sidebar-link">6.14 类型转换2-dynamic_cast</a><ul class="toc-sidebar-sub-headers"></ul></li><li><a href="/src/%E7%9F%A5%E8%AF%86%E7%A2%8E%E7%89%87/C++%E7%9B%B8%E5%85%B3/C++%E5%9F%BA%E6%9C%AC%E7%9F%A5%E8%AF%86.html#_6-15-类型转换3-static-cast" class="toc-sidebar-link">6.15 类型转换3-static_cast</a><ul class="toc-sidebar-sub-headers"></ul></li><li><a href="/src/%E7%9F%A5%E8%AF%86%E7%A2%8E%E7%89%87/C++%E7%9B%B8%E5%85%B3/C++%E5%9F%BA%E6%9C%AC%E7%9F%A5%E8%AF%86.html#_6-16-类型转换5-reinterpret-cast" class="toc-sidebar-link">6.16 类型转换5-reinterpret_cast</a><ul class="toc-sidebar-sub-headers"></ul></li><li><a href="/src/%E7%9F%A5%E8%AF%86%E7%A2%8E%E7%89%87/C++%E7%9B%B8%E5%85%B3/C++%E5%9F%BA%E6%9C%AC%E7%9F%A5%E8%AF%86.html#_6-17-c-11" class="toc-sidebar-link">6.17 C++11</a><ul class="toc-sidebar-sub-headers"></ul></li><li><a href="/src/%E7%9F%A5%E8%AF%86%E7%A2%8E%E7%89%87/C++%E7%9B%B8%E5%85%B3/C++%E5%9F%BA%E6%9C%AC%E7%9F%A5%E8%AF%86.html#_6-18-lambda1" class="toc-sidebar-link">6.18 Lambda1</a><ul class="toc-sidebar-sub-headers"></ul></li><li><a href="/src/%E7%9F%A5%E8%AF%86%E7%A2%8E%E7%89%87/C++%E7%9B%B8%E5%85%B3/C++%E5%9F%BA%E6%9C%AC%E7%9F%A5%E8%AF%86.html#_6-19-lambda2-变量捕获" class="toc-sidebar-link">6.19 Lambda2 变量捕获</a><ul class="toc-sidebar-sub-headers"></ul></li><li><a href="/src/%E7%9F%A5%E8%AF%86%E7%A2%8E%E7%89%87/C++%E7%9B%B8%E5%85%B3/C++%E5%9F%BA%E6%9C%AC%E7%9F%A5%E8%AF%86.html#_6-20-c-14、c-17" class="toc-sidebar-link">6.20 C++14、C++17</a><ul class="toc-sidebar-sub-headers"></ul></li><li><a href="/src/%E7%9F%A5%E8%AF%86%E7%A2%8E%E7%89%87/C++%E7%9B%B8%E5%85%B3/C++%E5%9F%BA%E6%9C%AC%E7%9F%A5%E8%AF%86.html#_6-21-异常1-捕捉" class="toc-sidebar-link">6.21 异常1- 捕捉</a><ul class="toc-sidebar-sub-headers"></ul></li><li><a href="/src/%E7%9F%A5%E8%AF%86%E7%A2%8E%E7%89%87/C++%E7%9B%B8%E5%85%B3/C++%E5%9F%BA%E6%9C%AC%E7%9F%A5%E8%AF%86.html#_6-22-异常2-抛出" class="toc-sidebar-link">6.22 异常2-抛出</a><ul class="toc-sidebar-sub-headers"></ul></li><li><a href="/src/%E7%9F%A5%E8%AF%86%E7%A2%8E%E7%89%87/C++%E7%9B%B8%E5%85%B3/C++%E5%9F%BA%E6%9C%AC%E7%9F%A5%E8%AF%86.html#_6-23-异常3-自定义" class="toc-sidebar-link">6.23 异常3-自定义</a><ul class="toc-sidebar-sub-headers"></ul></li><li><a href="/src/%E7%9F%A5%E8%AF%86%E7%A2%8E%E7%89%87/C++%E7%9B%B8%E5%85%B3/C++%E5%9F%BA%E6%9C%AC%E7%9F%A5%E8%AF%86.html#_6-24-智能指针-auto-ptr" class="toc-sidebar-link">6.24 智能指针-auto_ptr</a><ul class="toc-sidebar-sub-headers"></ul></li><li><a href="/src/%E7%9F%A5%E8%AF%86%E7%A2%8E%E7%89%87/C++%E7%9B%B8%E5%85%B3/C++%E5%9F%BA%E6%9C%AC%E7%9F%A5%E8%AF%86.html#_6-25-智能指针-自己实现" class="toc-sidebar-link">6.25 智能指针-自己实现</a><ul class="toc-sidebar-sub-headers"></ul></li><li><a href="/src/%E7%9F%A5%E8%AF%86%E7%A2%8E%E7%89%87/C++%E7%9B%B8%E5%85%B3/C++%E5%9F%BA%E6%9C%AC%E7%9F%A5%E8%AF%86.html#_6-26-智能指针-shared-ptr" class="toc-sidebar-link">6.26 智能指针-shared_ptr</a><ul class="toc-sidebar-sub-headers"></ul></li><li><a href="/src/%E7%9F%A5%E8%AF%86%E7%A2%8E%E7%89%87/C++%E7%9B%B8%E5%85%B3/C++%E5%9F%BA%E6%9C%AC%E7%9F%A5%E8%AF%86.html#_6-27-智能指针-循环引用、weak-ptr" class="toc-sidebar-link">6.27 智能指针-循环引用、weak_ptr</a><ul class="toc-sidebar-sub-headers"></ul></li><li><a href="/src/%E7%9F%A5%E8%AF%86%E7%A2%8E%E7%89%87/C++%E7%9B%B8%E5%85%B3/C++%E5%9F%BA%E6%9C%AC%E7%9F%A5%E8%AF%86.html#_6-28-智能指针-unique-ptr" class="toc-sidebar-link">6.28 智能指针-unique_ptr</a><ul class="toc-sidebar-sub-headers"></ul></li><li><a href="/src/%E7%9F%A5%E8%AF%86%E7%A2%8E%E7%89%87/C++%E7%9B%B8%E5%85%B3/C++%E5%9F%BA%E6%9C%AC%E7%9F%A5%E8%AF%86.html#_7-1创建mfc应用" class="toc-sidebar-link">7.1创建MFC应用</a><ul class="toc-sidebar-sub-headers"></ul></li><li><a href="/src/%E7%9F%A5%E8%AF%86%E7%A2%8E%E7%89%87/C++%E7%9B%B8%E5%85%B3/C++%E5%9F%BA%E6%9C%AC%E7%9F%A5%E8%AF%86.html#_7-2绑定函数和事件" class="toc-sidebar-link">7.2绑定函数和事件</a><ul class="toc-sidebar-sub-headers"></ul></li><li><a href="/src/%E7%9F%A5%E8%AF%86%E7%A2%8E%E7%89%87/C++%E7%9B%B8%E5%85%B3/C++%E5%9F%BA%E6%9C%AC%E7%9F%A5%E8%AF%86.html#_7-3打印调试" class="toc-sidebar-link">7.3打印调试</a><ul class="toc-sidebar-sub-headers"></ul></li><li><a href="/src/%E7%9F%A5%E8%AF%86%E7%A2%8E%E7%89%87/C++%E7%9B%B8%E5%85%B3/C++%E5%9F%BA%E6%9C%AC%E7%9F%A5%E8%AF%86.html#_7-4打开百度" class="toc-sidebar-link">7.4打开百度</a><ul class="toc-sidebar-sub-headers"></ul></li><li><a href="/src/%E7%9F%A5%E8%AF%86%E7%A2%8E%E7%89%87/C++%E7%9B%B8%E5%85%B3/C++%E5%9F%BA%E6%9C%AC%E7%9F%A5%E8%AF%86.html#_7-5单选框状态的读取和修改" class="toc-sidebar-link">7.5单选框状态的读取和修改</a><ul class="toc-sidebar-sub-headers"></ul></li></ul></div></div></div></div></div>  <main class="footer"> <div class="copy-right"><a target="_blank" rel="noreferrer">
              
            </a></div></main></main> <aside class="page-sidebar"> <div class="page-side-toolbar"></div>  </aside></div><div class="global-ui"><div></div><!----></div></div>
    <script src="/assets/js/app.594b08d3.js" defer></script><script src="/assets/js/1.0dbf451f.js" defer></script><script src="/assets/js/81.c6d78e39.js" defer></script>
  </body>
</html>
