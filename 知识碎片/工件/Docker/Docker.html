<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Docker | lin</title>
    <meta name="generator" content="VuePress 1.9.10">
    <link rel="icon" href="/favicon.ico">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/all.min.css">
    <meta name="description" content="记录进步的点滴">
    <meta property="og:site_name" content="lin">
    <meta property="og:title" content="Docker">
    <meta property="og:type" content="article">
    <meta property="og:url" content="https://bigdragonlin.github.io/%E7%9F%A5%E8%AF%86%E7%A2%8E%E7%89%87/%E5%B7%A5%E4%BB%B6/Docker/Docker.html">
    <meta name="twitter:title" content="Docker">
    <meta name="twitter:url" content="https://bigdragonlin.github.io/%E7%9F%A5%E8%AF%86%E7%A2%8E%E7%89%87/%E5%B7%A5%E4%BB%B6/Docker/Docker.html">
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:label1" content="Written by">
    <meta name="twitter:label2" content="Filed under">
    <meta name="twitter:data2" content="程序员, 编程, 计算机">
    <meta property="article:tag" content="程序员">
    <meta name="keywords" content="编程学习路线, 编程知识百科, Java, 编程导航, 前端, 开发, 编程分享, 项目, IT, 求职, 面经">
    
    <link rel="preload" href="/assets/css/0.styles.dd3f1dd5.css" as="style"><link rel="preload" href="/assets/js/app.ca6810f0.js" as="script"><link rel="preload" href="/assets/js/1.a7899151.js" as="script"><link rel="preload" href="/assets/js/93.87f9b7c1.js" as="script"><link rel="prefetch" href="/assets/js/10.8111f976.js"><link rel="prefetch" href="/assets/js/100.c3d9648c.js"><link rel="prefetch" href="/assets/js/101.31bd77ed.js"><link rel="prefetch" href="/assets/js/102.75748718.js"><link rel="prefetch" href="/assets/js/103.fefc26c8.js"><link rel="prefetch" href="/assets/js/104.6833bd21.js"><link rel="prefetch" href="/assets/js/105.2a44ef65.js"><link rel="prefetch" href="/assets/js/106.b085d75e.js"><link rel="prefetch" href="/assets/js/107.d43eadfd.js"><link rel="prefetch" href="/assets/js/108.a82c88db.js"><link rel="prefetch" href="/assets/js/109.43567b2e.js"><link rel="prefetch" href="/assets/js/11.675ae2e2.js"><link rel="prefetch" href="/assets/js/110.e9b76f2e.js"><link rel="prefetch" href="/assets/js/111.228eb17e.js"><link rel="prefetch" href="/assets/js/112.16977eac.js"><link rel="prefetch" href="/assets/js/113.bf85006c.js"><link rel="prefetch" href="/assets/js/114.1feafc0d.js"><link rel="prefetch" href="/assets/js/115.27c63cfd.js"><link rel="prefetch" href="/assets/js/116.6b258b63.js"><link rel="prefetch" href="/assets/js/117.2a4ea694.js"><link rel="prefetch" href="/assets/js/118.14319035.js"><link rel="prefetch" href="/assets/js/119.b45026b0.js"><link rel="prefetch" href="/assets/js/12.611fe139.js"><link rel="prefetch" href="/assets/js/120.f3eada75.js"><link rel="prefetch" href="/assets/js/121.d5813ad6.js"><link rel="prefetch" href="/assets/js/122.203b5e6a.js"><link rel="prefetch" href="/assets/js/123.8c4f7397.js"><link rel="prefetch" href="/assets/js/124.04cff09e.js"><link rel="prefetch" href="/assets/js/125.05b77e9b.js"><link rel="prefetch" href="/assets/js/126.385ad5db.js"><link rel="prefetch" href="/assets/js/127.5c05acb6.js"><link rel="prefetch" href="/assets/js/128.acc58546.js"><link rel="prefetch" href="/assets/js/129.e9e12ec9.js"><link rel="prefetch" href="/assets/js/13.bbcb9761.js"><link rel="prefetch" href="/assets/js/130.eb6bd4fc.js"><link rel="prefetch" href="/assets/js/131.77bc5ddd.js"><link rel="prefetch" href="/assets/js/132.a696f9a5.js"><link rel="prefetch" href="/assets/js/133.bd92160a.js"><link rel="prefetch" href="/assets/js/134.92264011.js"><link rel="prefetch" href="/assets/js/135.9a1d9b8a.js"><link rel="prefetch" href="/assets/js/136.e3f55bc9.js"><link rel="prefetch" href="/assets/js/137.38a53ca5.js"><link rel="prefetch" href="/assets/js/138.9af220ba.js"><link rel="prefetch" href="/assets/js/139.2ea1d0aa.js"><link rel="prefetch" href="/assets/js/14.27da1495.js"><link rel="prefetch" href="/assets/js/140.f24895fe.js"><link rel="prefetch" href="/assets/js/141.8380d4d5.js"><link rel="prefetch" href="/assets/js/142.cef7432d.js"><link rel="prefetch" href="/assets/js/143.7a359979.js"><link rel="prefetch" href="/assets/js/144.d135462b.js"><link rel="prefetch" href="/assets/js/145.b6f69890.js"><link rel="prefetch" href="/assets/js/146.66faecd7.js"><link rel="prefetch" href="/assets/js/15.49e75645.js"><link rel="prefetch" href="/assets/js/16.09145204.js"><link rel="prefetch" href="/assets/js/17.6b86b1e5.js"><link rel="prefetch" href="/assets/js/18.d042910d.js"><link rel="prefetch" href="/assets/js/19.ddb3a096.js"><link rel="prefetch" href="/assets/js/2.d74f4bad.js"><link rel="prefetch" href="/assets/js/20.3ace0aa5.js"><link rel="prefetch" href="/assets/js/21.7eb1c3cc.js"><link rel="prefetch" href="/assets/js/22.cff4c035.js"><link rel="prefetch" href="/assets/js/23.07adb667.js"><link rel="prefetch" href="/assets/js/24.29d6a672.js"><link rel="prefetch" href="/assets/js/25.f83be928.js"><link rel="prefetch" href="/assets/js/26.d1712bb0.js"><link rel="prefetch" href="/assets/js/27.25530b6e.js"><link rel="prefetch" href="/assets/js/28.a340957f.js"><link rel="prefetch" href="/assets/js/29.f2754eb7.js"><link rel="prefetch" href="/assets/js/3.72a02e88.js"><link rel="prefetch" href="/assets/js/30.9ac4febe.js"><link rel="prefetch" href="/assets/js/31.1dde25cc.js"><link rel="prefetch" href="/assets/js/32.4087c135.js"><link rel="prefetch" href="/assets/js/33.7696f9d2.js"><link rel="prefetch" href="/assets/js/34.56b8aa20.js"><link rel="prefetch" href="/assets/js/35.e5dd505a.js"><link rel="prefetch" href="/assets/js/36.0906ffc8.js"><link rel="prefetch" href="/assets/js/37.4bf277b3.js"><link rel="prefetch" href="/assets/js/38.898c86e2.js"><link rel="prefetch" href="/assets/js/39.2b08ff32.js"><link rel="prefetch" href="/assets/js/4.2002c685.js"><link rel="prefetch" href="/assets/js/40.de5b4385.js"><link rel="prefetch" href="/assets/js/41.4b058022.js"><link rel="prefetch" href="/assets/js/42.d9754d64.js"><link rel="prefetch" href="/assets/js/43.3d8af8e3.js"><link rel="prefetch" href="/assets/js/44.b49601c7.js"><link rel="prefetch" href="/assets/js/45.3fb7a5e7.js"><link rel="prefetch" href="/assets/js/46.7512c87a.js"><link rel="prefetch" href="/assets/js/47.69f52a8d.js"><link rel="prefetch" href="/assets/js/48.48367446.js"><link rel="prefetch" href="/assets/js/49.154237f1.js"><link rel="prefetch" href="/assets/js/5.ed8fd711.js"><link rel="prefetch" href="/assets/js/50.2d51489f.js"><link rel="prefetch" href="/assets/js/51.e3e48a00.js"><link rel="prefetch" href="/assets/js/52.71319e9d.js"><link rel="prefetch" href="/assets/js/53.76670559.js"><link rel="prefetch" href="/assets/js/54.b2a18c59.js"><link rel="prefetch" href="/assets/js/55.a206441f.js"><link rel="prefetch" href="/assets/js/56.602248d0.js"><link rel="prefetch" href="/assets/js/57.163afc2d.js"><link rel="prefetch" href="/assets/js/58.a2057559.js"><link rel="prefetch" href="/assets/js/59.3c0e4c86.js"><link rel="prefetch" href="/assets/js/6.a237149d.js"><link rel="prefetch" href="/assets/js/60.9d8d9dbc.js"><link rel="prefetch" href="/assets/js/61.b3811e77.js"><link rel="prefetch" href="/assets/js/62.5d38f7cd.js"><link rel="prefetch" href="/assets/js/63.264e91fb.js"><link rel="prefetch" href="/assets/js/64.4b55aee3.js"><link rel="prefetch" href="/assets/js/65.09c20b34.js"><link rel="prefetch" href="/assets/js/66.0fc1c46a.js"><link rel="prefetch" href="/assets/js/67.dc48310c.js"><link rel="prefetch" href="/assets/js/68.5d8c23b0.js"><link rel="prefetch" href="/assets/js/69.03cbc1c9.js"><link rel="prefetch" href="/assets/js/7.b3d59ec2.js"><link rel="prefetch" href="/assets/js/70.b2a017c1.js"><link rel="prefetch" href="/assets/js/71.da6e8dd0.js"><link rel="prefetch" href="/assets/js/72.679cfcfc.js"><link rel="prefetch" href="/assets/js/73.302bc7b7.js"><link rel="prefetch" href="/assets/js/74.f47f2a86.js"><link rel="prefetch" href="/assets/js/75.0435670f.js"><link rel="prefetch" href="/assets/js/76.aaca7275.js"><link rel="prefetch" href="/assets/js/77.1b271da3.js"><link rel="prefetch" href="/assets/js/78.476a924e.js"><link rel="prefetch" href="/assets/js/79.23be6cff.js"><link rel="prefetch" href="/assets/js/80.d592bdd2.js"><link rel="prefetch" href="/assets/js/81.461bcf2e.js"><link rel="prefetch" href="/assets/js/82.9888647c.js"><link rel="prefetch" href="/assets/js/83.d34e3c2a.js"><link rel="prefetch" href="/assets/js/84.0ba58301.js"><link rel="prefetch" href="/assets/js/85.5eb92f6d.js"><link rel="prefetch" href="/assets/js/86.efb3c6d4.js"><link rel="prefetch" href="/assets/js/87.c94d3f79.js"><link rel="prefetch" href="/assets/js/88.62d6286c.js"><link rel="prefetch" href="/assets/js/89.20284e25.js"><link rel="prefetch" href="/assets/js/90.af28317f.js"><link rel="prefetch" href="/assets/js/91.2909df0b.js"><link rel="prefetch" href="/assets/js/92.f47bc2a3.js"><link rel="prefetch" href="/assets/js/94.73eab5f3.js"><link rel="prefetch" href="/assets/js/95.5f08aca2.js"><link rel="prefetch" href="/assets/js/96.a82b607f.js"><link rel="prefetch" href="/assets/js/97.c61bfb76.js"><link rel="prefetch" href="/assets/js/98.55e7d7db.js"><link rel="prefetch" href="/assets/js/99.f1ab16a4.js"><link rel="prefetch" href="/assets/js/vendors~docsearch.3b28fe31.js">
    <link rel="stylesheet" href="/assets/css/0.styles.dd3f1dd5.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container no-sidebar"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><img src="/logo.png" alt="lin" class="logo"> <span class="site-name can-hide">lin</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/知识碎片/" class="nav-link"><!---->
  知识碎片
</a></div><div class="nav-item"><a href="/读书笔记/" class="nav-link"><!---->
  读书笔记
</a></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/知识碎片/" class="nav-link"><!---->
  知识碎片
</a></div><div class="nav-item"><a href="/读书笔记/" class="nav-link"><!---->
  读书笔记
</a></div> <!----></nav>  <!----> </aside> <main class="page"> <div class="content"><div style="width:100%"><div class="theme-default-content custom-content content__default"><h1 id="docker"><a href="#docker" class="header-anchor">#</a> Docker</h1> <h1 id="docker安装"><a href="#docker安装" class="header-anchor">#</a> docker安装</h1> <div class="language- line-numbers-mode"><pre class="language-text"><code>#yum安装gcc相关环境
yum -y install gcc
yum -y install gcc-c++

#1.uninstall old version
yum remove docker \
                  docker-client \
                  docker-client-latest \
                  docker-common \
                  docker-latest \
                  docker-latest-logrotate \
                  docker-logrotate \
                  docker-engine

#2.安装需要的软件包
yum install -y yum-utils

#3.设置镜像仓库
yum-config-manager \
    --add-repo \
http://mirrors.aliyun.com/docker-ce/linux/centos/docker-ce.repo

#4.更新yum软件包索引
yum makecache

#5.安装docker CE
yum install docker-ce docker-ce-cli containerd.io

#6.启动docker
systemctl start docker

#7.配置阿里云加速
mkdir -p /etc/docker

tee /etc/docker/daemon.json &lt;&lt;-'EOF'
{
  &quot;registry-mirrors&quot;: [&quot;https://a44vgxfx.mirror.aliyuncs.com&quot;]
}
EOF

systemctl daemon-reload

systemctl restart docker

</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br></div></div><h1 id="docker的常用命令"><a href="#docker的常用命令" class="header-anchor">#</a> <strong>Docker的常用命令</strong></h1> <h2 id="常用"><a href="#常用" class="header-anchor">#</a> 常用</h2> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code><span class="token comment">#启动docker</span>
systemctl start <span class="token function">docker</span>

<span class="token comment">#卸载docker</span>
systemctl stop <span class="token function">docker</span>

yum <span class="token parameter variable">-y</span> remove docker-ce docker-ce-cli containerd.io

<span class="token function">rm</span> <span class="token parameter variable">-rf</span> /var/lib/docker

</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br></div></div><h2 id="帮助命令"><a href="#帮助命令" class="header-anchor">#</a> <strong>帮助命令</strong></h2> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code><span class="token function">docker</span> version

<span class="token function">docker</span> info  //显示docker的系统信息

<span class="token function">docker</span> 命令 <span class="token parameter variable">--help</span>

</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><div class="language-java line-numbers-mode"><pre class="language-java"><code>docker info
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><ul><li><p>t1</p> <p>[root@vm1029731 ~]# docker info
Client:</p> <p>客户端
Context:    default</p> <p>内容：默认
Debug Mode: false</p> <p>debug模式：不开启</p> <p>Server:
Containers: 2
Running: 1
Paused: 0
Stopped: 1
Images: 2
Server Version: 20.10.18
Storage Driver: overlay2
Backing Filesystem: extfs
Supports d_type: true
Native Overlay Diff: true
userxattr: false
Logging Driver: json-file
Cgroup Driver: cgroupfs
Cgroup Version: 1</p> <ul><li><p>t1</p> <p>服务端：</p> <p>容器：两个</p> <p>运行中：一个</p> <p>暂停中：零个</p> <p>停止中：一个</p> <p>镜像：两个服务版本：20.10.18
存储器：overlay2</p> <p>备份文件系统：extfs</p> <p>支持的d_type</p> <p>原生overlay区分</p></li></ul> <p>Plugins:
Volume: local
Network: bridge host ipvlan macvlan null overlay
Log: awslogs fluentd gcplogs gelf journald json-file local logentries splunk syslog
Swarm: inactive
Runtimes: io.containerd.runc.v2 io.containerd.runtime.v1.linux runc
Default Runtime: runc
Init Binary: docker-init
containerd version: 9cd3357b7fd7218e4aec3eae239db1f68a5a6ec6
runc version: v1.1.4-0-g5fd4c4d1
init version: de40ad0</p> <ul><li><p>t1</p> <p>插件：</p> <p>容量：本地的</p> <p>网络： 桥接主机ipvlan,macvlan,非 overrlay</p> <p>日志：</p> <p>swarn</p> <p>运行时间：</p> <p>默认运行时间：</p> <p>初始化二进制：docker二进制</p> <p>容器版本：</p> <p>运行版本：</p> <p>初始化版本</p></li></ul> <p>Security Options:
seccomp
Profile: default
Kernel Version: 5.4.164-1.el8.elrepo.x86_64
Operating System: CentOS Stream 8
OSType: linux
Architecture: x86_64
CPUs: 1
Total Memory: 476.5MiB
Name: <a href="http://vm1029731.cloudsilk.io/" target="_blank" rel="noopener noreferrer">vm1029731.cloudsilk.io<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>
ID: 2AWV:QZSF:RI2N:RZKP:4B3Y:MB5J:6ABW:LH5L:QW3J:RPQS:QFDX:UHL2
Docker Root Dir: /var/lib/docker
Debug Mode: false
Registry: <a href="https://index.docker.io/v1/" target="_blank" rel="noopener noreferrer">https://index.docker.io/v1/<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <ul><li><p>t1</p> <p>安全选项：</p> <p>优先文件夹</p> <p>kernel version：内核版本</p> <p>操作系统</p> <p>系统类型</p> <p>architecture：架构</p> <p>cpu</p> <p>总内存</p> <p>名字</p> <p>docker根目录</p> <p>debug模式</p></li></ul> <p>Labels:
Experimental: false
Insecure Registries:
127.0.0.0/8
Live Restore Enabled: false
Product License: Community Engine</p> <ul><li><p>标签</p> <p>是线性的：false</p></li></ul></li></ul> <h2 id="镜像命令"><a href="#镜像命令" class="header-anchor">#</a> <strong>镜像命令</strong></h2> <div class="language- line-numbers-mode"><pre class="language-text"><code>docker images   查看本机所有的镜像

docker search   搜索命令

docker pull  下载镜像

docker rmi -f 删除镜像
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><h2 id="容器命令"><a href="#容器命令" class="header-anchor">#</a> <strong>容器命令</strong></h2> <p>有了镜像才可以创建容器</p> <p>新建容器并启动</p> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code><span class="token function">docker</span> run <span class="token punctuation">[</span>可选参数<span class="token punctuation">]</span> image

<span class="token comment">#可选参数</span>
<span class="token parameter variable">--name</span><span class="token operator">=</span><span class="token string">&quot;name&quot;</span>     容器名字，tomcat01，tomcat02，用来区分容器
<span class="token parameter variable">-d</span>                后台运行
<span class="token parameter variable">-it</span>               交互式运行
<span class="token parameter variable">-p</span>                指定容器的端口 <span class="token parameter variable">-p</span> <span class="token number">8080</span>:8080
   <span class="token parameter variable">-p</span> ip:主机端口:容器端口
   <span class="token parameter variable">-p</span> 主机端口:容器端口
   <span class="token parameter variable">-p</span> 容器端口
   容器端口
<span class="token parameter variable">-p</span>                 随机指定端口

<span class="token comment">#测试，启动并进入容器</span>
<span class="token punctuation">[</span>root@vm1029731 ~<span class="token punctuation">]</span><span class="token comment"># docker run -it centos /bin/bash</span>
<span class="token punctuation">[</span>root@b1de5b9b12d3 /<span class="token punctuation">]</span><span class="token comment"># ls #查看容器的centos，很多命令不是完善的</span>
bin  etc   lib	  lost+found  mnt  proc  run   srv  tmp  var
dev  home  lib64  media       opt  root  sbin  sys  usr

<span class="token comment">#从容器中退出</span>
<span class="token punctuation">[</span>root@6f708e6376bc /<span class="token punctuation">]</span><span class="token comment"># exit</span>
<span class="token builtin class-name">exit</span>

</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br></div></div><p>列出所有运行中的容器</p> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code><span class="token function">docker</span> <span class="token function">ps</span>  查看运行中的容器
    <span class="token comment">#当前运行、</span>
<span class="token parameter variable">-a</span>  <span class="token comment">#列出运行的容器+历史运行</span>
<span class="token parameter variable">-n</span><span class="token operator">=</span>? <span class="token comment">#显示最近创建的容器</span>
<span class="token parameter variable">-q</span>   <span class="token comment">#只显示容器编号</span>

<span class="token punctuation">[</span>root@iZ2vc7zktoz7z9fn3qhptjZ ~<span class="token punctuation">]</span><span class="token comment"># docker ps</span>
CONTAINER ID   IMAGE     COMMAND   CREATED   STATUS    PORTS     NAMES

<span class="token punctuation">[</span>root@iZ2vc7zktoz7z9fn3qhptjZ ~<span class="token punctuation">]</span><span class="token comment"># docker ps -a</span>
CONTAINER ID   IMAGE         COMMAND       CREATED             STATUS                         PORTS     NAMES
66b736657325   centos        <span class="token string">&quot;/bin/bash&quot;</span>   <span class="token number">5</span> minutes ago       Exited <span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span> <span class="token number">3</span> minutes ago                 bold_golick
	bc74ee3218c7   hello-world   <span class="token string">&quot;/hello&quot;</span>      About an hour ago   Exited <span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span> About an hour ago             wonderful_kepler

<span class="token punctuation">[</span>root@vm1029731 /<span class="token punctuation">]</span><span class="token comment"># docker ps -n=3</span>
CONTAINER ID   IMAGE          COMMAND                  CREATED          STATUS                        PORTS     NAMES
6f708e6376bc   centos         <span class="token string">&quot;/bin/bash&quot;</span>              <span class="token number">10</span> minutes ago   Exited <span class="token punctuation">(</span><span class="token number">127</span><span class="token punctuation">)</span> <span class="token number">9</span> minutes ago              stoic_beaver
b1de5b9b12d3   centos         <span class="token string">&quot;/bin/bash&quot;</span>              <span class="token number">13</span> minutes ago   Exited <span class="token punctuation">(</span><span class="token number">127</span><span class="token punctuation">)</span> <span class="token number">12</span> minutes ago             infallible_ellis
103f0e0c95e9   nginx:latest   <span class="token string">&quot;/docker-entrypoint.…&quot;</span>   <span class="token number">43</span> hours ago     Exited <span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span> <span class="token number">43</span> hours ago                 nginx

<span class="token punctuation">[</span>root@vm1029731 /<span class="token punctuation">]</span><span class="token comment"># docker ps -aq</span>
6f708e6376bc
b1de5b9b12d3
103f0e0c95e9
ce1934a522f9
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br></div></div><p>退出容器</p> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code><span class="token builtin class-name">exit</span> <span class="token comment">#直接从容器退出</span>
Ctrl + p + Q <span class="token comment">#容器不停止退出</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><p>删除容器</p> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code><span class="token function">docker</span> <span class="token function">rm</span> 容器id                    <span class="token comment">#删除指定的容器</span>
<span class="token function">docker</span> <span class="token function">rm</span> <span class="token parameter variable">-f</span> <span class="token variable"><span class="token variable">$(</span><span class="token function">docker</span> <span class="token function">ps</span> <span class="token parameter variable">-aq</span><span class="token variable">)</span></span>       <span class="token comment">#删除全部容器</span>
<span class="token function">docker</span> <span class="token function">rm</span> <span class="token parameter variable">-f</span>                        <span class="token comment">#强制删除容器</span>
<span class="token function">docker</span> <span class="token function">ps</span> <span class="token parameter variable">-a</span> -q<span class="token operator">|</span><span class="token function">xargs</span> <span class="token function">docker</span> <span class="token function">rm</span>     <span class="token comment">#删除所有容器</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><p>启动和停止容器</p> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code><span class="token function">docker</span> start 容器id    <span class="token comment">#启动容器</span>
<span class="token function">docker</span> restart 容器id  <span class="token comment">#重启容器</span>
<span class="token function">docker</span> stop 容器id     <span class="token comment">#停止当前运行的容器</span>
<span class="token function">docker</span> <span class="token function">kill</span> 容器id     <span class="token comment">#强制停止当前容器</span>

</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><p>其他常用命令</p> <ul><li>后台启动容器</li></ul> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code><span class="token comment"># 命令docker run -d 镜像名</span>
<span class="token punctuation">[</span>root@vm1029731 /<span class="token punctuation">]</span><span class="token comment"># docker run --name cenos2 -d centos</span>

<span class="token comment"># docker ps 后发现这个centos停止了</span>

<span class="token comment"># 常见的坑，docker容器在后台运行后，必须要有一个前台进程，如果在运行的过程中没有发现</span>
<span class="token comment"># 前台进程，那么启动的docker启动的后台进程就会自杀。</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><ul><li>查看日志</li></ul> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code><span class="token function">docker</span> logs <span class="token parameter variable">-f</span> <span class="token parameter variable">-t</span> <span class="token parameter variable">--tail</span> 容器，没有日志

<span class="token comment">#自己编写一段shell脚本</span>
<span class="token function">docker</span> run <span class="token parameter variable">-d</span> centos /bin/sh <span class="token parameter variable">-c</span> <span class="token string">&quot;while true;do echo kuangshen;sleep 1;done&quot;</span>

<span class="token punctuation">[</span>root@iZ2vc7zktoz7z9fn3qhptjZ ~<span class="token punctuation">]</span><span class="token comment"># docker ps</span>

<span class="token punctuation">[</span>root@iZ2vc7zktoz7z9fn3qhptjZ ~<span class="token punctuation">]</span><span class="token comment"># docker logs -tf --tail 10 ca62595a175a</span>
<span class="token comment"># -t加时间戳 -f 跟着日志输出 --tail 尾巴</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br></div></div><ul><li>查看容器中的进程信息ps</li></ul> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code><span class="token comment"># 命令docker top 容器id</span>

<span class="token comment"># 测试</span>
<span class="token punctuation">[</span>root@vm1029731 /<span class="token punctuation">]</span><span class="token comment"># docker top e8251c58d26e</span>
<span class="token environment constant">UID</span>                 PID                 <span class="token environment constant">PPID</span>                C                   STIME               TTY                 TIME                CMD
root                <span class="token number">25160</span>               <span class="token number">25141</span>               <span class="token number">0</span>                   <span class="token number">11</span>:36               ?                   00:00:00            /bin/sh <span class="token parameter variable">-c</span> <span class="token keyword">while</span> <span class="token boolean">true</span><span class="token punctuation">;</span><span class="token keyword">do</span> <span class="token builtin class-name">echo</span> hello bigdragon<span class="token punctuation">;</span><span class="token function">sleep</span> <span class="token number">1</span><span class="token punctuation">;</span><span class="token keyword">done</span>
root                <span class="token number">25781</span>               <span class="token number">25160</span>               <span class="token number">0</span>                   <span class="token number">11</span>:44               ?                   00:00:00            /usr/bin/coreutils --coreutils-prog-shebang<span class="token operator">=</span>sleep /usr/bin/sleep <span class="token number">1</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><ul><li>查看镜像的元数据</li></ul> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code><span class="token comment"># 命令 docker inspect 容器id</span>
<span class="token punctuation">[</span>
    <span class="token punctuation">{</span>
        <span class="token string">&quot;Id&quot;</span><span class="token builtin class-name">:</span> <span class="token string">&quot;e8251c58d26e3aa3bd70e3f23cd969a8cfb36e93777a6b72dfb0ec40dffc4a21&quot;</span>,
        <span class="token string">&quot;Created&quot;</span><span class="token builtin class-name">:</span> <span class="token string">&quot;2022-09-27T11:36:30.515226773Z&quot;</span>,
        <span class="token string">&quot;Path&quot;</span><span class="token builtin class-name">:</span> <span class="token string">&quot;/bin/sh&quot;</span>,
        <span class="token string">&quot;Args&quot;</span><span class="token builtin class-name">:</span> <span class="token punctuation">[</span>
            <span class="token string">&quot;-c&quot;</span>,
            <span class="token string">&quot;while true;do echo hello bigdragon;sleep 1;done&quot;</span>
        <span class="token punctuation">]</span>,
        <span class="token string">&quot;State&quot;</span><span class="token builtin class-name">:</span> <span class="token punctuation">{</span>
            <span class="token string">&quot;Status&quot;</span><span class="token builtin class-name">:</span> <span class="token string">&quot;running&quot;</span>,
            <span class="token string">&quot;Running&quot;</span><span class="token builtin class-name">:</span> true,
            <span class="token string">&quot;Paused&quot;</span><span class="token builtin class-name">:</span> false,
            <span class="token string">&quot;Restarting&quot;</span><span class="token builtin class-name">:</span> false,
            <span class="token string">&quot;OOMKilled&quot;</span><span class="token builtin class-name">:</span> false,
            <span class="token string">&quot;Dead&quot;</span><span class="token builtin class-name">:</span> false,
            <span class="token string">&quot;Pid&quot;</span><span class="token builtin class-name">:</span> <span class="token number">25160</span>,
            <span class="token string">&quot;ExitCode&quot;</span><span class="token builtin class-name">:</span> <span class="token number">0</span>,
            <span class="token string">&quot;Error&quot;</span><span class="token builtin class-name">:</span> <span class="token string">&quot;&quot;</span>,
            <span class="token string">&quot;StartedAt&quot;</span><span class="token builtin class-name">:</span> <span class="token string">&quot;2022-09-27T11:36:30.809380919Z&quot;</span>,
            <span class="token string">&quot;FinishedAt&quot;</span><span class="token builtin class-name">:</span> <span class="token string">&quot;0001-01-01T00:00:00Z&quot;</span>
        <span class="token punctuation">}</span>,
        <span class="token string">&quot;Image&quot;</span><span class="token builtin class-name">:</span> <span class="token string">&quot;sha256:5d0da3dc976460b72c77d94c8a1ad043720b0416bfc16c52c45d4847e53fadb6&quot;</span>,
        <span class="token string">&quot;ResolvConfPath&quot;</span><span class="token builtin class-name">:</span> <span class="token string">&quot;/var/lib/docker/containers/e8251c58d26e3aa3bd70e3f23cd969a8cfb36e93777a6b72dfb0ec40dffc4a21/resolv.conf&quot;</span>,
        <span class="token string">&quot;HostnamePath&quot;</span><span class="token builtin class-name">:</span> <span class="token string">&quot;/var/lib/docker/containers/e8251c58d26e3aa3bd70e3f23cd969a8cfb36e93777a6b72dfb0ec40dffc4a21/hostname&quot;</span>,
        <span class="token string">&quot;HostsPath&quot;</span><span class="token builtin class-name">:</span> <span class="token string">&quot;/var/lib/docker/containers/e8251c58d26e3aa3bd70e3f23cd969a8cfb36e93777a6b72dfb0ec40dffc4a21/hosts&quot;</span>,
        <span class="token string">&quot;LogPath&quot;</span><span class="token builtin class-name">:</span> <span class="token string">&quot;/var/lib/docker/containers/e8251c58d26e3aa3bd70e3f23cd969a8cfb36e93777a6b72dfb0ec40dffc4a21/e8251c58d26e3aa3bd70e3f23cd969a8cfb36e93777a6b72dfb0ec40dffc4a21-json.log&quot;</span>,
        <span class="token string">&quot;Name&quot;</span><span class="token builtin class-name">:</span> <span class="token string">&quot;/quirky_stonebraker&quot;</span>,
        <span class="token string">&quot;RestartCount&quot;</span><span class="token builtin class-name">:</span> <span class="token number">0</span>,
        <span class="token string">&quot;Driver&quot;</span><span class="token builtin class-name">:</span> <span class="token string">&quot;overlay2&quot;</span>,
        <span class="token string">&quot;Platform&quot;</span><span class="token builtin class-name">:</span> <span class="token string">&quot;linux&quot;</span>,
        <span class="token string">&quot;MountLabel&quot;</span><span class="token builtin class-name">:</span> <span class="token string">&quot;&quot;</span>,
        <span class="token string">&quot;ProcessLabel&quot;</span><span class="token builtin class-name">:</span> <span class="token string">&quot;&quot;</span>,
        <span class="token string">&quot;AppArmorProfile&quot;</span><span class="token builtin class-name">:</span> <span class="token string">&quot;&quot;</span>,
        <span class="token string">&quot;ExecIDs&quot;</span><span class="token builtin class-name">:</span> null,
        <span class="token string">&quot;HostConfig&quot;</span><span class="token builtin class-name">:</span> <span class="token punctuation">{</span>
            <span class="token string">&quot;Binds&quot;</span><span class="token builtin class-name">:</span> null,
            <span class="token string">&quot;ContainerIDFile&quot;</span><span class="token builtin class-name">:</span> <span class="token string">&quot;&quot;</span>,
            <span class="token string">&quot;LogConfig&quot;</span><span class="token builtin class-name">:</span> <span class="token punctuation">{</span>
                <span class="token string">&quot;Type&quot;</span><span class="token builtin class-name">:</span> <span class="token string">&quot;json-file&quot;</span>,
                <span class="token string">&quot;Config&quot;</span><span class="token builtin class-name">:</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
            <span class="token punctuation">}</span>,
            <span class="token string">&quot;NetworkMode&quot;</span><span class="token builtin class-name">:</span> <span class="token string">&quot;default&quot;</span>,
            <span class="token string">&quot;PortBindings&quot;</span><span class="token builtin class-name">:</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>,
            <span class="token string">&quot;RestartPolicy&quot;</span><span class="token builtin class-name">:</span> <span class="token punctuation">{</span>
                <span class="token string">&quot;Name&quot;</span><span class="token builtin class-name">:</span> <span class="token string">&quot;no&quot;</span>,
                <span class="token string">&quot;MaximumRetryCount&quot;</span><span class="token builtin class-name">:</span> <span class="token number">0</span>
            <span class="token punctuation">}</span>,
            <span class="token string">&quot;AutoRemove&quot;</span><span class="token builtin class-name">:</span> false,
            <span class="token string">&quot;VolumeDriver&quot;</span><span class="token builtin class-name">:</span> <span class="token string">&quot;&quot;</span>,
            <span class="token string">&quot;VolumesFrom&quot;</span><span class="token builtin class-name">:</span> null,
            <span class="token string">&quot;CapAdd&quot;</span><span class="token builtin class-name">:</span> null,
            <span class="token string">&quot;CapDrop&quot;</span><span class="token builtin class-name">:</span> null,
            <span class="token string">&quot;CgroupnsMode&quot;</span><span class="token builtin class-name">:</span> <span class="token string">&quot;host&quot;</span>,
            <span class="token string">&quot;Dns&quot;</span><span class="token builtin class-name">:</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>,
            <span class="token string">&quot;DnsOptions&quot;</span><span class="token builtin class-name">:</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>,
            <span class="token string">&quot;DnsSearch&quot;</span><span class="token builtin class-name">:</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>,
            <span class="token string">&quot;ExtraHosts&quot;</span><span class="token builtin class-name">:</span> null,
            <span class="token string">&quot;GroupAdd&quot;</span><span class="token builtin class-name">:</span> null,
            <span class="token string">&quot;IpcMode&quot;</span><span class="token builtin class-name">:</span> <span class="token string">&quot;private&quot;</span>,
            <span class="token string">&quot;Cgroup&quot;</span><span class="token builtin class-name">:</span> <span class="token string">&quot;&quot;</span>,
            <span class="token string">&quot;Links&quot;</span><span class="token builtin class-name">:</span> null,
            <span class="token string">&quot;OomScoreAdj&quot;</span><span class="token builtin class-name">:</span> <span class="token number">0</span>,
            <span class="token string">&quot;PidMode&quot;</span><span class="token builtin class-name">:</span> <span class="token string">&quot;&quot;</span>,
            <span class="token string">&quot;Privileged&quot;</span><span class="token builtin class-name">:</span> false,
            <span class="token string">&quot;PublishAllPorts&quot;</span><span class="token builtin class-name">:</span> false,
            <span class="token string">&quot;ReadonlyRootfs&quot;</span><span class="token builtin class-name">:</span> false,
            <span class="token string">&quot;SecurityOpt&quot;</span><span class="token builtin class-name">:</span> null,
            <span class="token string">&quot;UTSMode&quot;</span><span class="token builtin class-name">:</span> <span class="token string">&quot;&quot;</span>,
            <span class="token string">&quot;UsernsMode&quot;</span><span class="token builtin class-name">:</span> <span class="token string">&quot;&quot;</span>,
            <span class="token string">&quot;ShmSize&quot;</span><span class="token builtin class-name">:</span> <span class="token number">67108864</span>,
            <span class="token string">&quot;Runtime&quot;</span><span class="token builtin class-name">:</span> <span class="token string">&quot;runc&quot;</span>,
            <span class="token string">&quot;ConsoleSize&quot;</span><span class="token builtin class-name">:</span> <span class="token punctuation">[</span>
                <span class="token number">0</span>,
                <span class="token number">0</span>
            <span class="token punctuation">]</span>,
            <span class="token string">&quot;Isolation&quot;</span><span class="token builtin class-name">:</span> <span class="token string">&quot;&quot;</span>,
            <span class="token string">&quot;CpuShares&quot;</span><span class="token builtin class-name">:</span> <span class="token number">0</span>,
            <span class="token string">&quot;Memory&quot;</span><span class="token builtin class-name">:</span> <span class="token number">0</span>,
            <span class="token string">&quot;NanoCpus&quot;</span><span class="token builtin class-name">:</span> <span class="token number">0</span>,
            <span class="token string">&quot;CgroupParent&quot;</span><span class="token builtin class-name">:</span> <span class="token string">&quot;&quot;</span>,
            <span class="token string">&quot;BlkioWeight&quot;</span><span class="token builtin class-name">:</span> <span class="token number">0</span>,
            <span class="token string">&quot;BlkioWeightDevice&quot;</span><span class="token builtin class-name">:</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>,
            <span class="token string">&quot;BlkioDeviceReadBps&quot;</span><span class="token builtin class-name">:</span> null,
            <span class="token string">&quot;BlkioDeviceWriteBps&quot;</span><span class="token builtin class-name">:</span> null,
            <span class="token string">&quot;BlkioDeviceReadIOps&quot;</span><span class="token builtin class-name">:</span> null,
            <span class="token string">&quot;BlkioDeviceWriteIOps&quot;</span><span class="token builtin class-name">:</span> null,
            <span class="token string">&quot;CpuPeriod&quot;</span><span class="token builtin class-name">:</span> <span class="token number">0</span>,
            <span class="token string">&quot;CpuQuota&quot;</span><span class="token builtin class-name">:</span> <span class="token number">0</span>,
            <span class="token string">&quot;CpuRealtimePeriod&quot;</span><span class="token builtin class-name">:</span> <span class="token number">0</span>,
            <span class="token string">&quot;CpuRealtimeRuntime&quot;</span><span class="token builtin class-name">:</span> <span class="token number">0</span>,
            <span class="token string">&quot;CpusetCpus&quot;</span><span class="token builtin class-name">:</span> <span class="token string">&quot;&quot;</span>,
            <span class="token string">&quot;CpusetMems&quot;</span><span class="token builtin class-name">:</span> <span class="token string">&quot;&quot;</span>,
            <span class="token string">&quot;Devices&quot;</span><span class="token builtin class-name">:</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>,
            <span class="token string">&quot;DeviceCgroupRules&quot;</span><span class="token builtin class-name">:</span> null,
            <span class="token string">&quot;DeviceRequests&quot;</span><span class="token builtin class-name">:</span> null,
            <span class="token string">&quot;KernelMemory&quot;</span><span class="token builtin class-name">:</span> <span class="token number">0</span>,
            <span class="token string">&quot;KernelMemoryTCP&quot;</span><span class="token builtin class-name">:</span> <span class="token number">0</span>,
            <span class="token string">&quot;MemoryReservation&quot;</span><span class="token builtin class-name">:</span> <span class="token number">0</span>,
            <span class="token string">&quot;MemorySwap&quot;</span><span class="token builtin class-name">:</span> <span class="token number">0</span>,
            <span class="token string">&quot;MemorySwappiness&quot;</span><span class="token builtin class-name">:</span> null,
            <span class="token string">&quot;OomKillDisable&quot;</span><span class="token builtin class-name">:</span> false,
            <span class="token string">&quot;PidsLimit&quot;</span><span class="token builtin class-name">:</span> null,
            <span class="token string">&quot;Ulimits&quot;</span><span class="token builtin class-name">:</span> null,
            <span class="token string">&quot;CpuCount&quot;</span><span class="token builtin class-name">:</span> <span class="token number">0</span>,
            <span class="token string">&quot;CpuPercent&quot;</span><span class="token builtin class-name">:</span> <span class="token number">0</span>,
            <span class="token string">&quot;IOMaximumIOps&quot;</span><span class="token builtin class-name">:</span> <span class="token number">0</span>,
            <span class="token string">&quot;IOMaximumBandwidth&quot;</span><span class="token builtin class-name">:</span> <span class="token number">0</span>,
            <span class="token string">&quot;MaskedPaths&quot;</span><span class="token builtin class-name">:</span> <span class="token punctuation">[</span>
                <span class="token string">&quot;/proc/asound&quot;</span>,
                <span class="token string">&quot;/proc/acpi&quot;</span>,
                <span class="token string">&quot;/proc/kcore&quot;</span>,
                <span class="token string">&quot;/proc/keys&quot;</span>,
                <span class="token string">&quot;/proc/latency_stats&quot;</span>,
                <span class="token string">&quot;/proc/timer_list&quot;</span>,
                <span class="token string">&quot;/proc/timer_stats&quot;</span>,
                <span class="token string">&quot;/proc/sched_debug&quot;</span>,
                <span class="token string">&quot;/proc/scsi&quot;</span>,
                <span class="token string">&quot;/sys/firmware&quot;</span>
            <span class="token punctuation">]</span>,
            <span class="token string">&quot;ReadonlyPaths&quot;</span><span class="token builtin class-name">:</span> <span class="token punctuation">[</span>
                <span class="token string">&quot;/proc/bus&quot;</span>,
                <span class="token string">&quot;/proc/fs&quot;</span>,
                <span class="token string">&quot;/proc/irq&quot;</span>,
                <span class="token string">&quot;/proc/sys&quot;</span>,
                <span class="token string">&quot;/proc/sysrq-trigger&quot;</span>
            <span class="token punctuation">]</span>
        <span class="token punctuation">}</span>,
        <span class="token string">&quot;GraphDriver&quot;</span><span class="token builtin class-name">:</span> <span class="token punctuation">{</span>
            <span class="token string">&quot;Data&quot;</span><span class="token builtin class-name">:</span> <span class="token punctuation">{</span>
                <span class="token string">&quot;LowerDir&quot;</span><span class="token builtin class-name">:</span> <span class="token string">&quot;/var/lib/docker/overlay2/7310c7dcf0b88cfbc74202e6e13f611a31eacedcdc6ded02b78cbb37bbce8deb-init/diff:/var/lib/docker/overlay2/61f6bb3d5dd6f0075ab3b2eb7013b07038f3f69f9d2e9a4e9233c620357e1031/diff&quot;</span>,
                <span class="token string">&quot;MergedDir&quot;</span><span class="token builtin class-name">:</span> <span class="token string">&quot;/var/lib/docker/overlay2/7310c7dcf0b88cfbc74202e6e13f611a31eacedcdc6ded02b78cbb37bbce8deb/merged&quot;</span>,
                <span class="token string">&quot;UpperDir&quot;</span><span class="token builtin class-name">:</span> <span class="token string">&quot;/var/lib/docker/overlay2/7310c7dcf0b88cfbc74202e6e13f611a31eacedcdc6ded02b78cbb37bbce8deb/diff&quot;</span>,
                <span class="token string">&quot;WorkDir&quot;</span><span class="token builtin class-name">:</span> <span class="token string">&quot;/var/lib/docker/overlay2/7310c7dcf0b88cfbc74202e6e13f611a31eacedcdc6ded02b78cbb37bbce8deb/work&quot;</span>
            <span class="token punctuation">}</span>,
            <span class="token string">&quot;Name&quot;</span><span class="token builtin class-name">:</span> <span class="token string">&quot;overlay2&quot;</span>
        <span class="token punctuation">}</span>,
        <span class="token string">&quot;Mounts&quot;</span><span class="token builtin class-name">:</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>,
        <span class="token string">&quot;Config&quot;</span><span class="token builtin class-name">:</span> <span class="token punctuation">{</span>
            <span class="token string">&quot;Hostname&quot;</span><span class="token builtin class-name">:</span> <span class="token string">&quot;e8251c58d26e&quot;</span>,
            <span class="token string">&quot;Domainname&quot;</span><span class="token builtin class-name">:</span> <span class="token string">&quot;&quot;</span>,
            <span class="token string">&quot;User&quot;</span><span class="token builtin class-name">:</span> <span class="token string">&quot;&quot;</span>,
            <span class="token string">&quot;AttachStdin&quot;</span><span class="token builtin class-name">:</span> false,
            <span class="token string">&quot;AttachStdout&quot;</span><span class="token builtin class-name">:</span> false,
            <span class="token string">&quot;AttachStderr&quot;</span><span class="token builtin class-name">:</span> false,
            <span class="token string">&quot;Tty&quot;</span><span class="token builtin class-name">:</span> false,
            <span class="token string">&quot;OpenStdin&quot;</span><span class="token builtin class-name">:</span> false,
            <span class="token string">&quot;StdinOnce&quot;</span><span class="token builtin class-name">:</span> false,
            <span class="token string">&quot;Env&quot;</span><span class="token builtin class-name">:</span> <span class="token punctuation">[</span>
                <span class="token string">&quot;PATH=/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin&quot;</span>
            <span class="token punctuation">]</span>,
            <span class="token string">&quot;Cmd&quot;</span><span class="token builtin class-name">:</span> <span class="token punctuation">[</span>
                <span class="token string">&quot;/bin/sh&quot;</span>,
                <span class="token string">&quot;-c&quot;</span>,
                <span class="token string">&quot;while true;do echo hello bigdragon;sleep 1;done&quot;</span>
            <span class="token punctuation">]</span>,
            <span class="token string">&quot;Image&quot;</span><span class="token builtin class-name">:</span> <span class="token string">&quot;centos&quot;</span>,
            <span class="token string">&quot;Volumes&quot;</span><span class="token builtin class-name">:</span> null,
            <span class="token string">&quot;WorkingDir&quot;</span><span class="token builtin class-name">:</span> <span class="token string">&quot;&quot;</span>,
            <span class="token string">&quot;Entrypoint&quot;</span><span class="token builtin class-name">:</span> null,
            <span class="token string">&quot;OnBuild&quot;</span><span class="token builtin class-name">:</span> null,
            <span class="token string">&quot;Labels&quot;</span><span class="token builtin class-name">:</span> <span class="token punctuation">{</span>
                <span class="token string">&quot;org.label-schema.build-date&quot;</span><span class="token builtin class-name">:</span> <span class="token string">&quot;20210915&quot;</span>,
                <span class="token string">&quot;org.label-schema.license&quot;</span><span class="token builtin class-name">:</span> <span class="token string">&quot;GPLv2&quot;</span>,
                <span class="token string">&quot;org.label-schema.name&quot;</span><span class="token builtin class-name">:</span> <span class="token string">&quot;CentOS Base Image&quot;</span>,
                <span class="token string">&quot;org.label-schema.schema-version&quot;</span><span class="token builtin class-name">:</span> <span class="token string">&quot;1.0&quot;</span>,
                <span class="token string">&quot;org.label-schema.vendor&quot;</span><span class="token builtin class-name">:</span> <span class="token string">&quot;CentOS&quot;</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>,
        <span class="token string">&quot;NetworkSettings&quot;</span><span class="token builtin class-name">:</span> <span class="token punctuation">{</span>
            <span class="token string">&quot;Bridge&quot;</span><span class="token builtin class-name">:</span> <span class="token string">&quot;&quot;</span>,
            <span class="token string">&quot;SandboxID&quot;</span><span class="token builtin class-name">:</span> <span class="token string">&quot;00744082dcf4cef27dd2b061824c19cf2589f9969c5ed05614bc3869f88fa356&quot;</span>,
            <span class="token string">&quot;HairpinMode&quot;</span><span class="token builtin class-name">:</span> false,
            <span class="token string">&quot;LinkLocalIPv6Address&quot;</span><span class="token builtin class-name">:</span> <span class="token string">&quot;&quot;</span>,
            <span class="token string">&quot;LinkLocalIPv6PrefixLen&quot;</span><span class="token builtin class-name">:</span> <span class="token number">0</span>,
            <span class="token string">&quot;Ports&quot;</span><span class="token builtin class-name">:</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>,
            <span class="token string">&quot;SandboxKey&quot;</span><span class="token builtin class-name">:</span> <span class="token string">&quot;/var/run/docker/netns/00744082dcf4&quot;</span>,
            <span class="token string">&quot;SecondaryIPAddresses&quot;</span><span class="token builtin class-name">:</span> null,
            <span class="token string">&quot;SecondaryIPv6Addresses&quot;</span><span class="token builtin class-name">:</span> null,
            <span class="token string">&quot;EndpointID&quot;</span><span class="token builtin class-name">:</span> <span class="token string">&quot;2bdd2e34b30ae8ae73ea32f30de0c1a03b94214d422e770521f9a3814286c1f7&quot;</span>,
            <span class="token string">&quot;Gateway&quot;</span><span class="token builtin class-name">:</span> <span class="token string">&quot;172.17.0.1&quot;</span>,
            <span class="token string">&quot;GlobalIPv6Address&quot;</span><span class="token builtin class-name">:</span> <span class="token string">&quot;&quot;</span>,
            <span class="token string">&quot;GlobalIPv6PrefixLen&quot;</span><span class="token builtin class-name">:</span> <span class="token number">0</span>,
            <span class="token string">&quot;IPAddress&quot;</span><span class="token builtin class-name">:</span> <span class="token string">&quot;172.17.0.3&quot;</span>,
            <span class="token string">&quot;IPPrefixLen&quot;</span><span class="token builtin class-name">:</span> <span class="token number">16</span>,
            <span class="token string">&quot;IPv6Gateway&quot;</span><span class="token builtin class-name">:</span> <span class="token string">&quot;&quot;</span>,
            <span class="token string">&quot;MacAddress&quot;</span><span class="token builtin class-name">:</span> <span class="token string">&quot;02:42:ac:11:00:03&quot;</span>,
            <span class="token string">&quot;Networks&quot;</span><span class="token builtin class-name">:</span> <span class="token punctuation">{</span>
                <span class="token string">&quot;bridge&quot;</span><span class="token builtin class-name">:</span> <span class="token punctuation">{</span>
                    <span class="token string">&quot;IPAMConfig&quot;</span><span class="token builtin class-name">:</span> null,
                    <span class="token string">&quot;Links&quot;</span><span class="token builtin class-name">:</span> null,
                    <span class="token string">&quot;Aliases&quot;</span><span class="token builtin class-name">:</span> null,
                    <span class="token string">&quot;NetworkID&quot;</span><span class="token builtin class-name">:</span> <span class="token string">&quot;fb64fa3c9facedeff167789bdd14f22359a88d43537f36044a16d3b74a85e74a&quot;</span>,
                    <span class="token string">&quot;EndpointID&quot;</span><span class="token builtin class-name">:</span> <span class="token string">&quot;2bdd2e34b30ae8ae73ea32f30de0c1a03b94214d422e770521f9a3814286c1f7&quot;</span>,
                    <span class="token string">&quot;Gateway&quot;</span><span class="token builtin class-name">:</span> <span class="token string">&quot;172.17.0.1&quot;</span>,
                    <span class="token string">&quot;IPAddress&quot;</span><span class="token builtin class-name">:</span> <span class="token string">&quot;172.17.0.3&quot;</span>,
                    <span class="token string">&quot;IPPrefixLen&quot;</span><span class="token builtin class-name">:</span> <span class="token number">16</span>,
                    <span class="token string">&quot;IPv6Gateway&quot;</span><span class="token builtin class-name">:</span> <span class="token string">&quot;&quot;</span>,
                    <span class="token string">&quot;GlobalIPv6Address&quot;</span><span class="token builtin class-name">:</span> <span class="token string">&quot;&quot;</span>,
                    <span class="token string">&quot;GlobalIPv6PrefixLen&quot;</span><span class="token builtin class-name">:</span> <span class="token number">0</span>,
                    <span class="token string">&quot;MacAddress&quot;</span><span class="token builtin class-name">:</span> <span class="token string">&quot;02:42:ac:11:00:03&quot;</span>,
                    <span class="token string">&quot;DriverOpts&quot;</span><span class="token builtin class-name">:</span> null
                <span class="token punctuation">}</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">]</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br><span class="line-number">53</span><br><span class="line-number">54</span><br><span class="line-number">55</span><br><span class="line-number">56</span><br><span class="line-number">57</span><br><span class="line-number">58</span><br><span class="line-number">59</span><br><span class="line-number">60</span><br><span class="line-number">61</span><br><span class="line-number">62</span><br><span class="line-number">63</span><br><span class="line-number">64</span><br><span class="line-number">65</span><br><span class="line-number">66</span><br><span class="line-number">67</span><br><span class="line-number">68</span><br><span class="line-number">69</span><br><span class="line-number">70</span><br><span class="line-number">71</span><br><span class="line-number">72</span><br><span class="line-number">73</span><br><span class="line-number">74</span><br><span class="line-number">75</span><br><span class="line-number">76</span><br><span class="line-number">77</span><br><span class="line-number">78</span><br><span class="line-number">79</span><br><span class="line-number">80</span><br><span class="line-number">81</span><br><span class="line-number">82</span><br><span class="line-number">83</span><br><span class="line-number">84</span><br><span class="line-number">85</span><br><span class="line-number">86</span><br><span class="line-number">87</span><br><span class="line-number">88</span><br><span class="line-number">89</span><br><span class="line-number">90</span><br><span class="line-number">91</span><br><span class="line-number">92</span><br><span class="line-number">93</span><br><span class="line-number">94</span><br><span class="line-number">95</span><br><span class="line-number">96</span><br><span class="line-number">97</span><br><span class="line-number">98</span><br><span class="line-number">99</span><br><span class="line-number">100</span><br><span class="line-number">101</span><br><span class="line-number">102</span><br><span class="line-number">103</span><br><span class="line-number">104</span><br><span class="line-number">105</span><br><span class="line-number">106</span><br><span class="line-number">107</span><br><span class="line-number">108</span><br><span class="line-number">109</span><br><span class="line-number">110</span><br><span class="line-number">111</span><br><span class="line-number">112</span><br><span class="line-number">113</span><br><span class="line-number">114</span><br><span class="line-number">115</span><br><span class="line-number">116</span><br><span class="line-number">117</span><br><span class="line-number">118</span><br><span class="line-number">119</span><br><span class="line-number">120</span><br><span class="line-number">121</span><br><span class="line-number">122</span><br><span class="line-number">123</span><br><span class="line-number">124</span><br><span class="line-number">125</span><br><span class="line-number">126</span><br><span class="line-number">127</span><br><span class="line-number">128</span><br><span class="line-number">129</span><br><span class="line-number">130</span><br><span class="line-number">131</span><br><span class="line-number">132</span><br><span class="line-number">133</span><br><span class="line-number">134</span><br><span class="line-number">135</span><br><span class="line-number">136</span><br><span class="line-number">137</span><br><span class="line-number">138</span><br><span class="line-number">139</span><br><span class="line-number">140</span><br><span class="line-number">141</span><br><span class="line-number">142</span><br><span class="line-number">143</span><br><span class="line-number">144</span><br><span class="line-number">145</span><br><span class="line-number">146</span><br><span class="line-number">147</span><br><span class="line-number">148</span><br><span class="line-number">149</span><br><span class="line-number">150</span><br><span class="line-number">151</span><br><span class="line-number">152</span><br><span class="line-number">153</span><br><span class="line-number">154</span><br><span class="line-number">155</span><br><span class="line-number">156</span><br><span class="line-number">157</span><br><span class="line-number">158</span><br><span class="line-number">159</span><br><span class="line-number">160</span><br><span class="line-number">161</span><br><span class="line-number">162</span><br><span class="line-number">163</span><br><span class="line-number">164</span><br><span class="line-number">165</span><br><span class="line-number">166</span><br><span class="line-number">167</span><br><span class="line-number">168</span><br><span class="line-number">169</span><br><span class="line-number">170</span><br><span class="line-number">171</span><br><span class="line-number">172</span><br><span class="line-number">173</span><br><span class="line-number">174</span><br><span class="line-number">175</span><br><span class="line-number">176</span><br><span class="line-number">177</span><br><span class="line-number">178</span><br><span class="line-number">179</span><br><span class="line-number">180</span><br><span class="line-number">181</span><br><span class="line-number">182</span><br><span class="line-number">183</span><br><span class="line-number">184</span><br><span class="line-number">185</span><br><span class="line-number">186</span><br><span class="line-number">187</span><br><span class="line-number">188</span><br><span class="line-number">189</span><br><span class="line-number">190</span><br><span class="line-number">191</span><br><span class="line-number">192</span><br><span class="line-number">193</span><br><span class="line-number">194</span><br><span class="line-number">195</span><br><span class="line-number">196</span><br><span class="line-number">197</span><br><span class="line-number">198</span><br><span class="line-number">199</span><br><span class="line-number">200</span><br><span class="line-number">201</span><br><span class="line-number">202</span><br><span class="line-number">203</span><br><span class="line-number">204</span><br><span class="line-number">205</span><br><span class="line-number">206</span><br><span class="line-number">207</span><br><span class="line-number">208</span><br></div></div><ul><li>进入当前正在运行的容器</li></ul> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code><span class="token comment">#我们的容器都是使用后台方式运行的，需要进入容器，修改一些配置</span>
<span class="token function">docker</span> <span class="token builtin class-name">exec</span> <span class="token parameter variable">-it</span> 容器id bashShell

<span class="token comment">#测试</span>
<span class="token punctuation">[</span>root@iZ2vc7zktoz7z9fn3qhptjZ ~<span class="token punctuation">]</span><span class="token comment"># docker ps</span>
CONTAINER ID   IMAGE     COMMAND       CREATED       STATUS       PORTS     NAMES
df33d9b19dfc   centos    <span class="token string">&quot;/bin/bash&quot;</span>   <span class="token number">3</span> hours ago   Up <span class="token number">3</span> hours             intelligent_pasteur
<span class="token punctuation">[</span>root@iZ2vc7zktoz7z9fn3qhptjZ ~<span class="token punctuation">]</span><span class="token comment"># docker exec -it df33d9b19dfc /bin/bash</span>
<span class="token punctuation">[</span>root@df33d9b19dfc /<span class="token punctuation">]</span><span class="token comment"># ps -ef</span>
<span class="token environment constant">UID</span>          PID    <span class="token environment constant">PPID</span>  C STIME TTY          TIME CMD
root           <span class="token number">1</span>       <span class="token number">0</span>  <span class="token number">0</span> <span class="token number">10</span>:10 pts/0    00:00:00 /bin/bash
root          <span class="token number">15</span>       <span class="token number">0</span>  <span class="token number">0</span> <span class="token number">12</span>:50 pts/1    00:00:00 /bin/bash
root          <span class="token number">29</span>      <span class="token number">15</span>  <span class="token number">0</span> <span class="token number">12</span>:51 pts/1    00:00:00 <span class="token function">ps</span> <span class="token parameter variable">-ef</span>

<span class="token comment">#方式二</span>
<span class="token function">docker</span> attach 容器id

<span class="token comment">#docker exec   #进入容器后开启一个新的终端，可以在里面操作</span>
<span class="token comment">#docker attach    #进入容器正在执行的终端</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br></div></div><ul><li>从容器内拷贝文件到主机上</li></ul> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code><span class="token comment">#从容器内拷贝文件到主机上</span>
<span class="token function">docker</span> <span class="token function">cp</span> 容器id:容器内路径 目的的主机路径

<span class="token comment">#测试</span>
<span class="token comment">#将文件拷贝出到主机上</span>
<span class="token punctuation">[</span>root@iZ2vc7zktoz7z9fn3qhptjZ home<span class="token punctuation">]</span><span class="token comment"># docker cp 31ffda8491d6:/home/text.java /home</span>
<span class="token punctuation">[</span>root@iZ2vc7zktoz7z9fn3qhptjZ home<span class="token punctuation">]</span><span class="token comment"># ls</span>
text.java  yang.java

</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br></div></div><h2 id="小结"><a href="#小结" class="header-anchor">#</a> 小结</h2> <p><img alt="aHR0cHM6Ly9yYXcuZ2l0aHVidXNlcmNvbnRlbnQuY29tL2NoZW5nY29kZXgvY2xvdWRpbWcvbWFzdGVyL2ltZy9pbWFnZS0yMDIwMDUxNDIxNDMxMzk2Mi5wbmc.png" data-src="Docker%203c50fde541064eb8b2f0d252252aa964/aHR0cHM6Ly9yYXcuZ2l0aHVidXNlcmNvbnRlbnQuY29tL2NoZW5nY29kZXgvY2xvdWRpbWcvbWFzdGVyL2ltZy9pbWFnZS0yMDIwMDUxNDIxNDMxMzk2Mi5wbmc.png" loading="lazy" class="lazy"></p> <h3 id="基本常用命令"><a href="#基本常用命令" class="header-anchor">#</a> 基本常用命令</h3> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code>	attach      Attach <span class="token builtin class-name">local</span> standard input, output, and error streams to a running container
  <span class="token comment">#当前shell下 attach连接指定运行的镜像</span>
  build       Build an image from a Dockerfile <span class="token comment"># 通过Dockerfile定制镜像</span>
  commit      Create a new image from a container<span class="token string">'s changes #提交当前容器为新的镜像
  cp          Copy files/folders between a container and the local filesystem #拷贝文件
  create      Create a new container #创建一个新的容器
  diff        Inspect changes to files or directories on a container'</span>s filesystem <span class="token comment">#查看docker容器的变化</span>
  events      Get real <span class="token function">time</span> events from the server <span class="token comment"># 从服务获取容器实时时间</span>
  <span class="token builtin class-name">exec</span>        Run a <span class="token builtin class-name">command</span> <span class="token keyword">in</span> a running container <span class="token comment"># 在运行中的容器上运行命令</span>
  <span class="token builtin class-name">export</span>      Export a container's filesystem as a <span class="token function">tar</span> archive <span class="token comment">#导出容器文件系统作为一个tar归档文件[对应import]</span>
  <span class="token function">history</span>     Show the <span class="token function">history</span> of an image <span class="token comment"># 展示一个镜像形成历史</span>
  images      List images <span class="token comment">#列出系统当前的镜像</span>
  <span class="token function">import</span>      Import the contents from a tarball to create a filesystem image <span class="token comment">#从tar包中导入内容创建一个文件系统镜像</span>
  info        Display system-wide information <span class="token comment"># 显示全系统信息</span>
  inspect     Return low-level information on Docker objects <span class="token comment">#查看容器详细信息</span>
  <span class="token function">kill</span>        Kill one or <span class="token function">more</span> running containers <span class="token comment"># kill指定docker容器</span>
  load        Load an image from a <span class="token function">tar</span> archive or STDIN <span class="token comment">#从一个tar包或标准输入中加载一个镜像[对应save]</span>
  login       Log <span class="token keyword">in</span> to a Docker registry <span class="token comment">#</span>
  <span class="token builtin class-name">logout</span>      Log out from a Docker registry
  logs        Fetch the logs of a container
  pause       Pause all processes within one or <span class="token function">more</span> containers
  port        List port mappings or a specific mapping <span class="token keyword">for</span> the container
  <span class="token function">ps</span>          List containers
  pull        Pull an image or a repository from a registry
  push        Push an image or a repository to a registry
  <span class="token function">rename</span>      Rename a container
  restart     Restart one or <span class="token function">more</span> containers
  <span class="token function">rm</span>          Remove one or <span class="token function">more</span> containers
  rmi         Remove one or <span class="token function">more</span> images
  run         Run a <span class="token builtin class-name">command</span> <span class="token keyword">in</span> a new container
  save        Save one or <span class="token function">more</span> images to a <span class="token function">tar</span> archive <span class="token punctuation">(</span>streamed to STDOUT by default<span class="token punctuation">)</span>
  search      Search the Docker Hub <span class="token keyword">for</span> images
  start       Start one or <span class="token function">more</span> stopped containers
  stats       Display a live stream of container<span class="token punctuation">(</span>s<span class="token punctuation">)</span> resource usage statistics
  stop        Stop one or <span class="token function">more</span> running containers
  tag         Create a tag TARGET_IMAGE that refers to SOURCE_IMAGE
  <span class="token function">top</span>         Display the running processes of a container
  unpause     Unpause all processes within one or <span class="token function">more</span> containers
  update      Update configuration of one or <span class="token function">more</span> containers
  version     Show the Docker version information
  <span class="token function">wait</span>        Block <span class="token keyword">until</span> one or <span class="token function">more</span> containers stop, <span class="token keyword">then</span> print their <span class="token builtin class-name">exit</span> codes
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br></div></div><h1 id="作业"><a href="#作业" class="header-anchor">#</a> 作业</h1> <h2 id="docker安装nginx"><a href="#docker安装nginx" class="header-anchor">#</a> docker安装nginx</h2> <div class="language-powershell line-numbers-mode"><pre class="language-powershell"><code><span class="token comment">#1.搜索镜像 docker search</span>
<span class="token comment">#2.下载镜像 docker pull</span>
<span class="token comment">#3.运行测试</span>

<span class="token namespace">[root@iZ2vc7zktoz7z9fn3qhptjZ home]</span><span class="token comment"># docker images</span>
REPOSITORY    TAG       IMAGE ID       CREATED        SIZE
mysql         latest    ecac195d15af   16 hours ago   516MB
nginx         latest    87a94228f133   7 days ago     133MB
hello-world   latest    feb5d9fea6a5   3 weeks ago    13<span class="token punctuation">.</span>3kB
centos        latest    5d0da3dc9764   4 weeks ago    231MB

<span class="token comment">#-d 后台运行</span>
<span class="token comment">#--name   给容器命名</span>
<span class="token comment">#-p   容器内部端口</span>
<span class="token namespace">[root@iZ2vc7zktoz7z9fn3qhptjZ home]</span><span class="token comment"># docker run -d --name nginx01 -p 3344:80 nginx</span>
c2487d62a28c0577cf3dd7f1c3dd98967c32a2e81fcc45a6c4bf3502b5ee3924
<span class="token namespace">[root@iZ2vc7zktoz7z9fn3qhptjZ home]</span><span class="token comment"># docker ps</span>
CONTAINER ID   IMAGE     COMMAND                  CREATED         STATUS         PORTS                                   NAMES
c2487d62a28c   nginx     <span class="token string">&quot;/docker-entrypoint.…&quot;</span>   4 seconds ago   Up 4 seconds   0<span class="token punctuation">.</span>0<span class="token punctuation">.</span>0<span class="token punctuation">.</span>0:3344-&gt;80/tcp<span class="token punctuation">,</span> :::3344-&gt;80/tcp   nginx01

<span class="token namespace">[root@iZ2vc7zktoz7z9fn3qhptjZ home]</span><span class="token comment"># curl localhost:3344</span>

<span class="token comment">#进入容器</span>

</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br></div></div><h3 id="端口暴露概念"><a href="#端口暴露概念" class="header-anchor">#</a> 端口暴露概念</h3> <p><img alt="Docker%203c50fde541064eb8b2f0d252252aa964/82c23724a62b4599a85a8aa527a1f50e.png" data-src="Docker%203c50fde541064eb8b2f0d252252aa964/82c23724a62b4599a85a8aa527a1f50e.png" loading="lazy" class="lazy"></p> <h2 id="安装tomcat"><a href="#安装tomcat" class="header-anchor">#</a> 安装tomcat</h2> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code><span class="token comment">#官方的使用</span>
<span class="token function">docker</span> run <span class="token parameter variable">-it</span> <span class="token parameter variable">--rm</span> tomcat:9.0
<span class="token comment">#我们之前启动的是后台，停止了容器之后，容器还是可以查到  </span>
<span class="token comment">#docker run -it --rm  这个命令用完即删</span>

<span class="token comment">#下载</span>
<span class="token function">docker</span> pull tomcat

<span class="token comment">#启动</span>
<span class="token function">docker</span> run <span class="token parameter variable">-d</span> <span class="token parameter variable">-p</span> <span class="token number">3355</span>:8080 <span class="token parameter variable">--name</span> tomcat01 tomcat

<span class="token comment">#进入容器</span>
<span class="token punctuation">[</span>root@iZ2vc7zktoz7z9fn3qhptjZ home<span class="token punctuation">]</span><span class="token comment"># docker exec -it tomcat01 /bin/bash</span>
<span class="token comment">#进入容器后发现：1.Linux命令少了  2.没有webapps 阿里云镜像默认只保存最小的镜像，不必要的将会删除</span>

<span class="token comment">#webapp目录中存放网页文件，需要将webap.disk文件夹中的文件复制到webapps中</span>

</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br></div></div><p>思考问题：我们以后部署项目，每次都要进入容器非常麻烦</p> <h2 id="部署es-kiband"><a href="#部署es-kiband" class="header-anchor">#</a> 部署es+kiband</h2> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code><span class="token comment">#es暴露的端口很多</span>
<span class="token comment">#es十分耗费内存</span>
<span class="token comment">#es的数据需要放到安全目录挂载</span>
<span class="token comment">#--net somenetwork</span>

<span class="token comment">#启动elasticsearch</span>

<span class="token function">docker</span> run <span class="token parameter variable">-d</span> <span class="token parameter variable">--name</span> elasticsearch <span class="token parameter variable">-p</span> <span class="token number">9200</span>:9200 <span class="token parameter variable">-p</span> <span class="token number">9300</span>:9300 <span class="token parameter variable">-e</span> 
<span class="token string">&quot;discovery.type=single-node&quot;</span> elasticsearch:7.6.2

<span class="token comment">#启动后Linux变得非常卡 docker stats 查看CPU的状态</span>

<span class="token comment">#es是十分耗内存的</span>
<span class="token comment">#测试es十分成功</span>
<span class="token comment">#赶紧关闭，增加内存限制</span>

<span class="token function">docker</span> run <span class="token parameter variable">-d</span> <span class="token parameter variable">--name</span> elasticsearch02 <span class="token parameter variable">-p</span> <span class="token number">9200</span>:9200 <span class="token parameter variable">-p</span> <span class="token number">9300</span>:9300 <span class="token parameter variable">-e</span> <span class="token string">&quot;discovery.type=single-node&quot;</span> <span class="token parameter variable">-e</span> <span class="token assign-left variable">ES_JAVA_OPTS</span><span class="token operator">=</span><span class="token string">&quot;-Xms64m -Xmx512m&quot;</span> elasticsearch:7.6.2

</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br></div></div><div class="language-bash line-numbers-mode"><pre class="language-bash"><code><span class="token comment">#测试</span>
<span class="token punctuation">[</span>root@iZ2vc7zktoz7z9fn3qhptjZ ~<span class="token punctuation">]</span><span class="token comment"># curl localhost:9200</span>
<span class="token punctuation">{</span>
  <span class="token string">&quot;name&quot;</span> <span class="token builtin class-name">:</span> <span class="token string">&quot;df4d4ae3f99e&quot;</span>,
  <span class="token string">&quot;cluster_name&quot;</span> <span class="token builtin class-name">:</span> <span class="token string">&quot;docker-cluster&quot;</span>,
  <span class="token string">&quot;cluster_uuid&quot;</span> <span class="token builtin class-name">:</span> <span class="token string">&quot;YoDi8IlLRke18VxvJr2gLQ&quot;</span>,
  <span class="token string">&quot;version&quot;</span> <span class="token builtin class-name">:</span> <span class="token punctuation">{</span>
    <span class="token string">&quot;number&quot;</span> <span class="token builtin class-name">:</span> <span class="token string">&quot;7.6.2&quot;</span>,
    <span class="token string">&quot;build_flavor&quot;</span> <span class="token builtin class-name">:</span> <span class="token string">&quot;default&quot;</span>,
    <span class="token string">&quot;build_type&quot;</span> <span class="token builtin class-name">:</span> <span class="token string">&quot;docker&quot;</span>,
    <span class="token string">&quot;build_hash&quot;</span> <span class="token builtin class-name">:</span> <span class="token string">&quot;ef48eb35cf30adf4db14086e8aabd07ef6fb113f&quot;</span>,
    <span class="token string">&quot;build_date&quot;</span> <span class="token builtin class-name">:</span> <span class="token string">&quot;2020-03-26T06:34:37.794943Z&quot;</span>,
    <span class="token string">&quot;build_snapshot&quot;</span> <span class="token builtin class-name">:</span> false,
    <span class="token string">&quot;lucene_version&quot;</span> <span class="token builtin class-name">:</span> <span class="token string">&quot;8.4.0&quot;</span>,
    <span class="token string">&quot;minimum_wire_compatibility_version&quot;</span> <span class="token builtin class-name">:</span> <span class="token string">&quot;6.8.0&quot;</span>,
    <span class="token string">&quot;minimum_index_compatibility_version&quot;</span> <span class="token builtin class-name">:</span> <span class="token string">&quot;6.0.0-beta1&quot;</span>
  <span class="token punctuation">}</span>,
  <span class="token string">&quot;tagline&quot;</span> <span class="token builtin class-name">:</span> <span class="token string">&quot;You Know, for Search&quot;</span>
<span class="token punctuation">}</span>

<span class="token number">20</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br></div></div><blockquote><p>作业：使用kibana连接es，网络如何才能连接过去</p></blockquote> <p><img alt="Docker%203c50fde541064eb8b2f0d252252aa964/e542f060383444f19c81cf2aad475c32.png" data-src="Docker%203c50fde541064eb8b2f0d252252aa964/e542f060383444f19c81cf2aad475c32.png" loading="lazy" class="lazy"></p> <h2 id="可视化portainer"><a href="#可视化portainer" class="header-anchor">#</a> 可视化portainer</h2> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code><span class="token function">docker</span> run <span class="token parameter variable">-d</span> <span class="token parameter variable">-p</span> <span class="token number">8088</span>:9000 <span class="token parameter variable">--restart</span><span class="token operator">=</span>always <span class="token parameter variable">-v</span> /var/run/docker.sock:/var/run/docker.sock <span class="token parameter variable">--privileged</span><span class="token operator">=</span>true portainer/portainer

</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><div class="language- line-numbers-mode"><pre class="language-text"><code>docker commit #提交容器称为一个新的副本
docker commit -m=&quot;描述信息&quot; -a=&quot;作者&quot; 容器id 目标镜像名:[tag]

</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><blockquote><p>实战测试</p></blockquote> <div class="language- line-numbers-mode"><pre class="language-text"><code>#启动一个默认的Tomcat
#发现这个默认的Tomcat是没有webapps应用，官方的原因
#自己通过命令拷贝进去了基本的文件
#将我们操作过得容器通过commit提交为一个镜像，我们以后就使用自己修改过得镜像

</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><h1 id="docker-镜像讲解"><a href="#docker-镜像讲解" class="header-anchor">#</a> Docker 镜像讲解</h1> <h2 id="镜像是什么"><a href="#镜像是什么" class="header-anchor">#</a> 镜像是什么</h2> <p>镜像是一个软件包，里面包含着我们要运行的所有东西，环境，依赖等等，我们只要安装好这个软件包，我们就能够做到环境一致。减少代发开发环境和运行环境的差异，增加软件运行的效率。</p> <p>如何得到镜像：</p> <ul><li>从远程仓库下载</li> <li>朋友拷贝</li> <li>自己制作一个dockerfile</li></ul> <h2 id="docker镜像加载原理"><a href="#docker镜像加载原理" class="header-anchor">#</a> docker镜像加载原理</h2> <h3 id="unionfs联合文件系统"><a href="#unionfs联合文件系统" class="header-anchor">#</a> UnionFS联合文件系统</h3> <p>UnionFS将软件进行分层，公用的部分可以公用，我们不用再下载，这种方式节省了内存和硬盘空间，提高了软件运行效率。</p> <h3 id="docker镜像加载原理-2"><a href="#docker镜像加载原理-2" class="header-anchor">#</a> docker镜像加载原理</h3> <p>docker的镜像实际上是由一层一层文件系统组成的，我们把这种文件系统叫做unionFS（联合文件系统）</p> <p>bootfs（boot file system）主要包含bootload和kernel，bootload启动完成后加载kernel。Linux在刚启动的时候会加载bootfs文件系统，在docker最底层是bootfs。当bootload加载完成之后，此时内存从bootload交给kernel。</p> <p>roofs(root file system)，在bootfs之上。包含的就是典型linux系统中的/dev、、/proc、/bin等标准文件和目录。rootfs就是各种不同操作系统的发行版，如Ubuntu，cenos等。</p> <p>虚拟机是分钟级的，docker是秒级的。</p> <h3 id="分层理解"><a href="#分层理解" class="header-anchor">#</a> 分层理解</h3> <p>docker镜像都只是只读的，当容器启动的时候，一个新的可写层被加载到容器顶部。</p> <p>这一层就是我们说的容器层，容器之下的都叫做镜像层。</p> <h1 id="commit镜像"><a href="#commit镜像" class="header-anchor">#</a> commit镜像</h1> <p>提交自己的镜像</p> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code><span class="token function">docker</span> commit <span class="token parameter variable">-a</span><span class="token operator">=</span><span class="token string">&quot;作者&quot;</span> <span class="token parameter variable">-m</span><span class="token operator">=</span><span class="token string">&quot;提交的信息&quot;</span> 容器id 目标镜像命

<span class="token comment"># 测试</span>
<span class="token punctuation">[</span>root@vm1029731 home<span class="token punctuation">]</span><span class="token comment"># docker commit -a=&quot;bigdragon&quot; -m=&quot;mytomcat&quot; a879fa2d5ad2 itomcat</span>
sha256:6bc7720d2fa79638e254d0c4f87749c648e2b13f34746a5c91f9ad030ec5380c
<span class="token punctuation">[</span>root@vm1029731 home<span class="token punctuation">]</span><span class="token comment"># docker images</span>
REPOSITORY            TAG       IMAGE ID       CREATED          SIZE
itomcat               latest    6bc7720d2fa7   <span class="token number">10</span> seconds ago   481MB
tomcat                latest    acdcfe83bcc5   <span class="token number">16</span> hours ago     476MB
mariadb               <span class="token number">10.2</span>      625e5b493bbb   <span class="token number">7</span> weeks ago      338MB
centos                latest    5d0da3dc9764   <span class="token number">12</span> months ago    231MB
portainer/portainer   latest    980323c8eb3f   <span class="token number">20</span> months ago    196MB
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br></div></div><h1 id="容器数据卷"><a href="#容器数据卷" class="header-anchor">#</a> 容器数据卷</h1> <h2 id="什么是容器数据卷"><a href="#什么是容器数据卷" class="header-anchor">#</a> 什么是容器数据卷</h2> <p>将docker应用和数据放到一个容器中，如果容器挂了，那么我们的数据也就挂了</p> <p>需求：将docker应用和数据分开存放</p> <p>容器之间有一个技术，容器产生的数据可以同步到本地。这就是卷技术，目录的挂载。</p> <p><img alt="Docker%203c50fde541064eb8b2f0d252252aa964/74c6c9805a4742bb86aba9b2519b4dc4.png" data-src="Docker%203c50fde541064eb8b2f0d252252aa964/74c6c9805a4742bb86aba9b2519b4dc4.png" loading="lazy" class="lazy"></p> <p>总结：容器的数据卷技术，容器的持久化和同步操作，容器间也是可以数据共享的</p> <h2 id="使用数据卷"><a href="#使用数据卷" class="header-anchor">#</a> 使用数据卷</h2> <h3 id="方式一-直接使用命令进行挂载-v"><a href="#方式一-直接使用命令进行挂载-v" class="header-anchor">#</a> 方式一：直接使用命令进行挂载 -v</h3> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code><span class="token function">docker</span> run <span class="token parameter variable">-it</span> <span class="token parameter variable">-v</span> 主机目录:容器目录

<span class="token comment">#测试</span>
<span class="token function">docker</span> run <span class="token parameter variable">-it</span> <span class="token parameter variable">-v</span> /home/ceshi:/home centos /bin/bash

就是双向挂载
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><h3 id="实战-安装mysql"><a href="#实战-安装mysql" class="header-anchor">#</a> 实战：安装MySQL</h3> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code><span class="token comment">#获取镜像</span>
<span class="token function">docker</span> pull mysql:5.7

<span class="token comment">#运行容器，配置mysql的密码</span>
<span class="token function">docker</span> run <span class="token parameter variable">--name</span> some-mysql <span class="token parameter variable">-e</span> <span class="token assign-left variable">MYSQL_ROOT_PASSWORD</span><span class="token operator">=</span>my-secret-pw <span class="token parameter variable">-d</span> mysql:tag

<span class="token comment">#启动我们的mysql</span>
<span class="token parameter variable">-d</span>    后台运行
<span class="token parameter variable">-p</span>    端口
<span class="token parameter variable">-v</span>    磁盘挂载
<span class="token parameter variable">-e</span>    环境设置

<span class="token function">docker</span> run <span class="token parameter variable">-d</span> <span class="token parameter variable">-p</span> <span class="token number">3310</span>:3306 <span class="token parameter variable">-v</span> /home/mysql/conf:/etc/mysql/conf.d <span class="token parameter variable">-v</span> /home/mysql/data:/var/lib/mysql <span class="token parameter variable">-e</span> <span class="token assign-left variable">MYSQL_ROOT_PASSWORD</span><span class="token operator">=</span><span class="token number">88488848</span> <span class="token parameter variable">--name</span> mysql01 mysql:5.7

<span class="token comment"># 启动成功之后，我们可以使用远程连接工具去连接我们的mysql</span>

<span class="token comment">#在挂载的时候宿主机的目录必须不存在或者为空，否则容器会自动停止运行</span>

<span class="token comment">#</span>
<span class="token function">docker</span> run <span class="token parameter variable">-p</span> <span class="token number">3310</span>:3306 <span class="token parameter variable">--name</span> mysql01 <span class="token parameter variable">-e</span> <span class="token assign-left variable">MYSQL_ROOT_PASSWORD</span><span class="token operator">=</span><span class="token number">123456</span> <span class="token parameter variable">-d</span> mysql:5.7

<span class="token comment">#测试  使用Navicat连接</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br></div></div><p>删除镜像后，数据库的数据并未删除</p> <h3 id="具名挂载和匿名挂载"><a href="#具名挂载和匿名挂载" class="header-anchor">#</a> 具名挂载和匿名挂载</h3> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code><span class="token comment">#匿名挂载   不指定宿主机内的目录，随机分配挂载目录</span>
	<span class="token function">docker</span> run <span class="token parameter variable">-d</span> <span class="token parameter variable">-P</span> <span class="token parameter variable">--name</span> nginx01 <span class="token parameter variable">-v</span> /etc/nginx nginx

<span class="token comment">#查看所有volume(卷)的情况--匿名卷挂载</span>
<span class="token function">docker</span> volume <span class="token function">ls</span>
<span class="token punctuation">[</span>root@iZ2vc7zktoz7z9fn3qhptjZ data<span class="token punctuation">]</span><span class="token comment"># docker volume ls</span>
DRIVER    VOLUME NAME
<span class="token builtin class-name">local</span>     8f25eadc6fc021cceec30d57f098c8b747c0c4259893daef94180fcad9e0d035
<span class="token builtin class-name">local</span>     77191ab5590d6993214c197d35234b802b20b1dd0b3fc9ab89610614478e1cab
<span class="token builtin class-name">local</span>     2561304f2d5452e681af143f6bf7f89a3ffd8d16b54b87fe4d7d56baa54666ef

<span class="token comment">#具名挂载</span>
<span class="token function">docker</span> run <span class="token parameter variable">-d</span> <span class="token parameter variable">-P</span> <span class="token parameter variable">--name</span> nginx02 <span class="token parameter variable">-v</span> juming-nginx:/etc/nginx nginx

<span class="token comment">#测试</span>
<span class="token punctuation">[</span>root@iZ2vc7zktoz7z9fn3qhptjZ data<span class="token punctuation">]</span><span class="token comment"># docker run -d -P --name nginx02 -v juming-nginx:/etc/nginx nginx</span>
47a6f0234961c0370c3c03517e556e74ac2a73569aeb82d5987c3935571d30c7
<span class="token punctuation">[</span>root@iZ2vc7zktoz7z9fn3qhptjZ data<span class="token punctuation">]</span><span class="token comment"># docker volume ls</span>
DRIVER    VOLUME NAME
<span class="token builtin class-name">local</span>     8f25eadc6fc021cceec30d57f098c8b747c0c4259893daef94180fcad9e0d035
<span class="token builtin class-name">local</span>     9e95356d6b94193e20b71ca27ba174e7f9dafb083d548cfb41304cba212e1e80
<span class="token builtin class-name">local</span>     77191ab5590d6993214c197d35234b802b20b1dd0b3fc9ab89610614478e1cab
<span class="token builtin class-name">local</span>     2561304f2d5452e681af143f6bf7f89a3ffd8d16b54b87fe4d7d56baa54666ef
<span class="token builtin class-name">local</span>     juming-nginx

<span class="token comment">#查看挂载的具体地址</span>
<span class="token function">docker</span> volume inspect juming-nginx
<span class="token punctuation">[</span>root@iZ2vc7zktoz7z9fn3qhptjZ data<span class="token punctuation">]</span><span class="token comment"># docker volume inspect juming-nginx</span>
<span class="token punctuation">[</span>
    <span class="token punctuation">{</span>
        <span class="token string">&quot;CreatedAt&quot;</span><span class="token builtin class-name">:</span> <span class="token string">&quot;2021-10-21T20:17:55+08:00&quot;</span>,
        <span class="token string">&quot;Driver&quot;</span><span class="token builtin class-name">:</span> <span class="token string">&quot;local&quot;</span>,
        <span class="token string">&quot;Labels&quot;</span><span class="token builtin class-name">:</span> null,
        <span class="token string">&quot;Mountpoint&quot;</span><span class="token builtin class-name">:</span> <span class="token string">&quot;/var/lib/docker/volumes/juming-nginx/_data&quot;</span>,
        <span class="token string">&quot;Name&quot;</span><span class="token builtin class-name">:</span> <span class="token string">&quot;juming-nginx&quot;</span>,
        <span class="token string">&quot;Options&quot;</span><span class="token builtin class-name">:</span> null,
        <span class="token string">&quot;Scope&quot;</span><span class="token builtin class-name">:</span> <span class="token string">&quot;local&quot;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">]</span>

<span class="token comment">#所有docker容器内的卷，在没有指定目录的情况下都在/var/lib/docker/volumes/XXXX/_data</span>

</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br></div></div><p>#所有docker容器内的卷，在没有指定目录的情况下都在/var/lib/docker/volumes/XXXX/_data</p> <p>我们通过具名挂载可以方便的找到我们的卷，大多数时候使用</p> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code><span class="token parameter variable">-v</span> 容器内路径    <span class="token comment">#匿名挂载</span>
<span class="token parameter variable">-v</span> 卷名:容器内路径  <span class="token comment">#具名挂载</span>
<span class="token parameter variable">-v</span> /宿主机路径:容器内路径  <span class="token comment">#指定路径挂载</span>

</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><p>拓展</p> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code><span class="token comment">#通过 -v 容器内路径:ro rw  改变读写权限</span>
ro  <span class="token comment">#只读</span>
rw  <span class="token comment">#读写</span>

<span class="token function">docker</span> run <span class="token parameter variable">-d</span> <span class="token parameter variable">-P</span> <span class="token parameter variable">--name</span> nginx02 <span class="token parameter variable">-v</span> juming-nginx:/etc/nginx:ro nginx
<span class="token function">docker</span> run <span class="token parameter variable">-d</span> <span class="token parameter variable">-P</span> <span class="token parameter variable">--name</span> nginx02 <span class="token parameter variable">-v</span> juming-nginx:/etc/nginx:rw nginx
<span class="token comment">#ro只能通过宿主机操作，在容器内部是无法操作的</span>

</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><h3 id="初识dockerfile"><a href="#初识dockerfile" class="header-anchor">#</a> 初识Dockerfile</h3> <p>dockerfile 就是做自己的docker镜像，命令脚本</p> <p>通过这个脚本可以生成镜像，镜像一层一层的，脚本就是一个个的命令，每个命令都是一层</p> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code><span class="token comment">#创建一个dockerfile文件</span>

<span class="token comment">#文件中的内容命令大写</span>
FROM centos

VOLUME <span class="token punctuation">[</span><span class="token string">&quot;volume01&quot;</span>,<span class="token string">&quot;volume02&quot;</span><span class="token punctuation">]</span>

CMD <span class="token builtin class-name">echo</span> <span class="token string">&quot;----end----&quot;</span>
CMD /bin/bash

<span class="token comment">#要注意，输入的不要带/,和最后要加空格点</span>
<span class="token function">docker</span> build <span class="token parameter variable">-f</span> /home/docker-test-volume/dockerfile1 <span class="token parameter variable">-t</span> kuangshen/centos:1.0 <span class="token builtin class-name">.</span>

</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br></div></div><p><img alt="Docker%203c50fde541064eb8b2f0d252252aa964/923ee1cdbaa540c1b1d6ec2b03336b0a.png" data-src="Docker%203c50fde541064eb8b2f0d252252aa964/923ee1cdbaa540c1b1d6ec2b03336b0a.png" loading="lazy" class="lazy"></p> <p>这个卷一定和外部的目录是挂载的</p> <p><img alt="Docker%203c50fde541064eb8b2f0d252252aa964/33491806954e45c0bbabff77ac19a1ec.png" data-src="Docker%203c50fde541064eb8b2f0d252252aa964/33491806954e45c0bbabff77ac19a1ec.png" loading="lazy" class="lazy"></p> <p>测试刚才的文件是否同步出去</p> <p>这种方法我们以后要使用的非常多，因为我们要自己构建自己的镜像。</p> <h3 id="数据卷容器"><a href="#数据卷容器" class="header-anchor">#</a> 数据卷容器</h3> <p>容器之间同步数据</p> <p><img alt="Untitled" data-src="Docker%203c50fde541064eb8b2f0d252252aa964/Untitled.png" loading="lazy" class="lazy"></p> <p><code>启动3个容器，通过我们自己构建的容器启动</code></p> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code><span class="token comment">#将docker02的数据挂载到docker01  删除docker01，docker02的数据还在，所以文件共享是拷贝的状态</span>
<span class="token function">docker</span> run <span class="token parameter variable">-it</span> <span class="token parameter variable">--name</span> docker02 --volumes-from docker01 kuangshen/centos:1.0 /bin/bash

</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p>多个mysql实现数据共享</p> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code><span class="token comment">#第一步</span>
<span class="token function">docker</span> run <span class="token parameter variable">-d</span> <span class="token parameter variable">-p</span> <span class="token number">3310</span>:3306 <span class="token parameter variable">-v</span> /etc/mysql/conf.d <span class="token parameter variable">-v</span> /var/lib/mysql <span class="token parameter variable">-e</span> <span class="token assign-left variable">MYSQL_ROOT_PASSWORD</span><span class="token operator">=</span><span class="token number">123456</span> <span class="token parameter variable">--name</span> mysql01 mysql:5.7

<span class="token comment">#第二步</span>
<span class="token function">docker</span> run <span class="token parameter variable">-d</span> <span class="token parameter variable">-p</span> <span class="token number">3310</span>:3306 <span class="token parameter variable">-e</span> <span class="token assign-left variable">MYSQL_ROOT_PASSWORD</span><span class="token operator">=</span><span class="token number">123456</span> <span class="token parameter variable">--name</span> mysql02 --volumes-from mysql02 mysql:5.7

<span class="token comment">#实现两个容器数据共享</span>

</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><p>结论：容器之间配置信息的传递，容器数据卷的生命周期一直持续到没有容器使用为止</p> <p>但是你一旦持久化到了本地，本地的数据是不会删除的</p> <h2 id="dockerfile"><a href="#dockerfile" class="header-anchor">#</a> Dockerfile</h2> <h3 id="dockerfile介绍"><a href="#dockerfile介绍" class="header-anchor">#</a> dockerfile介绍</h3> <p>dockerfile是用来构建docker镜像的文件！命令参数脚本！</p> <ul><li>构建步骤</li></ul> <p>1.编写一个dockerfile文</p> <p>2.docker build构建成为一个镜像</p> <p>3.docker run 运行镜像</p> <p>4.docker push 发布镜像（DockerHub，阿里云镜像仓库）</p> <p>查看官方是怎么做的</p> <p><img alt="Docker%203c50fde541064eb8b2f0d252252aa964/5f739ce76a1e4d3ca2c41352245ac055.png" data-src="Docker%203c50fde541064eb8b2f0d252252aa964/5f739ce76a1e4d3ca2c41352245ac055.png" loading="lazy" class="lazy"></p> <p><img alt="Untitled" data-src="Docker%203c50fde541064eb8b2f0d252252aa964/Untitled%201.png" loading="lazy" class="lazy"></p> <p>很多官方镜像都是基础包，跟多功能没有，我们通常会搭建自己的环境</p> <p>官方可以自己制作镜像，我们也可以</p> <h3 id="dockerfile构建过程"><a href="#dockerfile构建过程" class="header-anchor">#</a> Dockerfile构建过程</h3> <p><img alt="Untitled" data-src="Docker%203c50fde541064eb8b2f0d252252aa964/Untitled%202.png" loading="lazy" class="lazy"></p> <p><strong>基础知识</strong></p> <p>1、每一关键字（指令）必须都要是大写</p> <p>2、按照从上到下的命令执行</p> <p>3、# 表示注释</p> <p>4、每一个指令都会创建提交一个新的镜像层，并且提交</p> <p>5、dockerfile是面向开发的，我们以后要发布项目，坐镜像，别写dockerfile文件</p> <p><img alt="Untitled" data-src="Docker%203c50fde541064eb8b2f0d252252aa964/Untitled%203.png" loading="lazy" class="lazy"></p> <h3 id="dockerfile的命令"><a href="#dockerfile的命令" class="header-anchor">#</a> DockerFile的命令</h3> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code><span class="token comment">#指令</span>
FROM           <span class="token comment">#基础镜像 centos ubantu,一切从这里开始</span>
MAINTAINER     <span class="token comment">#镜像是谁写的  姓名+邮箱</span>
RUN            <span class="token comment">#镜像运行的时候需要运行的命令</span>
ADD            <span class="token comment">#步骤：Tomcat镜像：Tomcat压缩包！</span>
WORKDIR        <span class="token comment">#工作目录</span>
VOLUME         <span class="token comment">#设置卷，挂载到哪个位置</span>
EXPOSE         <span class="token comment">#指定对外的端口</span>
CMD            <span class="token comment">#指定容器启动运行的要运行的命令，只有最后一个会生效，可被替代</span>
ENTRYPOINT     <span class="token comment">#容器启动是运行的命令，可以追加命令</span>
ONBUILD        <span class="token comment">#当构建镜像被继承，这个时候会运行ONBUILD   的指令</span>
COPY           <span class="token comment">#类似ADD，将文件拷贝到镜像中</span>
ENV            <span class="token comment">#构建的时候设置环境变量</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br></div></div><h3 id="实战测试-写个自己的镜像"><a href="#实战测试-写个自己的镜像" class="header-anchor">#</a> 实战测试:写个自己的镜像</h3> <p>DockerHub中99%的镜像都是FROM scratch，然后配置需要的软件和配置</p> <ul><li>创建自己的centos</li></ul> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code><span class="token comment">#1.编写dockerfile文件</span>
<span class="token punctuation">[</span>root@iZ2vc7zktoz7z9fn3qhptjZ dockerfile<span class="token punctuation">]</span><span class="token comment"># vim mydockerfile-centos</span>
<span class="token punctuation">[</span>root@iZ2vc7zktoz7z9fn3qhptjZ dockerfile<span class="token punctuation">]</span><span class="token comment"># cat mydockerfile-centos</span>
FROM centos
MAINTAINER bigdragon<span class="token operator">&lt;</span>bigdragonlin@qq.com<span class="token operator">&gt;</span>
ENV MYPATH /usr/local
WORKDIR <span class="token variable">$MYPATH</span>
RUN /bin/sh <span class="token parameter variable">-c</span> yum <span class="token parameter variable">-y</span> <span class="token function">install</span> <span class="token function">vim</span>
RUN /bin/sh <span class="token parameter variable">-c</span> yum <span class="token parameter variable">-y</span> <span class="token function">install</span> net-tools

<span class="token comment">## CMD命令只会执行最后一个命令</span>
EXPOSE <span class="token number">80</span>
CMD <span class="token builtin class-name">echo</span> <span class="token variable">$MYPATH</span>
CMD <span class="token builtin class-name">echo</span> <span class="token string">&quot;---end---&quot;</span>
CMD /bin/bash

<span class="token comment">#2.通过docker build 构建</span>
<span class="token function">docker</span> build <span class="token parameter variable">-f</span> dockerfile文件的位置 <span class="token parameter variable">-t</span> dockerimage的名字:版本号 .<span class="token punctuation">(</span>一定要注意，在最后有一个空格和点<span class="token punctuation">)</span>
<span class="token comment">#3.测试运行</span>

</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br></div></div><p>对比</p> <p>之前的原生centos</p> <p>增加我们自己的centos</p> <p><img alt="Docker%203c50fde541064eb8b2f0d252252aa964/4e9695860ae2435cadb92cc52df8c6d0.png" data-src="Docker%203c50fde541064eb8b2f0d252252aa964/4e9695860ae2435cadb92cc52df8c6d0.png" loading="lazy" class="lazy"></p> <ul><li>我们可以本地查看变更历史</li></ul> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code><span class="token function">docker</span> <span class="token function">history</span> 镜像<span class="token punctuation">[</span>root@vm1029731 dockerfile<span class="token punctuation">]</span><span class="token comment"># docker history 83d53d6b7cd4</span>
IMAGE          CREATED          CREATED BY                                      SIZE      COMMENT
83d53d6b7cd4   <span class="token number">11</span> minutes ago   /bin/sh <span class="token parameter variable">-c</span> <span class="token comment">#(nop)  CMD [&quot;/bin/sh&quot; &quot;-c&quot; &quot;/bin…   0B        </span>
4a4974b5f52a   <span class="token number">11</span> minutes ago   /bin/sh <span class="token parameter variable">-c</span> <span class="token comment">#(nop)  CMD [&quot;/bin/sh&quot; &quot;-c&quot; &quot;echo…   0B        </span>
ebecbc78a8a3   <span class="token number">11</span> minutes ago   /bin/sh <span class="token parameter variable">-c</span> <span class="token comment">#(nop)  CMD [&quot;/bin/sh&quot; &quot;-c&quot; &quot;echo…   0B        </span>
0da671877732   <span class="token number">11</span> minutes ago   /bin/sh <span class="token parameter variable">-c</span> <span class="token comment">#(nop)  EXPOSE 80                    0B        </span>
737290e25b2b   <span class="token number">11</span> minutes ago   /bin/sh <span class="token parameter variable">-c</span> /bin/sh <span class="token parameter variable">-c</span> yum <span class="token parameter variable">-y</span> <span class="token function">install</span> net-too…   410kB     
baada7aab89b   <span class="token number">11</span> minutes ago   /bin/sh <span class="token parameter variable">-c</span> /bin/sh <span class="token parameter variable">-c</span> yum <span class="token parameter variable">-y</span> <span class="token function">install</span> <span class="token function">vim</span>        410kB     
7144920ac23f   <span class="token number">14</span> minutes ago   /bin/sh <span class="token parameter variable">-c</span> <span class="token comment">#(nop) WORKDIR /usr/local            0B        </span>
329b7e456657   <span class="token number">14</span> minutes ago   /bin/sh <span class="token parameter variable">-c</span> <span class="token comment">#(nop)  ENV MYPATH=/usr/local        0B        </span>
cf34c4e50434   <span class="token number">14</span> minutes ago   /bin/sh <span class="token parameter variable">-c</span> <span class="token comment">#(nop)  MAINTAINER bigdragon&lt;bigd…   0B        </span>
5d0da3dc9764   <span class="token number">12</span> months ago    /bin/sh <span class="token parameter variable">-c</span> <span class="token comment">#(nop)  CMD [&quot;/bin/bash&quot;]            0B        </span>
<span class="token operator">&lt;</span>missing<span class="token operator">&gt;</span>      <span class="token number">12</span> months ago    /bin/sh <span class="token parameter variable">-c</span> <span class="token comment">#(nop)  LABEL org.label-schema.sc…   0B        </span>
<span class="token operator">&lt;</span>missing<span class="token operator">&gt;</span>      <span class="token number">12</span> months ago    /bin/sh <span class="token parameter variable">-c</span> <span class="token comment">#(nop) ADD file:805cb5e15fb6e0bb0…   231MBid</span>

</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br></div></div><ul><li>CMD和ENTRYPOINT的区别</li></ul> <p>测试CMD</p> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code><span class="token comment">#编写dockerfile文件</span>
<span class="token punctuation">[</span>root@iZ2vc7zktoz7z9fn3qhptjZ dockerfile<span class="token punctuation">]</span><span class="token comment"># vim dockerfile-cmd-test</span>
FROM centos
CMD <span class="token punctuation">[</span><span class="token string">&quot;ls&quot;</span>,<span class="token string">&quot;-a&quot;</span><span class="token punctuation">]</span>

<span class="token comment">#要想追加一个命令-l,使得执行的命令变成 ls -al,会发现报错</span>
<span class="token punctuation">[</span>root@iZ2vc7zktoz7z9fn3qhptjZ dockerfile<span class="token punctuation">]</span><span class="token comment"># docker run 0ab8341a6e84 -l</span>
docker: Error response from daemon: OCI runtime create failed: container_linux.go:380: starting container process caused: exec: <span class="token string">&quot;-l&quot;</span><span class="token builtin class-name">:</span> executable <span class="token function">file</span> not found <span class="token keyword">in</span> <span class="token environment constant">$PATH</span><span class="token builtin class-name">:</span> unknown.
<span class="token comment"># daemon中有一个错误的响应：OCI运行时创建失败，源于i，在$PATH中没有找到执行文件</span>

<span class="token comment">#原因在于，我们最后追加的那个-l会把cmd中的命令替换掉，导致无效命令</span>
<span class="token comment">#正确的办法应该为</span>
<span class="token punctuation">[</span>root@iZ2vc7zktoz7z9fn3qhptjZ dockerfile<span class="token punctuation">]</span><span class="token comment"># docker run 0ab8341a6e84 ls -al</span>
total <span class="token number">0</span>
drwxr-xr-x   <span class="token number">1</span> root root   <span class="token number">6</span> Oct <span class="token number">21</span> <span class="token number">15</span>:32 <span class="token builtin class-name">.</span>
drwxr-xr-x   <span class="token number">1</span> root root   <span class="token number">6</span> Oct <span class="token number">21</span> <span class="token number">15</span>:32 <span class="token punctuation">..</span>
-rwxr-xr-x   <span class="token number">1</span> root root   <span class="token number">0</span> Oct <span class="token number">21</span> <span class="token number">15</span>:32 .dockerenv
lrwxrwxrwx   <span class="token number">1</span> root root   <span class="token number">7</span> Nov  <span class="token number">3</span>  <span class="token number">2020</span> bin -<span class="token operator">&gt;</span> usr/bin
drwxr-xr-x   <span class="token number">5</span> root root <span class="token number">340</span> Oct <span class="token number">21</span> <span class="token number">15</span>:32 dev
drwxr-xr-x   <span class="token number">1</span> root root  <span class="token number">66</span> Oct <span class="token number">21</span> <span class="token number">15</span>:32 etc
drwxr-xr-x   <span class="token number">2</span> root root   <span class="token number">6</span> Nov  <span class="token number">3</span>  <span class="token number">2020</span> home
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br></div></div><p>测试ENTRYPOINT</p> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code><span class="token punctuation">[</span>root@iZ2vc7zktoz7z9fn3qhptjZ dockerfile<span class="token punctuation">]</span><span class="token comment"># vim dockerfile-cmd-entrypoint</span>
FROM centos
ENTRYPOINT <span class="token punctuation">[</span><span class="token string">&quot;ls&quot;</span>,<span class="token string">&quot;-a&quot;</span><span class="token punctuation">]</span>

<span class="token comment">#追加命令</span>
<span class="token punctuation">[</span>root@iZ2vc7zktoz7z9fn3qhptjZ dockerfile<span class="token punctuation">]</span><span class="token comment"># docker run 7cf9e42fd793 -l</span>
total <span class="token number">0</span>
drwxr-xr-x   <span class="token number">1</span> root root   <span class="token number">6</span> Oct <span class="token number">21</span> <span class="token number">15</span>:36 <span class="token builtin class-name">.</span>
drwxr-xr-x   <span class="token number">1</span> root root   <span class="token number">6</span> Oct <span class="token number">21</span> <span class="token number">15</span>:36 <span class="token punctuation">..</span>
-rwxr-xr-x   <span class="token number">1</span> root root   <span class="token number">0</span> Oct <span class="token number">21</span> <span class="token number">15</span>:36 .dockerenv
lrwxrwxrwx   <span class="token number">1</span> root root   <span class="token number">7</span> Nov  <span class="token number">3</span>  <span class="token number">2020</span> bin -<span class="token operator">&gt;</span> usr/bin
drwxr-xr-x   <span class="token number">5</span> root root <span class="token number">340</span> Oct <span class="token number">21</span> <span class="token number">15</span>:36 dev
drwxr-xr-x   <span class="token number">1</span> root root  <span class="token number">66</span> Oct <span class="token number">21</span> <span class="token number">15</span>:36 etc
drwxr-xr-x   <span class="token number">2</span> root root   <span class="token number">6</span> Nov  <span class="token number">3</span>  <span class="token number">2020</span> home
lrwxrwxrwx   <span class="token number">1</span> root root   <span class="token number">7</span> Nov  <span class="token number">3</span>  <span class="token number">2020</span> lib -<span class="token operator">&gt;</span> usr/lib
lrwxrwxrwx   <span class="token number">1</span> root root   <span class="token number">9</span> Nov  <span class="token number">3</span>  <span class="token number">2020</span> lib64 -<span class="token operator">&gt;</span> usr/lib64
drwx------   <span class="token number">2</span> root root   <span class="token number">6</span> Sep <span class="token number">15</span> <span class="token number">14</span>:17 lost+found
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br></div></div><div class="language-bash line-numbers-mode"><pre class="language-bash"><code><span class="token punctuation">[</span>root@iZ2vc7zktoz7z9fn3qhptjZ dockerfile<span class="token punctuation">]</span><span class="token comment"># vim dockerfile-cmd-entrypoint</span>
FROM centos
ENTRYPOINT <span class="token punctuation">[</span><span class="token string">&quot;ls&quot;</span>,<span class="token string">&quot;-a&quot;</span><span class="token punctuation">]</span>

<span class="token comment">#追加命令</span>
<span class="token punctuation">[</span>root@iZ2vc7zktoz7z9fn3qhptjZ dockerfile<span class="token punctuation">]</span><span class="token comment"># docker run 7cf9e42fd793 -l</span>
total <span class="token number">0</span>
drwxr-xr-x   <span class="token number">1</span> root root   <span class="token number">6</span> Oct <span class="token number">21</span> <span class="token number">15</span>:36 <span class="token builtin class-name">.</span>
drwxr-xr-x   <span class="token number">1</span> root root   <span class="token number">6</span> Oct <span class="token number">21</span> <span class="token number">15</span>:36 <span class="token punctuation">..</span>
-rwxr-xr-x   <span class="token number">1</span> root root   <span class="token number">0</span> Oct <span class="token number">21</span> <span class="token number">15</span>:36 .dockerenv
lrwxrwxrwx   <span class="token number">1</span> root root   <span class="token number">7</span> Nov  <span class="token number">3</span>  <span class="token number">2020</span> bin -<span class="token operator">&gt;</span> usr/bin
drwxr-xr-x   <span class="token number">5</span> root root <span class="token number">340</span> Oct <span class="token number">21</span> <span class="token number">15</span>:36 dev
drwxr-xr-x   <span class="token number">1</span> root root  <span class="token number">66</span> Oct <span class="token number">21</span> <span class="token number">15</span>:36 etc
drwxr-xr-x   <span class="token number">2</span> root root   <span class="token number">6</span> Nov  <span class="token number">3</span>  <span class="token number">2020</span> home
lrwxrwxrwx   <span class="token number">1</span> root root   <span class="token number">7</span> Nov  <span class="token number">3</span>  <span class="token number">2020</span> lib -<span class="token operator">&gt;</span> usr/lib
lrwxrwxrwx   <span class="token number">1</span> root root   <span class="token number">9</span> Nov  <span class="token number">3</span>  <span class="token number">2020</span> lib64 -<span class="token operator">&gt;</span> usr/lib64
drwx------   <span class="token number">2</span> root root   <span class="token number">6</span> Sep <span class="token number">15</span> <span class="token number">14</span>:17 lost+found
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br></div></div><p>结论：entrypoint能够在运行的时候直接加命令，cmd不能够直接在后面直接加命令，cmd新加的命令会挤掉原来有的旧命令</p> <h3 id="实战-tomcat镜像"><a href="#实战-tomcat镜像" class="header-anchor">#</a> 实战：Tomcat镜像</h3> <p>1.准备Tomcat压缩包，jdk的压缩包</p> <p>2.编写dockerfile文件，官方命名<strong>Dockerfile</strong>,执行docker build时会自动寻找dockerfile文件不需要-f指定</p> <ul><li>java jdk 1.8各个文件夹的意思</li></ul> <p><img alt="Untitled" data-src="Docker%203c50fde541064eb8b2f0d252252aa964/Untitled%204.png" loading="lazy" class="lazy"></p> <ul><li>tomcat的目录结构</li></ul> <p><img alt="Untitled" data-src="Docker%203c50fde541064eb8b2f0d252252aa964/Untitled%205.png" loading="lazy" class="lazy"></p> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code>FROM centos
MAINTAINER ybw<span class="token operator">&lt;</span><span class="token number">1554094535</span>@qq.com<span class="token operator">&gt;</span>

COPY readme.txt /usr/local/readme.txt
<span class="token comment">## 这个命令会将readme.txt 复制到容器的/usr/local/readme.txt中去。readme放到和dockerfile同级别的文件夹中去</span>

ADD apache-tomcat-9.0.54.tar.gz /usr/local/
<span class="token comment">## linux 默认的都放到这里，在这里，我们不用手工解压，add命令会帮我们自动解压。</span>
ADD jdk-8u311-linux-x64.tar.gz /usr/local/

RUN yum <span class="token parameter variable">-y</span> <span class="token function">install</span> <span class="token function">vim</span>

ENV MYPATH /usr/local
WORKDIR <span class="token variable">$MYPATH</span>

ENV JAVA_HOME /usr/local/jdk1.8.0_311
ENV CLASSPATH <span class="token variable">$JAVA_HOME</span>/lib/dt.jar:<span class="token variable">$JAVA_HOME</span>/lib/tools.jar
<span class="token comment"># 通过冒号来隔开</span>
ENV CATALINA_HOME /usr/local/apache-tomcat-9.0.54
ENV CATALINA_BASH /usr/local/apache-tomcat-9.0.54
ENV <span class="token environment constant">PATH</span> <span class="token environment constant">$PATH</span><span class="token builtin class-name">:</span><span class="token variable">$JAVA_HOME</span>/bin:<span class="token variable">$CATALINA_HOME</span>/lib:<span class="token variable">$CATALINA_HOME</span>/bin
<span class="token comment"># 通过冒号来个开</span>

EXPOSE <span class="token number">8080</span>
CMD /usr/local/apache-tomcat-9.0.54/bin/startup.sh <span class="token operator">&amp;&amp;</span> <span class="token function">tail</span> <span class="token parameter variable">-F</span> /usr/local/apache-tomcat-9.0.54/bin/logs/catalina.out

--------------------------------------
FROM centos
MAINTAINER LONG<span class="token operator">&lt;</span>bigdragon@qq.com<span class="token operator">&gt;</span>
COPY readme.txt /usr/local/
ADD apache-tomcat-9.0.67.tar.gz /usr/local
ADD jdk-8u212-linux-x64.tar.gz /rur/local
RUN /bin/sh <span class="token parameter variable">-c</span> yum <span class="token parameter variable">-y</span> <span class="token function">install</span> <span class="token function">vim</span>
ENV MYPATH /usr/local
WORKDIR <span class="token variable">$MYPATH</span>

ENV JAVA_HOME /usr/local/jdk1.8.0_212
ENV CLASSPATH <span class="token variable">$JAVA_HOME</span>/lib/dt.jar:<span class="token variable">$JAVA_HOME</span>/lib/tools.jar
ENV CATALINA_HOME /usr/local/apache-tomcat-9.0.67
ENV CLASSPATH <span class="token variable">$JAVA_HOME</span>/lib/dt.jar:<span class="token variable">$JAVA_HOME</span>/lib/tools.jar
ENV <span class="token environment constant">PATH</span> <span class="token environment constant">$PATH</span><span class="token builtin class-name">:</span><span class="token variable">$JAVA_HOME</span>/bin:<span class="token variable">$CATALINA_HOME</span>/lib:<span class="token variable">$CATALINA_HOME</span>/bin

EXPOSE <span class="token number">8080</span>
CMD /usr/local/apache-tomcat-9.0.67/bin/startup.sh <span class="token operator">&amp;&amp;</span> <span class="token function">tail</span> <span class="token parameter variable">-F</span> /usr/local/apache-tomcat-9.0.67/bin/logs/catalina.out
~                                                                                                                                                                                            
~

</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br></div></div><div class="language-bash line-numbers-mode"><pre class="language-bash"><code>FROM centos
MAINTAINER LONG<span class="token operator">&lt;</span>bigdragon@qq.com<span class="token operator">&gt;</span>
COPY readme.txt /usr/local/
ADD apache-tomcat-9.0.67.tar.gz /usr/local
ADD jdk-8u212-linux-x64.tar.gz /usr/local
RUN /bin/sh <span class="token parameter variable">-c</span> yum <span class="token parameter variable">-y</span> <span class="token function">install</span> <span class="token function">vim</span>
ENV MYPATH /usr/local
WORKDIR <span class="token variable">$MYPATH</span>

ENV JAVA_HOME /usr/local/jdk1.8.0_212
ENV CLASSPATH <span class="token variable">$JAVA_HOME</span>/lib/dt.jar:<span class="token variable">$JAVA_HOME</span>/lib/tools.jar
ENV CATALINA_HOME /usr/local/apache-tomcat-9.0.67
ENV CLASSPATH <span class="token variable">$JAVA_HOME</span>/lib/dt.jar:<span class="token variable">$JAVA_HOME</span>/lib/tools.jar
ENV <span class="token environment constant">PATH</span> <span class="token environment constant">$PATH</span><span class="token builtin class-name">:</span><span class="token variable">$JAVA_HOME</span>/bin:<span class="token variable">$CATALINA_HOME</span>/lib:<span class="token variable">$CATALINA_HOME</span>/bin

EXPOSE <span class="token number">8080</span>
CMD /usr/local/apache-tomcat-9.0.67/bin/startup.sh <span class="token operator">&amp;&amp;</span> <span class="token function">tail</span> <span class="token parameter variable">-F</span> /usr/local/apache-tomcat-9.0.67/bin/logs/catalina.out
~                                                                                                                                                                                            
~
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br></div></div><p>3.构建镜像</p> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code><span class="token function">docker</span> build <span class="token parameter variable">-t</span> mytomcat <span class="token builtin class-name">.</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>4.运行</p> <ul><li>第二种方式</li></ul> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code><span class="token function">docker</span> run <span class="token parameter variable">-d</span> <span class="token parameter variable">-p</span> <span class="token number">9090</span>:8080 <span class="token parameter variable">--name</span> ybwtomcat <span class="token parameter variable">-v</span> /home/ybw/tomcat/test:/url/local/apache-tomcat-9.0.54/webapps/test <span class="token parameter variable">-v</span> /home/ybw/tomcat/tomcatlogs/:/url/local/apache-tomcat-9.0.54/logs diytomcat

<span class="token function">docker</span> run <span class="token parameter variable">-d</span> <span class="token parameter variable">-p</span> <span class="token number">9090</span>:8080 <span class="token parameter variable">--name</span> bgtomcat <span class="token parameter variable">-v</span> /home/bg/tomcat/test:/usr/local/apache-tomcat-9.0.56/webapps/test <span class="token parameter variable">-v</span> /home/bg/tomcat/tomcatlogs/:/usr/local/apache-tomcat-9.0.56/logs mytomcat:1.1
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p>5.启动镜像</p> <p>6.访问测试</p> <p>7.发布项目，做了卷挂载，直接在本地发布</p> <div class="language-xml line-numbers-mode"><pre class="language-xml"><code>  <span class="token prolog">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;</span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>web-app</span> <span class="token attr-name">xmlns</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>http://java.sun.com/xml/ns/javaee<span class="token punctuation">&quot;</span></span>
           <span class="token attr-name"><span class="token namespace">xmlns:</span>xsi</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>http://www.w3.org/2001/XMLSchema-instance<span class="token punctuation">&quot;</span></span>
           <span class="token attr-name"><span class="token namespace">xsi:</span>schemaLocation</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>http://java.sun.com/xml/ns/javaee
                               http://java.sun.com/xml/ns/javaee/web-app_2_5.xsd<span class="token punctuation">&quot;</span></span>
           <span class="token attr-name">version</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>2.5<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>

  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>web-app</span><span class="token punctuation">&gt;</span></span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><div class="language-html line-numbers-mode"><pre class="language-html"><code>&lt;%@ page language=&quot;java&quot; contentType=&quot;text/html; charset=UTF-8&quot;
    pageEncoding=&quot;UTF-8&quot;%&gt;
<span class="token doctype"><span class="token punctuation">&lt;!</span><span class="token doctype-tag">DOCTYPE</span> <span class="token name">html</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>html</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>head</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>meta</span> <span class="token attr-name">charset</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>utf-8<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>title</span><span class="token punctuation">&gt;</span></span>hello,杨博文<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>title</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>head</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>body</span><span class="token punctuation">&gt;</span></span>
Hello World!<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>br</span><span class="token punctuation">/&gt;</span></span>
&lt;%
System.out.println(&quot;---ybw---&quot;);
%&gt;
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>body</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>html</span><span class="token punctuation">&gt;</span></span>

</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br></div></div><p>项目部署成功</p> <p>我们以后的开发步骤，需要掌握DockerFile的编写</p> <h3 id="发布自己的镜像"><a href="#发布自己的镜像" class="header-anchor">#</a> 发布自己的镜像</h3> <p>在dockerhub上发布自己的镜像</p> <p>1、地址 hub.docker.com注册账号</p> <p>2、在服务器上提交</p> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code><span class="token comment">#1.查看登录命令</span>
<span class="token punctuation">[</span>root@iZ2vc7zktoz7z9fn3qhptjZ tomcatlogs<span class="token punctuation">]</span><span class="token comment"># docker login --help</span>

Usage:  <span class="token function">docker</span> login <span class="token punctuation">[</span>OPTIONS<span class="token punctuation">]</span> <span class="token punctuation">[</span>SERVER<span class="token punctuation">]</span>

Log <span class="token keyword">in</span> to a Docker registry.
If no server is specified, the default is defined by the daemon.

Options:
  -p, <span class="token parameter variable">--password</span> string   Password
      --password-stdin    Take the password from stdin
  -u, <span class="token parameter variable">--username</span> string   Username
<span class="token comment">#2.登录</span>
<span class="token punctuation">[</span>root@iZ2vc7zktoz7z9fn3qhptjZ tomcatlogs<span class="token punctuation">]</span><span class="token comment"># docker login -u timenever -p &quot;password&quot;</span>

<span class="token comment">#给镜像添加标签</span>
<span class="token comment"># 官方要求，镜像的名称必须为 YOUR_DOCKER_HUB_ID/XXXX</span>
<span class="token function">docker</span> tag bgtomcat:3.0 bgtomcat:3.0/tomcat:1.0

<span class="token comment">#发布</span>
<span class="token function">docker</span> push bigdragonlin/bgtomcat:3.0

</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br></div></div><h3 id="发布到阿里云镜像"><a href="#发布到阿里云镜像" class="header-anchor">#</a> 发布到阿里云镜像</h3> <p>1.登录阿里云</p> <p>2.找到容器镜像服务</p> <p>3.创建命名空间</p> <p>4.创建容器镜像</p> <p>5.游览仓库信息</p> <p><img alt="Docker%203c50fde541064eb8b2f0d252252aa964/0eec5a47869d4e0c9510e12f8c6c05d5.png" data-src="Docker%203c50fde541064eb8b2f0d252252aa964/0eec5a47869d4e0c9510e12f8c6c05d5.png" loading="lazy" class="lazy"></p> <h3 id="小结-2"><a href="#小结-2" class="header-anchor">#</a> 小结</h3> <p><img alt="Untitled" data-src="Docker%203c50fde541064eb8b2f0d252252aa964/Untitled%206.png" loading="lazy" class="lazy"></p> <h1 id="docker-网络"><a href="#docker-网络" class="header-anchor">#</a> Docker 网络</h1> <h3 id="网络名词"><a href="#网络名词" class="header-anchor">#</a> 网络名词</h3> <ul><li><p>同网段</p> <p>在同一个局域网中</p></li> <li><p>子网掩码</p> <p>和ip地址相联系，可以表示同一网段有多少可用ip</p> <p>192.168.0.1/24 表示ip地址前二十四位不可用。只能用（0-255）开集</p></li> <li><p>网关</p> <p>局域网访问广域网的地址</p></li> <li><p>DNS服务器</p> <p>域名解析服务器</p></li></ul> <h3 id="理解docker0"><a href="#理解docker0" class="header-anchor">#</a> 理解docker0</h3> <p>1.清空所有环境测试</p> <p>三个网络</p> <p><img alt="Untitled" data-src="Docker%203c50fde541064eb8b2f0d252252aa964/Untitled%207.png" loading="lazy" class="lazy"></p> <ul><li>问题：docker是如何处理容器网络访问的</li></ul> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code><span class="token punctuation">[</span>root@iZ2vc7zktoz7z9fn3qhptjZ ~<span class="token punctuation">]</span><span class="token comment"># docker run -d -P --name tomcat01 tomcat</span>

<span class="token comment">#查看容器内部网络地址  ip addr 发现容器启动时会有eth0@if77 这是docker分配的</span>

<span class="token comment">#容器容器内部没有ip命令，进入容器执行 apt update &amp;&amp; apt install -y iproute2</span>
<span class="token comment">#  没有ipconfig   执行    apt install net-tools</span>
<span class="token comment">#没有ping命令   执行   apt install iputils-ping</span>
<span class="token punctuation">[</span>root@iZ2vc7zktoz7z9fn3qhptjZ ~<span class="token punctuation">]</span><span class="token comment"># docker exec -it tomcat01 ip addr</span>
<span class="token number">1</span>: lo: <span class="token operator">&lt;</span>LOOPBACK,UP,LOWER_UP<span class="token operator">&gt;</span> mtu <span class="token number">65536</span> qdisc noqueue state UNKNOWN group default qlen <span class="token number">1000</span>
    link/loopback 00:00:00:00:00:00 brd 00:00:00:00:00:00
    inet <span class="token number">127.0</span>.0.1/8 scope <span class="token function">host</span> lo
       valid_lft forever preferred_lft forever
<span class="token number">76</span>: eth0@if77: <span class="token operator">&lt;</span>BROADCAST,MULTICAST,UP,LOWER_UP<span class="token operator">&gt;</span> mtu <span class="token number">1500</span> qdisc noqueue state UP group default
    link/ether 02:42:ac:12:00:02 brd ff:ff:ff:ff:ff:ff link-netnsid <span class="token number">0</span>
    inet <span class="token number">172.18</span>.0.2/16 brd <span class="token number">172.18</span>.255.255 scope global eth0
       valid_lft forever preferred_lft forever

<span class="token comment">#思考  Linux能不能ping通容器内部</span>
<span class="token punctuation">[</span>root@iZ2vc7zktoz7z9fn3qhptjZ ~<span class="token punctuation">]</span><span class="token comment"># ping 172.18.0.2</span>
PING <span class="token number">172.18</span>.0.2 <span class="token punctuation">(</span><span class="token number">172.18</span>.0.2<span class="token punctuation">)</span> <span class="token number">56</span><span class="token punctuation">(</span><span class="token number">84</span><span class="token punctuation">)</span> bytes of data.
<span class="token number">64</span> bytes from <span class="token number">172.18</span>.0.2: <span class="token assign-left variable">icmp_seq</span><span class="token operator">=</span><span class="token number">1</span> <span class="token assign-left variable">ttl</span><span class="token operator">=</span><span class="token number">64</span> <span class="token assign-left variable">time</span><span class="token operator">=</span><span class="token number">0.034</span> ms
<span class="token number">64</span> bytes from <span class="token number">172.18</span>.0.2: <span class="token assign-left variable">icmp_seq</span><span class="token operator">=</span><span class="token number">2</span> <span class="token assign-left variable">ttl</span><span class="token operator">=</span><span class="token number">64</span> <span class="token assign-left variable">time</span><span class="token operator">=</span><span class="token number">0.035</span> ms
<span class="token number">64</span> bytes from <span class="token number">172.18</span>.0.2: <span class="token assign-left variable">icmp_seq</span><span class="token operator">=</span><span class="token number">3</span> <span class="token assign-left variable">ttl</span><span class="token operator">=</span><span class="token number">64</span> <span class="token assign-left variable">time</span><span class="token operator">=</span><span class="token number">0.037</span> ms
<span class="token number">64</span> bytes from <span class="token number">172.18</span>.0.2: <span class="token assign-left variable">icmp_seq</span><span class="token operator">=</span><span class="token number">4</span> <span class="token assign-left variable">ttl</span><span class="token operator">=</span><span class="token number">64</span> <span class="token assign-left variable">time</span><span class="token operator">=</span><span class="token number">0.033</span> ms

<span class="token comment">#说明Linux可以ping通容器内部</span>

</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br></div></div><ul><li>原理</li></ul> <p>1、我们每启动一个容器，docker就会给我们分配一个IP，只要我们装了docker，就会有一个网卡docker0，docker网卡使用的是桥接模式，使用的技术是evth-pair技术。</p> <p>2.再启动一个容器测试，发现又多了一对网卡</p> <p>测试ip addr</p> <p><img alt="Untitled" data-src="Docker%203c50fde541064eb8b2f0d252252aa964/Untitled%208.png" loading="lazy" class="lazy"></p> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code><span class="token comment">#我们发现这个容器的网卡，都是一对对的</span>

<span class="token comment">#evth-pair  就是一对虚拟的设备接口，一端连接协议，一端连接彼此</span>

<span class="token comment">#正因为有这个特性，evth-pair 充当一个桥梁，连接着各种虚拟设备</span>

<span class="token comment">#OpenStack，Docker容器之间的连接，OVS的连接，都是使用evth-pair技术</span>

</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><p>3.我们来测试Tomcat01和Tomcat02能否ping通</p> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code><span class="token punctuation">[</span>root@iZ2vc7zktoz7z9fn3qhptjZ ~<span class="token punctuation">]</span><span class="token comment"># docker exec -it tomcat02 ping 172.18.0.2</span>
PING <span class="token number">172.18</span>.0.2 <span class="token punctuation">(</span><span class="token number">172.18</span>.0.2<span class="token punctuation">)</span> <span class="token number">56</span><span class="token punctuation">(</span><span class="token number">84</span><span class="token punctuation">)</span> bytes of data.
<span class="token number">64</span> bytes from <span class="token number">172.18</span>.0.2: <span class="token assign-left variable">icmp_seq</span><span class="token operator">=</span><span class="token number">1</span> <span class="token assign-left variable">ttl</span><span class="token operator">=</span><span class="token number">64</span> <span class="token assign-left variable">time</span><span class="token operator">=</span><span class="token number">0.061</span> ms
<span class="token number">64</span> bytes from <span class="token number">172.18</span>.0.2: <span class="token assign-left variable">icmp_seq</span><span class="token operator">=</span><span class="token number">2</span> <span class="token assign-left variable">ttl</span><span class="token operator">=</span><span class="token number">64</span> <span class="token assign-left variable">time</span><span class="token operator">=</span><span class="token number">0.043</span> ms
<span class="token number">64</span> bytes from <span class="token number">172.18</span>.0.2: <span class="token assign-left variable">icmp_seq</span><span class="token operator">=</span><span class="token number">3</span> <span class="token assign-left variable">ttl</span><span class="token operator">=</span><span class="token number">64</span> <span class="token assign-left variable">time</span><span class="token operator">=</span><span class="token number">0.046</span> ms

<span class="token comment">#发现容器和容器之间是可以ping通</span>

</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><p><img alt="Untitled" data-src="Docker%203c50fde541064eb8b2f0d252252aa964/Untitled%209.png" loading="lazy" class="lazy"></p> <p>tomcat01和tomcat02是公用的一个路由器</p> <p>所有的容器不指定网络的情况下，都是docker0路由的，docker会给我们的容器默认分配ip</p> <ul><li>小结</li></ul> <p>Docker使用的是Linux的桥接，宿主机中是一个Docker容器的网桥 docker0</p> <p><img alt="Untitled" data-src="Docker%203c50fde541064eb8b2f0d252252aa964/Untitled%2010.png" loading="lazy" class="lazy"></p> <p>Docker中所有的网络接口都是虚拟的</p> <p>只要删除容器，对应的一对网桥就没了</p> <h3 id="link"><a href="#link" class="header-anchor">#</a> —link</h3> <ul><li>思考一个场景，编写一个微服务，database url=ip;项目重启，数据库ip换掉了，我们希望可以处理这个问题，可以通过名字来进行访问容器</li></ul> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code><span class="token punctuation">[</span>root@iZ2vc7zktoz7z9fn3qhptjZ ~<span class="token punctuation">]</span><span class="token comment"># docker exec -it tomcat02 ping tomcat01</span>
ping: tomcat01: Name or <span class="token function">service</span> not known

<span class="token comment">#如何解决这个问题</span>
<span class="token comment">#1.用--link</span>
<span class="token punctuation">[</span>root@iZ2vc7zktoz7z9fn3qhptjZ ~<span class="token punctuation">]</span><span class="token comment"># docker run -d  -P --name tomcat03 --link tomcat02 tomcat</span>
<span class="token comment">#2.测试</span>
<span class="token punctuation">[</span>root@iZ2vc7zktoz7z9fn3qhptjZ ~<span class="token punctuation">]</span><span class="token comment"># docker exec -it tomcat03 ping tomcat02</span>
PING tomcat02 <span class="token punctuation">(</span><span class="token number">172.18</span>.0.3<span class="token punctuation">)</span> <span class="token number">56</span><span class="token punctuation">(</span><span class="token number">84</span><span class="token punctuation">)</span> bytes of data.
<span class="token number">64</span> bytes from tomcat02 <span class="token punctuation">(</span><span class="token number">172.18</span>.0.3<span class="token punctuation">)</span>: <span class="token assign-left variable">icmp_seq</span><span class="token operator">=</span><span class="token number">1</span> <span class="token assign-left variable">ttl</span><span class="token operator">=</span><span class="token number">64</span> <span class="token assign-left variable">time</span><span class="token operator">=</span><span class="token number">0.069</span> ms
<span class="token number">64</span> bytes from tomcat02 <span class="token punctuation">(</span><span class="token number">172.18</span>.0.3<span class="token punctuation">)</span>: <span class="token assign-left variable">icmp_seq</span><span class="token operator">=</span><span class="token number">2</span> <span class="token assign-left variable">ttl</span><span class="token operator">=</span><span class="token number">64</span> <span class="token assign-left variable">time</span><span class="token operator">=</span><span class="token number">0.047</span> ms
<span class="token number">64</span> bytes from tomcat02 <span class="token punctuation">(</span><span class="token number">172.18</span>.0.3<span class="token punctuation">)</span>: <span class="token assign-left variable">icmp_seq</span><span class="token operator">=</span><span class="token number">3</span> <span class="token assign-left variable">ttl</span><span class="token operator">=</span><span class="token number">64</span> <span class="token assign-left variable">time</span><span class="token operator">=</span><span class="token number">0.044</span> ms
<span class="token comment">#反向可以ping通吗</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br></div></div><div class="language-bash line-numbers-mode"><pre class="language-bash"><code><span class="token function">docker</span> network
<span class="token function">docker</span> network inspect
<span class="token punctuation">[</span>
    <span class="token punctuation">{</span>
        <span class="token string">&quot;Name&quot;</span><span class="token builtin class-name">:</span> <span class="token string">&quot;bridge&quot;</span>,
        <span class="token string">&quot;Id&quot;</span><span class="token builtin class-name">:</span> <span class="token string">&quot;e2ca01469d86d2e82406bfffef661244084989d16dbff4497ea894cb90a357c9&quot;</span>,
        <span class="token string">&quot;Created&quot;</span><span class="token builtin class-name">:</span> <span class="token string">&quot;2022-10-05T05:50:08.414107476Z&quot;</span>,
        <span class="token string">&quot;Scope&quot;</span><span class="token builtin class-name">:</span> <span class="token string">&quot;local&quot;</span>,
        <span class="token string">&quot;Driver&quot;</span><span class="token builtin class-name">:</span> <span class="token string">&quot;bridge&quot;</span>,
        <span class="token string">&quot;EnableIPv6&quot;</span><span class="token builtin class-name">:</span> false,
        <span class="token string">&quot;IPAM&quot;</span><span class="token builtin class-name">:</span> <span class="token punctuation">{</span>
            <span class="token string">&quot;Driver&quot;</span><span class="token builtin class-name">:</span> <span class="token string">&quot;default&quot;</span>,
            <span class="token string">&quot;Options&quot;</span><span class="token builtin class-name">:</span> null,
            <span class="token string">&quot;Config&quot;</span><span class="token builtin class-name">:</span> <span class="token punctuation">[</span>
                <span class="token punctuation">{</span>
                    <span class="token string">&quot;Subnet&quot;</span><span class="token builtin class-name">:</span> <span class="token string">&quot;172.17.0.0/16&quot;</span>,
										<span class="token comment"># 子网</span>
                    <span class="token string">&quot;Gateway&quot;</span><span class="token builtin class-name">:</span> <span class="token string">&quot;172.17.0.1&quot;</span>
										<span class="token comment"># 网关</span>
                <span class="token punctuation">}</span>
            <span class="token punctuation">]</span>
        <span class="token punctuation">}</span>,
        <span class="token string">&quot;Internal&quot;</span><span class="token builtin class-name">:</span> false,
        <span class="token string">&quot;Attachable&quot;</span><span class="token builtin class-name">:</span> false,
        <span class="token string">&quot;Ingress&quot;</span><span class="token builtin class-name">:</span> false,
        <span class="token string">&quot;ConfigFrom&quot;</span><span class="token builtin class-name">:</span> <span class="token punctuation">{</span>
            <span class="token string">&quot;Network&quot;</span><span class="token builtin class-name">:</span> <span class="token string">&quot;&quot;</span>
        <span class="token punctuation">}</span>,
        <span class="token string">&quot;ConfigOnly&quot;</span><span class="token builtin class-name">:</span> false,
        <span class="token string">&quot;Containers&quot;</span><span class="token builtin class-name">:</span> <span class="token punctuation">{</span>
            <span class="token string">&quot;01d0e518acac2486f61733a434a2dc99e35f676d00216396bf359fffabae88b6&quot;</span><span class="token builtin class-name">:</span> <span class="token punctuation">{</span>
                <span class="token string">&quot;Name&quot;</span><span class="token builtin class-name">:</span> <span class="token string">&quot;tomcat02&quot;</span>,
                <span class="token string">&quot;EndpointID&quot;</span><span class="token builtin class-name">:</span> <span class="token string">&quot;da94e81c69dc69c8be1e334ef326422f555ce3a48ba8c7803b7313ee92739cd5&quot;</span>,
                <span class="token string">&quot;MacAddress&quot;</span><span class="token builtin class-name">:</span> <span class="token string">&quot;02:42:ac:11:00:05&quot;</span>,
                <span class="token string">&quot;IPv4Address&quot;</span><span class="token builtin class-name">:</span> <span class="token string">&quot;172.17.0.5/16&quot;</span>,
                <span class="token string">&quot;IPv6Address&quot;</span><span class="token builtin class-name">:</span> <span class="token string">&quot;&quot;</span>
            <span class="token punctuation">}</span>,
            <span class="token string">&quot;aedd953e825edaa07e3c78267d443e6a0219c8538bd519475f3225c37eb02245&quot;</span><span class="token builtin class-name">:</span> <span class="token punctuation">{</span>
                <span class="token string">&quot;Name&quot;</span><span class="token builtin class-name">:</span> <span class="token string">&quot;relaxed_galileo&quot;</span>,
                <span class="token string">&quot;EndpointID&quot;</span><span class="token builtin class-name">:</span> <span class="token string">&quot;8f7ef98666239e6eaad0f028ce87f94fe4ca86985409dd37364553b09aba1689&quot;</span>,
                <span class="token string">&quot;MacAddress&quot;</span><span class="token builtin class-name">:</span> <span class="token string">&quot;02:42:ac:11:00:02&quot;</span>,
                <span class="token string">&quot;IPv4Address&quot;</span><span class="token builtin class-name">:</span> <span class="token string">&quot;172.17.0.2/16&quot;</span>,
                <span class="token string">&quot;IPv6Address&quot;</span><span class="token builtin class-name">:</span> <span class="token string">&quot;&quot;</span>
            <span class="token punctuation">}</span>,
            <span class="token string">&quot;bbc363ed94023b81838c67f4606ffcd490bc3499d61623766c9cf5818577453a&quot;</span><span class="token builtin class-name">:</span> <span class="token punctuation">{</span>
                <span class="token string">&quot;Name&quot;</span><span class="token builtin class-name">:</span> <span class="token string">&quot;tomcat03&quot;</span>,
                <span class="token string">&quot;EndpointID&quot;</span><span class="token builtin class-name">:</span> <span class="token string">&quot;ba084508d706d37e06891ae2876139fa084ba4d91aac959450f0b1b10da14d0f&quot;</span>,
                <span class="token string">&quot;MacAddress&quot;</span><span class="token builtin class-name">:</span> <span class="token string">&quot;02:42:ac:11:00:04&quot;</span>,
                <span class="token string">&quot;IPv4Address&quot;</span><span class="token builtin class-name">:</span> <span class="token string">&quot;172.17.0.4/16&quot;</span>,
                <span class="token string">&quot;IPv6Address&quot;</span><span class="token builtin class-name">:</span> <span class="token string">&quot;&quot;</span>
            <span class="token punctuation">}</span>,
            <span class="token string">&quot;f529df3dcabdec1d7e254620477078310bd0228ce0edb14153b88db9c5f5d741&quot;</span><span class="token builtin class-name">:</span> <span class="token punctuation">{</span>
                <span class="token string">&quot;Name&quot;</span><span class="token builtin class-name">:</span> <span class="token string">&quot;trojan-mariadb&quot;</span>,
                <span class="token string">&quot;EndpointID&quot;</span><span class="token builtin class-name">:</span> <span class="token string">&quot;f8219603808e2ab60950385ec8f1dd527cdf6ea40f56f162dff89b502b1d4488&quot;</span>,
                <span class="token string">&quot;MacAddress&quot;</span><span class="token builtin class-name">:</span> <span class="token string">&quot;02:42:ac:11:00:03&quot;</span>,
                <span class="token string">&quot;IPv4Address&quot;</span><span class="token builtin class-name">:</span> <span class="token string">&quot;172.17.0.3/16&quot;</span>,
                <span class="token string">&quot;IPv6Address&quot;</span><span class="token builtin class-name">:</span> <span class="token string">&quot;&quot;</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>,
        <span class="token string">&quot;Options&quot;</span><span class="token builtin class-name">:</span> <span class="token punctuation">{</span>
            <span class="token string">&quot;com.docker.network.bridge.default_bridge&quot;</span><span class="token builtin class-name">:</span> <span class="token string">&quot;true&quot;</span>,
            <span class="token string">&quot;com.docker.network.bridge.enable_icc&quot;</span><span class="token builtin class-name">:</span> <span class="token string">&quot;true&quot;</span>,
            <span class="token string">&quot;com.docker.network.bridge.enable_ip_masquerade&quot;</span><span class="token builtin class-name">:</span> <span class="token string">&quot;true&quot;</span>,
            <span class="token string">&quot;com.docker.network.bridge.host_binding_ipv4&quot;</span><span class="token builtin class-name">:</span> <span class="token string">&quot;0.0.0.0&quot;</span>,
            <span class="token string">&quot;com.docker.network.bridge.name&quot;</span><span class="token builtin class-name">:</span> <span class="token string">&quot;docker0&quot;</span>,
            <span class="token string">&quot;com.docker.network.driver.mtu&quot;</span><span class="token builtin class-name">:</span> <span class="token string">&quot;1500&quot;</span>
        <span class="token punctuation">}</span>,
        <span class="token string">&quot;Labels&quot;</span><span class="token builtin class-name">:</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">]</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br><span class="line-number">53</span><br><span class="line-number">54</span><br><span class="line-number">55</span><br><span class="line-number">56</span><br><span class="line-number">57</span><br><span class="line-number">58</span><br><span class="line-number">59</span><br><span class="line-number">60</span><br><span class="line-number">61</span><br><span class="line-number">62</span><br><span class="line-number">63</span><br><span class="line-number">64</span><br><span class="line-number">65</span><br><span class="line-number">66</span><br><span class="line-number">67</span><br><span class="line-number">68</span><br><span class="line-number">69</span><br><span class="line-number">70</span><br></div></div><p>其实这个tomcat03就是在本地配置了tomcat02的配置</p> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code><span class="token comment">#查看hosts配置，在这里发现</span>
<span class="token punctuation">[</span>root@iZ2vc7zktoz7z9fn3qhptjZ ~<span class="token punctuation">]</span><span class="token comment"># docker exec -it tomcat03 cat /etc/hosts</span>
<span class="token number">127.0</span>.0.1	localhost
::1	localhost ip6-localhost ip6-loopback
fe00::0	ip6-localnet
ff00::0	ip6-mcastprefix
ff02::1	ip6-allnodes
ff02::2	ip6-allrouters
<span class="token number">172.18</span>.0.3	tomcat02 0b46548f4648
<span class="token number">172.18</span>.0.4	300b08083fdb
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br></div></div><p>本质：–link就是我们在host配置中增加了一个172.18.0.3 tomcat02 0b46548f4648</p> <p>我们现在用docker已经不建议用–link</p> <p>我们现在自定义网络</p> <h3 id="自定义网络"><a href="#自定义网络" class="header-anchor">#</a> 自定义网络</h3> <ul><li>查看所有的docker网络</li></ul> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code><span class="token punctuation">[</span>root@vm1029731 ~<span class="token punctuation">]</span><span class="token comment"># docker network ls</span>
NETWORK ID     NAME      DRIVER    SCOPE
e2ca01469d86   bridge    bridge    <span class="token builtin class-name">local</span>
e6622eb8525b   <span class="token function">host</span>      <span class="token function">host</span>      <span class="token builtin class-name">local</span>
3ac8be8b0ec4   none      null      <span class="token builtin class-name">local</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><ul><li>网络模式</li></ul> <p>bridge：桥接 docker（默认，自己创建的有这样使用）</p> <p>none： 不配置网络</p> <p>host：和宿主机共享网络</p> <p>container：容器网络连通（用的少）</p> <ul><li><strong>测试</strong></li></ul> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code>
<span class="token comment"># 我们可以自定义一个网络！</span>
<span class="token punctuation">[</span>root@vm1029731 ~<span class="token punctuation">]</span><span class="token comment"># docker network create --driver bridge --subnet 192.168.0.0/16 --gateway 192.168.0.1 mynetwork</span>
c53f3f0cc52fdfce6dd49b536b4309bd5e25411814c5ac8f894ccb85cc55ac82
<span class="token punctuation">[</span>root@vm1029731 ~<span class="token punctuation">]</span><span class="token comment"># docker network ls</span>
NETWORK ID     NAME        DRIVER    SCOPE
e2ca01469d86   bridge      bridge    <span class="token builtin class-name">local</span>
e6622eb8525b   <span class="token function">host</span>        <span class="token function">host</span>      <span class="token builtin class-name">local</span>
c53f3f0cc52f   mynetwork   bridge    <span class="token builtin class-name">local</span>
3ac8be8b0ec4   none        null      <span class="token builtin class-name">local</span>
<span class="token punctuation">[</span>root@vm1029731 ~<span class="token punctuation">]</span><span class="token comment"># </span>

<span class="token comment"># 查看我们的自己的网络</span>
<span class="token function">docker</span> network inspect mynetwork

<span class="token punctuation">[</span>root@vm1029731 ~<span class="token punctuation">]</span><span class="token comment"># docker network inspect mynetwork</span>
<span class="token punctuation">[</span>
    <span class="token punctuation">{</span>
        <span class="token string">&quot;Name&quot;</span><span class="token builtin class-name">:</span> <span class="token string">&quot;mynetwork&quot;</span>,
        <span class="token string">&quot;Id&quot;</span><span class="token builtin class-name">:</span> <span class="token string">&quot;c53f3f0cc52fdfce6dd49b536b4309bd5e25411814c5ac8f894ccb85cc55ac82&quot;</span>,
        <span class="token string">&quot;Created&quot;</span><span class="token builtin class-name">:</span> <span class="token string">&quot;2022-10-05T06:31:53.121675601Z&quot;</span>,
        <span class="token string">&quot;Scope&quot;</span><span class="token builtin class-name">:</span> <span class="token string">&quot;local&quot;</span>,
        <span class="token string">&quot;Driver&quot;</span><span class="token builtin class-name">:</span> <span class="token string">&quot;bridge&quot;</span>,
        <span class="token string">&quot;EnableIPv6&quot;</span><span class="token builtin class-name">:</span> false,
        <span class="token string">&quot;IPAM&quot;</span><span class="token builtin class-name">:</span> <span class="token punctuation">{</span>
            <span class="token string">&quot;Driver&quot;</span><span class="token builtin class-name">:</span> <span class="token string">&quot;default&quot;</span>,
            <span class="token string">&quot;Options&quot;</span><span class="token builtin class-name">:</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>,
            <span class="token string">&quot;Config&quot;</span><span class="token builtin class-name">:</span> <span class="token punctuation">[</span>
                <span class="token punctuation">{</span>
                    <span class="token string">&quot;Subnet&quot;</span><span class="token builtin class-name">:</span> <span class="token string">&quot;192.168.0.0/16&quot;</span>,
                    <span class="token string">&quot;Gateway&quot;</span><span class="token builtin class-name">:</span> <span class="token string">&quot;192.168.0.1&quot;</span>
                <span class="token punctuation">}</span>
            <span class="token punctuation">]</span>
        <span class="token punctuation">}</span>,
        <span class="token string">&quot;Internal&quot;</span><span class="token builtin class-name">:</span> false,
        <span class="token string">&quot;Attachable&quot;</span><span class="token builtin class-name">:</span> false,
        <span class="token string">&quot;Ingress&quot;</span><span class="token builtin class-name">:</span> false,
        <span class="token string">&quot;ConfigFrom&quot;</span><span class="token builtin class-name">:</span> <span class="token punctuation">{</span>
            <span class="token string">&quot;Network&quot;</span><span class="token builtin class-name">:</span> <span class="token string">&quot;&quot;</span>
        <span class="token punctuation">}</span>,
        <span class="token string">&quot;ConfigOnly&quot;</span><span class="token builtin class-name">:</span> false,
        <span class="token string">&quot;Containers&quot;</span><span class="token builtin class-name">:</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>,
        <span class="token string">&quot;Options&quot;</span><span class="token builtin class-name">:</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>,
        <span class="token string">&quot;Labels&quot;</span><span class="token builtin class-name">:</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
 
<span class="token comment"># 使用我们自己搭建的网络run容器</span>
<span class="token punctuation">[</span>root@0a7f581f70f8 /docker run <span class="token parameter variable">-it</span> <span class="token parameter variable">--name</span> centos02 <span class="token parameter variable">--network</span> mynetwork  centos /bin/bash

<span class="token comment"># 搭建两个</span>
<span class="token punctuation">[</span>root@0a7f581f70f8 /docker run <span class="token parameter variable">-it</span> <span class="token parameter variable">--name</span> centos01 <span class="token parameter variable">--network</span> mynetwork  centos /bin/bash

<span class="token comment">#相互ping</span>
<span class="token punctuation">[</span>root@eb941f2308c2 /<span class="token punctuation">]</span><span class="token comment"># ping 192.168.0.2</span>
PING <span class="token number">192.168</span>.0.2 <span class="token punctuation">(</span><span class="token number">192.168</span>.0.2<span class="token punctuation">)</span> <span class="token number">56</span><span class="token punctuation">(</span><span class="token number">84</span><span class="token punctuation">)</span> bytes of data.
<span class="token number">64</span> bytes from <span class="token number">192.168</span>.0.2: <span class="token assign-left variable">icmp_seq</span><span class="token operator">=</span><span class="token number">1</span> <span class="token assign-left variable">ttl</span><span class="token operator">=</span><span class="token number">64</span> <span class="token assign-left variable">time</span><span class="token operator">=</span><span class="token number">0.107</span> ms
<span class="token number">64</span> bytes from <span class="token number">192.168</span>.0.2: <span class="token assign-left variable">icmp_seq</span><span class="token operator">=</span><span class="token number">2</span> <span class="token assign-left variable">ttl</span><span class="token operator">=</span><span class="token number">64</span> <span class="token assign-left variable">time</span><span class="token operator">=</span><span class="token number">0.072</span> ms
<span class="token number">64</span> bytes from <span class="token number">192.168</span>.0.2: <span class="token assign-left variable">icmp_seq</span><span class="token operator">=</span><span class="token number">3</span> <span class="token assign-left variable">ttl</span><span class="token operator">=</span><span class="token number">64</span> <span class="token assign-left variable">time</span><span class="token operator">=</span><span class="token number">0.106</span> ms

<span class="token number">64</span> bytes from <span class="token number">192.168</span>.0.2: <span class="token assign-left variable">icmp_seq</span><span class="token operator">=</span><span class="token number">4</span> <span class="token assign-left variable">ttl</span><span class="token operator">=</span><span class="token number">64</span> <span class="token assign-left variable">time</span><span class="token operator">=</span><span class="token number">0.067</span> ms
<span class="token number">64</span> bytes from <span class="token number">192.168</span>.0.2: <span class="token assign-left variable">icmp_seq</span><span class="token operator">=</span><span class="token number">5</span> <span class="token assign-left variable">ttl</span><span class="token operator">=</span><span class="token number">64</span> <span class="token assign-left variable">time</span><span class="token operator">=</span><span class="token number">0.069</span> ms

可以ping通
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br><span class="line-number">53</span><br><span class="line-number">54</span><br><span class="line-number">55</span><br><span class="line-number">56</span><br><span class="line-number">57</span><br><span class="line-number">58</span><br><span class="line-number">59</span><br><span class="line-number">60</span><br><span class="line-number">61</span><br><span class="line-number">62</span><br></div></div><p>我们自定义的网络帮我们已经维护好对应关系，推荐我们平时使用这样的网络！</p> <ul><li>好处</li></ul> <p>redis-不同集群使用不同的网络，保证集群是安全和健康的</p> <p>mysql-不同集群使用不同的网络，保证集群是安全和健康的</p> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code><span class="token comment">#进入容器后解决apt update下载速度慢</span>
root@6646172977e6:/usr/local/tomcat<span class="token comment"># cd /etc/apt</span>
root@6646172977e6:/etc/apt<span class="token comment"># ls</span>
apt.conf.d  auth.conf.d  preferences.d	sources.list  sources.list.d  trusted.gpg.d
root@6646172977e6:/etc/apt<span class="token comment"># echo &quot;&quot;&gt;sources.list</span>
root@6646172977e6:/etc/apt<span class="token comment"># echo &quot;deb http://ftp2.cn.debian.org/debian/ buster main&quot;&gt;&gt;sources.list</span>
root@6646172977e6:/etc/apt<span class="token comment"># echo &quot;deb http://ftp2.cn.debian.org/debian/debian-security buster/updates main&quot;&gt;&gt;sources.list</span>
root@6646172977e6:/etc/apt<span class="token comment"># echo &quot;deb http://ftp2.cn.debian.org/debian/debian buster-updates main&quot;&gt;&gt;sources.list</span>

</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br></div></div><h3 id="网络连通"><a href="#网络连通" class="header-anchor">#</a> <strong>网络连通</strong></h3> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code><span class="token comment">#尝试将tomcat01和tomcat-net-01连通</span>
<span class="token punctuation">[</span>root@iZ2vc7zktoz7z9fn3qhptjZ ~<span class="token punctuation">]</span><span class="token comment"># docker exec -it tomcat01 ping tomcat-net-01</span>
ping: tomcat-net-01: Name or <span class="token function">service</span> not known
<span class="token comment">#失败</span>

</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><ul><li>docker network命令</li></ul> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code><span class="token punctuation">[</span>root@vm1029731 ~<span class="token punctuation">]</span><span class="token comment"># docker network --help</span>

Usage:  <span class="token function">docker</span> network COMMAND

Manage networks

Commands:
  connect     Connect a container to a network
  create      Create a network
  disconnect  Disconnect a container from a network
  inspect     Display detailed information on one or <span class="token function">more</span> networks
  <span class="token function">ls</span>          List networks
  prune       Remove all unused networks
  <span class="token function">rm</span>          Remove one or <span class="token function">more</span> networks
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br></div></div><ul><li>docker network connect命令</li></ul> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code><span class="token punctuation">[</span>root@vm1029731 ~<span class="token punctuation">]</span><span class="token comment"># docker network connect --help</span>

Usage:  <span class="token function">docker</span> network connect <span class="token punctuation">[</span>OPTIONS<span class="token punctuation">]</span> NETWORK CONTAINER

Connect a container to a network

Options:
      <span class="token parameter variable">--alias</span> strings           Add network-scoped <span class="token builtin class-name">alias</span> <span class="token keyword">for</span> the container
      --driver-opt strings      driver options <span class="token keyword">for</span> the network
      <span class="token parameter variable">--ip</span> string               IPv4 address <span class="token punctuation">(</span>e.g., <span class="token number">172.30</span>.100.104<span class="token punctuation">)</span>
      <span class="token parameter variable">--ip6</span> string              IPv6 address <span class="token punctuation">(</span>e.g., <span class="token number">2001</span>:db8::33<span class="token punctuation">)</span>
      <span class="token parameter variable">--link</span> list               Add <span class="token function">link</span> to another container
      --link-local-ip strings   Add a link-local address <span class="token keyword">for</span> the container
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br></div></div><div class="language-bash line-numbers-mode"><pre class="language-bash"><code><span class="token comment">#测试  tomcat能否ping通tomcat-net-01</span>
<span class="token function">docker</span> network connect mynet tomcat01
<span class="token comment">#连通之后就是将tomcat01放到了mynet网络下</span>
<span class="token comment">#一个容器两个ip地址</span>

<span class="token string">&quot;Networks&quot;</span><span class="token builtin class-name">:</span> <span class="token punctuation">{</span>
                <span class="token string">&quot;bridge&quot;</span><span class="token builtin class-name">:</span> <span class="token punctuation">{</span>
                    <span class="token string">&quot;IPAMConfig&quot;</span><span class="token builtin class-name">:</span> null,
                    <span class="token string">&quot;Links&quot;</span><span class="token builtin class-name">:</span> null,
                    <span class="token string">&quot;Aliases&quot;</span><span class="token builtin class-name">:</span> null,
                    <span class="token string">&quot;NetworkID&quot;</span><span class="token builtin class-name">:</span> <span class="token string">&quot;e2ca01469d86d2e82406bfffef661244084989d16dbff4497ea894cb90a357c9&quot;</span>,
                    <span class="token string">&quot;EndpointID&quot;</span><span class="token builtin class-name">:</span> <span class="token string">&quot;5ef0ac9d6b1d139b3e734c948fabb6ca69a2f5ec36228d6e9d9cf79e7a087b33&quot;</span>,
                    <span class="token string">&quot;Gateway&quot;</span><span class="token builtin class-name">:</span> <span class="token string">&quot;172.17.0.1&quot;</span>,
                    <span class="token string">&quot;IPAddress&quot;</span><span class="token builtin class-name">:</span> <span class="token string">&quot;172.17.0.4&quot;</span>,
                    <span class="token string">&quot;IPPrefixLen&quot;</span><span class="token builtin class-name">:</span> <span class="token number">16</span>,
                    <span class="token string">&quot;IPv6Gateway&quot;</span><span class="token builtin class-name">:</span> <span class="token string">&quot;&quot;</span>,
                    <span class="token string">&quot;GlobalIPv6Address&quot;</span><span class="token builtin class-name">:</span> <span class="token string">&quot;&quot;</span>,
                    <span class="token string">&quot;GlobalIPv6PrefixLen&quot;</span><span class="token builtin class-name">:</span> <span class="token number">0</span>,
                    <span class="token string">&quot;MacAddress&quot;</span><span class="token builtin class-name">:</span> <span class="token string">&quot;02:42:ac:11:00:04&quot;</span>,
                    <span class="token string">&quot;DriverOpts&quot;</span><span class="token builtin class-name">:</span> null
                <span class="token punctuation">}</span>,
                <span class="token string">&quot;mynetwork&quot;</span><span class="token builtin class-name">:</span> <span class="token punctuation">{</span>
                    <span class="token string">&quot;IPAMConfig&quot;</span><span class="token builtin class-name">:</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>,
                    <span class="token string">&quot;Links&quot;</span><span class="token builtin class-name">:</span> null,
                    <span class="token string">&quot;Aliases&quot;</span><span class="token builtin class-name">:</span> <span class="token punctuation">[</span>
                        <span class="token string">&quot;8ff8cc1c9ad7&quot;</span>
                    <span class="token punctuation">]</span>,
                    <span class="token string">&quot;NetworkID&quot;</span><span class="token builtin class-name">:</span> <span class="token string">&quot;c53f3f0cc52fdfce6dd49b536b4309bd5e25411814c5ac8f894ccb85cc55ac82&quot;</span>,
                    <span class="token string">&quot;EndpointID&quot;</span><span class="token builtin class-name">:</span> <span class="token string">&quot;26d88c929ed41a690e623d5f7f2183ec304aabaa8117af6836b82261f17bcc91&quot;</span>,
                    <span class="token string">&quot;Gateway&quot;</span><span class="token builtin class-name">:</span> <span class="token string">&quot;192.168.0.1&quot;</span>,
                    <span class="token string">&quot;IPAddress&quot;</span><span class="token builtin class-name">:</span> <span class="token string">&quot;192.168.0.4&quot;</span>,
                    <span class="token string">&quot;IPPrefixLen&quot;</span><span class="token builtin class-name">:</span> <span class="token number">16</span>,
                    <span class="token string">&quot;IPv6Gateway&quot;</span><span class="token builtin class-name">:</span> <span class="token string">&quot;&quot;</span>,
                    <span class="token string">&quot;GlobalIPv6Address&quot;</span><span class="token builtin class-name">:</span> <span class="token string">&quot;&quot;</span>,
                    <span class="token string">&quot;GlobalIPv6PrefixLen&quot;</span><span class="token builtin class-name">:</span> <span class="token number">0</span>,
                    <span class="token string">&quot;MacAddress&quot;</span><span class="token builtin class-name">:</span> <span class="token string">&quot;02:42:c0:a8:00:04&quot;</span>,
                    <span class="token string">&quot;DriverOpts&quot;</span><span class="token builtin class-name">:</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
                <span class="token punctuation">}</span>

</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br></div></div><div class="language-bash line-numbers-mode"><pre class="language-bash"><code><span class="token punctuation">[</span>root@iZ2vc7zktoz7z9fn3qhptjZ ~<span class="token punctuation">]</span><span class="token comment"># docker exec -it tomcat01 ping tomcat-net-01</span>
PING tomcat-net-01 <span class="token punctuation">(</span><span class="token number">192.168</span>.0.3<span class="token punctuation">)</span> <span class="token number">56</span><span class="token punctuation">(</span><span class="token number">84</span><span class="token punctuation">)</span> bytes of data.
<span class="token number">64</span> bytes from tomcat-net-01.mynet <span class="token punctuation">(</span><span class="token number">192.168</span>.0.3<span class="token punctuation">)</span>: <span class="token assign-left variable">icmp_seq</span><span class="token operator">=</span><span class="token number">1</span> <span class="token assign-left variable">ttl</span><span class="token operator">=</span><span class="token number">64</span> <span class="token assign-left variable">time</span><span class="token operator">=</span><span class="token number">0.072</span> ms
<span class="token number">64</span> bytes from tomcat-net-01.mynet <span class="token punctuation">(</span><span class="token number">192.168</span>.0.3<span class="token punctuation">)</span>: <span class="token assign-left variable">icmp_seq</span><span class="token operator">=</span><span class="token number">2</span> <span class="token assign-left variable">ttl</span><span class="token operator">=</span><span class="token number">64</span> <span class="token assign-left variable">time</span><span class="token operator">=</span><span class="token number">0.053</span> ms
<span class="token number">64</span> bytes from tomcat-net-01.mynet <span class="token punctuation">(</span><span class="token number">192.168</span>.0.3<span class="token punctuation">)</span>: <span class="token assign-left variable">icmp_seq</span><span class="token operator">=</span><span class="token number">3</span> <span class="token assign-left variable">ttl</span><span class="token operator">=</span><span class="token number">64</span> <span class="token assign-left variable">time</span><span class="token operator">=</span><span class="token number">0.055</span> ms
<span class="token comment">#tomcat01和tomcat-net-01连通</span>

<span class="token comment">#tomcat02依旧是打不通的</span>
<span class="token punctuation">[</span>root@iZ2vc7zktoz7z9fn3qhptjZ ~<span class="token punctuation">]</span><span class="token comment"># docker exec -it tomcat02 ping tomcat-net-01</span>
ping: tomcat-net-01: Name or <span class="token function">service</span> not known

</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br></div></div><p>结论：假设要跨网操作别人，就需要使用docker network connect连通。</p> <h3 id="实战-部署redis集群"><a href="#实战-部署redis集群" class="header-anchor">#</a> 实战：部署redis集群</h3> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code><span class="token comment">#创建网卡</span>
<span class="token function">docker</span> network create redis <span class="token parameter variable">--subnet</span> <span class="token number">172.38</span>.0.0/16

<span class="token comment">#通过脚本创建6个Redis配置</span>
redis集群
<span class="token keyword">for</span> <span class="token for-or-select variable">port</span> <span class="token keyword">in</span> <span class="token variable"><span class="token variable">$(</span><span class="token function">seq</span> <span class="token number">1</span> <span class="token number">6</span><span class="token variable">)</span></span><span class="token punctuation">;</span> <span class="token punctuation">\</span>
<span class="token keyword">do</span> <span class="token punctuation">\</span>
<span class="token function">mkdir</span> <span class="token parameter variable">-p</span> /mydata/redis/node-<span class="token variable">${port}</span>/conf
<span class="token function">touch</span> /mydata/redis/node-<span class="token variable">${port}</span>/conf/redis.conf
<span class="token function">cat</span> <span class="token operator">&lt;&lt;</span> <span class="token string">EOF<span class="token bash punctuation"> <span class="token operator">&gt;</span>/mydata/redis/node-<span class="token variable">${port}</span>/conf/redis.conf</span>
port 6379
bind 0.0.0.0
cluster-enabled yes
cluster-config-file nodes.conf
cluster-node-timeout 5000
cluster-announce-ip 172.38.0.1<span class="token variable">${port}</span>
cluster-announce-port 6379
cluster-announce-bus-port 16379
appendonly yes
EOF</span>
<span class="token keyword">done</span>

运行部分
<span class="token keyword">for</span> <span class="token for-or-select variable">port</span> <span class="token keyword">in</span> <span class="token variable"><span class="token variable">$(</span><span class="token function">seq</span> <span class="token number">1</span> <span class="token number">6</span><span class="token variable">)</span></span><span class="token punctuation">;</span> <span class="token punctuation">\</span>
<span class="token keyword">do</span>
<span class="token function">docker</span> run <span class="token parameter variable">-p</span> <span class="token number">637</span><span class="token variable">${port}</span>:6379 <span class="token parameter variable">-p</span> <span class="token number">1637</span><span class="token variable">${port}</span>:16379 <span class="token parameter variable">--name</span> redis-<span class="token variable">${port}</span> <span class="token punctuation">\</span>
<span class="token parameter variable">-v</span> /mydata/redis/node-<span class="token variable">${port}</span>/data:/data <span class="token punctuation">\</span>
<span class="token parameter variable">-v</span> /mydata/redis/node-<span class="token variable">${port}</span>/conf/redis.conf:/etc/redis/redis.conf <span class="token punctuation">\</span>
<span class="token parameter variable">-d</span> <span class="token parameter variable">--net</span> redis <span class="token parameter variable">--ip</span> <span class="token number">172.38</span>.0.1<span class="token variable">${port}</span> redis:5.0.9-alpine3.11 redis-server /etc/redis/redis.conf<span class="token punctuation">;</span> <span class="token punctuation">\</span>
<span class="token keyword">done</span>

<span class="token comment">#创建集群</span>
<span class="token punctuation">[</span>root@iZ2vc7zktoz7z9fn3qhptjZ conf<span class="token punctuation">]</span><span class="token comment"># docker exec -it redis-1 /bin/sh</span>
/data <span class="token comment"># ls</span>
appendonly.aof  nodes.conf
/data <span class="token comment"># redis-cli --cluster create 172.38.0.11:6379 172.38.0.12:6379 172.38.0.13:6379 172.38.0.14:6379 172.</span>
<span class="token number">38.0</span>.15:6379 <span class="token number">172.38</span>.0.16:6379 --cluster-replicas <span class="token number">1</span>
<span class="token operator">&gt;&gt;</span><span class="token operator">&gt;</span> Performing <span class="token builtin class-name">hash</span> slots allocation on <span class="token number">6</span> nodes<span class="token punctuation">..</span>.
Master<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> -<span class="token operator">&gt;</span> Slots <span class="token number">0</span> - <span class="token number">5460</span>
Master<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> -<span class="token operator">&gt;</span> Slots <span class="token number">5461</span> - <span class="token number">10922</span>
Master<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span> -<span class="token operator">&gt;</span> Slots <span class="token number">10923</span> - <span class="token number">16383</span>
Adding replica <span class="token number">172.38</span>.0.15:6379 to <span class="token number">172.38</span>.0.11:6379
Adding replica <span class="token number">172.38</span>.0.16:6379 to <span class="token number">172.38</span>.0.12:6379
Adding replica <span class="token number">172.38</span>.0.14:6379 to <span class="token number">172.38</span>.0.13:6379
M: 3d08d4a1b1a69e6541f94748cf58f0e3d406c7f5 <span class="token number">172.38</span>.0.11:6379
   slots:<span class="token punctuation">[</span><span class="token number">0</span>-5460<span class="token punctuation">]</span> <span class="token punctuation">(</span><span class="token number">5461</span> slots<span class="token punctuation">)</span> master
M: 4409cb51675fd8cfc259b083991d40225329747f <span class="token number">172.38</span>.0.12:6379
   slots:<span class="token punctuation">[</span><span class="token number">5461</span>-10922<span class="token punctuation">]</span> <span class="token punctuation">(</span><span class="token number">5462</span> slots<span class="token punctuation">)</span> master
M: f0bf7d6fce8e15091e4de77d2e3c0fc28db6c4d5 <span class="token number">172.38</span>.0.13:6379
   slots:<span class="token punctuation">[</span><span class="token number">10923</span>-16383<span class="token punctuation">]</span> <span class="token punctuation">(</span><span class="token number">5461</span> slots<span class="token punctuation">)</span> master
S: eca5b549a77c15e0274f2472600bfbf05dc00b82 <span class="token number">172.38</span>.0.14:6379
   replicates f0bf7d6fce8e15091e4de77d2e3c0fc28db6c4d5
S: 92d808d95466384e4dc5f26d2b50f77f0207e887 <span class="token number">172.38</span>.0.15:6379
   replicates 3d08d4a1b1a69e6541f94748cf58f0e3d406c7f5
S: 6856d04ed4b0b2ef5257ff3f9638518089eb1133 <span class="token number">172.38</span>.0.16:6379
   replicates 4409cb51675fd8cfc259b083991d40225329747f
Can I <span class="token builtin class-name">set</span> the above configuration? <span class="token punctuation">(</span>type <span class="token string">'yes'</span> to accept<span class="token punctuation">)</span>: <span class="token function">yes</span>
<span class="token operator">&gt;&gt;</span><span class="token operator">&gt;</span> Nodes configuration updated
<span class="token operator">&gt;&gt;</span><span class="token operator">&gt;</span> Assign a different config epoch to each <span class="token function">node</span>
<span class="token operator">&gt;&gt;</span><span class="token operator">&gt;</span> Sending CLUSTER MEET messages to <span class="token function">join</span> the cluster
Waiting <span class="token keyword">for</span> the cluster to <span class="token function">join</span>
<span class="token punctuation">..</span>
<span class="token operator">&gt;&gt;</span><span class="token operator">&gt;</span> Performing Cluster Check <span class="token punctuation">(</span>using <span class="token function">node</span> <span class="token number">172.38</span>.0.11:6379<span class="token punctuation">)</span>
M: 3d08d4a1b1a69e6541f94748cf58f0e3d406c7f5 <span class="token number">172.38</span>.0.11:6379
   slots:<span class="token punctuation">[</span><span class="token number">0</span>-5460<span class="token punctuation">]</span> <span class="token punctuation">(</span><span class="token number">5461</span> slots<span class="token punctuation">)</span> master
   <span class="token number">1</span> additional replica<span class="token punctuation">(</span>s<span class="token punctuation">)</span>
S: 92d808d95466384e4dc5f26d2b50f77f0207e887 <span class="token number">172.38</span>.0.15:6379
   slots: <span class="token punctuation">(</span><span class="token number">0</span> slots<span class="token punctuation">)</span> slave
   replicates 3d08d4a1b1a69e6541f94748cf58f0e3d406c7f5
S: 6856d04ed4b0b2ef5257ff3f9638518089eb1133 <span class="token number">172.38</span>.0.16:6379
   slots: <span class="token punctuation">(</span><span class="token number">0</span> slots<span class="token punctuation">)</span> slave
   replicates 4409cb51675fd8cfc259b083991d40225329747f
M: f0bf7d6fce8e15091e4de77d2e3c0fc28db6c4d5 <span class="token number">172.38</span>.0.13:6379
   slots:<span class="token punctuation">[</span><span class="token number">10923</span>-16383<span class="token punctuation">]</span> <span class="token punctuation">(</span><span class="token number">5461</span> slots<span class="token punctuation">)</span> master
   <span class="token number">1</span> additional replica<span class="token punctuation">(</span>s<span class="token punctuation">)</span>
M: 4409cb51675fd8cfc259b083991d40225329747f <span class="token number">172.38</span>.0.12:6379
   slots:<span class="token punctuation">[</span><span class="token number">5461</span>-10922<span class="token punctuation">]</span> <span class="token punctuation">(</span><span class="token number">5462</span> slots<span class="token punctuation">)</span> master
   <span class="token number">1</span> additional replica<span class="token punctuation">(</span>s<span class="token punctuation">)</span>
S: eca5b549a77c15e0274f2472600bfbf05dc00b82 <span class="token number">172.38</span>.0.14:6379
   slots: <span class="token punctuation">(</span><span class="token number">0</span> slots<span class="token punctuation">)</span> slave
   replicates f0bf7d6fce8e15091e4de77d2e3c0fc28db6c4d5
<span class="token punctuation">[</span>OK<span class="token punctuation">]</span> All nodes agree about slots configuration.
<span class="token operator">&gt;&gt;</span><span class="token operator">&gt;</span> Check <span class="token keyword">for</span> <span class="token function">open</span> slots<span class="token punctuation">..</span>.
<span class="token operator">&gt;&gt;</span><span class="token operator">&gt;</span> Check slots coverage<span class="token punctuation">..</span>.
<span class="token punctuation">[</span>OK<span class="token punctuation">]</span> All <span class="token number">16384</span> slots covered.

</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br><span class="line-number">53</span><br><span class="line-number">54</span><br><span class="line-number">55</span><br><span class="line-number">56</span><br><span class="line-number">57</span><br><span class="line-number">58</span><br><span class="line-number">59</span><br><span class="line-number">60</span><br><span class="line-number">61</span><br><span class="line-number">62</span><br><span class="line-number">63</span><br><span class="line-number">64</span><br><span class="line-number">65</span><br><span class="line-number">66</span><br><span class="line-number">67</span><br><span class="line-number">68</span><br><span class="line-number">69</span><br><span class="line-number">70</span><br><span class="line-number">71</span><br><span class="line-number">72</span><br><span class="line-number">73</span><br><span class="line-number">74</span><br><span class="line-number">75</span><br><span class="line-number">76</span><br><span class="line-number">77</span><br><span class="line-number">78</span><br><span class="line-number">79</span><br><span class="line-number">80</span><br><span class="line-number">81</span><br><span class="line-number">82</span><br><span class="line-number">83</span><br><span class="line-number">84</span><br><span class="line-number">85</span><br><span class="line-number">86</span><br></div></div><div class="language-bash line-numbers-mode"><pre class="language-bash"><code><span class="token comment">#测试</span>
/data <span class="token comment"># redis-cli -c</span>
<span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>&gt;</span> cluster info
cluster_state:ok
cluster_slots_assigned:16384
cluster_slots_ok:16384
cluster_slots_pfail:0
cluster_slots_fail:0
cluster_known_nodes:6
cluster_size:3
cluster_current_epoch:6
cluster_my_epoch:1
cluster_stats_messages_ping_sent:186
cluster_stats_messages_pong_sent:199
cluster_stats_messages_sent:385
cluster_stats_messages_ping_received:194
cluster_stats_messages_pong_received:186
cluster_stats_messages_meet_received:5
cluster_stats_messages_received:385
<span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>&gt;</span> cluster nodes
92d808d95466384e4dc5f26d2b50f77f0207e887 <span class="token number">172.38</span>.0.15:6379@16379 slave 3d08d4a1b1a69e6541f94748cf58f0e3d406c7f5 <span class="token number">0</span> <span class="token number">1635347376000</span> <span class="token number">5</span> connected
6856d04ed4b0b2ef5257ff3f9638518089eb1133 <span class="token number">172.38</span>.0.16:6379@16379 slave 4409cb51675fd8cfc259b083991d40225329747f <span class="token number">0</span> <span class="token number">1635347377502</span> <span class="token number">6</span> connected
f0bf7d6fce8e15091e4de77d2e3c0fc28db6c4d5 <span class="token number">172.38</span>.0.13:6379@16379 master - <span class="token number">0</span> <span class="token number">1635347376501</span> <span class="token number">3</span> connected <span class="token number">10923</span>-16383
4409cb51675fd8cfc259b083991d40225329747f <span class="token number">172.38</span>.0.12:6379@16379 master - <span class="token number">0</span> <span class="token number">1635347376501</span> <span class="token number">2</span> connected <span class="token number">5461</span>-10922
3d08d4a1b1a69e6541f94748cf58f0e3d406c7f5 <span class="token number">172.38</span>.0.11:6379@16379 myself,master - <span class="token number">0</span> <span class="token number">1635347375000</span> <span class="token number">1</span> connected <span class="token number">0</span>-5460
eca5b549a77c15e0274f2472600bfbf05dc00b82 <span class="token number">172.38</span>.0.14:6379@16379 slave f0bf7d6fce8e15091e4de77d2e3c0fc28db6c4d5 <span class="token number">0</span> <span class="token number">1635347377002</span> <span class="token number">4</span> connected
<span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>&gt;</span> <span class="token builtin class-name">set</span> a b
-<span class="token operator">&gt;</span> Redirected to slot <span class="token punctuation">[</span><span class="token number">15495</span><span class="token punctuation">]</span> located at <span class="token number">172.38</span>.0.13:6379
OK
<span class="token number">172.38</span>.0.13:637<span class="token operator"><span class="token file-descriptor important">9</span>&gt;</span> get a
Could not connect to Redis at <span class="token number">172.38</span>.0.13:6379: Host is unreachable
<span class="token punctuation">(</span><span class="token number">18</span>.18s<span class="token punctuation">)</span>
not connected<span class="token operator">&gt;</span>
/data <span class="token comment"># redis-cli -c</span>
<span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>&gt;</span> get a
-<span class="token operator">&gt;</span> Redirected to slot <span class="token punctuation">[</span><span class="token number">15495</span><span class="token punctuation">]</span> located at <span class="token number">172.38</span>.0.14:6379
<span class="token string">&quot;b&quot;</span>
<span class="token number">172.38</span>.0.14:637<span class="token operator"><span class="token file-descriptor important">9</span>&gt;</span> cluster nodes
92d808d95466384e4dc5f26d2b50f77f0207e887 <span class="token number">172.38</span>.0.15:6379@16379 slave 3d08d4a1b1a69e6541f94748cf58f0e3d406c7f5 <span class="token number">0</span> <span class="token number">1635347593557</span> <span class="token number">1</span> connected
f0bf7d6fce8e15091e4de77d2e3c0fc28db6c4d5 <span class="token number">172.38</span>.0.13:6379@16379 master,fail - <span class="token number">1635347462939</span> <span class="token number">1635347462000</span> <span class="token number">3</span> connected
3d08d4a1b1a69e6541f94748cf58f0e3d406c7f5 <span class="token number">172.38</span>.0.11:6379@16379 master - <span class="token number">0</span> <span class="token number">1635347594560</span> <span class="token number">1</span> connected <span class="token number">0</span>-5460
6856d04ed4b0b2ef5257ff3f9638518089eb1133 <span class="token number">172.38</span>.0.16:6379@16379 slave 4409cb51675fd8cfc259b083991d40225329747f <span class="token number">0</span> <span class="token number">1635347593958</span> <span class="token number">6</span> connected
4409cb51675fd8cfc259b083991d40225329747f <span class="token number">172.38</span>.0.12:6379@16379 master - <span class="token number">0</span> <span class="token number">1635347593057</span> <span class="token number">2</span> connected <span class="token number">5461</span>-10922
eca5b549a77c15e0274f2472600bfbf05dc00b82 <span class="token number">172.38</span>.0.14:6379@16379 myself,master - <span class="token number">0</span> <span class="token number">1635347594000</span> <span class="token number">7</span> connected <span class="token number">10923</span>-16383

</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br></div></div><h3 id="springboot微服务打包docker镜像"><a href="#springboot微服务打包docker镜像" class="header-anchor">#</a> SpringBoot微服务打包Docker镜像</h3> <p>1.构建springboot项目</p> <p>2.打包应用</p> <p>3.编写dockerfile</p> <p>4.构建镜像</p> <p>5.发布运行</p> <h1 id="docker进阶"><a href="#docker进阶" class="header-anchor">#</a> Docker进阶</h1> <h2 id="docker-compose"><a href="#docker-compose" class="header-anchor">#</a> Docker Compose</h2> <p>Docker Compose轻松高效管理容器</p> <blockquote><p>官方介绍</p></blockquote> <p>定义运行多个容器</p> <p>YAML file配置文件</p> <p>Using Compose is basically a three-step process:</p> <ol><li>Define your app’s environment with a <code>Dockerfile</code> so it can be reproduced anywhere.</li> <li>Define the services that make up your app in <code>docker-compose.yml</code> so they can be run together in an isolated environment.</li> <li>Run <code>docker compose up</code> and the <a href="https://docs.docker.com/compose/cli-command/" target="_blank" rel="noopener noreferrer">Docker compose command<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> starts and runs your entire app. You can alternatively run <code>docker-compose up</code> using the docker-compose binary.</li></ol> <div class="language- line-numbers-mode"><pre class="language-text"><code>version: &quot;3.9&quot;  # optional since v1.27.0
services:
  web:
    build: .
    ports:
      - &quot;5000:5000&quot;
    volumes:
      - .:/code
      - logvolume01:/var/log
    links:
      - redis
  redis:
    image: redis
volumes:
  logvolume01: {}

</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br></div></div><blockquote><p>compose重要概念</p></blockquote> <ul><li>服务service，容器，应用（Redis，mysql）</li> <li>项目project 一组关联的容器</li></ul> <h3 id="安装"><a href="#安装" class="header-anchor">#</a> 安装</h3> <p>1.下载</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>curl -L &quot;https://github.com/docker/compose/releases/download/1.29.2/docker-compose-$(uname -s)-$(uname -m)&quot; -o /usr/local/bin/docker-compose

#或者
curl -L https://get.daocloud.io/docker/compose/releases/download/1.25.5/docker-compose-`uname -s`-`uname -m` &gt; /usr/local/bin/docker-compose

</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><p>2.授权</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>chmod +x /usr/local/bin/docker-compose
#查看是否安装成功
[root@ybw bin]# docker-compose version
docker-compose version 1.25.5, build 8a1c60f6
docker-py version: 4.1.0
CPython version: 3.7.5
OpenSSL version: OpenSSL 1.1.0l  10 Sep 2019

</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><p>3.体验</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>[root@ybw bin]# docker-compose version
docker-compose version 1.25.5, build 8a1c60f6
docker-py version: 4.1.0
CPython version: 3.7.5
OpenSSL version: OpenSSL 1.1.0l  10 Sep 2019

</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><p>1.应用app.py</p> <p>2.Dockerfile 应用打包为镜像</p> <p>3.Docker-compose.yaml（定义整个服务需要的环境 web redis）</p> <p>4.启动docker-compose(docker-compose up)</p> <p>流程</p> <p>1.创建网络</p> <p>2.执行docker-compose.yaml</p> <p>3.启动服务</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>[root@ybw composetest]# docker-compose up
Starting composetest_web_1 ...
Starting composetest_web_1 ... done

</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><div class="language- line-numbers-mode"><pre class="language-text"><code>#步骤
1.创建项目文件夹
mkdir composetest
cd composetest
#2创建app.py文件
import time

import redis
from flask import Flask

app = Flask(__name__)
cache = redis.Redis(host='redis', port=6379)

def get_hit_count():
    retries = 5
    while True:
        try:
            return cache.incr('hits')
        except redis.exceptions.ConnectionError as exc:
            if retries == 0:
                raise exc
            retries -= 1
            time.sleep(0.5)

@app.route('/')
def hello():
    count = get_hit_count()
    return 'Hello World! I have been seen {} times.\n'.format(count)

if __name__ == &quot;__main__&quot;:
    app.run(host=&quot;0.0.0.0&quot;,debug=True)

#3创建requirements.txt
flask
redis

#4创建Dockerfile
FROM python:3.6-alpine
ADD . /code
WORKDIR /code
RUN pip install -r requirements.txt
CMD [&quot;python&quot;, &quot;app.py&quot;]

#4创建docker-compose.yml文件
version: &quot;3.8&quot;
services:
  web:
    build: .
    ports:
      - &quot;5000:5000&quot;
    volumes:
      - .:/code
  redis:
    image: &quot;redis:alpine&quot;

#5使用docker-compose up 启动

</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br><span class="line-number">53</span><br><span class="line-number">54</span><br><span class="line-number">55</span><br><span class="line-number">56</span><br><span class="line-number">57</span><br></div></div><p>默认的服务名 ：文件名_______服务名____num</p> <p>网络规则</p> <p>以前都是单个docker run 启动容器</p> <p>docker-compose，通过编写yml文件，一次启动或停止多个容器</p> <h3 id="yaml规则"><a href="#yaml规则" class="header-anchor">#</a> yaml规则</h3> <div class="language- line-numbers-mode"><pre class="language-text"><code>#docker-compose.yml
#3层
version:'3.8'
service:
  服务1:web
    #服务配置
    images
    build
  服务2:redis
    #服务配置

  服务3：

#第3层 其它配置
volumes:
network:

</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br></div></div><h3 id="实战"><a href="#实战" class="header-anchor">#</a> 实战</h3> <p>docker-compose up --build #重新构建</p> <h2 id="docker-swarm"><a href="#docker-swarm" class="header-anchor">#</a> Docker Swarm</h2> <p>1.生成主节点 docker swarm init</p> <p>2.加入</p> <p>十分简单：集群，可用！3个主节点</p> <h3 id="raft协议"><a href="#raft协议" class="header-anchor">#</a> Raft协议</h3> <p>双主双从：假设一个节点挂了，其它节点是否可用</p> <p>Raft协议：保证绝大多数节点存活才可用，只要&gt;1,</p></div> <div class="page-meta"><footer class="page-edit" style="margin:0;"><!----> <!----></footer> <div class="page-views" data-v-1a66a508><i class="fas fa-eye" data-v-1a66a508></i> <span class="view-count" data-v-1a66a508><span id="busuanzi_container_page_pv" style="display: none;" data-v-1a66a508>
            阅读次数: <span id="busuanzi_value_page_pv" data-v-1a66a508>0</span></span></span></div></div> <!----></div> <div class="toc-container-sidebar"><div class="pos-box"><div class="icon-arrow"></div> <div class="scroll-box" style="max-height:86vh"><div style="font-weight:bold;">Docker</div> <hr> <div class="toc-box"><ul class="toc-sidebar-links"><li><a href="/%E7%9F%A5%E8%AF%86%E7%A2%8E%E7%89%87/%E5%B7%A5%E4%BB%B6/Docker/Docker.html#常用" class="toc-sidebar-link">常用</a><ul class="toc-sidebar-sub-headers"></ul></li><li><a href="/%E7%9F%A5%E8%AF%86%E7%A2%8E%E7%89%87/%E5%B7%A5%E4%BB%B6/Docker/Docker.html#帮助命令" class="toc-sidebar-link">帮助命令</a><ul class="toc-sidebar-sub-headers"></ul></li><li><a href="/%E7%9F%A5%E8%AF%86%E7%A2%8E%E7%89%87/%E5%B7%A5%E4%BB%B6/Docker/Docker.html#镜像命令" class="toc-sidebar-link">镜像命令</a><ul class="toc-sidebar-sub-headers"></ul></li><li><a href="/%E7%9F%A5%E8%AF%86%E7%A2%8E%E7%89%87/%E5%B7%A5%E4%BB%B6/Docker/Docker.html#容器命令" class="toc-sidebar-link">容器命令</a><ul class="toc-sidebar-sub-headers"></ul></li><li><a href="/%E7%9F%A5%E8%AF%86%E7%A2%8E%E7%89%87/%E5%B7%A5%E4%BB%B6/Docker/Docker.html#小结" class="toc-sidebar-link">小结</a><ul class="toc-sidebar-sub-headers"><li class="toc-sidebar-sub-header"><a href="/%E7%9F%A5%E8%AF%86%E7%A2%8E%E7%89%87/%E5%B7%A5%E4%BB%B6/Docker/Docker.html#基本常用命令" class="toc-sidebar-link">基本常用命令</a></li></ul></li><li><a href="/%E7%9F%A5%E8%AF%86%E7%A2%8E%E7%89%87/%E5%B7%A5%E4%BB%B6/Docker/Docker.html#docker安装nginx" class="toc-sidebar-link">docker安装nginx</a><ul class="toc-sidebar-sub-headers"><li class="toc-sidebar-sub-header"><a href="/%E7%9F%A5%E8%AF%86%E7%A2%8E%E7%89%87/%E5%B7%A5%E4%BB%B6/Docker/Docker.html#端口暴露概念" class="toc-sidebar-link">端口暴露概念</a></li></ul></li><li><a href="/%E7%9F%A5%E8%AF%86%E7%A2%8E%E7%89%87/%E5%B7%A5%E4%BB%B6/Docker/Docker.html#安装tomcat" class="toc-sidebar-link">安装tomcat</a><ul class="toc-sidebar-sub-headers"></ul></li><li><a href="/%E7%9F%A5%E8%AF%86%E7%A2%8E%E7%89%87/%E5%B7%A5%E4%BB%B6/Docker/Docker.html#部署es-kiband" class="toc-sidebar-link">部署es+kiband</a><ul class="toc-sidebar-sub-headers"></ul></li><li><a href="/%E7%9F%A5%E8%AF%86%E7%A2%8E%E7%89%87/%E5%B7%A5%E4%BB%B6/Docker/Docker.html#可视化portainer" class="toc-sidebar-link">可视化portainer</a><ul class="toc-sidebar-sub-headers"></ul></li><li><a href="/%E7%9F%A5%E8%AF%86%E7%A2%8E%E7%89%87/%E5%B7%A5%E4%BB%B6/Docker/Docker.html#镜像是什么" class="toc-sidebar-link">镜像是什么</a><ul class="toc-sidebar-sub-headers"></ul></li><li><a href="/%E7%9F%A5%E8%AF%86%E7%A2%8E%E7%89%87/%E5%B7%A5%E4%BB%B6/Docker/Docker.html#docker镜像加载原理" class="toc-sidebar-link">docker镜像加载原理</a><ul class="toc-sidebar-sub-headers"><li class="toc-sidebar-sub-header"><a href="/%E7%9F%A5%E8%AF%86%E7%A2%8E%E7%89%87/%E5%B7%A5%E4%BB%B6/Docker/Docker.html#unionfs联合文件系统" class="toc-sidebar-link">UnionFS联合文件系统</a></li><li class="toc-sidebar-sub-header"><a href="/%E7%9F%A5%E8%AF%86%E7%A2%8E%E7%89%87/%E5%B7%A5%E4%BB%B6/Docker/Docker.html#docker镜像加载原理-2" class="toc-sidebar-link">docker镜像加载原理</a></li><li class="toc-sidebar-sub-header"><a href="/%E7%9F%A5%E8%AF%86%E7%A2%8E%E7%89%87/%E5%B7%A5%E4%BB%B6/Docker/Docker.html#分层理解" class="toc-sidebar-link">分层理解</a></li></ul></li><li><a href="/%E7%9F%A5%E8%AF%86%E7%A2%8E%E7%89%87/%E5%B7%A5%E4%BB%B6/Docker/Docker.html#什么是容器数据卷" class="toc-sidebar-link">什么是容器数据卷</a><ul class="toc-sidebar-sub-headers"></ul></li><li><a href="/%E7%9F%A5%E8%AF%86%E7%A2%8E%E7%89%87/%E5%B7%A5%E4%BB%B6/Docker/Docker.html#使用数据卷" class="toc-sidebar-link">使用数据卷</a><ul class="toc-sidebar-sub-headers"><li class="toc-sidebar-sub-header"><a href="/%E7%9F%A5%E8%AF%86%E7%A2%8E%E7%89%87/%E5%B7%A5%E4%BB%B6/Docker/Docker.html#方式一-直接使用命令进行挂载-v" class="toc-sidebar-link">方式一：直接使用命令进行挂载 -v</a></li><li class="toc-sidebar-sub-header"><a href="/%E7%9F%A5%E8%AF%86%E7%A2%8E%E7%89%87/%E5%B7%A5%E4%BB%B6/Docker/Docker.html#实战-安装mysql" class="toc-sidebar-link">实战：安装MySQL</a></li><li class="toc-sidebar-sub-header"><a href="/%E7%9F%A5%E8%AF%86%E7%A2%8E%E7%89%87/%E5%B7%A5%E4%BB%B6/Docker/Docker.html#具名挂载和匿名挂载" class="toc-sidebar-link">具名挂载和匿名挂载</a></li><li class="toc-sidebar-sub-header"><a href="/%E7%9F%A5%E8%AF%86%E7%A2%8E%E7%89%87/%E5%B7%A5%E4%BB%B6/Docker/Docker.html#初识dockerfile" class="toc-sidebar-link">初识Dockerfile</a></li><li class="toc-sidebar-sub-header"><a href="/%E7%9F%A5%E8%AF%86%E7%A2%8E%E7%89%87/%E5%B7%A5%E4%BB%B6/Docker/Docker.html#数据卷容器" class="toc-sidebar-link">数据卷容器</a></li></ul></li><li><a href="/%E7%9F%A5%E8%AF%86%E7%A2%8E%E7%89%87/%E5%B7%A5%E4%BB%B6/Docker/Docker.html#dockerfile" class="toc-sidebar-link">Dockerfile</a><ul class="toc-sidebar-sub-headers"><li class="toc-sidebar-sub-header"><a href="/%E7%9F%A5%E8%AF%86%E7%A2%8E%E7%89%87/%E5%B7%A5%E4%BB%B6/Docker/Docker.html#dockerfile介绍" class="toc-sidebar-link">dockerfile介绍</a></li><li class="toc-sidebar-sub-header"><a href="/%E7%9F%A5%E8%AF%86%E7%A2%8E%E7%89%87/%E5%B7%A5%E4%BB%B6/Docker/Docker.html#dockerfile构建过程" class="toc-sidebar-link">Dockerfile构建过程</a></li><li class="toc-sidebar-sub-header"><a href="/%E7%9F%A5%E8%AF%86%E7%A2%8E%E7%89%87/%E5%B7%A5%E4%BB%B6/Docker/Docker.html#dockerfile的命令" class="toc-sidebar-link">DockerFile的命令</a></li><li class="toc-sidebar-sub-header"><a href="/%E7%9F%A5%E8%AF%86%E7%A2%8E%E7%89%87/%E5%B7%A5%E4%BB%B6/Docker/Docker.html#实战测试-写个自己的镜像" class="toc-sidebar-link">实战测试:写个自己的镜像</a></li><li class="toc-sidebar-sub-header"><a href="/%E7%9F%A5%E8%AF%86%E7%A2%8E%E7%89%87/%E5%B7%A5%E4%BB%B6/Docker/Docker.html#实战-tomcat镜像" class="toc-sidebar-link">实战：Tomcat镜像</a></li><li class="toc-sidebar-sub-header"><a href="/%E7%9F%A5%E8%AF%86%E7%A2%8E%E7%89%87/%E5%B7%A5%E4%BB%B6/Docker/Docker.html#发布自己的镜像" class="toc-sidebar-link">发布自己的镜像</a></li><li class="toc-sidebar-sub-header"><a href="/%E7%9F%A5%E8%AF%86%E7%A2%8E%E7%89%87/%E5%B7%A5%E4%BB%B6/Docker/Docker.html#发布到阿里云镜像" class="toc-sidebar-link">发布到阿里云镜像</a></li><li class="toc-sidebar-sub-header"><a href="/%E7%9F%A5%E8%AF%86%E7%A2%8E%E7%89%87/%E5%B7%A5%E4%BB%B6/Docker/Docker.html#小结-2" class="toc-sidebar-link">小结</a></li><li class="toc-sidebar-sub-header"><a href="/%E7%9F%A5%E8%AF%86%E7%A2%8E%E7%89%87/%E5%B7%A5%E4%BB%B6/Docker/Docker.html#网络名词" class="toc-sidebar-link">网络名词</a></li><li class="toc-sidebar-sub-header"><a href="/%E7%9F%A5%E8%AF%86%E7%A2%8E%E7%89%87/%E5%B7%A5%E4%BB%B6/Docker/Docker.html#理解docker0" class="toc-sidebar-link">理解docker0</a></li><li class="toc-sidebar-sub-header"><a href="/%E7%9F%A5%E8%AF%86%E7%A2%8E%E7%89%87/%E5%B7%A5%E4%BB%B6/Docker/Docker.html#link" class="toc-sidebar-link">—link</a></li><li class="toc-sidebar-sub-header"><a href="/%E7%9F%A5%E8%AF%86%E7%A2%8E%E7%89%87/%E5%B7%A5%E4%BB%B6/Docker/Docker.html#自定义网络" class="toc-sidebar-link">自定义网络</a></li><li class="toc-sidebar-sub-header"><a href="/%E7%9F%A5%E8%AF%86%E7%A2%8E%E7%89%87/%E5%B7%A5%E4%BB%B6/Docker/Docker.html#网络连通" class="toc-sidebar-link">网络连通</a></li><li class="toc-sidebar-sub-header"><a href="/%E7%9F%A5%E8%AF%86%E7%A2%8E%E7%89%87/%E5%B7%A5%E4%BB%B6/Docker/Docker.html#实战-部署redis集群" class="toc-sidebar-link">实战：部署redis集群</a></li><li class="toc-sidebar-sub-header"><a href="/%E7%9F%A5%E8%AF%86%E7%A2%8E%E7%89%87/%E5%B7%A5%E4%BB%B6/Docker/Docker.html#springboot微服务打包docker镜像" class="toc-sidebar-link">SpringBoot微服务打包Docker镜像</a></li></ul></li><li><a href="/%E7%9F%A5%E8%AF%86%E7%A2%8E%E7%89%87/%E5%B7%A5%E4%BB%B6/Docker/Docker.html#docker-compose" class="toc-sidebar-link">Docker Compose</a><ul class="toc-sidebar-sub-headers"><li class="toc-sidebar-sub-header"><a href="/%E7%9F%A5%E8%AF%86%E7%A2%8E%E7%89%87/%E5%B7%A5%E4%BB%B6/Docker/Docker.html#安装" class="toc-sidebar-link">安装</a></li><li class="toc-sidebar-sub-header"><a href="/%E7%9F%A5%E8%AF%86%E7%A2%8E%E7%89%87/%E5%B7%A5%E4%BB%B6/Docker/Docker.html#yaml规则" class="toc-sidebar-link">yaml规则</a></li><li class="toc-sidebar-sub-header"><a href="/%E7%9F%A5%E8%AF%86%E7%A2%8E%E7%89%87/%E5%B7%A5%E4%BB%B6/Docker/Docker.html#实战" class="toc-sidebar-link">实战</a></li></ul></li><li><a href="/%E7%9F%A5%E8%AF%86%E7%A2%8E%E7%89%87/%E5%B7%A5%E4%BB%B6/Docker/Docker.html#docker-swarm" class="toc-sidebar-link">Docker Swarm</a><ul class="toc-sidebar-sub-headers"><li class="toc-sidebar-sub-header"><a href="/%E7%9F%A5%E8%AF%86%E7%A2%8E%E7%89%87/%E5%B7%A5%E4%BB%B6/Docker/Docker.html#raft协议" class="toc-sidebar-link">Raft协议</a></li></ul></li></ul></div></div></div></div></div>  <main class="footer"> <div class="copy-right"><a target="_blank" rel="noreferrer">
              
            </a></div></main></main> <aside class="page-sidebar"> <div class="page-side-toolbar"></div>  </aside></div><div class="global-ui"><div></div><!----></div></div>
    <script src="/assets/js/app.ca6810f0.js" defer></script><script src="/assets/js/1.a7899151.js" defer></script><script src="/assets/js/93.87f9b7c1.js" defer></script>
  </body>
</html>
